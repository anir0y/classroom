<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>Log Analysis With SIEM - TryHackMe Walkthrough | Classroom</title><link href=/img/avatar.jpeg rel="shortcut icon" type=image/x-icon><meta name=author content="Animesh Roy @anir0y  "><meta name=description content="Try Hack Me Room Log Analysis With SIEM solved by Animesh Roy. this is a walkthough. read more..."><title>Animesh Roy | Classroom Posts</title><meta name=title content="Animesh Roy | Blogs & Writeups"><meta name=description content="Animesh Roy has more than a decade worth experience working in cyber security domain. He has worked with governments, corporates, colleges and universities, defence, and the community. He also running a community “Arishti Live” to help everyone who wants to, or work in cyber security domain. His expertise on training & consulting are the best of both the world. He uses his real-life case studies in trainings, to help candidates to understand the job in better ways."><script async src="https://www.googletagmanager.com/gtag/js?id=G-SPD6BXK0P5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SPD6BXK0P5")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","it10lq8bk1")</script><meta property="og:type" content="website"><meta property="og:url" content="https://classroom.anir0y.in/"><meta property="og:title" content="Animesh Roy | Blogs & Writeups"><meta property="og:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training"><meta property="og:image" content="https://i.imgur.com/Ji5C41H.png"><script type=text/javascript src=//cdn.cookie-script.com/s/88cd00f83ae38d0239d06996b1ad293a.js></script><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://classroom.anir0y.in/post/log-analysis-with-siem/"><meta property="twitter:title" content="Animesh Roy | Blogs & Writeups"><meta property="twitter:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training"><meta property="twitter:image" content="https://i.imgur.com/Ji5C41H.png"><script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><link rel=canonical href=https://classroom.anir0y.in/post/log-analysis-with-siem/><meta property="og:url" content="https://classroom.anir0y.in/post/log-analysis-with-siem/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="Log Analysis With SIEM - TryHackMe Walkthrough"><meta property="og:description" content="Try Hack Me Room Log Analysis With SIEM solved by Animesh Roy. this is a walkthough. read more..."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-12-15T19:16:54+05:30"><meta property="article:modified_time" content="2025-12-15T19:16:54+05:30"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="article:tag" content="Thm"><meta name=twitter:card content="summary"><meta name=twitter:title content="Log Analysis With SIEM - TryHackMe Walkthrough"><meta name=twitter:description content="Try Hack Me Room Log Analysis With SIEM solved by Animesh Roy. this is a walkthough. read more..."><link rel=stylesheet href=/css/semantic.min.css><link rel=stylesheet href=/css/icomoon.css><link rel=stylesheet href=/css/OverlayScrollbars.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/site.css><link rel=stylesheet href=/css/custom.css><style>a:not(.ui.button):hover{text-decoration:underline}a:not(.ui.button){color:#2e8b57!important}.inverted a:not(.ui.button),.inverted a:not(.ui.button):hover{color:#8fbc8f!important}body.default{background-color:#fff}body.dark{background-color:#000}</style><link rel=stylesheet data-highlight href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/tomorrow.min.css><link rel=stylesheet href=/css/custom.css></head><body class=default><nav class="ui secondary menu dream-menu"><div class=item><i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i></div><div class=item><i class="large link home icon" title=Home onclick='window.location.href="https://classroom.anir0y.in/"'></i></div><div class=item><i class="large link icon theme-switch" onclick=themeSwitch()></i></div><div class=item><i class="large link search icon" onclick=toggleSearch()></i></div></nav><div class=flip-container><div class=flipper><section class=front><div class=dream-max-width><div class="ui relaxed grid dream-grid dream-grid-single" style=flex-direction:row-reverse><aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside"><div class="ui segment toc"><nav id=TableOfContents><ul><li><a href=#overview>OverView</a></li></ul><ul><li><a href=#learning-objectives>Learning Objectives</a></li></ul><ul><li><a href=#centralisation>Centralisation</a></li><li><a href=#correlation>Correlation</a></li><li><a href=#historical-events>Historical Events</a></li><li><a href=#02---answer-the-questions-below>02 - Answer the questions below</a><ul><li><a href=#21-what-is-the-process-of-linking-data-from-multiple-sources-to-identify-relationships-between-individual-events-called>2.1: What is the process of linking data from multiple sources to identify relationships between individual events called?</a></li><li><a href=#22-what-is-the-process-of-collecting-and-storing-log-data-from-multiple-systems-and-sources-into-a-single-unified-location-for-easier-analysis-called>2.2: What is the process of collecting and storing log data from multiple systems and sources into a single, unified location for easier analysis called?</a></li></ul></li></ul><ul><li><a href=#host-based-log-sources>Host-Based Log Sources</a></li><li><a href=#network-based-log-sources>Network-Based Log Sources</a></li><li><a href=#web-based-log-sources>Web-Based Log Sources</a></li><li><a href=#03---answer-the-questions-below>03 - Answer the questions below</a><ul><li><a href=#31-what-is-the-process-of-converting-logs-from-different-formats-into-a-single-format-for-easier-analysis-in-a-siem>3.1: What is the process of converting logs from different formats into a single format for easier analysis in a SIEM?</a></li><li><a href=#32-which-log-source-type-can-be-used-to-detect-the-execution-of-a-malicious-script>3.2: Which log source type can be used to detect the execution of a malicious script?</a></li></ul></li></ul><ul><li><a href=#sysmon>Sysmon</a><ul><li></li></ul></li><li><a href=#wineventlogs>WinEventLogs</a><ul><li></li></ul></li><li><a href=#04---answer-the-questions-below>04 - Answer the questions below</a><ul><li><a href=#41-which-ip-address-was-the-connection-established-with>4.1: Which IP address was the connection established with?</a></li><li><a href=#42-which-process-initiated-this-suspicious-connection>4.2: Which process initiated this suspicious connection?</a></li><li><a href=#43-what-is-the-md5-hash-of-the-malicious-process-from-the-previous-question>4.3: What is the MD5 hash of the malicious process from the previous question?</a></li><li><a href=#44-what-is-the-name-of-the-scheduled-task-that-was-created-on-the-system>4.4: What is the name of the scheduled task that was created on the system?</a></li></ul></li></ul><ul><li><ul><li></li></ul></li><li><a href=#system-logs>System Logs</a><ul><li></li></ul></li><li><a href=#05---answer-the-questions-below>05 - Answer the questions below</a><ul><li><a href=#51-what-was-the-timestamp-of-the-remote-ssh-account-creation>5.1: What was the timestamp of the remote-ssh account creation?</a></li><li><a href=#52-which-user-successfully-escalated-their-privileges-to-root-prior-to-the-action-from-the-first-question>5.2: Which user successfully escalated their privileges to root prior to the action from the first question?</a></li><li><a href=#53-from-which-ip-address-did-the-user-from-the-previous-question-successfully-log-in-to-the-system>5.3: From which IP address did the user from the previous question successfully log in to the system?</a></li><li><a href=#54-how-many-failed-login-attempts-occurred-prior-to-this-successful-login>5.4: How many failed login attempts occurred prior to this successful login?</a></li><li><a href=#55-which-port-is-the-persistence-mechanism-configured-to-connect-to>5.5: Which port is the persistence mechanism configured to connect to?</a></li></ul></li></ul><ul><li><ul><li><a href=#web-log-sources>Web Log Sources</a></li></ul></li></ul><ul><li><ul><li><a href=#61-which-uri-path-had-the-highest-number-of-requests>6.1: Which URI path had the highest number of requests?</a></li><li><a href=#62-which-ip-address-was-the-source-of-the-activity>6.2: Which IP address was the source of the activity?</a></li><li><a href=#63-how-can-this-activity-be-classified>6.3: How can this activity be classified?</a></li><li><a href=#64-which-tool-did-the-threat-actor-use>6.4: Which tool did the threat actor use?</a></li></ul></li></ul></nav></div><div class="ui segment actions"><button class="ui circular icon button save-as-image" title="Save as image" onclick=savePostAsImg()>
<i class="save icon"></i>
</button>
<a href="https://twitter.com/intent/tweet?text=Log%20Analysis%20With%20SIEM%20-%20TryHackMe%20Walkthrough&url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2flog-analysis-with-siem%2f" class="ui circular twitter icon button"><i class="twitter icon"></i>
</a><a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2flog-analysis-with-siem%2f" class="ui circular facebook icon button"><i class="facebook icon"></i></a></div></aside><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img><section class="ui top attached segment"><header><h1 class="ui large header">Log Analysis With SIEM - TryHackMe Walkthrough<div class="sub header">@
<a href=https://bit.ly/34sGFiK target=_blank>Animesh Roy</a>
|
Monday, Dec 15, 2025
| 19 minutes read
| Update at
Monday, Dec 15, 2025</div></h1></header><article class=main><p>Learn how SIEM solutions can be used to detect and analyse malicious behaviour.</p><h2 id=overview>OverView</h2><table><thead><tr><th><script src=https://tryhackme.com/badge/434937></script></th><th><a class=twitter-follow-button href=https://twitter.com/anir0y data-size=large>Follow @anir0y<a></th></tr></thead><tbody><tr><td>Log Analysis With SIEM</td><td><img src=https://tryhackme-images.s3.amazonaws.com/room-icons/674d9727a22822c1eb46cb31-1755722165142 alt=logo></td></tr></tbody></table><h1 id=task-01-introduction>Task 01: Introduction</h1><h2 id=learning-objectives>Learning Objectives</h2><ul><li>Discover various data sources that are ingested into a SIEM.</li><li>Understand the importance of data correlation.</li><li>Learn the value of Windows, Linux, Web, and Network logs during an investigation.</li><li>Practice analysing malicious behaviour.</li></ul><h1 id=task-02-benefits-of-siem-for-analysts>Task 02: Benefits of SIEM for Analysts</h1><p>SIEM solutions play a vital role in every Security Operations Centre, and any SOC analyst&rsquo;s day-to-day life.
Let’s take a moment to understand why SIEM is so valuable and explore its key benefits for analysis.</p><h2 id=centralisation>Centralisation</h2><p>One of the first things that makes SIEM so helpful for a SOC is centralisation. Instead of checking logs in different places, like network devices, cloud services, identity providers, and more, a SIEM allows you to gather all that data in one place. This means an analyst doesn’t have to switch between systems during an investigation. Everything is available in a single solution, making their work much smoother and more efficient.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755761894614.png alt=img></p><p>Let’s take an example.
We have two SOC Level 1 analysts: Ted and Emily. Ted works in a SOC with a SIEM solution, but Emily doesn’t.
Both analysts receive similar alerts at the same time:</p><p>-A suspicious spike in network activity.</p><ul><li>A malicious command was detected on a host.</li></ul><p>With a SIEM, Ted can investigate both alerts from a single platform. He has access to logs from the IPS, endpoints, and other systems, all in one place, ready to be searched and analysed. On the other hand, Emily has to log into each system separately, for example, the IPS and EDR. She must collect and review data manually from each one.</p><p>While Ted quickly sees the bigger picture, Emily spends valuable time just gathering information. This highlights how centralised visibility through SIEM enables faster and more effective analysis.</p><h2 id=correlation>Correlation</h2><p>Another core strength of SIEM is correlation, the ability to link separate events and piece them together like pieces of a puzzle to form a complete picture. Let’s walk through a scenario.
You receive an alert in your SIEM about internal network discovery activity. The only information you have is the IP address of the host performing the scan. Nothing else. The alert comes from your IDS logs.</p><p>That’s not much to go on, is it? To make sense of it, you need to enrich the data, find out which device the IP belongs to, and who triggered the activity.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755774393070.png alt=img></p><p>You can check Windows Event Logs or Sysmon by correlating this with the IDS alert and build context:
Who performed this activity, where, and possibly which tool was used.</p><p>Piece by piece, the puzzle forms, helping you decide if the activity was malicious or just noise.</p><h2 id=historical-events>Historical Events</h2><p>SIEM also allows you to look at past events, not just current activity. This helps you spot patterns or threats that may have started earlier but weren’t noticed at the time.</p><p>For instance, if you get an alert about an unusual login location for a user, you can look back at historical logs to see if he has logged in from that location or IP before. This helps you identify patterns in their behaviour and assess whether the activity is part of a malicious attempt or a legitimate action.
Of course, these aren&rsquo;t all the benefits SIEM offers for the SOC. There are many others, such as visualisation, detection rules, and automation paths, which we’ll cover partially later in this room.</p><h2 id=02---answer-the-questions-below>02 - Answer the questions below</h2><h3 id=21-what-is-the-process-of-linking-data-from-multiple-sources-to-identify-relationships-between-individual-events-called>2.1: What is the process of linking data from multiple sources to identify relationships between individual events called?</h3><p><code>Correlation</code></p><h3 id=22-what-is-the-process-of-collecting-and-storing-log-data-from-multiple-systems-and-sources-into-a-single-unified-location-for-easier-analysis-called>2.2: What is the process of collecting and storing log data from multiple systems and sources into a single, unified location for easier analysis called?</h3><p><code>Centralisation</code></p><h1 id=task-03-log-sources-overview>Task 03: Log Sources Overview</h1><p>Let’s explore the Log Sources that an analyst can come across in SIEM and the value they can provide to the analyst.
Every organisation has different types of resources from which logs can be collected into the SIEM, such as workstations, servers, network devices, identity providers, cloud services, various applications, and more. It can be helpful to think of this as a tree, where the organisation is the tree itself, and the roots represent the resources that make up this tree. While these components are often unique to each organisation, they all come together to form a logical structure.
Logs from all or just a few of these resources are sent to the SIEM platform, where the analyst can use them for analysis and correlation events.</p><h2 id=host-based-log-sources>Host-Based Log Sources</h2><p>Host-based log sources come from individual devices within the organisation, such as workstations and servers. Every organisation relies on workstations for employees to perform their duties and servers serving different purposes, such as web servers, SQL servers, DNS servers, and more. Typically, we monitor this type of behaviour from systems.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755609915384.svg alt=img></p><p>From all of these machines, a significant amount of data is sent to the SIEM for monitoring. This is not surprising, as nearly every attack will involve hosts in some way. Therefore, the data from these devices is invaluable during an investigation. We will dive deeper later into what can be discovered from this data.</p><h2 id=network-based-log-sources>Network-Based Log Sources</h2><p>Network-based log sources collect data from network devices, such as firewalls, routers, IDS and IPS, and other systems. These devices play a critical role in monitoring traffic and connections across the network.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755429715478.svg alt=img></p><p>Just as the roots of a tree connect and support the branches, network logs give analysts visibility into how devices are communicating with each other.
These logs can provide valuable insights when correlating data from different sources, making them a crucial part of a complete picture.</p><h2 id=web-based-log-sources>Web-Based Log Sources</h2><p>And of course, almost every organisation has its own web application, and logs from it are also sent to the SIEM.
It’s through web vulnerabilities that attackers often gain access to an organisation’s environment, so careful monitoring of web events is an essential part of every analyst&rsquo;s role in a SOC environment, day by day.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755452765665.svg alt=img></p><p>In addition to the above-mentioned data sources, SIEM also collects logs from cloud platforms such as AWS and Azure, various identity providers like Entra ID, and third-party applications. However, this is beyond the scope of this room, so we’ll leave it for future discussions.</p><p>However, this task will touch upon two other important topics, such as time pitfalls and normalisation in SIEM.</p><p><strong>Time Pitfalls</strong></p><p>One common challenge analysts face when working in a SIEM is time, specifically how time is recorded across different log sources.
Logs can come from systems in different time zones. Some сan be in UTC, others in local time, and some may not include a timezone at all.</p><p>It’s important to understand that your local time can be different from the time set in the SIEM.</p><p>Let’s say you’re working in UTC-2, but the logs in Splunk SIEM are normalised to UTC+2.
If it’s 5 PM for you, those same logs might appear as 1 PM in Splunk.
That doesn’t mean the logs are ingested four hours late; it’s just a difference in time settings.</p><p>So always be aware of which time zones you’re dealing with when analysing events. It can make all the difference in understanding what really happened, and when.</p><p><strong>Logs Normalisation</strong></p><p>Different logs come in various formats. Some are in JSON, others in XML, or even plain text. Each system logs events in its own way, using different field names and structures.</p><p>That’s where normalisation comes in.</p><p>The idea is to convert all these formats into a single, consistent structure, so that logs are easier to work with.
Analysts can simply view everything in one standard way inside the SIEM. This makes searching, filtering, and linking events much easier. Without normalisation, every log source would feel like solving an entirely different puzzle.</p><h2 id=03---answer-the-questions-below>03 - Answer the questions below</h2><h3 id=31-what-is-the-process-of-converting-logs-from-different-formats-into-a-single-format-for-easier-analysis-in-a-siem>3.1: What is the process of converting logs from different formats into a single format for easier analysis in a SIEM?</h3><p><code>Normalisation</code></p><h3 id=32-which-log-source-type-can-be-used-to-detect-the-execution-of-a-malicious-script>3.2: Which log source type can be used to detect the execution of a malicious script?</h3><p><code>Host-Based</code></p><h1 id=task-04-windows-logs>Task 04: Windows Logs</h1><p>When using a SIEM to analyse Windows logs, we usually talk about two main data sources: WinEventLogs and Sysmon. The second one must be installed and configured separately to start receiving logs.</p><p>However, combining these two data sources actually provides clear visibility for analysing activity.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1754989770283.png alt=sysmon></p><h2 id=sysmon>Sysmon</h2><p>An additional, and in some cases, even primary log source on Windows is Sysmon. It’s an incredibly powerful place that logs a wide range of activity types, providing a high level of visibility during analysis. Using Sysmon logs, an analyst can observe a variety of activity types that provide deep visibility into system behaviour.
It helps identify malicious process execution, network connections, possible process injection, registry changes, and file creation, among other activities.</p><h4 id=malicious-process-execution>Malicious Process Execution</h4><p>Let’s consider a situation where you’ve received an alert about the execution of a suspicious encoded PowerShell command. You now need to analyse the activity. How would you use a SIEM in this case? Let’s try using a Splunk query to see what useful information we can find in the logs using Splunk SIEM. Let’s write a search that detects launched processes (EventCode=1) related to PowerShell that include the EncodedCommand PowerShell argument.</p><pre tabindex=0><code class=language-powerhell data-lang=powerhell>index=winenv EventCode=1 *powershell* AND *EncodedCommand*
| table _time ComputerName ParentUser ParentImage ParentCommandLine Image CommandLine
</code></pre><p>In this example, we detected that on host WINHOST05, a malicious <code>update_config.js</code> file was executed from the <code>C:\Users\Public directory</code>, which resulted in cmd.exe launching PowerShell with an encoded command.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755074986601.svg alt=refimg></p><h4 id=suspicious-network-connection>Suspicious Network Connection</h4><p>This story didn’t end there, as just a few minutes later, we received another alert from WINHOST05, this time about a suspicious network connection. Let’s try to determine what happened using Sysmon logs. To do this, we will search for EventCode 3, which identifies network connections, and filter by the host WINHOST05, since that is where the activity originated.</p><pre tabindex=0><code class=language-powerhell data-lang=powerhell>index=winenv EventCode=3 ComputerName=WINHOST05
| table _time ComputerName Image SourceIp SourcePort DestinationIp DestinationPort Protocol
</code></pre><p>As shown in the image below, a suspicious connection was initiated by the suspicious process PPn423.exe from the Temp folder, targeting the unusual port 9999 on IP address 83.222.191.2. We also recommend checking this IP on TI platforms.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755076712585.svg alt=refimg2></p><p>These are just two examples of when Sysmon can be useful; in reality, there are many other situations where these logs can help detect anomalies.</p><h2 id=wineventlogs>WinEventLogs</h2><p>Windows Event Logs include a huge number of unique log files. While you&rsquo;re probably most familiar with the Security, System, and Application logs, in reality, the system contains over 200 different log channels beyond just those three.</p><h4 id=windows-security-logs>Windows Security Logs</h4><p>The most commonly viewed and referenced logs are the Security logs, but why is that the case? Let’s break down why these logs are so important and what makes them essential for investigation. Analysts can detect in Security logs activities such as user authentication attempts, account creation or modification, access to files and registry keys, process execution, system restarts or log clearing, and changes to audit or security policies.</p><p>We hope you still remember our examples with the WINHOST05 host. A SOC analyst started a new shift and was handed information about suspicious activity on this host. Within just a couple of hours, another alert came in from the same machine, this time about a user account creation. This suggests the attacker is still present on the host. We need to review the Security logs to detect what’s happening and share this information with our SOC L2 analyst.</p><pre tabindex=0><code class=language-powerhell data-lang=powerhell>index=winenv EventCode=4720 OR EventCode=4722
| table _time EventCode ComputerName Subject_Account_Name Target_Account_Name New_Account_Account_Name Keywords 
</code></pre><p>The attacker likely decided to create a persistence mechanism in the form of a backup user account, which was created and enabled by ted-admin on the WINHOST05 host.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755079576382.svg alt=refimg3></p><h4 id=windows-system-logs>Windows System Logs</h4><p>These logs record events generated by the operating system and its core services. They help detect various events related to services, system-level activity, and potential errors.
These logs are an excellent place to look for potential persistence or privilege escalation attempts via services. Let’s examine the activity on our compromised host WINHOST05 and try to identify anomalies. We will use two event codes, 7045 and 7036, which indicate service creation and service start/stop events.</p><pre tabindex=0><code class=language-powerhell data-lang=powerhell>index=winenv EventCode=7045 OR EventCode=7036 ComputerName=WINHOST05
|  table _time EventCode ComputerName Service_Name Service_Account Service_File_Name Message
</code></pre><p>From the search results, we can see that on the host, a service named &ldquo;User Updates&rdquo; was created and started, which launches the malicious RNSfnsjdf.exe file from the Temp directory under the SYSTEM account. This is most likely a privilege escalation attempt, as we recall that the attacker previously only had access to the ted-admin account.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755084370036.svg alt=refimg4></p><p>In that task, we examined a number of important log sources for an SOC L1 analyst and the value they can provide. Of course, there are many other logs that we will explore together in future rooms.</p><h4 id=practical-scenario>practical Scenario:</h4><p>You are an SOC Level 1 Analyst on shift and have received an alert indicating a suspicious network connection using port 5678 on the WIN-105 host. Your task is to conduct an investigation and determine whether this activity is suspicious.</p><p>The logs for this task are located in the Splunk index task4. Use the following query: <code>index=task4</code></p><h2 id=04---answer-the-questions-below>04 - Answer the questions below</h2><h3 id=41-which-ip-address-was-the-connection-established-with>4.1: Which IP address was the connection established with?</h3><p>Execute the query below to find the answer:</p><pre tabindex=0><code class=language-powerhell data-lang=powerhell>index=&#34;task4&#34; ComputerName=WIN-105 DestinationPort=5678 | table Time host User EventType EventCode Image SourceIp SourcePort DestinationIp DestinationPort Message
</code></pre><p>Ans is: <code>10.10.114.80</code></p><p><img src=/img/laws1/img1.png alt=img></p><h3 id=42-which-process-initiated-this-suspicious-connection>4.2: Which process initiated this suspicious connection?</h3><p>Ref to task 4.1 answer you can see <code>SharePoInt.exe</code> initiated the connection.</p><h3 id=43-what-is-the-md5-hash-of-the-malicious-process-from-the-previous-question>4.3: What is the MD5 hash of the malicious process from the previous question?</h3><p>Well this one looked tricky but you can use the below query to find the MD5 hash of the process.</p><p>I started with this query:</p><pre tabindex=0><code class=language-powerhell data-lang=powerhell>index=task4 *SharePoInt* 
</code></pre><p><img src=/img/laws1/img2.png alt=img></p><p>then loooked for process creation event and used the below query to get the MD5 hash.</p><pre tabindex=0><code class=language-powerhell data-lang=powerhell>index=task4 EventCode=1 Image=&#34;*SharePoInt.exe&#34; | table _time ComputerName User EventType EventCode Image CommandLine Hashes
</code></pre><p><img src=/img/laws1/img3.png alt=img></p><p>Ans is: <code>770D14FFA142F09730B415506249E7D1</code></p><h3 id=44-what-is-the-name-of-the-scheduled-task-that-was-created-on-the-system>4.4: What is the name of the scheduled task that was created on the system?</h3><p>I recall from task 01, there was sc query ran, so I searched for it using below query:</p><pre tabindex=0><code class=language-powerhell data-lang=powerhell>index=task4 *schtasks /create*
</code></pre><p><img src=/img/laws1/img4.png alt=img></p><p>Ans is: <code>Office365 Install</code></p><h1 id=task-05-linux-logs>Task 05: Linux Logs</h1><p>When you&rsquo;re analysing Linux systems in a SIEM, you&rsquo;ll often start by looking at two key log sources.</p><p>First, you’ll see auth.log, which tracks authentication-related activity, such as user logins and sudo usage, among other things. These logs are crucial for spotting failed logins, unauthorised access attempts, or privilege escalation.</p><p>Next, you&rsquo;ll come across syslog, which captures general system-level events. Here, you can monitor service restarts, cron jobs, and background processes - all helpful when building timelines or understanding how the system behaves over time. These tools significantly improve visibility.</p><h4 id=unusual-login-activities>Unusual login activities</h4><p>Let’s move on to real scenarios and examine a situation in the SOC. As an SOC L1 analyst, you have received an alert about an unusual SSH login to the ubuntu username on the system. In this case, let’s write a query to search for successful and failed login attempts to the system for the ubuntu user.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>linux source<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;auth.log&#34;</span> *ubuntu* process<span style=color:#f92672>=</span>sshd 
</span></span><span style=display:flex><span>| search <span style=color:#e6db74>&#34;Accepted password&#34;</span> OR <span style=color:#e6db74>&#34;Failed password&#34;</span>
</span></span></code></pre></div><p>There were 97 events, and the last ones show successful login attempts to the ubuntu user. This can likely be classified as a successful brute-force attack - an activity that should be escalated to L2. From a learning perspective, let’s take a look at what happened .</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1754916954992.svg alt=img></p><p>Privilege Escalation behaviours
Attackers often need root access on a system to gain access to certain files and more. Let’s see if, in our case, there are any signs of such activities.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>linux source<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;auth.log&#34;</span> *su*
</span></span><span style=display:flex><span>| sort + _time
</span></span></code></pre></div><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1754918505523.svg alt=img></p><h2 id=system-logs>System Logs</h2><p>System logs are another essential source of visibility. They capture events related to service activity, system restarts, and crons, all useful for identifying unusual system behaviour often linked to persistence or privilege escalation attempts.</p><h4 id=persistence-mechanisms>Persistence Mechanisms</h4><p>We hope you still remember our case in this task about the threat actor who successfully switched from ubuntu to root.
In this scenario, syslog can also be useful, specifically for searching for activity related to persistence through cron jobs or services.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>linux sourcetype<span style=color:#f92672>=</span>syslog <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;CRON&#34;</span> OR <span style=color:#e6db74>&#34;cron&#34;</span><span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span>|  search <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;python&#34;</span> OR <span style=color:#e6db74>&#34;perl&#34;</span> OR <span style=color:#e6db74>&#34;ruby&#34;</span> OR <span style=color:#e6db74>&#34;.sh&#34;</span> OR <span style=color:#e6db74>&#34;bash&#34;</span> OR <span style=color:#e6db74>&#34;nc&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>We detected three interesting events. First, we can see that a suspicious pnr5433sw.sh file from the /tmp folder is being executed via cron every 5 minutes. Next, there are clear signs of a Perl reverse shell attempting to establish a connection to 10.10.101.12 IP on port 9999.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1754921979559.svg alt=img></p><p>As mentioned earlier, in addition to the core data sources, it&rsquo;s very common to see tools like auditd and osquery used in real-world environments. These tools fall outside the scope of this room, so if you&rsquo;re interested in learning more about them, feel free to explore other related rooms available on our platform.</p><h4 id=practice-scenario>Practice Scenario</h4><p>You are an SOC Level 1 Analyst on shift and have received an alert indicating possible persistence through the creation of a new remote-ssh user on an Ubuntu server.
Your task is to dive into the logs and determine exactly what happened on the system.</p><h2 id=05---answer-the-questions-below>05 - Answer the questions below</h2><h3 id=51-what-was-the-timestamp-of-the-remote-ssh-account-creation>5.1: What was the timestamp of the remote-ssh account creation?</h3><p>Answer Format Example: 2025-01-15 12:30:45</p><p>Being a lazy person I searched for <code>useradd remote-ssh</code> in the logs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>task5 useradd remote-ssh
</span></span></code></pre></div><p><img src=/img/laws1/img51.png alt=img></p><p>Ans is: <code>2025-08-12 09:52:57</code></p><h3 id=52-which-user-successfully-escalated-their-privileges-to-root-prior-to-the-action-from-the-first-question>5.2: Which user successfully escalated their privileges to root prior to the action from the first question?</h3><p>Execute this query to find the answer:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>task5 
</span></span><span style=display:flex><span>|  search sudo
</span></span></code></pre></div><p>Ans is: <code>jack-brown</code></p><h3 id=53-from-which-ip-address-did-the-user-from-the-previous-question-successfully-log-in-to-the-system>5.3: From which IP address did the user from the previous question successfully log in to the system?</h3><p>Execute this query to find the answer:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>task5 
</span></span><span style=display:flex><span>|  search jack-brown 
</span></span><span style=display:flex><span>|  search ssh
</span></span></code></pre></div><p>Ans is: <code>10.14.94.82</code></p><h3 id=54-how-many-failed-login-attempts-occurred-prior-to-this-successful-login>5.4: How many failed login attempts occurred prior to this successful login?</h3><p>Execute this query to find the answer:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>task5
</span></span><span style=display:flex><span>|  search <span style=color:#e6db74>&#34;Failed password for jack-brown&#34;</span>
</span></span></code></pre></div><blockquote><p>ignore the <code>message repeated 2 tiems</code> lines</p></blockquote><h3 id=55-which-port-is-the-persistence-mechanism-configured-to-connect-to>5.5: Which port is the persistence mechanism configured to connect to?</h3><p>Execute this query to find the answer:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>index<span style=color:#f92672>=</span>task5 *port*
</span></span></code></pre></div><p><img src=/img/laws1/img52.png alt=img></p><p>Ans is: <code>7654</code></p><h1 id=task-06-web-application-logs>Task 06: Web Application Logs</h1><p>Other important data sources for analysis include the Web. Let’s discuss them in more detail.</p><h3 id=web-log-sources>Web Log Sources</h3><p>Almost every organisation has its own website and therefore a web server running it. Logs from these web servers are collected from Apache, Nginx, and other resources.
The most useful for analysis are the access logs, where you can detect requests to website resources. These logs often contain signs of malicious activity, such as scanning, DDoS attempts, various web-based attacks, and web shells. In addition, error logs can provide valuable insight, helping you understand possible failures or issues.</p><p>Let’s explore how different types of malicious activity can be detected using web access logs.</p><h4 id=brute-force-activity>Brute Force Activity</h4><p>Imagine you are a SOC L1 analyst on shift, and you’ve just received an alert about a possible brute-force attack targeting a WordPress login page. To investigate, we recommend starting by identifying the login page URL (e.g., /wp-login.php) and filtering for POST requests. Brute-force activity involves many repeated attempts, so set a threshold like count > 25 during 5 mins. Group the results by clientip to pinpoint the source of the activity. Other fields, such as user-agent, can also provide useful context. Below is the ready query.</p><pre tabindex=0><code class=language-splunk data-lang=splunk>index=* method=POST uri_path=&#34;/wp-login.php&#34;
| bin _time span=5m
| stats values(referer_domain) as referer_domain values(status) as status values(useragent) as UserAgent values(uri_path) as uri_path count by clientip _time
| where count &gt; 25
| table referer_domain clientip UserAgent uri_path count status
</code></pre><p>As a result, we can detect that in our example, the IP address 167.172.41.141 made as many as 160 requests to the wp-login.php page. Interestingly, the User-Agent string shows Hydra, a popular tool often used by attackers to perform brute-force attacks.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755000862956.svg alt=img></p><h4 id=possible-web-shell>Possible Web Shell</h4><p>Shortly after, you receive a second alert about possible web shell activity during your shift. To investigate potential web shell activity in Splunk, search for requests to script or executable file types such as .php, .asp, .jsp, or .exe, combined with POST and GET methods and a status=200 response. Web shells often generate a few suspicious requests in a short time frame, so set a threshold such as count > 2. Group the results by domain to identify patterns and review fields like clientip and user-agent for attacker fingerprints. Below is the ready query.</p><pre tabindex=0><code class=language-splunk data-lang=splunk>index=*
| search status=200 AND uri_path IN(*.php, *.phtm, *.asp, *.aspx, *.jsp, *.exe) AND (method=POST AND method=GET)
| stats values(status) as status values(useragent) as UserAgent values(method) as method
  values(uri) as uri values(clientip) as clientip count by referer_domain
| where count &gt; 2
| table referer_domain count method status clientip UserAgent uri
</code></pre><p>As you can see in the results, we detect a variety of different URIs, but what caught our attention the most was 505.php, which could be a web shell. This means we need to take a closer look at it in more detail.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755001860043.svg alt=img></p><h4 id=ddos-activity>DDoS Activity</h4><p>Your shift is almost over, but don’t rush to close your laptop just yet, a new alert has just come in, likely the last one for today, about a possible DDoS attack. When checking for signs of a potential DDoS in Splunk, look for status code 503, which can mean the server is overloaded. Review for huge request counts in a short time, for example, more than 100 000 in 10 minutes filtered by IPs. Review the targeted domain, which user-agent was used, and the URI path to spot patterns or attacker fingerprints. Below is the ready query.</p><pre tabindex=0><code class=language-splunk data-lang=splunk>index=* status=503
| bin _time span=10m
| stats values(referer_domain) as referer_domain values(status) as status values(useragent) as UserAgent values(uri_path) as uri_path count by clientip _time
| where count &gt; 100000
| table _time referer_domain clientip UserAgent uri_path count status
</code></pre><p>And from this example, we can see that the resource was unavailable for the last 10 minutes and received more than 1.5 million requests, which confirms a possible DDoS attack.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/674d9727a22822c1eb46cb31/room-content/674d9727a22822c1eb46cb31-1755000374081.svg alt=img></p><h4 id=practice-scenario-1>Practice Scenario</h4><p>You are an SOC Level 1 Analyst on shift and have received an alert indicating a spike in activity on the organisation&rsquo;s web server.
Your task is to dive into the logs and determine exactly what happened.</p><h1 id=06---answer-the-questions-below>06 - Answer the questions below</h1><p><img src=/img/laws1/img6.png alt=img></p><blockquote><p>this one image answers all the below questions</p></blockquote><h3 id=61-which-uri-path-had-the-highest-number-of-requests>6.1: Which URI path had the highest number of requests?</h3><p><code>wp-login.php</code></p><h3 id=62-which-ip-address-was-the-source-of-the-activity>6.2: Which IP address was the source of the activity?</h3><p><code>10.10.243.134</code></p><h3 id=63-how-can-this-activity-be-classified>6.3: How can this activity be classified?</h3><p><code>brute-force</code></p><h3 id=64-which-tool-did-the-threat-actor-use>6.4: Which tool did the threat actor use?</h3><p>Refer to user-agent string in the image.</p><p><code>wpscan</code></p><h1 id=conclusion>Conclusion</h1><p>I enjoyed solving this room and learning about log analysis with SIEM. It provided valuable insights into how SIEM solutions can be used to detect and analyse malicious behaviour effectively. The hands-on experience with different log sources and scenarios enhanced my understanding of security operations and incident response.</p><p>If you have any suggestions or feedback regarding this walkthrough, please feel free to share them with me.</p><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=anir0y data-description="Support me on Buy me a coffee!" data-message data-color=#5F7FFF data-position=Right data-x_margin=18 data-y_margin=18></script></article></section></div></div><footer class="ui basic center aligned segment" style=background-color:initial><p>© 2010 - 2026 Classroom</p></footer></div></section><section class=back><div class=dream-max-width><header class="ui basic very padded segment dream-header"><div class="ui small circular image"><img src=/img/avatar.jpeg></div><div class=content><h1 class="ui medium header">Reading Stuffs<div class="sub header"></div></h1><article class="ui horizontal list"><a class=item href=/categories><i class="th list icon" title="All Categories"></i>
</a><a class=item href=/tags><i class="tags icon" title="All Tags"></i></a></article></div></header><div class="ui relaxed grid dream-grid dream-back"><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment"><h3 class="ui header">Social Links</h3><nav class="ui secondary menu dream-menu dream-socials"><div class=item><a href=/index.xml><i class="large rss square icon" title=RSS></i></a></div><div class=item><a href=mailto:classroom@anir0y.in><i class="large mail icon" title=Email></i></a></div><div class=item><a href=https://twitter.com/anir0y target=_blank><i class="large twitter icon" title=Twitter></i></a></div><div class=item><a href=https://facebook.com/0xanir0y target=_blank><i class="large facebook icon" title=Facebook></i></a></div><div class=item><a href=https://instagram.com/0xanir0y target=_blank><i class="large instagram icon" title=Instagram></i></a></div><div class=item><a href=https://www.linkedin.com/in/anir0y target=_blank><i class="large linkedin icon" title=Linkedin></i></a></div><div class=item><a href=https://github.com/anir0y target=_blank><i class="large github icon" title=GitHub></i></a></div></nav></article></div><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment">YOU CAN REUSE MY CONTENT</article></div></div></div></section></div></div><script>window.defaultDark=null,window.backgroundDark="black",window.backgroundImageDark=null,window.darkNav=!0,window.hasTwitterEmbed=!0,window.hasTwitterEmbed&&(window.twttr=function(e,t,n){var o,i=e.getElementsByTagName(t)[0],s=window.twttr||{};return e.getElementById(n)?s:(o=e.createElement(t),o.id=n,o.src="https://platform.twitter.com/widgets.js",i.parentNode.insertBefore(o,i),s._e=[],s.ready=function(e){s._e.push(e)},s)}(document,"script","twitter-wjs"))</script><script src=/js/jquery.min.js></script><script src=/js/semantic.min.js></script><script src=/js/jquery.overlayScrollbars.min.js></script><script src=/js/header.js></script><script src=/js/main.js></script><script src=/js/theme.js></script><script src=/js/html2canvas.min.js></script><script src=/js/post.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/clojure.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js></script><script>hljs.initHighlightingOnLoad(),setHighlightTheme();function setHighlightTheme(){var e=localStore.getItem("hugo-theme-dream-is-dark"),e=e?e:window.defaultDark?"y":e,t="tomorrow",n="tomorrow-night",s=e==="y"?n:t;$("link[data-highlight]").attr("href","https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/"+s+".min.css"),$("pre").css("background",e==="y"?"#333":"")}</script><div class="ui inverted segment" id=dream-search><div class="ui search"><div class="ui transparent input"><input class=prompt type=text placeholder=Search></div><div class=results></div></div></div><script>$(document).ready(function(){$.getJSON("https://classroom.anir0y.in//index.json",function(e){$(".ui.search").search({source:e,searchFields:["title"],showNoResults:!0})})})</script><script src=/js/search.js></script></body></html>