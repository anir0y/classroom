<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>Try Hack Me Android Malware Analysis | Classroom</title>
<link href=/img/avatar.jpeg rel="shortcut icon" type=image/x-icon><meta name=author content="Animesh Roy @anir0y  "><meta name=description content="Try Hack Me Room Android Malware Analysis solved by Animesh Roy.  Android malware analysis with Pithus (static and hunting)"><title>Animesh Roy | Classroom Posts</title>
<meta name=title content="Animesh Roy | Blogs & Writeups"><meta name=description content="Animesh Roy has more than a decade worth experience working in cyber security domain. He has worked with governments, corporates, colleges and universities, defence, and the community. He also running a community “Arishti Live” to help everyone who wants to, or work in cyber security domain. His expertise on training & consulting are the best of both the world. He uses his real-life case studies in trainings, to help candidates to understand the job in better ways."><script async src="https://www.googletagmanager.com/gtag/js?id=G-SPD6BXK0P5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SPD6BXK0P5")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","it10lq8bk1")</script><meta property="og:type" content="website"><meta property="og:url" content="https://classroom.anir0y.in/"><meta property="og:title" content="Animesh Roy | Blogs & Writeups"><meta property="og:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training"><meta property="og:image" content="https://i.imgur.com/Ji5C41H.png"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://classroom.anir0y.in/post/tryhackme-androidmalwareanalysis/"><meta property="twitter:title" content="Animesh Roy | Blogs & Writeups"><meta property="twitter:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training"><meta property="twitter:image" content="https://i.imgur.com/Ji5C41H.png"><script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><link rel=canonical href=https://classroom.anir0y.in/post/tryhackme-androidmalwareanalysis/><meta property="og:title" content="Try Hack Me Android Malware Analysis"><meta property="og:description" content="Try Hack Me Room Android Malware Analysis solved by Animesh Roy.  Android malware analysis with Pithus (static and hunting)"><meta property="og:type" content="article"><meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-androidmalwareanalysis/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-01-23T11:38:33+05:30"><meta property="article:modified_time" content="2022-01-23T11:38:33+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Try Hack Me Android Malware Analysis"><meta name=twitter:description content="Try Hack Me Room Android Malware Analysis solved by Animesh Roy.  Android malware analysis with Pithus (static and hunting)"><link rel=stylesheet href=/css/semantic.min.css><link rel=stylesheet href=/css/icomoon.css><link rel=stylesheet href=/css/OverlayScrollbars.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/site.css><link rel=stylesheet href=/css/custom.css><style>a:not(.ui.button):hover{text-decoration:underline}a:not(.ui.button){color:#2e8b57!important}.inverted a:not(.ui.button),.inverted a:not(.ui.button):hover{color:#8fbc8f!important}body.default{background-color:#fff}body.dark{background-color:#000}</style><link rel=stylesheet data-highlight href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/tomorrow.min.css><link rel=stylesheet href=/css/custom.css></head><body class=default><nav class="ui secondary menu dream-menu"><div class=item><i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i></div><div class=item><i class="large link home icon" title=Home onclick='window.location.href="https://classroom.anir0y.in/"'></i></div><div class=item><i class="large link icon theme-switch" onclick=themeSwitch()></i></div><div class=item><i class="large link search icon" onclick=toggleSearch()></i></div></nav><div class=flip-container><div class=flipper><section class=front><div class=dream-max-width><div class="ui relaxed grid dream-grid dream-grid-single" style=flex-direction:row-reverse><aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside"><div class="ui segment toc"><nav id=TableOfContents><ul><li><a href=#overview>OverView</a></li><li><a href=#task-01-introduction>Task 01: Introduction</a></li><li><a href=#task-02-first-steps>Task 02: First steps</a><ul><li><a href=#21-answer-the-questions-below>2.1 Answer the questions below</a></li></ul></li><li><a href=#task-03-getting-into-the-apk>Task 03: Getting into the APK</a><ul><li><a href=#3-answer-the-questions-below>3 Answer the questions below</a></li><li><a href=#31-which-version-of-the-application-is-targeted>3.1 Which version of the application is targeted?</a></li><li><a href=#32-check-all-the-activities-there-is-one-standing-out-which-one-is-it>3.2 Check all the activities. There is one standing out. Which one is it?</a></li><li><a href=#33-how-many-activities-in-the-manifest-analysis-are-linked-to-the-activity-that-we-have-identified>3.3 How many activities in the Manifest analysis are linked to the activity that we have identified?</a></li><li><a href=#34-what-is-the-first-crime-identified>3.4 What is the first crime identified?</a></li><li><a href=#35-there-is-a-crime-that-should-attract-your-attention-it-is-something-that-shouldnt-happen-with-a-non-malicious-chat-app-what-crime-is-it>3.5 There is a crime that should attract your attention. It is something that shouldn&rsquo;t happen with a non-malicious chat app. What crime is it?</a></li><li><a href=#36-how-many-classes-have-a-tcp-connection-and-are-identified-as-being-part-of-our-malicious-activity>3.6 How many classes have a TCP connection and are identified as being part of our malicious activity?</a></li><li><a href=#37-which-one-of-the-classes-having-a-tcp-connection-is-probably-not-malicous>3.7 Which one of the classes having a TCP connection is probably not malicous?</a></li></ul></li><li><a href=#task-04-hunting>Task 04: Hunting</a></li><li><a href=#4-answer-the-questions-below>4 Answer the questions below</a><ul><li><a href=#41-in-the-section-for-search-by-identified-names-click-on-the-magnifying-glass-icon-to-search-for-finspy-samples>4.1 In the section for search by identified names. Click on the magnifying glass icon to search for &ldquo;finspy&rdquo; samples.</a></li><li><a href=#42-what-do-you-notice-that-will-identify-our-sample-as-having-similarities-with-the-other-search-results>4.2 What do you notice that will identify our sample as having similarities with the other search results?</a></li></ul></li><li><a href=#task-05-hunting-2>Task 05: Hunting 2</a></li><li><a href=#5-answer-the-questions-below>5 Answer the questions below</a><ul><li><a href=#51-find-the-sha256-hash-of-our-previous-sample-and-run-a-query-using-the-hash-what-is-the-query-you-used>5.1 Find the sha256 hash of our previous sample and run a query using the hash. What is the query you used?</a></li><li><a href=#52-what-query-would-you-use-to-find-the-non-malicious-class-that-we-identified-previously>5.2 What query would you use to find the non malicious class that we identified previously?</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div class="ui segment actions"><button class="ui circular icon button save-as-image" title="Save as image" onclick=savePostAsImg()>
<i class="save icon"></i>
</button>
<a href="https://twitter.com/intent/tweet?text=Try%20Hack%20Me%20Android%20Malware%20Analysis&url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-androidmalwareanalysis%2f" class="ui circular twitter icon button"><i class="twitter icon"></i>
</a><a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-androidmalwareanalysis%2f" class="ui circular facebook icon button"><i class="facebook icon"></i></a></div></aside><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img><section class="ui top attached segment"><header><h1 class="ui large header">Try Hack Me Android Malware Analysis<div class="sub header">@
<a href=https://bit.ly/34sGFiK target=_blank>Animesh Roy</a>
|
Sunday, Jan 23, 2022
| 9 minutes read
| Update at
Sunday, Jan 23, 2022</div></h1></header><article class=main><h2 id=overview>OverView</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><script src=https://tryhackme.com/badge/434937></script></td><td><a class=twitter-follow-button href=https://twitter.com/anir0y data-size=large>Follow @anir0y<a></td></tr><tr><td>Android Malware Analysis</td><td><img src=https://tryhackme-images.s3.amazonaws.com/room-icons/614168d64533447f0e81987aaa858ff3.png alt=logo></td></tr><tr><td><b>Android Malware Analysis [FREE ROOM]</b></td><td><a href=https://tryhackme.com/room/androidmalwareanalysis>Android Malware Analysis</a></td></tr></tbody></table><h2 id=task-01-introduction>Task 01: Introduction</h2><p>Hi all! In this room, we are going to investigate some Android malware and learn how to pivot from the information we have to build hunting rules and find similar samples. To do this room, it is recommended to have done the following rooms (especially if you&rsquo;re a beginner):</p><h2 id=task-02-first-steps>Task 02: First steps</h2><p>Most Android malware masquerades as a normal application. Those files are called APKs (Android Application Package), and the very large majority of your Android applications are APKs.</p><p>You can find some of those malware programs on the Play Store (although it&rsquo;s rare &ndash; Google usually takes them down), or, more often, they are shared through other means such as SMS or 3rd party websites.</p><p>Because Google Play adds some information to the APKs when they are uploaded to the Play Store, it is possible to check for applications that come from it. This modification is called frosting.</p><p>When you find an APK that is not frosted, you&rsquo;d need to be extra careful with it. There are chances it is malicious.</p><p>Our case study for this room will be a trojanized application of the secure chat application <a href=https://wire.com/en/>Wire</a>.</p><p>During the next steps, we are going to use <a href=https://beta.pithus.org/>Pithus</a>, an open-source, online, static analysis APK tool. Pithus embeds a number of tools you might have seen in previous rooms, such as MoBSF, SSdeep, or APKiD.</p><p>You will work on the following sample: <a href=https://beta.pithus.org/report/ae05bbd31820c566543addbb0ddc7b19b05be3c098d0f7aa658ab83d6f6cd5c8>https://beta.pithus.org/report/ae05bbd31820c566543addbb0ddc7b19b05be3c098d0f7aa658ab83d6f6cd5c8</a>.</p><p>Check the report page on Pithus and answer the following questions to check you have the correct sample:</p><h3 id=21-answer-the-questions-below>2.1 Answer the questions below</h3><table><thead><tr><th style=text-align:left>Task</th><th>Question</th><th>Ans</th></tr></thead><tbody><tr><td style=text-align:left>1</td><td>What is the name of the technique used by Google Play to mark the applications uploaded to the Google Play Store?</td><td><code>frosting</code></td></tr><tr><td style=text-align:left>2</td><td>What is the name of the package?</td><td><code>com.wire</code></td></tr><tr><td style=text-align:left>3</td><td>What is the MD5 hash of the APK?</td><td><code>e162504122c224d4609ade9efa9af82d</code></td></tr><tr><td style=text-align:left>4</td><td>What is the SHA256 hash of this sample?</td><td><code>ae05bbd31820c566543addbb0ddc7b19b05be3c098d0f7aa658ab83d6f6cd5c8</code></td></tr><tr><td style=text-align:left>5</td><td>What is the size of the sample?</td><td><code>40.68MB</code></td></tr></tbody></table><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr><h2 id=task-03-getting-into-the-apk>Task 03: Getting into the APK</h2><p>First of all, we need to understand what kind of sample this one is. For this, let&rsquo;s choose the APK Analysis tab.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/d9c9cbc140aaec13f78160262095a8b7.png alt=img></p><p>Here you can see basic information regarding the sample. In our case, we are dealing with a specific trojanized application. This means that we need to identify which version of the application is targeted.</p><p>With some quick online research, we can find that this version was released on 1 March 2021.</p><p>In the Threat Intel tab, we have a timeline of events that could tell us about the time the malware was active or is supposed to be active.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/f76e44051ba209ebc14173ba904687fa.png alt=img></p><p>As we can see, the X.509 certificate was created to work from 26 April 2021, and the oldest files from the samples were identified around that time. Two months after the release of the version of the legit APK.</p><p>In the APK Analysis tab, we can find the main activity for this application (if you need to refresh your memory on activities, check out the Android developer&rsquo;s documentation. The main activity is an important point in your analysis. Indeed, when you look into the APK, you might want to start from there, so it&rsquo;s important to identify it in the early stages of your work.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/e98ba363f095bfa8e5de317cdffe96db.png alt=img></p><p>After having identified a potentially malicious activity, let&rsquo;s browse the Manifest and look for actions that are triggered by this activity. You will find that information in the APK Analysis tab.</p><p>Now moving on to the Behavior Analysis tab, where we will gather some general information on how the APK is behaving. The first part of the tab looks into the permissions that the APK will be requesting. This is a good indicator to identify what kind of resources will be used.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/39eddf75fa9a0efb14168ad79cb760ae.png alt=img></p><p>This APK is requesting an extensive amount of permissions. This might not be entirely suspicious, depending on what this application is doing. In this case, the trojanized application is supposed to act as a chat application so requesting contacts or camera access are not surprising. Nonetheless, one must be wary of what kind of requests are made.</p><p>Later on, on the same page on Pithus, we scroll to the Threat Analysis section. The analysis there is based on a tool called <a href=https://github.com/quark-engine/quark-engine>Quark</a>. With these tools, it is possible to identify a number of &ldquo;crimes&rdquo; (as they call them) to map the behaviour of Android malware.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/04373d6b7ac8d1679291868d5148c942.png alt=img></p><p>For our sample, we have a number of crimes identified. Check the questions related to this theme before moving on.</p><p>Moving on to identify classes that have behaviors we would want to look at. Scroll down to the Behavior Analysis. Here we can see the name of the classes that have the identified behaviors, which will give us valuable pivot points when analyzing the APK.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/13a2b11b9836a2a57d2296bff3b7f34c.png alt=img></p><p>Now we&rsquo;ll check out how the Network Analysis tab. Here you will see a number of domains that have been identified and are queried by the APK. Here you will see a number of domains that have been identified and are queried by the APK. Considering that we work on a high-profile case here, it is less likely we&rsquo;ll easily discover clues. Indeed more advanced malware will obfuscate the domain or IP it communicates to avoid detection.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/0c8d580bc8d2663a580040b0b3931b6f.png alt=img></p><h3 id=3-answer-the-questions-below>3 Answer the questions below</h3><h3 id=31-which-version-of-the-application-is-targeted>3.1 Which version of the application is targeted?</h3><p><strong>ref</strong> : <a href=https://beta.pithus.org/report/ae05bbd31820c566543addbb0ddc7b19b05be3c098d0f7aa658ab83d6f6cd5c8>https://beta.pithus.org/report/ae05bbd31820c566543addbb0ddc7b19b05be3c098d0f7aa658ab83d6f6cd5c8</a></p><p><img src=https://i.imgur.com/jLIYx7v.png alt=img></p><h3 id=32-check-all-the-activities-there-is-one-standing-out-which-one-is-it>3.2 Check all the activities. There is one standing out. Which one is it?</h3><p><img src=https://i.imgur.com/5Ec0ZmF.png alt=img></p><h3 id=33-how-many-activities-in-the-manifest-analysis-are-linked-to-the-activity-that-we-have-identified>3.3 How many activities in the Manifest analysis are linked to the activity that we have identified?</h3><p><img src=https://i.imgur.com/PEsLUI3.png alt=img></p><h3 id=34-what-is-the-first-crime-identified>3.4 What is the first crime identified?</h3><p><code>Load external class</code></p><p><img src=https://i.imgur.com/uAPZnWJ.png alt=img></p><h3 id=35-there-is-a-crime-that-should-attract-your-attention-it-is-something-that-shouldnt-happen-with-a-non-malicious-chat-app-what-crime-is-it>3.5 There is a crime that should attract your attention. It is something that shouldn&rsquo;t happen with a non-malicious chat app. What crime is it?</h3><p><code>Hide the current app's icon</code></p><p><img src=https://i.imgur.com/FGeS77A.png alt=img></p><h3 id=36-how-many-classes-have-a-tcp-connection-and-are-identified-as-being-part-of-our-malicious-activity>3.6 How many classes have a TCP connection and are identified as being part of our malicious activity?</h3><p><code>5</code></p><p><img src=https://i.imgur.com/stmwCE8.png alt=img></p><h3 id=37-which-one-of-the-classes-having-a-tcp-connection-is-probably-not-malicous>3.7 Which one of the classes having a TCP connection is probably not malicous?</h3><p><code>okio/Okio.java</code></p><hr><h2 id=task-04-hunting>Task 04: Hunting</h2><p>Now that we have a general idea of the sample, let&rsquo;s continue our research to see if we can find other samples that are identical or similar to the first sample.</p><p>Hunting for other samples is an important step in malware analysis. Now that we have a general idea of the sample, let&rsquo;s continue our research to see if we can find other samples that are identical or similar to the first sample.</p><p>Finding new samples might start to give you an understanding of the type of victims being targeted and the Tactics, Techniques, and Procedures (TTPs) malicious actor/s are using.</p><p>Without further ado, let&rsquo;s get into it! Pithus offers different tools to run hunts. Let&rsquo;s check what we have based on the current sample.</p><p>Search by similarity</p><p>In the Fingerprints tab, scroll down to the SSdeep and Dexofuzzy results.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/1109fcf1058582bc0fd57d820d2e72c2.png alt=img></p><p>By clicking on the little magnifying glass, we can start to look for similar samples. At the time this room was created, there are no results from this search.</p><p>Search by identified names</p><p>In the Threat Intel tab, scroll down to Move Popular AV Detection. Sometimes, samples are quite unique, and they are not so easily detected. However, Anti-Virus companies might use their knowledge to identify specific patterns in samples. Thanks to this, we can look for samples for a specific name of malware or group.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/81c640f8c099510f6d70a5d9b465b297.png alt=img></p><p>Check the questions before moving on.</p><p>Based on the threat names, we could gain an idea of who the threat actor might be based on pre-existing research or the type of sample that we are analyzing. Take some time to research &ldquo;Finspy&rdquo; to get acquainted with this actor.</p><p>Search by Yara rules</p><p>For the moment, Yara searches are only available for registered users. If you have a Github account, you can use it to connect yourself to Pithus. After that, you will see &ldquo;My Hunting&rdquo; in the top bar.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/97903b71b44728fe1ca7613d971b05e1.png alt=img></p><p>In this section, you will be able to add your own Yara rules to look for other samples. Pithus allows you also to retroactively search for older samples. Pithus also allows you also to create private or public Yara rules. In the case of public rules, anyone using the platform will have access to any public rules.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/4eac3506a76ffd19d15165625275707f.png alt=img></p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/d401b850faebfc7bfd645677f45cd3aa.png alt=img></p><p>Important: Pithus only supports vanilla Yara for the moment. If you try to use modules, it will not work.</p><p>You might have already noticed that our samples have Yara matches if you look into the Threat Intelligence section.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/722f1e0ff157b53cfdc158dc05f4a0e7.png alt=img></p><p>The rules used are public and can be found on this <a href=https://github.com/DefensiveLabAgency/FinSpy-for-Android/blob/master/python/yara/FinSpy.yar>Github page</a>.</p><p>Keep in mind when writing Yara rules for APKs, you can always specify the APK&rsquo;s magic bytes: <code>uint32(0) == 0x04034b50</code>, so your rule will only look into APK files. This is not important when using Pithus but might be good to know if you use your rules on VirusTotal or other platforms.</p><h2 id=4-answer-the-questions-below>4 Answer the questions below</h2><h3 id=41-in-the-section-for-search-by-identified-names-click-on-the-magnifying-glass-icon-to-search-for-finspy-samples>4.1 In the section for search by identified names. Click on the magnifying glass icon to search for &ldquo;finspy&rdquo; samples.</h3><p><code>N/A</code></p><h3 id=42-what-do-you-notice-that-will-identify-our-sample-as-having-similarities-with-the-other-search-results>4.2 What do you notice that will identify our sample as having similarities with the other search results?</h3><p><code>org.xmlpush.v3</code></p><p>ref: <code>https://beta.pithus.org/?q=threat_name:*finspy*</code></p><hr><h2 id=task-05-hunting-2>Task 05: Hunting 2</h2><p>Let&rsquo;s look for the &ldquo;search feature&rdquo; that Pithus offers!</p><p>On the home page of Pithus, there is a query field available.</p><p><img src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5fb4d2969a25095e200e4b6c/room-content/2d9ef9067895863bebcec1d3c5837046.png alt=img></p><p>Clicking the ? icon brings up more information for some features described below.</p><p>Here are some tricks:</p><ul><li>You can list all samples available in Pithus with this search: <code>*</code> (Note that not all samples will be shown at once.)</li><li>You can combine searches and look for all files that have a rating on VirusTotal with:<code> * and vt > 0</code></li><li>Sometimes, searches will yield a low amount of results. You can expand the search with <code>*</code> — For example: <code>threat_name:*finspy*</code></li></ul><h2 id=5-answer-the-questions-below>5 Answer the questions below</h2><h3 id=51-find-the-sha256-hash-of-our-previous-sample-and-run-a-query-using-the-hash-what-is-the-query-you-used>5.1 Find the sha256 hash of our previous sample and run a query using the hash. What is the query you used?</h3><p><code>sha256:ae05bbd31820c566543addbb0ddc7b19b05be3c098d0f7aa658ab83d6f6cd5c8</code></p><h3 id=52-what-query-would-you-use-to-find-the-non-malicious-class-that-we-identified-previously>5.2 What query would you use to find the non malicious class that we identified previously?</h3><p><code>java_classes:okio/okio</code></p><hr><h2 id=conclusion>Conclusion</h2><p>Now let&rsquo;s recap what we&rsquo;ve explored in this room</p><p>Firstly, we worked on a trojanized application of Wire that is linked to the threat actor Finspy. At the time this room was created, little public information is available as to where this trojanized application has been used and how many victims have been affected. Nonetheless, we&rsquo;ve gathered preliminary knowledge of the application&rsquo;s behavior that could speed up a future in-depth code analysis. We have identified network communication classes that could serve as useful pivot points should you continue analyzing this sample on your own.</p><p>Then, we looked into how to find similar APKs based on our analysis and what was fingerprinted from the sample. As we were able to see, it was possible to gather other implants uploaded on Pithus that matched our first APK. Gathering other samples is an important step in your analysis. With more samples, we might be able to better understand <a href=https://azeria-labs.com/tactics-techniques-and-procedures-ttps/>the techniques, tactics and procedures</a> of the group and/or the malware. This might answer questions as &ldquo;Why was that application trojanized?&rdquo; or &ldquo;Who are the victims of this malware?&rdquo;.</p><p>Finally, we played with some search features of Pithus, which will allow you to look for more samples based on atomic indicators of compromises.</p><p>It&rsquo;s time for our journey to come to an end. We hope that you enjoyed this walk-through and remember that Pithus is an open-source tool.</p><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=anir0y data-description="Support me on Buy me a coffee!" data-message data-color=#5F7FFF data-position=Right data-x_margin=18 data-y_margin=18></script></article></section></div></div><footer class="ui basic center aligned segment" style=background-color:transparent><p>© 2010 - 2024 Classroom</p></footer></div></section><section class=back><div class=dream-max-width><header class="ui basic very padded segment dream-header"><div class="ui small circular image"><img src=/img/avatar.jpeg></div><div class=content><h1 class="ui medium header">Reading Stuffs<div class="sub header"></div></h1><article class="ui horizontal list"><a class=item href=/categories><i class="th list icon" title="All Categories"></i>
</a><a class=item href=/tags><i class="tags icon" title="All Tags"></i></a></article></div></header><div class="ui relaxed grid dream-grid dream-back"><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment"><h3 class="ui header">Social Links</h3><nav class="ui secondary menu dream-menu dream-socials"><div class=item><a href=/index.xml><i class="large rss square icon" title=RSS></i></a></div><div class=item><a href=mailto:classroom@anir0y.in><i class="large mail icon" title=Email></i></a></div><div class=item><a href=https://twitter.com/anir0y target=_blank><i class="large twitter icon" title=Twitter></i></a></div><div class=item><a href=https://facebook.com/0xanir0y target=_blank><i class="large facebook icon" title=Facebook></i></a></div><div class=item><a href=https://instagram.com/0xanir0y target=_blank><i class="large instagram icon" title=Instagram></i></a></div><div class=item><a href=https://www.linkedin.com/in/anir0y target=_blank><i class="large linkedin icon" title=Linkedin></i></a></div><div class=item><a href=https://github.com/anir0y target=_blank><i class="large github icon" title=GitHub></i></a></div></nav></article></div><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment">YOU CAN REUSE MY CONTENT</article></div></div></div></section></div></div><script>window.defaultDark=null,window.backgroundDark="black",window.backgroundImageDark=null,window.darkNav=!0,window.hasTwitterEmbed=!0,window.hasTwitterEmbed&&(window.twttr=function(e,t,n){var o,i=e.getElementsByTagName(t)[0],s=window.twttr||{};return e.getElementById(n)?s:(o=e.createElement(t),o.id=n,o.src="https://platform.twitter.com/widgets.js",i.parentNode.insertBefore(o,i),s._e=[],s.ready=function(e){s._e.push(e)},s)}(document,"script","twitter-wjs"))</script><script src=/js/jquery.min.js></script><script src=/js/semantic.min.js></script><script src=/js/jquery.overlayScrollbars.min.js></script><script src=/js/header.js></script><script src=/js/main.js></script><script src=/js/theme.js></script><script src=/js/html2canvas.min.js></script><script src=/js/post.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/clojure.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js></script><script>hljs.initHighlightingOnLoad(),setHighlightTheme();function setHighlightTheme(){var e=localStore.getItem("hugo-theme-dream-is-dark"),e=e?e:window.defaultDark?"y":e,t="tomorrow",n="tomorrow-night",s=e==="y"?n:t;$("link[data-highlight]").attr("href","https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/"+s+".min.css"),$("pre").css("background",e==="y"?"#333":"")}</script><div class="ui inverted segment" id=dream-search><div class="ui search"><div class="ui transparent input"><input class=prompt type=text placeholder=Search></div><div class=results></div></div></div><script>$(document).ready(function(){$.getJSON("https://classroom.anir0y.in//index.json",function(e){$(".ui.search").search({source:e,searchFields:["title"],showNoResults:!0})})})</script><script src=/js/search.js></script></body></html>