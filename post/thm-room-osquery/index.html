<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Try Hack Me Room Osquery &#183; Classroom</title><meta name=title content="Try Hack Me Room Osquery &#183; Classroom"><meta name=description content="TryHackMe Room Osquery walkthrough â€” learn endpoint monitoring with osquery SQL-based queries for process, network, and file system analysis."><meta name=keywords content="notes,tryhackme,rooms,"><link rel=canonical href=https://classroom.anir0y.in/post/thm-room-osquery/><meta name=author content="Animesh Roy"><link href=https://twitter.com/anir0y rel=me><link href=https://github.com/anir0y rel=me><meta property="og:url" content="https://classroom.anir0y.in/post/thm-room-osquery/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="Try Hack Me Room Osquery"><meta property="og:description" content="TryHackMe Room Osquery walkthrough â€” learn endpoint monitoring with osquery SQL-based queries for process, network, and file system analysis."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-16T23:54:39+05:30"><meta property="article:modified_time" content="2021-05-16T23:54:39+05:30"><meta property="article:tag" content="Notes"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta name=twitter:card content="summary"><meta name=twitter:title content="Try Hack Me Room Osquery"><meta name=twitter:description content="TryHackMe Room Osquery walkthrough â€” learn endpoint monitoring with osquery SQL-based queries for process, network, and file system analysis."><meta name=twitter:image content="https://classroom.anir0y.in/img/cover.jpg"><meta property="og:image" content="https://classroom.anir0y.in/img/cover.jpg"><link type=text/css rel=stylesheet href=/css/main.bundle.min.2b25fd51aafe5a0a65545bce9bd61a30f10d3e06d3ee7763f9340e7b14b436599753c7638c95d4d05f1c440e6fd97fc28f2f1a2f19130b30f65434ddd920ebe3.css integrity="sha512-KyX9Uar+WgplVFvOm9YaMPENPgbT7ndj+TQOexS0NlmXU8djjJXU0F8cRA5v2X/Cjy8aLxkTCzD2VDTd2SDr4w=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.bdda7dece6cbaf08deef7d254f7f842f3261c2524d247905127c9a20decc03f1011a2950048464c79272c1ce0705a49a41147f39f2b95163bb71d404b33263ef.js integrity="sha512-vdp97ObLrwje730lT3+ELzJhwlJNJHkFEnyaIN7MA/EBGilQBIRkx5Jywc4HBaSaQRR/OfK5UWO7cdQEszJj7w==" data-copy=Copy data-copied=Copied></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Try Hack Me Room Osquery","headline":"Try Hack Me Room Osquery","description":"TryHackMe Room Osquery walkthrough â€” learn endpoint monitoring with osquery SQL-based queries for process, network, and file system analysis.","inLanguage":"en","url":"https://classroom.anir0y.in/post/thm-room-osquery/","author":{"@type":"Person","name":"Animesh Roy","url":"https:\/\/classroom.anir0y.in\/about/me/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https:\/\/classroom.anir0y.in\/img/avatar.jpeg"}},"image":"https:\/\/classroom.anir0y.in\/img\/thm.png","copyrightYear":"2021","dateCreated":"2021-05-16T23:54:39\u002b05:30","datePublished":"2021-05-16T23:54:39\u002b05:30","dateModified":"2021-05-16T23:54:39\u002b05:30","keywords":["notes","tryhackme","rooms"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/thm-room-osquery/"},"wordCount":"2513"},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"Try Hack Me Room Osquery","item":"https://classroom.anir0y.in/post/thm-room-osquery/"}]}]</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3526678290068011" crossorigin=anonymous></script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">Classroom</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/post/ class="flex items-center bf-icon-color-hover" aria-label=Posts title=Posts><span class="text-base font-medium break-normal">Posts
</span></a><a href=/categories/ class="flex items-center bf-icon-color-hover" aria-label=Categories title=Categories><span class="text-base font-medium break-normal">Categories
</span></a><a href=/tags/ class="flex items-center bf-icon-color-hover" aria-label=Tags title=Tags><span class="text-base font-medium break-normal">Tags
</span></a><a href=/archives/ class="flex items-center bf-icon-color-hover" aria-label=Archives title=Archives><span class="text-base font-medium break-normal">Archives
</span></a><a href=/about/me/ class="flex items-center bf-icon-color-hover" aria-label=About title><span class="text-base font-medium break-normal">About
</span></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base bf-icon-color-hover"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile type=button aria-label="Dark mode switcher" class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400"><div class=dark:hidden><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden dark:block"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/post/ aria-label=Posts class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Posts class="text-2xl font-bold tracking-tight">Posts</span></a></div><div class=px-2><a href=/categories/ aria-label=Categories class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Categories class="text-2xl font-bold tracking-tight">Categories</span></a></div><div class=px-2><a href=/tags/ aria-label=Tags class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Tags class="text-2xl font-bold tracking-tight">Tags</span></a></div><div class=px-2><a href=/archives/ aria-label=Archives class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Archives class="text-2xl font-bold tracking-tight">Archives</span></a></div><div class=px-2><a href=/about/me/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title class="text-2xl font-bold tracking-tight">About</span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/img/thm_hu_ac8a16fd71d6b794.png role=presentation loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div><script type=text/javascript src=/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W+5DcKnbOMMOI+f7IvMGNsVvUfj+ooJ13n6EqqcGEz2FKMVvHLGwWPQ==" data-blur-id=background-blur data-image-id=background-image data-image-url=/img/thm_hu_ac8a16fd71d6b794.png></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Classroom</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/post/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/post/thm-room-osquery/>Try Hack Me Room Osquery</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Try Hack Me Room Osquery</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-05-16T23:54:39+05:30>16 May 2021</time><span class="px-2 text-primary-500">&#183;</span><span>2513 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">12 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/classroom/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Classroom
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/categories/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">TryHackMe
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/notes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Notes
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Tryhackme
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/rooms/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rooms</span></span></a></div></div><div class="flex author"><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Animesh Roy</div><div class="text-sm text-neutral-700 dark:text-neutral-400">CTF walkthroughs, malware analysis, penetration testing, and security research.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/anir0y target=_blank aria-label=Twitter title=Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/anir0y target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#osquery>Osquery</a></li><li><a href=#task-1--introduction>TASK 1 : Introduction</a></li><li><a href=#task-2--installation>TASK 2 : Installation</a></li><li><a href=#task-3--interacting-with-the-osquery-shell>TASK 3 : Interacting with the Osquery Shell</a><ul><li><a href=#flag-31>Flag 3.1</a><ul><li><a href=#what-is-the-osquery-version>What is the Osquery version</a></li></ul></li><li><a href=#flag-32>Flag 3.2</a><ul><li><a href=#what-is-the-sqlite-version>What is the SQLite version?</a></li></ul></li><li><a href=#flag-33>Flag 3.3</a><ul><li><a href=#what-is-the-default-output-mode>What is the default output mode?</a></li></ul></li><li><a href=#flag-34>Flag 3.4</a><ul><li><a href=#what-is-the-meta-command-to-set-the-output-to-show-one-value-per-line>What is the meta-command to set the output to show one value per line?</a></li></ul></li><li><a href=#flag-35>Flag 3.5</a><ul><li><a href=#what-are-the-2-meta-commands-to-exit-osqueryi>What are the 2 meta-commands to exit osqueryi?</a></li></ul></li></ul></li><li><a href=#task-4--schema-documentation>TASK 4 : Schema Documentation</a><ul><li><a href=#flag-41>Flag 4.1</a><ul><li><a href=#what-table-would-you-query-to-get-the-version-of-osquery-installed-on-the-windows-endpoint>What table would you query to get the version of Osquery installed on the Windows endpoint?</a></li></ul></li><li><a href=#flag-42>Flag 4.2</a><ul><li><a href=#how-many-tables-are-there-for-this-version-of-osquery>How many tables are there for this version of Osquery?</a></li></ul></li><li><a href=#flag-43>Flag 4.3</a><ul><li><a href=#how-many-of-the-tables-for-this-version-are-compatible-with-windows>How many of the tables for this version are compatible with Windows?</a></li></ul></li><li><a href=#flag-44>Flag 4.4</a><ul><li><a href=#how-many-tables-is-compatible-with-linux>How many tables is compatible with Linux?</a></li></ul></li><li><a href=#flag-45>Flag 4.5</a><ul><li><a href=#what-is-the-first-table-listed-that-is-compatible-with-both-linux-and-windows>What is the first table listed that is compatible with both Linux and Windows?</a></li></ul></li></ul></li><li><a href=#task-5--creating-queries>TASK 5 : Creating queries</a><ul><li><a href=#flags-51>Flags 5.1</a><ul><li><a href=#what-is-the-query-to-show-the-username-field-from-the-users-table-where-the-username-is-3-characters-long-and-ends-with-en-use-single-quotes-in-your-answer>What is the query to show the username field from the users table where the username is 3 characters long and ends with &rsquo;en&rsquo;? (use single quotes in your answer)</a></li></ul></li></ul></li><li><a href=#task-6--using-kolide-fleet>TASK 6 : Using Kolide Fleet</a><ul><li><a href=#flags-61>Flags 6.1</a><ul><li><a href=#what-is-the-osquery-enroll-secret>What is the Osquery Enroll Secret?</a></li></ul></li><li><a href=#flags-62>Flags 6.2</a><ul><li><a href=#what-is-the-osquery-version-1>What is the Osquery version?</a></li></ul></li><li><a href=#flags-63>Flags 6.3</a><ul><li><a href=#what-is-the-path-for-the-running-osquerydexe-process>What is the path for the running osqueryd.exe process?</a></li></ul></li></ul></li><li><a href=#task-7--osquery-extensions>TASK 7 : Osquery extensions</a><ul><li><a href=#flags-71>Flags 7.1</a><ul><li><a href=#according-to-the-polylogyx-readme-how-many-features-does-the-plug-in-add-to-the-osquery-core>According to the polylogyx readme, how many &lsquo;features&rsquo; does the plug-in add to the Osquery core?</a></li></ul></li></ul></li><li><a href=#task-8--linux-and-osquery>TASK 8 : Linux and Osquery</a><ul><li><a href=#flags-81>Flags 8.1</a><ul><li><a href=#what-is-the-current_value-for-kernelosrelease>What is the &lsquo;current_value&rsquo; for kernel.osrelease?</a></li></ul></li><li><a href=#flags-82>Flags 8.2</a><ul><li><a href=#what-is-the-uid-for-the-bravo-user>What is the uid for the bravo user?</a></li></ul></li><li><a href=#flags-83>Flags 8.3</a><ul><li><a href=#one-of-the-users-performed-a-binary-padding-attack-what-was-the-target-file-in-the-attack>One of the users performed a &lsquo;Binary Padding&rsquo; attack. What was the target file in the attack?</a></li></ul></li><li><a href=#flags-84>Flags 8.4</a><ul><li><a href=#what-is-the-hash-value-for-this-file>What is the hash value for this file?</a></li></ul></li><li><a href=#flags-85>Flags 8.5</a><ul><li><a href=#check-all-file-hashes-in-the-home-directory-for-each-user-one-file-will-not-show-any-hashes-which-file-is-that>Check all file hashes in the home directory for each user. One file will not show any hashes. Which file is that?</a></li><li><a href=#solution-provided-by-georg>solution provided by <strong>Georg</strong></a></li></ul></li><li><a href=#flags-86>Flags 8.6</a><ul><li><a href=#there-is-a-file-that-is-categorized-as-malicious-in-one-of-the-home-directories-query-the-yara-table-to-find-this-file-use-the-sigfile-which-is-saved-in-varosqueryyarascanneryara-which-file-is-it>There is a file that is categorized as malicious in one of the home directories. Query the Yara table to find this file. Use the sigfile which is saved in &lsquo;/var/osquery/yara/scanner.yara&rsquo;. Which file is it?</a></li></ul></li><li><a href=#flags-87>Flags 8.7</a><ul><li><a href=#what-were-the-matches>What were the &lsquo;matches&rsquo;?</a></li></ul></li><li><a href=#flags-88>Flags 8.8</a><ul><li><a href=#scan-the-file-from-q3-with-the-same-yara-file-what-is-the-entry-for-strings>Scan the file from Q#3 with the same Yara file. What is the entry for &lsquo;strings&rsquo;?</a></li></ul></li></ul></li><li><a href=#task-9--windows-and-osquery>TASK 9 : Windows and Osquery</a><ul><li><a href=#flags-91>Flags 9.1</a><ul><li><a href=#what-is-the-description-for-the-windows-defender-service>What is the description for the Windows Defender Service?</a></li></ul></li><li><a href=#flags-92>Flags 9.2</a><ul><li><a href=#there-is-another-security-agent-on-the-windows-endpoint-what-is-the-name-of-this-agent>There is another security agent on the Windows endpoint. What is the name of this agent?</a></li></ul></li><li><a href=#flags-93>Flags 9.3</a><ul><li><a href=#what-is-required-with-win_event_log_data>What is required with win_event_log_data?</a></li></ul></li><li><a href=#flags-94>Flags 9.4</a><ul><li><a href=#how-many-sources-are-returned-for-win_event_log_channels>How many sources are returned for win_event_log_channels?</a></li></ul></li><li><a href=#flags-95>Flags 9.5</a><ul><li><a href=#what-is-the-schema-for-win_event_log_data>What is the schema for win_event_log_data?</a></li></ul></li><li><a href=#flags-96>Flags 9.6</a><ul><li><a href=#previous-file-scanned-on-the-linux-endpoint-with-yara-is-on-the-windows-endpoint--what-datetime-was-this-file-first-detected-answer-format-yyyy-mm-dd-hhmmss>previous file scanned on the Linux endpoint with Yara is on the Windows endpoint. What date/time was this file first detected? (Answer format: YYYY-MM-DD HH:MM:SS)</a></li></ul></li><li><a href=#flags-97>Flags 9.7</a><ul><li><a href=#what-is-the-query-to-find-the-first-sysmon-event-select-only-the-event-id-order-by-datetime-and-limit-the-output-to-only-1-entry>What is the query to find the first Sysmon event? Select only the event id, order by date/time, and limit the output to only 1 entry.</a></li></ul></li><li><a href=#flags-98>Flags 9.8</a><ul><li><a href=#what-is-the-sysmon-event-id>What is the Sysmon event id?</a></li></ul></li></ul></li><li><a href=#task-10->TASK 10 :</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#osquery>Osquery</a></li><li><a href=#task-1--introduction>TASK 1 : Introduction</a></li><li><a href=#task-2--installation>TASK 2 : Installation</a></li><li><a href=#task-3--interacting-with-the-osquery-shell>TASK 3 : Interacting with the Osquery Shell</a><ul><li><a href=#flag-31>Flag 3.1</a><ul><li><a href=#what-is-the-osquery-version>What is the Osquery version</a></li></ul></li><li><a href=#flag-32>Flag 3.2</a><ul><li><a href=#what-is-the-sqlite-version>What is the SQLite version?</a></li></ul></li><li><a href=#flag-33>Flag 3.3</a><ul><li><a href=#what-is-the-default-output-mode>What is the default output mode?</a></li></ul></li><li><a href=#flag-34>Flag 3.4</a><ul><li><a href=#what-is-the-meta-command-to-set-the-output-to-show-one-value-per-line>What is the meta-command to set the output to show one value per line?</a></li></ul></li><li><a href=#flag-35>Flag 3.5</a><ul><li><a href=#what-are-the-2-meta-commands-to-exit-osqueryi>What are the 2 meta-commands to exit osqueryi?</a></li></ul></li></ul></li><li><a href=#task-4--schema-documentation>TASK 4 : Schema Documentation</a><ul><li><a href=#flag-41>Flag 4.1</a><ul><li><a href=#what-table-would-you-query-to-get-the-version-of-osquery-installed-on-the-windows-endpoint>What table would you query to get the version of Osquery installed on the Windows endpoint?</a></li></ul></li><li><a href=#flag-42>Flag 4.2</a><ul><li><a href=#how-many-tables-are-there-for-this-version-of-osquery>How many tables are there for this version of Osquery?</a></li></ul></li><li><a href=#flag-43>Flag 4.3</a><ul><li><a href=#how-many-of-the-tables-for-this-version-are-compatible-with-windows>How many of the tables for this version are compatible with Windows?</a></li></ul></li><li><a href=#flag-44>Flag 4.4</a><ul><li><a href=#how-many-tables-is-compatible-with-linux>How many tables is compatible with Linux?</a></li></ul></li><li><a href=#flag-45>Flag 4.5</a><ul><li><a href=#what-is-the-first-table-listed-that-is-compatible-with-both-linux-and-windows>What is the first table listed that is compatible with both Linux and Windows?</a></li></ul></li></ul></li><li><a href=#task-5--creating-queries>TASK 5 : Creating queries</a><ul><li><a href=#flags-51>Flags 5.1</a><ul><li><a href=#what-is-the-query-to-show-the-username-field-from-the-users-table-where-the-username-is-3-characters-long-and-ends-with-en-use-single-quotes-in-your-answer>What is the query to show the username field from the users table where the username is 3 characters long and ends with &rsquo;en&rsquo;? (use single quotes in your answer)</a></li></ul></li></ul></li><li><a href=#task-6--using-kolide-fleet>TASK 6 : Using Kolide Fleet</a><ul><li><a href=#flags-61>Flags 6.1</a><ul><li><a href=#what-is-the-osquery-enroll-secret>What is the Osquery Enroll Secret?</a></li></ul></li><li><a href=#flags-62>Flags 6.2</a><ul><li><a href=#what-is-the-osquery-version-1>What is the Osquery version?</a></li></ul></li><li><a href=#flags-63>Flags 6.3</a><ul><li><a href=#what-is-the-path-for-the-running-osquerydexe-process>What is the path for the running osqueryd.exe process?</a></li></ul></li></ul></li><li><a href=#task-7--osquery-extensions>TASK 7 : Osquery extensions</a><ul><li><a href=#flags-71>Flags 7.1</a><ul><li><a href=#according-to-the-polylogyx-readme-how-many-features-does-the-plug-in-add-to-the-osquery-core>According to the polylogyx readme, how many &lsquo;features&rsquo; does the plug-in add to the Osquery core?</a></li></ul></li></ul></li><li><a href=#task-8--linux-and-osquery>TASK 8 : Linux and Osquery</a><ul><li><a href=#flags-81>Flags 8.1</a><ul><li><a href=#what-is-the-current_value-for-kernelosrelease>What is the &lsquo;current_value&rsquo; for kernel.osrelease?</a></li></ul></li><li><a href=#flags-82>Flags 8.2</a><ul><li><a href=#what-is-the-uid-for-the-bravo-user>What is the uid for the bravo user?</a></li></ul></li><li><a href=#flags-83>Flags 8.3</a><ul><li><a href=#one-of-the-users-performed-a-binary-padding-attack-what-was-the-target-file-in-the-attack>One of the users performed a &lsquo;Binary Padding&rsquo; attack. What was the target file in the attack?</a></li></ul></li><li><a href=#flags-84>Flags 8.4</a><ul><li><a href=#what-is-the-hash-value-for-this-file>What is the hash value for this file?</a></li></ul></li><li><a href=#flags-85>Flags 8.5</a><ul><li><a href=#check-all-file-hashes-in-the-home-directory-for-each-user-one-file-will-not-show-any-hashes-which-file-is-that>Check all file hashes in the home directory for each user. One file will not show any hashes. Which file is that?</a></li><li><a href=#solution-provided-by-georg>solution provided by <strong>Georg</strong></a></li></ul></li><li><a href=#flags-86>Flags 8.6</a><ul><li><a href=#there-is-a-file-that-is-categorized-as-malicious-in-one-of-the-home-directories-query-the-yara-table-to-find-this-file-use-the-sigfile-which-is-saved-in-varosqueryyarascanneryara-which-file-is-it>There is a file that is categorized as malicious in one of the home directories. Query the Yara table to find this file. Use the sigfile which is saved in &lsquo;/var/osquery/yara/scanner.yara&rsquo;. Which file is it?</a></li></ul></li><li><a href=#flags-87>Flags 8.7</a><ul><li><a href=#what-were-the-matches>What were the &lsquo;matches&rsquo;?</a></li></ul></li><li><a href=#flags-88>Flags 8.8</a><ul><li><a href=#scan-the-file-from-q3-with-the-same-yara-file-what-is-the-entry-for-strings>Scan the file from Q#3 with the same Yara file. What is the entry for &lsquo;strings&rsquo;?</a></li></ul></li></ul></li><li><a href=#task-9--windows-and-osquery>TASK 9 : Windows and Osquery</a><ul><li><a href=#flags-91>Flags 9.1</a><ul><li><a href=#what-is-the-description-for-the-windows-defender-service>What is the description for the Windows Defender Service?</a></li></ul></li><li><a href=#flags-92>Flags 9.2</a><ul><li><a href=#there-is-another-security-agent-on-the-windows-endpoint-what-is-the-name-of-this-agent>There is another security agent on the Windows endpoint. What is the name of this agent?</a></li></ul></li><li><a href=#flags-93>Flags 9.3</a><ul><li><a href=#what-is-required-with-win_event_log_data>What is required with win_event_log_data?</a></li></ul></li><li><a href=#flags-94>Flags 9.4</a><ul><li><a href=#how-many-sources-are-returned-for-win_event_log_channels>How many sources are returned for win_event_log_channels?</a></li></ul></li><li><a href=#flags-95>Flags 9.5</a><ul><li><a href=#what-is-the-schema-for-win_event_log_data>What is the schema for win_event_log_data?</a></li></ul></li><li><a href=#flags-96>Flags 9.6</a><ul><li><a href=#previous-file-scanned-on-the-linux-endpoint-with-yara-is-on-the-windows-endpoint--what-datetime-was-this-file-first-detected-answer-format-yyyy-mm-dd-hhmmss>previous file scanned on the Linux endpoint with Yara is on the Windows endpoint. What date/time was this file first detected? (Answer format: YYYY-MM-DD HH:MM:SS)</a></li></ul></li><li><a href=#flags-97>Flags 9.7</a><ul><li><a href=#what-is-the-query-to-find-the-first-sysmon-event-select-only-the-event-id-order-by-datetime-and-limit-the-output-to-only-1-entry>What is the query to find the first Sysmon event? Select only the event id, order by date/time, and limit the output to only 1 entry.</a></li></ul></li><li><a href=#flags-98>Flags 9.8</a><ul><li><a href=#what-is-the-sysmon-event-id>What is the Sysmon event id?</a></li></ul></li></ul></li><li><a href=#task-10->TASK 10 :</a></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!0,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="not-prose my-4 print:hidden"><div class=ad-container><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class="article-content max-w-prose mb-20"><h2 class="relative group">Osquery<div id=osquery class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#osquery aria-label=Anchor>#</a></span></h2><table><thead><tr><th style=text-align:left>Profile</th><th style=text-align:right>Support</th></tr></thead><tbody><tr><td style=text-align:left><script src=https://tryhackme.com/badge/434937></script></td><td style=text-align:right><a href=https://www.buymeacoffee.com/anir0y><img src="https://img.buymeacoffee.com/button-api/?text=Cheers!!!&emoji=ðŸº&slug=anir0y&button_colour=BD5FFF&font_colour=ffffff&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00"></a></td></tr></tbody></table><hr><h2 class="relative group">TASK 1 : Introduction<div id=task-1--introduction class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-1--introduction aria-label=Anchor>#</a></span></h2><p><a href=https://osquery.io/ target=_blank rel=noreferrer>Osquery</a> is an <a href=https://github.com/osquery/osquery target=_blank rel=noreferrer>open-source</a> tool created by Facebook. With Osquery, Security Analysts, Incident Responders, Threat Hunters, etc., can query an endpoint (or multiple endpoints) using SQL syntax. Osquery can be installed on multiple platforms: Windows, Linux, macOS, and FreeBSD.</p><p>Many well-known companies, besides Facebook, either use Osquery, utilize osquery within their tools, and/or look for individuals who know Osquery.</p><p>As of today (March 2021), Github and AT&amp;T seek individuals who have experience with Osquery.</p><p>Github:<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/github-posting.png></figure><br>AT&amp;T:<br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/att-posting.png></figure></p><p>Some of the tools (open-source and commercial) that utilize Osquery are listed below.</p><ul><li>Alienvault: The <a href=https://otx.alienvault.com/endpoint-security/welcome target=_blank rel=noreferrer>AlienVault agent</a> is based on Osquery.</li><li>Cisco: Cisco AMP (Advanced Malware Protection) for endpoints utilize Osquery in Cisco Orbital.</li></ul><p>Learning Osquery will be beneficial if you are looking to enter into this field or if you&rsquo;re already in the field and you&rsquo;re looking to level up your skills.</p><hr><h2 class="relative group">TASK 2 : Installation<div id=task-2--installation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-2--installation aria-label=Anchor>#</a></span></h2><p>Install Osquery on your local machine or local virtual machine, please refer to the installation instructions.</p><ul><li><a href=https://osquery.readthedocs.io/en/stable/installation/install-windows/ target=_blank rel=noreferrer>Windows</a></li><li><a href=https://osquery.readthedocs.io/en/stable/installation/install-linux/ target=_blank rel=noreferrer>Linux</a></li><li><a href=https://osquery.readthedocs.io/en/stable/installation/install-macos/ target=_blank rel=noreferrer>MacOS</a></li><li><a href=https://osquery.readthedocs.io/en/stable/installation/install-freebsd/ target=_blank rel=noreferrer>FreeBSD</a></li></ul><p>Refer to the documentation on the Osquery daemon (osqueryd) information and all the <a href=https://osquery.readthedocs.io/en/latest/installation/cli-flags/ target=_blank rel=noreferrer>command-line flags here</a>.<br>Schema is <a href=https://osquery.io/schema/ target=_blank rel=noreferrer>here</a></p><h2 class="relative group">TASK 3 : Interacting with the Osquery Shell<div id=task-3--interacting-with-the-osquery-shell class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-3--interacting-with-the-osquery-shell aria-label=Anchor>#</a></span></h2><p>To interact with the Osquery interactive console/shell, open CMD (or PowerShell) and run <code>osqueryi</code>.</p><p>As per the documentation, osqueryi is a modified version of the SQLite shell.</p><p>You&rsquo;ll know that you&rsquo;ve successfully entered into the interactive shell by the new command prompt.<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_prompt.png></figure><br>One way to familiarize yourself with the Osquery interactive shell, as with any new tool, is to check its help menu.</p><p>In Osquery, the help command (or meta-command) is <code>.help</code>.<br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_help.png></figure><br>Note: As per the documentation, meta-commands are prefixed with a <code>'.'</code>.</p><p>To list all the available tables that can be queried, use the .<code>tables</code> meta-command.</p><p>For example, if you wish to check what tables are associated with processes, you can use <code>.tables</code> process.<br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_tables.png></figure><br>In the above image, 3 tables are returned that contain the word &lsquo;process.&rsquo;</p><p>Note: Depending on the operating system, different tables will be returned when the .tables meta-command is executed.</p><p>Table names are not enough to know exactly what information is contained in any given table without actually querying it.</p><p>Knowing what columns and types, known as a schema, for each table are also useful.</p><p>You can list a table&rsquo;s schema with the following meta-command: <code>.schema table_name</code><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_schema.png></figure><br>Looking at the above image, <strong>pid</strong> is the <strong>column</strong>, and <strong>BIGINT</strong> is the type.</p><p><strong>Note</strong>: Any user on a system can run and interact with osqueryi, but some tables might return limited results compared to running osqueryi from an elevated shell.</p><p>If you which to check the schema for another operating system, you&rsquo;ll need to use the <code>--enable_foreign</code> command-line flag.</p><p>To read more about command-line flags, refer to this page, <a href=https://osquery.readthedocs.io/en/latest/installation/cli-flags/ target=_blank rel=noreferrer>https://osquery.readthedocs.io/en/latest/installation/cli-flags/</a>.</p><p>Interacting with the shell to get quick schema information for a table is good but not ideal when you want schema information for multiple tables.</p><p>For that, the schema API online documentation can be used to view a complete list of tables, columns, types, and column descriptions.</p><h3 class="relative group">Flag 3.1<div id=flag-31 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-31 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the Osquery version<div id=what-is-the-osquery-version class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-osquery-version aria-label=Anchor>#</a></span></h4><p>run <code>.version</code> to get the flag</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/IEJciiE.png></figure><h3 class="relative group">Flag 3.2<div id=flag-32 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-32 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the SQLite version?<div id=what-is-the-sqlite-version class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-sqlite-version aria-label=Anchor>#</a></span></h4><p>run <code>.version</code> to get the flag</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/IEJciiE.png></figure><h3 class="relative group">Flag 3.3<div id=flag-33 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-33 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the default output mode?<div id=what-is-the-default-output-mode class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-default-output-mode aria-label=Anchor>#</a></span></h4><p>run the <code>.show</code> command to get the answer</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/dAlkh6g.png></figure><h3 class="relative group">Flag 3.4<div id=flag-34 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-34 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the meta-command to set the output to show one value per line?<div id=what-is-the-meta-command-to-set-the-output-to-show-one-value-per-line class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-meta-command-to-set-the-output-to-show-one-value-per-line aria-label=Anchor>#</a></span></h4><p>run <code>.help</code> command to find out the <code>.mode</code> args.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/9aPv10t.png></figure><h3 class="relative group">Flag 3.5<div id=flag-35 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-35 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What are the 2 meta-commands to exit osqueryi?<div id=what-are-the-2-meta-commands-to-exit-osqueryi class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-are-the-2-meta-commands-to-exit-osqueryi aria-label=Anchor>#</a></span></h4><p>not a rocket science, figure it out by yourself.</p><blockquote><p>Hint: Don&rsquo;t <code>quit</code> ;)</p></blockquote><hr><h2 class="relative group">TASK 4 : Schema Documentation<div id=task-4--schema-documentation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-4--schema-documentation aria-label=Anchor>#</a></span></h2><p>Head over to the schema documentation <a href=https://osquery.io/schema/4.7.0/ target=_blank rel=noreferrer>here</a>.<br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_apischema-1.png></figure></p><p>The above image is a resemblance to what you&rsquo;ll see when you navigate to the page.</p><p><strong>Note</strong>: At the time of this writing, the current version for Osquery is 4.7.0.</p><p>A breakdown of the information listed on the schema API page is explained below.</p><ol><li>A dropdown listing various versions of Osquery. Choose the version of Osquery you wish to see schema tables for.</li><li>The number of tables within the selected version of Osquery. (In the above image, 271 tables exist for Osquery 4.7.0)</li><li>The list of the tables is listed in alphabetical order for the selected version of Osquery.</li><li>The name of the table and a brief description.</li><li>A detailed chart listing the column, type, and column description for each table.</li><li>Information to which operating system the table applies to. (In the above image, the account_policy_data table is available only for macOS)</li></ol><p>You have enough information to confidently navigate this resource to retrieve any information you&rsquo;ll need.</p><h3 class="relative group">Flag 4.1<div id=flag-41 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-41 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What table would you query to get the version of Osquery installed on the Windows endpoint?<div id=what-table-would-you-query-to-get-the-version-of-osquery-installed-on-the-windows-endpoint class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-table-would-you-query-to-get-the-version-of-osquery-installed-on-the-windows-endpoint aria-label=Anchor>#</a></span></h4><p>search for <code>osquery_*</code> tables and find out which one have <code>vesion</code> column.</p><h3 class="relative group">Flag 4.2<div id=flag-42 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-42 aria-label=Anchor>#</a></span></h3><h4 class="relative group">How many tables are there for this version of Osquery?<div id=how-many-tables-are-there-for-this-version-of-osquery class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#how-many-tables-are-there-for-this-version-of-osquery aria-label=Anchor>#</a></span></h4><p>just open the website <a href=https://osquery.io/schema/4.6.0/ target=_blank rel=noreferrer>here</a> you&rsquo;ll see it in left corner.</p><h3 class="relative group">Flag 4.3<div id=flag-43 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-43 aria-label=Anchor>#</a></span></h3><h4 class="relative group">How many of the tables for this version are compatible with Windows?<div id=how-many-of-the-tables-for-this-version-are-compatible-with-windows class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#how-many-of-the-tables-for-this-version-are-compatible-with-windows aria-label=Anchor>#</a></span></h4><p>just open the website <a href=https://osquery.io/schema/4.6.0/ target=_blank rel=noreferrer>here</a> filter for windows.<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/a9NrNKv.png></figure></p><h3 class="relative group">Flag 4.4<div id=flag-44 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-44 aria-label=Anchor>#</a></span></h3><h4 class="relative group">How many tables is compatible with Linux?<div id=how-many-tables-is-compatible-with-linux class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#how-many-tables-is-compatible-with-linux aria-label=Anchor>#</a></span></h4><p>just open the website <a href=https://osquery.io/schema/4.6.0/ target=_blank rel=noreferrer>here</a> filter for Linux.<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/AJtMIKt.png></figure></p><h3 class="relative group">Flag 4.5<div id=flag-45 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flag-45 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the first table listed that is compatible with both Linux and Windows?<div id=what-is-the-first-table-listed-that-is-compatible-with-both-linux-and-windows class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-first-table-listed-that-is-compatible-with-both-linux-and-windows aria-label=Anchor>#</a></span></h4><p>just open the website <a href=https://osquery.io/schema/4.6.0/ target=_blank rel=noreferrer>here</a> filter for windows & Linux type the first table name.<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/AJtMIKt.png></figure></p><hr><h2 class="relative group">TASK 5 : Creating queries<div id=task-5--creating-queries class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-5--creating-queries aria-label=Anchor>#</a></span></h2><p>The SQL language implemented in Osquery is not an entire SQL language that you might be accustomed to, but rather it&rsquo;s a superset of SQLite&rsquo;s.</p><p>Realistically all your queries will start with a SELECT statement. This makes sense because, with Osquery, you are only querying information on an endpoint or endpoints. You won&rsquo;t be updating or deleting any information/data on the endpoint.</p><p>The exception to the rule: The use of other SQL statements, such as UPDATE and DELETE, is possible, but only if you&rsquo;re creating run-time tables (views) or using an extension if the extension supports them.</p><p>Your queries will also include a FROM clause and end with a semicolon.</p><p>If you wish to retrieve all the information about the running processes on the endpoint: <code>SELECT * FROM processes;</code><br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_selectall.png></figure></p><p><strong>Note</strong>: The results for you will be different if you run this query in the attached VM or your local machine (if Osquery is installed).</p><p>The number of columns returned might be more than what you need. You can select specific columns rather than retrieving every column in the table.</p><p>Query: <code>SELECT pid, name, path FROM processes;</code><br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_notselectall.png></figure><br>The above query will list the process id, the process&rsquo;s name, and the path for all running processes on the endpoint.</p><p>This will still return a large number of results, depending on how busy the endpoint is.</p><p>The count() function can be used to get exactly how many.</p><p>Query: <code>SELECT count(*) from processes;</code><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_count.png></figure><br>The output can be limited to the first 3 in ascending order by process name, as shown below.<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_orderby_limit.png></figure><br>Optionally, you can use a WHERE clause to narrow down the list of results returned based on specified criteria.</p><p>Query: <code>SELECT pid, name, path FROM processes WHERE name='lsass.exe';</code><br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_where.png></figure></p><p>The equal sign is not the only filtering option available in a WHERE clause.</p><p>Below are filtering operators that can be used in a WHERE clause:</p><ul><li><code>= </code>[equal]</li><li><code>&lt;></code> [not equal]</li><li><code>></code>, <code>>=</code> [greater than, greater than or equal to]</li><li><code>&lt;</code>, <code>&lt;=</code>[less than or less than or equal to]</li><li><code>BETWEEN</code> [between a range]</li><li><code>LIKE</code> [pattern wildcard searches]</li><li><code>%</code>[wildcard, multiple characters]</li><li><code>_</code> [wildcard, one character]</li></ul><p>Below is a screenshot from the Osquery <a href=https://osquery.readthedocs.io/en/stable/deployment/file-integrity-monitoring/ target=_blank rel=noreferrer>documentation</a> showing examples of using wildcards when used in folder structures.<br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_wildcard.png></figure></p><p>Some tables will require a WHERE clause, such as the file table, to return a value. If the required WHERE clause is not included in the query, then you will get an error.<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_fileerror.png></figure></p><p>The last concept to cover is JOIN. To join 2 or more tables, each table needs to share a column in common.</p><p>Let&rsquo;s look at 2 tables to demonstrate this further. Below is the schema for the <strong>osquery_info</strong> table and the <strong>processes</strong> table.<br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_join_example.png></figure><br>The common column in both tables is pid. A query can be constructed to use the JOIN clause to join these 2 tables USING the PID column.</p><p>Query: <code>SELECT pid, name, path FROM osquery_info JOIN processes USING (pid);</code><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_join.png></figure></p><h3 class="relative group">Flags 5.1<div id=flags-51 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-51 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the query to show the username field from the users table where the username is 3 characters long and ends with &rsquo;en&rsquo;? (use single quotes in your answer)<div id=what-is-the-query-to-show-the-username-field-from-the-users-table-where-the-username-is-3-characters-long-and-ends-with-en-use-single-quotes-in-your-answer class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-query-to-show-the-username-field-from-the-users-table-where-the-username-is-3-characters-long-and-ends-with-en-use-single-quotes-in-your-answer aria-label=Anchor>#</a></span></h4><p>Query: <code>select username from users where username like '%nt';</code><br>Modify the query Smarty Pants!</p><hr><h2 class="relative group">TASK 6 : Using Kolide Fleet<div id=task-6--using-kolide-fleet class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-6--using-kolide-fleet aria-label=Anchor>#</a></span></h2><p>In this task, we will look at an open-source Osquery Fleet Manager known as <a href=https://github.com/kolide/fleet target=_blank rel=noreferrer>Kolide Fleet</a>.</p><p>With Kolide Fleet, instead of using Osquery locally to query an endpoint, you can query multiple endpoints from the Kolide Fleet UI.</p><p>Note: The open-source repo of Kolide Fleet is no longer supported and was retired on November 4th, 2020. A commercial version, known as Kolide K2, is available. You can view more about it <a href=https://www.kolide.com/launcher target=_blank rel=noreferrer>here</a>. There is a more recent repo called <a href=https://github.com/fleetdm/fleet target=_blank rel=noreferrer>fleet</a>, a fork of the original Kolide Fleet, and as per the creators of Kolide Fleet, &ldquo;it appears to be the first of many promising forks.&rdquo;</p><p>Feel free to explore Query Packs at your own leisure. You can read more about this <a href=https://osquery.readthedocs.io/en/stable/deployment/configuration/ target=_blank rel=noreferrer>here</a> and <a href=https://osquery.readthedocs.io/en/stable/deployment/log-aggregation/ target=_blank rel=noreferrer>here</a>.</p><h3 class="relative group">Flags 6.1<div id=flags-61 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-61 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the Osquery Enroll Secret?<div id=what-is-the-osquery-enroll-secret class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-osquery-enroll-secret aria-label=Anchor>#</a></span></h4><p>When you click on add host you can copy the secret from there<br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/N8w9xqd.png></figure></p><h3 class="relative group">Flags 6.2<div id=flags-62 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-62 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the Osquery version?<div id=what-is-the-osquery-version-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-osquery-version-1 aria-label=Anchor>#</a></span></h4><p>read it on added host, it&rsquo;s in details<br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/PwnlQ4h.png></figure></p><h3 class="relative group">Flags 6.3<div id=flags-63 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-63 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the path for the running osqueryd.exe process?<div id=what-is-the-path-for-the-running-osquerydexe-process class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-path-for-the-running-osquerydexe-process aria-label=Anchor>#</a></span></h4><p>the launcher path.
hint: <code>C:\Users\?????????????\Desktop\????????\???????\osqueryd.exe</code></p><hr><h2 class="relative group">TASK 7 : Osquery extensions<div id=task-7--osquery-extensions class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-7--osquery-extensions aria-label=Anchor>#</a></span></h2><p>Extensions add functionality/features (i.e., additional tables) that are not included in the core Osquery. Anyone can create extensions for Osquery. The official documentation on this subject is <a href=https://osquery.readthedocs.io/en/latest/deployment/extensions/ target=_blank rel=noreferrer>here</a>.</p><p>If you perform a search, you&rsquo;ll find some interesting ones that can be downloaded and implemented with Osquery with little hassle. Others might require extra steps, such as setting up additional dependencies and compiling the extension before use.</p><p>Below are 2 repos of Osquery extensions that you can play with.</p><ul><li><a href=https://github.com/trailofbits/osquery-extensions target=_blank rel=noreferrer>https://github.com/trailofbits/osquery-extensions</a></li><li><a href=https://github.com/polylogyx/osq-ext-bin target=_blank rel=noreferrer>https://github.com/polylogyx/osq-ext-bin</a></li></ul><h3 class="relative group">Flags 7.1<div id=flags-71 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-71 aria-label=Anchor>#</a></span></h3><h4 class="relative group">According to the polylogyx readme, how many &lsquo;features&rsquo; does the plug-in add to the Osquery core?<div id=according-to-the-polylogyx-readme-how-many-features-does-the-plug-in-add-to-the-osquery-core class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#according-to-the-polylogyx-readme-how-many-features-does-the-plug-in-add-to-the-osquery-core aria-label=Anchor>#</a></span></h4><p>answer is in readme page: <a href=https://github.com/polylogyx/osq-ext-bin/blob/master/README.md target=_blank rel=noreferrer>https://github.com/polylogyx/osq-ext-bin/blob/master/README.md</a></p><hr><h2 class="relative group">TASK 8 : Linux and Osquery<div id=task-8--linux-and-osquery class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-8--linux-and-osquery aria-label=Anchor>#</a></span></h2><p>Review the On-Demand YARA scanning <a href=https://osquery.readthedocs.io/en/stable/deployment/yara/ target=_blank rel=noreferrer>here</a> to answer some of the questions below.</p><h3 class="relative group">Flags 8.1<div id=flags-81 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-81 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the &lsquo;current_value&rsquo; for kernel.osrelease?<div id=what-is-the-current_value-for-kernelosrelease class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-current_value-for-kernelosrelease aria-label=Anchor>#</a></span></h4><p><code>osquery> SELECT * FROM kernel_info;</code></p><h3 class="relative group">Flags 8.2<div id=flags-82 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-82 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the uid for the bravo user?<div id=what-is-the-uid-for-the-bravo-user class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-uid-for-the-bravo-user aria-label=Anchor>#</a></span></h4><p>Query: <code>osquery> SELECT username,uid from users where username= "bravo" ;</code></p><h3 class="relative group">Flags 8.3<div id=flags-83 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-83 aria-label=Anchor>#</a></span></h3><h4 class="relative group">One of the users performed a &lsquo;Binary Padding&rsquo; attack. What was the target file in the attack?<div id=one-of-the-users-performed-a-binary-padding-attack-what-was-the-target-file-in-the-attack class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#one-of-the-users-performed-a-binary-padding-attack-what-was-the-target-file-in-the-attack aria-label=Anchor>#</a></span></h4><p>I gave up on real way of finding answer, I guess my way isn&rsquo;t intended. correct me if I&rsquo;m wrong <a href=mailto:classroom@anir0y.in>here</a>.<br>I found the ans by running this: <code>select * from shell_history;</code> and looking into file names.</p><h3 class="relative group">Flags 8.4<div id=flags-84 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-84 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the hash value for this file?<div id=what-is-the-hash-value-for-this-file class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-hash-value-for-this-file aria-label=Anchor>#</a></span></h4><p>Exit from OSQuery, find the file name, run md5sum<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/0ZSrZxW.png></figure></p><h3 class="relative group">Flags 8.5<div id=flags-85 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-85 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Check all file hashes in the home directory for each user. One file will not show any hashes. Which file is that?<div id=check-all-file-hashes-in-the-home-directory-for-each-user-one-file-will-not-show-any-hashes-which-file-is-that class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#check-all-file-hashes-in-the-home-directory-for-each-user-one-file-will-not-show-any-hashes-which-file-is-that aria-label=Anchor>#</a></span></h4><p>it;s the zip. I just bruteforeced it.<br>I guess my way isn&rsquo;t intended. correct me <a href=mailto:classroom@anir0y.in>here</a>.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/6dlQi2d.png></figure><h4 class="relative group">solution provided by <strong>Georg</strong><div id=solution-provided-by-georg class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#solution-provided-by-georg aria-label=Anchor>#</a></span></h4><p><code>osquery> select path,filename,md5 from file join hash using (path) where path like "/home/%%/%" ;</code></p><h3 class="relative group">Flags 8.6<div id=flags-86 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-86 aria-label=Anchor>#</a></span></h3><h4 class="relative group">There is a file that is categorized as malicious in one of the home directories. Query the Yara table to find this file. Use the sigfile which is saved in &lsquo;/var/osquery/yara/scanner.yara&rsquo;. Which file is it?<div id=there-is-a-file-that-is-categorized-as-malicious-in-one-of-the-home-directories-query-the-yara-table-to-find-this-file-use-the-sigfile-which-is-saved-in-varosqueryyarascanneryara-which-file-is-it class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#there-is-a-file-that-is-categorized-as-malicious-in-one-of-the-home-directories-query-the-yara-table-to-find-this-file-use-the-sigfile-which-is-saved-in-varosqueryyarascanneryara-which-file-is-it aria-label=Anchor>#</a></span></h4><p>being a lame person I ran yara directly.
query: <code>yara /var/osquery/yara/scanner.yara /home/charlie/</code></p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/TJI9YbY.png></figure><p>query: <code>osquery> SELECT * FROM yara WHERE path="/path/filename" and sigfile="/var/osquery/yara/scanner.yara";</code><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/rvVBDwa.png></figure></p><h3 class="relative group">Flags 8.7<div id=flags-87 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-87 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What were the &lsquo;matches&rsquo;?<div id=what-were-the-matches class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-were-the-matches aria-label=Anchor>#</a></span></h4><p>ans is on same query run<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/TJI9YbY.png></figure></p><h3 class="relative group">Flags 8.8<div id=flags-88 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-88 aria-label=Anchor>#</a></span></h3><h4 class="relative group">Scan the file from Q#3 with the same Yara file. What is the entry for &lsquo;strings&rsquo;?<div id=scan-the-file-from-q3-with-the-same-yara-file-what-is-the-entry-for-strings class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#scan-the-file-from-q3-with-the-same-yara-file-what-is-the-entry-for-strings aria-label=Anchor>#</a></span></h4><p>run the same command by changing the file name get the strings.</p><p><strong>Query</strong>: <code>osquery> SELECT * FROM yara WHERE path="/home/tryhackme/filename" and sigfile="/var/osquery/yara/scanner.yara";</code></p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/G6Yy6Ks.png></figure><hr><h2 class="relative group">TASK 9 : Windows and Osquery<div id=task-9--windows-and-osquery class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-9--windows-and-osquery aria-label=Anchor>#</a></span></h2><p>For this exercise, use either Kolide Fleet or the Windows CMD/PowerShell.</p><p>Note: For the questions which involve the Polylogyx osq-ext-bin extension, you&rsquo;ll need to interact with Osquery via the command line.</p><p>To load the extension: <code>osqueryi --allow-unsafe --extension "C:\Program Files\osquery\extensions\osq-ext-bin\plgx_win_extension.ext.exe"</code></p><p>Wait for the command prompt to reflect the phrase <code>Done StartDriver</code>. This will indicate that the extension is fully loaded into the session.</p><p>Tip: If the phrase doesn&rsquo;t appear after a minute or so, hit the ENTER key. It should appear right after.</p><p>Resources for Polylogx osq-ext-bin:</p><ul><li><a href=https://github.com/polylogyx/osq-ext-bin/blob/master/README.md target=_blank rel=noreferrer>https://github.com/polylogyx/osq-ext-bin/blob/master/README.md</a></li><li><a href=https://github.com/polylogyx/osq-ext-bin/tree/master/tables-schema target=_blank rel=noreferrer>https://github.com/polylogyx/osq-ext-bin/tree/master/tables-schema</a></li></ul><h3 class="relative group">Flags 9.1<div id=flags-91 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-91 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the description for the Windows Defender Service?<div id=what-is-the-description-for-the-windows-defender-service class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-description-for-the-windows-defender-service aria-label=Anchor>#</a></span></h4><p>Query: <code>select name,description from services where name like "WinD%";</code><br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/kYRGFD3.png></figure></p><h3 class="relative group">Flags 9.2<div id=flags-92 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-92 aria-label=Anchor>#</a></span></h3><h4 class="relative group">There is another security agent on the Windows endpoint. What is the name of this agent?<div id=there-is-another-security-agent-on-the-windows-endpoint-what-is-the-name-of-this-agent class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#there-is-another-security-agent-on-the-windows-endpoint-what-is-the-name-of-this-agent aria-label=Anchor>#</a></span></h4><p><strong>Query:</strong>: <code>select name,publisher from programs;</code><br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/VBAQZ9C.png></figure></p><h3 class="relative group">Flags 9.3<div id=flags-93 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-93 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is required with win_event_log_data?<div id=what-is-required-with-win_event_log_data class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-required-with-win_event_log_data aria-label=Anchor>#</a></span></h4><p>Well the &lsquo;Origin&rsquo; from where you get the data (hint: S****E )</p><h3 class="relative group">Flags 9.4<div id=flags-94 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-94 aria-label=Anchor>#</a></span></h3><h4 class="relative group">How many sources are returned for win_event_log_channels?<div id=how-many-sources-are-returned-for-win_event_log_channels class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#how-many-sources-are-returned-for-win_event_log_channels aria-label=Anchor>#</a></span></h4><p><strong>Query:</strong>: <code>osquery> select count (*) from win_event_log_channels;</code><br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/nP2cI5j.png></figure></p><h3 class="relative group">Flags 9.5<div id=flags-95 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-95 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the schema for win_event_log_data?<div id=what-is-the-schema-for-win_event_log_data class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-schema-for-win_event_log_data aria-label=Anchor>#</a></span></h4><p><strong>Query:</strong>: <code>osquery> .schema win_event_log_data</code><br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/3b25Pxn.png></figure></p><h3 class="relative group">Flags 9.6<div id=flags-96 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-96 aria-label=Anchor>#</a></span></h3><h4 class="relative group">previous file scanned on the Linux endpoint with Yara is on the Windows endpoint. What date/time was this file first detected? (Answer format: YYYY-MM-DD HH:MM:SS)<div id=previous-file-scanned-on-the-linux-endpoint-with-yara-is-on-the-windows-endpoint--what-datetime-was-this-file-first-detected-answer-format-yyyy-mm-dd-hhmmss class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#previous-file-scanned-on-the-linux-endpoint-with-yara-is-on-the-windows-endpoint--what-datetime-was-this-file-first-detected-answer-format-yyyy-mm-dd-hhmmss aria-label=Anchor>#</a></span></h4><p>Query: <code>osquery> select eventid,datetime from win_event_log_data where source = "Microsoft-Windows-Windows Defender/Operational" and eventid like '1116' ;</code><br><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/oz9YRJ8.png></figure></p><h3 class="relative group">Flags 9.7<div id=flags-97 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-97 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the query to find the first Sysmon event? Select only the event id, order by date/time, and limit the output to only 1 entry.<div id=what-is-the-query-to-find-the-first-sysmon-event-select-only-the-event-id-order-by-datetime-and-limit-the-output-to-only-1-entry class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-query-to-find-the-first-sysmon-event-select-only-the-event-id-order-by-datetime-and-limit-the-output-to-only-1-entry aria-label=Anchor>#</a></span></h4><p>Query 1: find the sysmon Source
<code>select * from win_event_log_channels where source like '%sysmon%';</code></p><p>Query 2: <code>select eventid from win_event_log_data where source="Microsoft-Windows-Sysmon/Operational" order by datetime limit 1;</code></p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/hmBZb7L.png></figure><h3 class="relative group">Flags 9.8<div id=flags-98 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#flags-98 aria-label=Anchor>#</a></span></h3><h4 class="relative group">What is the Sysmon event id?<div id=what-is-the-sysmon-event-id class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-sysmon-event-id aria-label=Anchor>#</a></span></h4><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://i.imgur.com/hmBZb7L.png></figure><hr><h2 class="relative group">TASK 10 :<div id=task-10- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-10- aria-label=Anchor>#</a></span></h2><p>This was a high-level overview of Osquery. This room&rsquo;s goal was to introduce you to this alternate method of interacting with endpoints to extract information. There is more to Osquery than what was covered in this room.</p><ul><li>File Integrity Monitoring: <a href=https://osquery.readthedocs.io/en/latest/deployment/file-integrity-monitoring/ target=_blank rel=noreferrer>https://osquery.readthedocs.io/en/latest/deployment/file-integrity-monitoring/</a></li><li>Process Auditing: <a href=https://osquery.readthedocs.io/en/latest/deployment/process-auditing/ target=_blank rel=noreferrer>https://osquery.readthedocs.io/en/latest/deployment/process-auditing/</a></li><li>Syslog Consumption: <a href=https://osquery.readthedocs.io/en/latest/deployment/syslog/ target=_blank rel=noreferrer>https://osquery.readthedocs.io/en/latest/deployment/syslog/</a></li></ul><p>SIEMs like ELK and Splunk can ingest Osquery logs. If you completed some of the Splunk rooms, specifically Splunk 2 and Splunk 3, you should recall that Osquery logs (osquery:info, osquery:results, and osquery:warning) were part of the various queried sources to extract information. If looking at the log data seemed foreign, now you have a better understanding of the displayed in the results.</p><p>Lastly, look at other community projects for Osquery listed at <a href=https://osquery.io/ target=_blank rel=noreferrer>https://osquery.io/</a>.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt src=https://assets.tryhackme.com/additional/osquery/osquery_comm_projs.png></figure><p>The repo on enterprise threat hunting with <a href=https://github.com/teoseller/osquery-attck target=_blank rel=noreferrer>Osquery + MITRE ATT&amp;CK</a> is definitely worth your attention.</p><div class="not-prose my-6 print:hidden"><div class=ad-container><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/thm_hu_cb9f1817f5f97e5a.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/thm-room-openvas/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Try Hack Me Room Room Openvas</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-05-10T01:36:51+05:30>10 May 2021</time><span class="px-2 text-primary-500">&#183;</span><span>1872 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/classroom/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Classroom
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/categories/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">TryHackMe
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/notes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Notes
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Tryhackme
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/rooms/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rooms</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/thm_hu_cb9f1817f5f97e5a.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/thm-room-zerologon/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Try Hack ME Room Zerologon</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-05-10T01:22:37+05:30>10 May 2021</time><span class="px-2 text-primary-500">&#183;</span><span>3664 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">18 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/classroom/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Classroom
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/categories/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">TryHackMe
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/notes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Notes
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Tryhackme
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/rooms/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rooms</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/blog_hu_be59c7de05deaafc.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/cyber-security-interview-questions-with-answers/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Cyber Security Interview Questions With Answers</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-05-07T19:38:21+05:30>7 May 2021</time><span class="px-2 text-primary-500">&#183;</span><span>2645 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">13 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/classroom/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Classroom
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/notes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Notes
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/interview/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Interview</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/post/thm-room-openvas/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Try Hack Me Room Room Openvas
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2021-05-10T01:36:51+05:30>10 May 2021</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/post/thm-room-attacktivedirectory/><span class=leading-6>Try Hack Me Room Attacktivedirectory&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2021-05-18T23:58:19+05:30>18 May 2021</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/categories/ title=Categories>Categories</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">YOU CAN REUSE MY CONTENT</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://classroom.anir0y.in/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>