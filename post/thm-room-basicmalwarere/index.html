<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>TryHackMe BasicMalwareRE Writeup | Classroom</title>
<link href=/img/avatar.jpeg rel="shortcut icon" type=image/x-icon><meta name=author content="Animesh Roy @anir0y  "><meta name=description content="Try Hack Me Room BasicMalwareRE solved by Animesh Roy. this is a walkthough. read more..."><title>Animesh Roy | Classroom Posts</title>
<meta name=title content="Animesh Roy | Blogs & Writeups"><meta name=description content="Animesh Roy has more than a decade worth experience working in cyber security domain. He has worked with governments, corporates, colleges and universities, defence, and the community. He also running a community â€œArishti Liveâ€ to help everyone who wants to, or work in cyber security domain. His expertise on training & consulting are the best of both the world. He uses his real-life case studies in trainings, to help candidates to understand the job in better ways."><script async src="https://www.googletagmanager.com/gtag/js?id=G-SPD6BXK0P5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SPD6BXK0P5")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","it10lq8bk1")</script><meta property="og:type" content="website"><meta property="og:url" content="https://classroom.anir0y.in/"><meta property="og:title" content="Animesh Roy | Blogs & Writeups"><meta property="og:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training"><meta property="og:image" content="https://i.imgur.com/Ji5C41H.png"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://classroom.anir0y.in/post/thm-room-basicmalwarere/"><meta property="twitter:title" content="Animesh Roy | Blogs & Writeups"><meta property="twitter:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training"><meta property="twitter:image" content="https://i.imgur.com/Ji5C41H.png"><script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><link rel=canonical href=https://classroom.anir0y.in/post/thm-room-basicmalwarere/><meta property="og:url" content="https://classroom.anir0y.in/post/thm-room-basicmalwarere/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="TryHackMe BasicMalwareRE Writeup"><meta property="og:description" content="Try Hack Me Room BasicMalwareRE solved by Animesh Roy. this is a walkthough. read more..."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-31T08:20:27+05:30"><meta property="article:modified_time" content="2021-05-31T08:20:27+05:30"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="article:tag" content="Thm"><meta name=twitter:card content="summary"><meta name=twitter:title content="TryHackMe BasicMalwareRE Writeup"><meta name=twitter:description content="Try Hack Me Room BasicMalwareRE solved by Animesh Roy. this is a walkthough. read more..."><link rel=stylesheet href=/css/semantic.min.css><link rel=stylesheet href=/css/icomoon.css><link rel=stylesheet href=/css/OverlayScrollbars.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/site.css><link rel=stylesheet href=/css/custom.css><style>a:not(.ui.button):hover{text-decoration:underline}a:not(.ui.button){color:#2e8b57!important}.inverted a:not(.ui.button),.inverted a:not(.ui.button):hover{color:#8fbc8f!important}body.default{background-color:#fff}body.dark{background-color:#000}</style><link rel=stylesheet data-highlight href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/tomorrow.min.css><link rel=stylesheet href=/css/custom.css></head><body class=default><nav class="ui secondary menu dream-menu"><div class=item><i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i></div><div class=item><i class="large link home icon" title=Home onclick='window.location.href="https://classroom.anir0y.in/"'></i></div><div class=item><i class="large link icon theme-switch" onclick=themeSwitch()></i></div><div class=item><i class="large link search icon" onclick=toggleSearch()></i></div></nav><div class=flip-container><div class=flipper><section class=front><div class=dream-max-width><div class="ui relaxed grid dream-grid dream-grid-single" style=flex-direction:row-reverse><aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside"><div class="ui segment toc"><nav id=TableOfContents><ul><li><a href=#i-learnt-from-this-book-practical-malware-analysis-the-hands-on-guide-to-dissecting-malicious-softwarehttpsamznto3ucw0n5>I learnt from this Book: <a href=https://amzn.to/3uCw0N5>Practical Malware Analysis: The Hands-On Guide to Dissecting Malicious Software</a></a></li><li><a href=#task-01-introduction>Task 01: Introduction</a></li><li><a href=#task-02-strings--challenge-1>Task 02: Strings :: Challenge 1</a></li><li><a href=#flag-1>Flag 1</a></li><li><a href=#task-03--strings--challenge-2>Task 03: Strings :: Challenge 2</a><ul><li><a href=#find-the-entry-point>Find the entry point</a></li></ul></li><li><a href=#task-04-strings-3--challenge-3>Task 04: Strings 3 :: Challenge 3</a><ul><li><a href=#entry-point>Entry Point</a></li></ul></li></ul></nav></div><div class="ui segment actions"><button class="ui circular icon button save-as-image" title="Save as image" onclick=savePostAsImg()>
<i class="save icon"></i>
</button>
<a href="https://twitter.com/intent/tweet?text=TryHackMe%20BasicMalwareRE%20Writeup&url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-basicmalwarere%2f" class="ui circular twitter icon button"><i class="twitter icon"></i>
</a><a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-basicmalwarere%2f" class="ui circular facebook icon button"><i class="facebook icon"></i></a></div></aside><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img><section class="ui top attached segment"><header><h1 class="ui large header">TryHackMe BasicMalwareRE Writeup<div class="sub header">@
<a href=https://bit.ly/34sGFiK target=_blank>Animesh Roy</a>
|
Monday, May 31, 2021
| 3 minutes read
| Update at
Monday, May 31, 2021</div></h1></header><article class=main><h1 id=basicmalwarere>BasicMalwareRE</h1><table><thead><tr><th style=text-align:left>Profile</th><th style=text-align:right>Support</th></tr></thead><tbody><tr><td style=text-align:left><script src=https://tryhackme.com/badge/434937></script></td><td style=text-align:right><a href=https://www.buymeacoffee.com/anir0y><img src="https://img.buymeacoffee.com/button-api/?text=Cheers!!!&emoji=ðŸº&slug=anir0y&button_colour=BD5FFF&font_colour=ffffff&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00"></a></td></tr></tbody></table><iframe style=width:300px;height:240px marginwidth=0 marginheight=0 scrolling=no frameborder=0 src="//ws-in.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=IN&source=ss&ref=as_ss_li_til&ad_type=product_link&tracking_id=anir0y-21&language=en_IN&marketplace=amazon&region=IN&placement=1593272901&asins=1593272901&linkId=60304e65b31865f7a816862eaac56668&show_border=false&link_opens_in_new_window=true"></iframe><h2 id=i-learnt-from-this-book-practical-malware-analysis-the-hands-on-guide-to-dissecting-malicious-softwarehttpsamznto3ucw0n5>I learnt from this Book: <a href=https://amzn.to/3uCw0N5>Practical Malware Analysis: The Hands-On Guide to Dissecting Malicious Software</a></h2><hr><h2 id=task-01-introduction>Task 01: Introduction</h2><p>These challenges are aimed towards learning about the &ldquo;Static Analysis&rdquo; technique used to analyze the malware. The main aim for this room is not to used any types of debuggers neither the executable&rsquo;s/programs should be run on any platform. You are required to answer all the questions without even using the debugger and even not executing the executable&rsquo;s/programs.</p><p>Meanwhile all the credits goes to @MalwareTechBlog for creating these awesome challenges.</p><p>Note: If you have already solved these challenges - give it a try again while giving enough time to the newbies who want to learn about &ldquo;Malware Analysis&rdquo;. Also don&rsquo;t try to copy paste stuff from other blogs/walkthroughs as it won&rsquo;t lead you to learn this amazing field. If you are having hard time solving these challenges. Study more about it and the techniques which are involved. Meanwhile you can also join TryHackMe discord and fire up you problems in there.</p><p>Password for the ZIP is MalwareTech.</p><hr><h2 id=task-02-strings--challenge-1>Task 02: Strings :: Challenge 1</h2><h2 id=flag-1>Flag 1</h2><p>Find the entry point</p><p><img src=https://i.imgur.com/4SqwuGb.png alt></p><p>Jump to EAX value (just double click on it)</p><p>FLag :</p><p><img src=https://i.imgur.com/LZmUoyB.png alt></p><hr><h2 id=task-03--strings--challenge-2>Task 03: Strings :: Challenge 2</h2><h3 id=find-the-entry-point>Find the entry point</h3><h4 id=copy-the-values-to-a-temp-file-3>Copy the values to a temp file (3)</h4><p><img src=https://i.imgur.com/j0PSCIT.png alt></p><h4 id=filter-the-output-for-parsing>Filter the output for parsing</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat temp | awk -F <span style=color:#e6db74>&#34;0x&#34;</span> <span style=color:#e6db74>&#39;{print $2}&#39;</span> &gt; cleanHex
</span></span></code></pre></div><h4 id=open-with-vim-to-clean-trailing->open with vim to clean trailing &lsquo;;&rsquo;</h4><pre tabindex=0><code>vi cleanHex
</code></pre><pre tabindex=0><code>:%s/; # delete &#39;;&#39; from results
</code></pre><p><img src=https://i.imgur.com/lsrfxud.png alt></p><h4 id=now-we-only-have-hex-values-that-we-can-parse-eiher-online-or-using-a-simple-bash-script-i-used-a-bash-script-to-automate>now we only have HEX values that we can parse eiher online or using a simple bash script. I used a bash script to automate</h4><p><strong>code</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>echo -n $1 | xxd -r -p | tee &gt;&gt;  flag2
</span></span><span style=display:flex><span><span style=color:#75715e># $1 will be input file later on</span>
</span></span></code></pre></div><h4 id=all-set-lets-convert-the-hex-to-ascii-and-get-the-flag>all set, let&rsquo;s Convert the hex to ascii and get the flag.</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>while</span> IFS<span style=color:#f92672>=</span> read -r line; <span style=color:#66d9ef>do</span> ./hextoascii.sh $line; <span style=color:#66d9ef>done</span> &lt; cleanHex 
</span></span><span style=display:flex><span><span style=color:#75715e># cleanHex is the input fiile name</span>
</span></span></code></pre></div><p><strong>output</strong> :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$cat flag2 
</span></span><span style=display:flex><span>FLAG<span style=color:#f92672>{</span>STACK-STRINGS-<span style=color:#f92672>[</span>deleted-so-COPY-PASTE-wont-work<span style=color:#f92672>]</span>-BEST-STRINGS<span style=color:#f92672>}</span>
</span></span></code></pre></div><hr><h2 id=task-04-strings-3--challenge-3>Task 04: Strings 3 :: Challenge 3</h2><h3 id=entry-point>Entry Point</h3><ol><li>Open this project, go the functions, see entry and double click it. Same as before.</li><li>Okay, so first we have quite a few defined variables. None of these were super interesting. I was hopeful that maybe one of them would reference a defined string, but no dice.</li><li>Next I look at the body of the function, and we see a call another functions FindResourceA() and LoadStringA(). A quick look at the assembly and we see FindResourceA() is from the Kernel32 Library and LoadStringA() is from User32 Library. I quickly found this reference to try and gain an understanding of LoadStringA(). The most relevant thing it seems is that the string is being loaded from its reference and stored at the variable local_4a<ul><li>The assembly code shows the LoadStringA function, and then right next to it shows what it actually loads (aka the flag). I have cut this out for obvious</li></ul></li><li>We know the identifier for the string is hex value 0x110 as seen in the parameters for the function call. Now if we open up the defined strings and clock on the first one, we can see the start of the flag table. Included on the far right is the string id. 0x110 translates to 272 in decimal. Scroll down to 272 and that is your final flag :)</li></ol><p><img src=https://i.imgur.com/iFYCXFm.png alt></p><h4 id=follow-the-call-function>follow the &ldquo;Call&rdquo; function</h4><p><img src=https://i.imgur.com/kbvQ3vc.png alt></p><p>got the Flag:</p><p><img src=https://i.imgur.com/xqp4YjQ.png alt></p><hr><iframe style=width:120px;height:240px marginwidth=0 marginheight=0 scrolling=no frameborder=0 src="//ws-in.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=IN&source=ss&ref=as_ss_li_til&ad_type=product_link&tracking_id=anir0y-21&language=en_IN&marketplace=amazon&region=IN&placement=1593272901&asins=1593272901&linkId=60304e65b31865f7a816862eaac56668&show_border=false&link_opens_in_new_window=true"></iframe><hr></article></section></div></div><footer class="ui basic center aligned segment" style=background-color:transparent><p>Â© 2010 - 2024 Classroom</p></footer></div></section><section class=back><div class=dream-max-width><header class="ui basic very padded segment dream-header"><div class="ui small circular image"><img src=/img/avatar.jpeg></div><div class=content><h1 class="ui medium header">Reading Stuffs<div class="sub header"></div></h1><article class="ui horizontal list"><a class=item href=/categories><i class="th list icon" title="All Categories"></i>
</a><a class=item href=/tags><i class="tags icon" title="All Tags"></i></a></article></div></header><div class="ui relaxed grid dream-grid dream-back"><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment"><h3 class="ui header">Social Links</h3><nav class="ui secondary menu dream-menu dream-socials"><div class=item><a href=/index.xml><i class="large rss square icon" title=RSS></i></a></div><div class=item><a href=mailto:classroom@anir0y.in><i class="large mail icon" title=Email></i></a></div><div class=item><a href=https://twitter.com/anir0y target=_blank><i class="large twitter icon" title=Twitter></i></a></div><div class=item><a href=https://facebook.com/0xanir0y target=_blank><i class="large facebook icon" title=Facebook></i></a></div><div class=item><a href=https://instagram.com/0xanir0y target=_blank><i class="large instagram icon" title=Instagram></i></a></div><div class=item><a href=https://www.linkedin.com/in/anir0y target=_blank><i class="large linkedin icon" title=Linkedin></i></a></div><div class=item><a href=https://github.com/anir0y target=_blank><i class="large github icon" title=GitHub></i></a></div></nav></article></div><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment">YOU CAN REUSE MY CONTENT</article></div></div></div></section></div></div><script>window.defaultDark=null,window.backgroundDark="black",window.backgroundImageDark=null,window.darkNav=!0,window.hasTwitterEmbed=!0,window.hasTwitterEmbed&&(window.twttr=function(e,t,n){var o,i=e.getElementsByTagName(t)[0],s=window.twttr||{};return e.getElementById(n)?s:(o=e.createElement(t),o.id=n,o.src="https://platform.twitter.com/widgets.js",i.parentNode.insertBefore(o,i),s._e=[],s.ready=function(e){s._e.push(e)},s)}(document,"script","twitter-wjs"))</script><script src=/js/jquery.min.js></script><script src=/js/semantic.min.js></script><script src=/js/jquery.overlayScrollbars.min.js></script><script src=/js/header.js></script><script src=/js/main.js></script><script src=/js/theme.js></script><script src=/js/html2canvas.min.js></script><script src=/js/post.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/clojure.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js></script><script>hljs.initHighlightingOnLoad(),setHighlightTheme();function setHighlightTheme(){var e=localStore.getItem("hugo-theme-dream-is-dark"),e=e?e:window.defaultDark?"y":e,t="tomorrow",n="tomorrow-night",s=e==="y"?n:t;$("link[data-highlight]").attr("href","https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/"+s+".min.css"),$("pre").css("background",e==="y"?"#333":"")}</script><div class="ui inverted segment" id=dream-search><div class="ui search"><div class="ui transparent input"><input class=prompt type=text placeholder=Search></div><div class=results></div></div></div><script>$(document).ready(function(){$.getJSON("https://classroom.anir0y.in//index.json",function(e){$(".ui.search").search({source:e,searchFields:["title"],showNoResults:!0})})})</script><script src=/js/search.js></script></body></html>