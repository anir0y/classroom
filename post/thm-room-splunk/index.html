<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Try Hack Me Room Room Splunk | Classroom</title><link href=/img/avatar.jpeg rel="shortcut icon" type=image/x-icon><meta name=author content="Animesh Roy"><meta name=description content="Try Hack ME Room Splunk walkthough by Animesh Roy"><script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-NZBEX7RBNF"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-NZBEX7RBNF')</script><script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","6gp5990ghr")</script><link rel=canonical href=https://classroom.anir0y.in/post/thm-room-splunk/><meta property="og:title" content="Try Hack Me Room Room Splunk"><meta property="og:description" content="Try Hack ME Room Splunk walkthough by Animesh Roy"><meta property="og:type" content="article"><meta property="og:url" content="https://classroom.anir0y.in/post/thm-room-splunk/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-18T00:28:31+05:30"><meta property="article:modified_time" content="2021-05-18T00:28:31+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Try Hack Me Room Room Splunk"><meta name=twitter:description content="Try Hack ME Room Splunk walkthough by Animesh Roy"><link rel=stylesheet href=/css/semantic.min.css><link rel=stylesheet href=/css/icomoon.css><link rel=stylesheet href=/css/OverlayScrollbars.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/site.css><style>a:not(.ui.button):hover{text-decoration:underline}a:not(.ui.button){color:#2e8b57!important}.inverted a:not(.ui.button),.inverted a:not(.ui.button):hover{color:#8fbc8f!important}body.default{background-color:#fff}body.dark{background-color:#000}</style><link rel=stylesheet data-highlight href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/tomorrow.min.css><link rel=stylesheet href=/css/custom.css></head><body class=default><nav class="ui secondary menu dream-menu"><div class=item><i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i></div><div class=item><i class="large link home icon" title=Home onclick="window.location.href='https://classroom.anir0y.in'"></i></div><div class=item><i class="large link icon theme-switch" onclick=themeSwitch()></i></div><div class=item><i class="large link search icon" onclick=toggleSearch()></i></div></nav><div class=flip-container><div class=flipper><section class=front><div class=dream-max-width><div class="ui relaxed grid dream-grid dream-grid-single" style=flex-direction:row-reverse><aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside"><div class="ui segment toc"><nav id=TableOfContents><ul><li><a href=#splunk>Splunk</a></li><li><a href=#task-1---introduction-to-splunk>TASK 1 : Introduction to Splunk</a></li><li><a href=#task-2--navigating-splunk>TASK 2 : Navigating Splunk</a></li><li><a href=#task-3--splunk-apps>TASK 3 : Splunk Apps</a><ul><li><a href=#31--32>3.1 & 3.2</a></li></ul></li><li><a href=#task-4---adding-data>TASK 4 : Adding Data</a><ul><li><a href=#41>4.1</a></li></ul></li><li><a href=#task-5--splunk-queries>TASK 5 : Splunk Queries</a><ul><li><a href=#51>5.1</a></li><li><a href=#52>5.2</a></li><li><a href=#53>5.3</a></li><li><a href=#54>5.4</a></li><li><a href=#55>5.5</a></li></ul></li><li><a href=#task-6--sigma-rules>TASK 6 : Sigma Rules</a><ul><li><a href=#61>6.1</a></li><li><a href=#62>6.2</a></li></ul></li><li><a href=#task-7--dashboards--visualizations>TASK 7 : Dashboards & Visualizations</a><ul><li><a href=#71>7.1</a></li></ul></li><li><a href=#task-8--alerts>TASK 8 : Alerts</a></li><li><a href=#task-9->TASK 9 :</a></li></ul></nav></div><div class="ui segment actions"><button class="ui circular icon button save-as-image" title="Save as image" onclick=savePostAsImg()>
<i class="save icon"></i></button>
<a href="https://twitter.com/intent/tweet?text=Try%20Hack%20Me%20Room%20Room%20Splunk&url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-splunk%2f" class="ui circular twitter icon button"><i class="twitter icon"></i></a>
<a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-splunk%2f" class="ui circular facebook icon button"><i class="facebook icon"></i></a></div></aside><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img><section class="ui top attached segment"><header><h1 class="ui large header">Try Hack Me Room Room Splunk<div class="sub header">@
<a href=https://anir0y.in target=_blank>Animesh Roy</a>
|
Tuesday, May 18, 2021
| 16 minutes read
| Update at
Tuesday, May 18, 2021</div></h1></header><article class=main><hr><h2 id=splunk>Splunk</h2><script src=https://tryhackme.com/badge/434937></script><hr><h2 id=task-1---introduction-to-splunk>TASK 1 : Introduction to Splunk</h2><p>Typically when people think of a SIEM, they think of Splunk, and rightly so. Per the Splunk website, they boast that 91 of the Fortune 100 use Splunk.</p><p>Splunk is not only used for security; it&rsquo;s used for data analysis, DevOps, etc. But before speaking more on Splunk, what is a SIEM exactly?</p><p>A SIEM (Security Information and Event Management) is a software solution that provides a central location to collect log data from multiple sources within your environment. This data is aggregated and normalized, which can then be queried by an analyst.</p><p>As stated by <a href=https://www.varonis.com/blog/what-is-siem/>Varonis</a>, there are 3 critical capabilities for a SIEM:</p><ul><li>Threat detection</li><li>Investigation</li><li>Time to respond</li></ul><p>Some other SIEM features:</p><ul><li>Basic security monitoring</li><li>Advanced threat detection</li><li>Forensics & incident response</li><li>Log collection</li><li>Normalization</li><li>Notifications and alerts</li><li>Security incident detection</li><li>Threat response workflow</li></ul><p>Splunk was named a &ldquo;Leader&rdquo; in <a href=https://www.splunk.com/en_us/form/gartner-siem-magic-quadrant.html>Gartner</a>&rsquo;s 2020 Magic Quadrant for Security Information and Event Management.</p><p>Per Gartner, &ldquo;<em>Thousands of organizations around the world use Splunk as their SIEM for security monitoring, advanced threat detection, incident investigation and forensics, incident response, SOC automation and a wide range of security analytics and operations use cases.</em>&rdquo;</p><p>If you want to install Splunk on your own machine, follow Splunk&rsquo;s official installation notes <a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/InstallSplunk>here</a>.</p><hr><h2 id=task-2--navigating-splunk>TASK 2 : Navigating Splunk</h2><p>When you access Splunk, you will see the default home screen identical to the screenshot below.<br><img src=https://i.imgur.com/CqLE1r1.png alt><br>Let&rsquo;s look at each section, or panel, that makes up the home screen. The top panel is the Splunk Bar (below image).<br><img src=https://i.imgur.com/VPFqMmV.png alt><br>In the Splunk Bar, you can see system-level messages (Messages), configure the Splunk instance (Settings), review the progress of jobs (Activity), miscellaneous information such as tutorials (Help), and a search feature (Find).</p><p>The ability to switch between installed Splunk apps instead of using the Apps panel can be achieved from the Splunk Bar, like in the image below.<br><img src=https://i.imgur.com/lFAlsrL.png alt><br>Next is the Apps Panel. In this panel, you can see the apps installed for the Splunk instance.</p><p>The default app for every Splunk installation is Search & Reporting.<br><img src=https://i.imgur.com/VbYp5zA.png alt><br>The next section is Explore Splunk. This panel contains quick links to add data to the Splunk instance, add new Splunk apps, and access the Splunk documentation.</p><p><img src=https://i.imgur.com/RBCBrrK.png alt><br>The last section is the Home Dashboard. By default, no dashboards are displayed. You can choose from a range of dashboards readily available within your Splunk instance. You can select a dashboard from the dropdown menu or by visiting the dashboards listing page.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-add-dashboard.gif alt></p><p>You can also create dashboards and add them to the Home Dashboard. The dashboards you create can be viewed isolated from the other dashboards by clicking on the Yours tab.</p><p>Please review the Splunk documentation on Navigating Splunk <a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/NavigatingSplunk>here</a>.</p><hr><h2 id=task-3--splunk-apps>TASK 3 : Splunk Apps</h2><p>As mentioned in the previous task, Search & Reporting is a Splunk app installed by default with your Splunk instance. This app is also referred to as the Search app. If you click on the Search & Reporting app, you will be redirected to the Search app (see image below).<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-search.png alt><br>The Search app is where you will enter your Splunk queries to search through the data ingested by Splunk. More on Splunk queries later.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-app-navigation.png alt></p><p>The above image is the navigation for the Search app. Each app will have its own navigation menu. This menu is different from the menu/navigation within the Splunk bar, accessible throughout your entire Splunk session.</p><p>Let&rsquo;s draw our attention back to the Splunk Home page. In the Apps panel, there is a cog icon. By clicking the cog, you will be redirected to the Manage Apps page. From this page, you can change various settings (properties) for the installed apps. Let&rsquo;s look at the properties for the Search & Reporting app by clicking on <code>Edit properties</code>.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-app-properties2.png alt></p><p>Tip: If you want to land into the Search app upon login automatically, you can do so by editing the <code>user-prefs.conf</code> file.</p><ul><li>Windows: <code>C:\Program Files\Splunk\etc\apps\user-prefs\default\user-prefs.conf</code></li><li>Linux:<code>/opt/splunk/etc/apps/user-pref/default/user-prefs.conf</code></li></ul><p>Before:<br><img src=https://assets.tryhackme.com/additional/splunk-overview/user-prefs1.png alt></p><p>After:<br><img src=https://assets.tryhackme.com/additional/splunk-overview/user-prefs2.png alt></p><p><strong>Note</strong>: The above paths' base location will be different if you changed your Splunk install location.</p><p>In order for the user preferences changes to take effect, the splunkd service has to be restarted from a command-line prompt, using the following two commands: <code>net stop splunkd</code> and <code>net start splunkd</code>.</p><p>Lastly, you can install more Splunk apps to the Splunk instance to further expand Splunk&rsquo;s capabilities. You can either click on +<code> Find More Apps</code> in the Apps panel or <code>Splunk Apps</code> in the Explore Splunk panel.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/more-splunk-apps.png alt></p><p>To install apps into the Splunk instance, you can either install directly from within Splunk or download it from <a href=https://splunkbase.splunk.com/>Splunkbase</a> and manually upload it to add it to your Splunk instance.</p><p>Note: You must have an account on <a href=https://www.splunk.com/>Splunk.com</a> to download and install Splunk apps.</p><p>If you wish to install the app manually, click the <code>Install app from file</code> button.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-install-app.png alt></p><p>Just browse to the location of the app and upload it.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-install-app2.png alt></p><p>You can also download the app (tgz file) from Splunkbase. You then unzip the file and place the entire directory into the Apps location for your Splunk instance.</p><p>Note: If you performed the install steps from the Linux section within this room and manually copied an App to the Apps location for your Splunk instance, you might need to change the file ownership and group to <code>splunk</code> or else your Splunk instance might not restart properly.</p><p>Back to Windows, if you wish to remove an app (or an add-on), you can do so via the command-line.</p><p>Below is the command to perform this task on Windows.</p><p><code>C:\Program Files\Splunk\bin>splunk.exe remove app app-name -auth splunk-username:splunk-password</code></p><p>Note: The syntax is similar on Linux machines.</p><p>If the command were successful, you would see the following output: <code>App 'app-name' removed</code></p><p>Refer to the following Splunk documentation <a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Admin/Managingappobjects>here</a> for more information about managing Splunk apps.</p><p>Now time to upload an add-on into the Splunk instance.</p><p>There is a Splunk add-on on the desktop. Upload this add-on into the Splunk instance. Restart Splunk when prompted to.</p><h3 id=31--32>3.1 & 3.2</h3><h4 id=what-is-the-folder-name-for-the-add-on>What is the &lsquo;Folder name&rsquo; for the add-on?</h4><p>To get this answer, you need to install the app located in your desktop, once you install it you&rsquo;ll see the &lsquo;Folder Name&rsquo; there. hint:</p><p><img src=https://i.imgur.com/9zx22rf.png alt></p><hr><h2 id=task-4---adding-data>TASK 4 : Adding Data</h2><p>Splunk can ingest any data. As per the Splunk documentation, when data is added to Splunk, the data is processed and transformed into a series of individual events.</p><p>The sources of the data can be event logs, website logs, firewall logs, etc.</p><p>Data sources are grouped into categories. Below is a chart listing from the Splunk documentation detailing each data source category.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-data-sources.png alt></p><p>Please refer to the Splunk documentation <a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Data/Getstartedwithgettingdatain#Use_apps_to_get_data_in>here</a> for more information regarding the specific data source you want to add Splunk.</p><p>In this room, we&rsquo;re going to focus on Sysmon Logs.</p><p>When we click on the <code>Add Data</code> link (from the Splunk home screen), we&rsquo;re presented with the following screen.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-add-data.png alt></p><p>Looking at the guides, if we click on <strong>Operating System</strong>, we should see <code>Windows event logs</code>. But the only option available is <code>Forward data to Splunk indexers</code>. This is not what we want.</p><p>Let&rsquo;s ignore the guides and look at the bottom options: Upload, Monitor, and Forward.</p><p>Note: The above screenshot is what you&rsquo;ll see if you installed Splunk locally on your end. The Splunk instance in the attached room will only show Upload, Monitor, and Forward. (see below)<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-add-data-2.png alt></p><p>Since we want to look at Windows event logs and Sysmon logs from this host system, we want <strong>Monitor</strong>.</p><p>There are many options to pick from on the following screen. <code>Local Event Logs</code> is the one we want.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/local-event-logs1.png alt></p><p>Look at the list of <code>Available item(s)</code>. Do you see PowerShell logs listed? How about Sysmon? I didn&rsquo;t either.</p><p>Another way we can add data to the Splunk instance is from S<code>ettings > Data Inputs</code>.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-data-inputs.gif alt></p><p>As you can see, there are A LOT more logs we can add to the Splunk instance.</p><p>Now it&rsquo;s your turn to add some data to the Splunk instance so we can start querying them.</p><h3 id=41>4.1</h3><h4 id=upload-the-splunk-tutorial-data-on-the-desktop-how-many-events-are-in-this-source>Upload the Splunk tutorial data on the desktop. How many events are in this source?</h4><blockquote><p>Note: Make sure you upload the data once only.
Follow this to Upload the file</p></blockquote><ul><li><p>step 1
<img src=https://i.imgur.com/Yv3SnUX.png alt></p></li><li><p>Step 2 : add the zip file</p><p><img src=https://i.imgur.com/DfvBnfc.png alt></p></li><li><p>Step 3: wait for it. once it&rsquo;s loaded you&rsquo;ll have the answer, make sure timeline sets to alltime.</p><p><img src=https://i.imgur.com/YoJPSI8.png alt></p></li></ul><hr><h2 id=task-5--splunk-queries>TASK 5 : Splunk Queries</h2><p>Enter an asterisk <code>*</code> in the Search bar and change the timeframe to search from <code>Last 24 hours</code> to <code>All time</code>. This will retrieve all the historical data within Splunk.</p><p>Even though we haven&rsquo;t discussed Filters yet but essentially <code>Last 24 hours</code> and <code>All time</code> are filters. We&rsquo;re instructing Splunk to output all the events from the historical data within the last 24 hours from the point in time we submit our query.</p><p>Click on the magnifying glass to initiate the search.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-search-results-new.png alt></p><p>If you want to focus on a specific source or sourcetype, you can specify that within the Search bar. (see below image)<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-search-sources-new.png alt></p><p>This information is also available if you click on source or sourcetype under Selected Fields.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sourcetype-new.png alt></p><p>Let&rsquo;s look at source.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-source-count-new.png alt></p><p>From the above image, we see the names (values) of each source and the number of events (count), and the percentage value (%) of all the events for each source.</p><p>In the above image, the top 10 values are visible.</p><p>Let&rsquo;s start our query with Sysmon as the source. The query will look like this:</p><p><code>source="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational"</code></p><p>We&rsquo;ll use this one, instead of WinEventLog:Microsoft-Windows-Sysmon/Operational, since it has more events we can sift through.</p><p>I&rsquo;ll select the first event that appeared for me for demonstration purposes. Expanding on the event, the details of the event are more readable.</p><p><strong>Before:</strong><br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sysmon-1.png alt></p><p><strong>After:</strong><br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sysmon-2.png alt></p><p>Some of these fields are specific to Sysmon.</p><p>Note: The fields will be different depending on the source/sourcetype.</p><p>Back to our query, we can adjust our query to show events with Event ID 12, RegistryEvent (Object create and delete).<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sysmon-3.png alt></p><p>Fields are case-sensitive. If you attempt to query for EventID in all lowercase, no results will be returned.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sysmon-4.png alt></p><p>You can also search by keywords. Using the same event from above, I&rsquo;ll adjust the query and manually enter &lsquo;GoogleUpdate.exe.&rsquo;<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sysmon-5.png alt></p><p>Unlike fields, <strong>keywords</strong> are <strong>not case-sensitive</strong>.</p><p>Instead of manually keying in the keyword, the keyword can also be added by clicking the value you would like to add to the existing query (Add to search) or start a new query (New search).<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sysmon-6.png alt></p><p>In the above image, I clicked on &lsquo;GoogleUpdate.exe,&rsquo; and the options appeared.</p><p>Note: If you click on the icon to the far right for each choice, it will open the query in a new window.</p><p>In the example below, I selected to Add to search.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sysmon-7.png alt></p><p>You can use multiple keywords in your query. Splunk will use an implicit AND operator between each keyword.</p><p>Example:<code> * GoogleUpdate.exe chrome_installer.exe</code><br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-search-binaries.png alt></p><p>Note: You can try this query in the THM Splunk instance.</p><p>The above query will search across all the events (according to the timeframe specified) and return all the events with GoogleUpdate.exe AND chrome_installer.exe.</p><p>A keyword doesn&rsquo;t have to be a &lsquo;word&rsquo; necessarily, but it can be a phrase.</p><p>To search for a phrase, you need to surround the phrase with quotes. See the example below.</p><p>Example:<code> * "failed password for sneezy"</code><br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-failed-password.png alt></p><p>The above query will return any events that contain the exact phrase.</p><p>Note: You can try this query in the THM Splunk instance. (Make sure you imported tutorialdata.zip into the Splunk instance first)</p><p>Moving along. Let&rsquo;s go back to the Sysmon logs and look at GoogleUpdate.exe again.</p><p>Draw your attention to the Interesting Fields sidebar. This information is useful and can help adjust your query and narrow down your search results even more.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-interesting-fields.png alt></p><p>Let&rsquo;s look at RuleName and see what the 8 values are.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-rulename-9.png alt></p><p>We can further expand on our query with one of these values.</p><p>Note: If you click on any of the Interesting Fields sidebar values, it will be automatically added to the existing query.</p><p>Another thing to note regarding Interesting Fields. Let&rsquo;s say we would like to see the RuleName appear for each event, just like the host, source, and sourcetype fields (the default fields for every event).</p><p>You can change the value of Selected from No to Yes. This is visible in the above image. The value in the image is set to No.</p><p>Let&rsquo;s change the value of Selected to Yes for RuleName.</p><p>Before:<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-before-rulename.png alt></p><p>After:<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-after-rulename.png alt></p><p>The Selected Fields sidebar reflects the change.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-rulename-selected.png alt></p><p>Refer to the following Splunk documentation for more information on searching in Splunk.</p><ul><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Aboutthesearchapp>https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Aboutthesearchapp</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Startsearching>https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Startsearching</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Aboutthetimerangepicker>https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Aboutthetimerangepicker</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Usefieldstosearch>https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Usefieldstosearch</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Usefieldlookups>https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Usefieldlookups</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Searchwithfieldlookups>https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Searchwithfieldlookups</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Knowledge/AboutSplunkregularexpressions>https://docs.splunk.com/Documentation/Splunk/8.1.2/Knowledge/AboutSplunkregularexpressions</a></li></ul><p>Note: Some of the information in the above links will overlap each other.</p><p>The <a href=https://www.splunk.com/pdfs/solution-guides/splunk-quick-reference-guide.pdf>Splunk Quick Reference Guide</a> has more tips on searching and filtering in Splunk, along with other tips.</p><h3 id=51>5.1</h3><h4 id=use-splunk-to-search-for-the-phrase-failed-password-using-tutorialdatazip-as-the-source>Use Splunk to Search for the phrase &lsquo;failed password&rsquo; using tutorialdata.zip as the source.</h4><p>Query: <code>* failed password</code></p><h3 id=52>5.2</h3><h4 id=what-is-the-sourcetype>What is the sourcetype?</h4><p><img src=https://i.imgur.com/ifGGNYt.png alt></p><h3 id=53>5.3</h3><h4 id=in-the-search-result-look-at-the-patterns-tab>In the search result, look at the Patterns tab.</h4><p>IMG:
<img src=https://i.imgur.com/1NkGYlw.png alt></p><h3 id=54>5.4</h3><h4 id=what-is-the-last-username-in-this-tab>What is the last username in this tab?</h4><p>this covers the ans
<img src=https://i.imgur.com/1NkGYlw.png alt></p><h3 id=55>5.5</h3><h4 id=search-for-failed-password-events-for-this-specific-username-how-many-events-are-returned>Search for failed password events for this specific username. How many events are returned?</h4><p>query:<code>* failed password sourcetype="www1/secure" myuan</code></p><p><img src=https://i.imgur.com/vHkfMLT.png alt></p><hr><h2 id=task-6--sigma-rules>TASK 6 : Sigma Rules</h2><p>Florian Roth created Sigma.</p><p>What is Sigma?
As per the GitHub <a href=https://github.com/Neo23x0/sigma>repo</a>, &ldquo;Sigma is a generic and open signature format that allows you to describe relevant log events in a straightforward manner. The rule format is very flexible, easy to write and applicable to any type of log file. The main purpose of this project is to provide a structured form in which researchers or analysts can describe their once developed detection methods and make them shareable with others.&rdquo;</p><p>Each SIEM has its own structure/format for creating queries. It isn&rsquo;t easy to share SIEM queries with other Security Teams if they don&rsquo;t use your exact SIEM product. For example, you can have a repo of Splunk queries that your team utilizes for threat exposure checks or threat hunting. These queries (or rules) can be created in the Sigma format and shared with teams that don&rsquo;t use Splunk. Sigma rules can be shared along with IOCs and YARA rules as Threat Intelligence.</p><p>Some supported target SIEMs:</p><ul><li><a href=https://www.splunk.com/>Splunk</a></li><li><a href=https://www.microsoft.com/en-us/microsoft-365/windows/microsoft-defender-atp>Microsoft Defender Advanced Threat Protection</a></li><li><a href=https://azure.microsoft.com/en-us/services/azure-sentinel/>Azure Sentinel</a></li><li><a href=https://software.microfocus.com/en-us/products/siem-security-information-event-management/overview>ArcSight</a></li><li><a href=https://www.ibm.com/products/qradar-siem>QRadar</a></li></ul><p>Some projects/products that use Sigma:</p><ul><li><a href=https://www.misp-project.org/index.html>MISP</a></li><li><a href=https://www.nextron-systems.com/thor/>THOR</a></li><li><a href=https://www.joesecurity.org/>Joe Sandbox</a></li></ul><p>There also is a Splunk app titled <a href=https://github.com/dstaulcu/TA-Sigma-Searches>TA-Sigma-Searches</a>.</p><p>Sigma rules are written in YAML (YAML Ain&rsquo;t Markup Language).</p><p>As per the website, &ldquo;YAML is a human friendly data serialization standard for all programming languages.&rdquo;</p><p>Example: .<code>/sigmac -t splunk -c tools/config/generic/sysmon.yml ./rules/windows/process_creation/win_susp_whoami.yml</code></p><p>Please refer to the Github <a href=https://github.com/Neo23x0/sigma>repo</a> for more information, examples, install instructions, rules, etc.</p><p>An online version of this tool created by SOC PRIME (<a href=https://socprime.com/leadership/florian-roth/>Florian Roth</a>) does the conversion work for you. The tool is <a href=https://uncoder.io/>Uncoder.io</a>.</p><p>This online tool is not only for Sigma -> SIEM conversion. It also allows for other conversions. I&rsquo;ll leave you to explore that.</p><p>Let&rsquo;s explore this online tool a bit.</p><p>Near the top, there is a drop-down box. This drop-down will feature Sigma rules we can convert to a Splunk query<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sigma-1.png alt></p><p>Choose some Sigma rules and convert them to Elasticsearch, QRadar, Splunk, etc.</p><p>The Sigma rule for &lsquo;User Added to Local Administrators&rsquo; is converted to a Splunk query in the example below.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-sigma-example2.gif alt></p><p>The best way to get familiar and comfortable with Sigma and YAML files is to inspect that repo and look at Sigma rules and create some of your own.</p><h3 id=61>6.1</h3><h4 id=use-the-select-document-feature-what-is-the-splunk-query-for-sigma-apt29>Use the Select document feature. What is the Splunk query for &lsquo;sigma: APT29&rsquo;?</h4><p>hit Translate to get the ans.
<img src=https://i.imgur.com/vo6PURE.png alt></p><h3 id=62>6.2</h3><h4 id=use-the-github-sigma-repo-what-is-the-splunk-query-for-cactustorch-remote-thread-creation>Use the Github Sigma repo. What is the Splunk query for &lsquo;CACTUSTORCH Remote Thread Creation&rsquo;?</h4><p>File you&rsquo;re looking for is here somewhere: <a href=https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread>https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread</a></p><hr><h2 id=task-7--dashboards--visualizations>TASK 7 : Dashboards & Visualizations</h2><p>Dashboards are panels displaying different data (visualizations) in one view.</p><p>Visualizations allow us to view data in a visual format, such as a chart (bar or pie, for instance) or as a single value.</p><p>Typically SOCs create a variety of dashboards, and these dashboards are displayed on large screens. Different dashboards can be created, but the dashboards' overall objective is to provide a high-level overview of the environment.</p><p>Circling back to the <a href=https://tryhackme.com/room/windowseventlogs>Windows Event Log room</a>, it was briefly mentioned that in Event Viewer, we could use <code>Create Custom View</code> . A custom view is a filter to focus on specific data within the log. This concept is similar to a dashboard in a SIEM.</p><p>Note: Dashboards are specific to Apps. If you create a dashboard for the Search app, then the dashboard uses this particular app&rsquo;s context.</p><p>Follow these steps to create a dashboard in the Search app (and enable dark mode).</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-dashboard-example.gif alt></p><p>We&rsquo;re tasked to display the top 5 Sysmon Event IDs on the dashboard for the SOC team.</p><p>First, we&rsquo;ll create the search query, pipe to a transform command to filter the top 5 Event IDs, and examine the results.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-query-dashboard.png alt></p><p>After we confirm the query and results, we can look at Visualizations.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-dashboard-visuals.png alt></p><p>Please refer to the Splunk documentation on Dashboards and Visualizations to understand the difference between each option <a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/Visualizationreference>here</a>.</p><p>After the visualization is selected, save it as a Dashboard panel.<br><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-dashboard-saveas.png alt></p><p>If the dashboard is already created, we can select Existing for Dashboard and select it.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-dashboard-saveas-2.png alt></p><p>After successfully saving the Dashboard Panel, you can view the dashboard.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-dashboard-new-2.png alt></p><p>If you wish to add the dashboard to your home page, you can click on the ellipsis and select the option.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-dashboard-ellipsis-2.png alt></p><p>Result:</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-home-dashboard.png alt></p><p>Note:</p><p>Refer to the Splunk documentation on dashboards and visualizations:</p><ul><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/WebFramework>https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/WebFramework</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/Aboutthismanual>https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/Aboutthismanual</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/CreateDashboards>https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/CreateDashboards</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/AddPanels>https://docs.splunk.com/Documentation/Splunk/8.1.2/Viz/AddPanels</a></li><li><a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Createnewdashboard>https://docs.splunk.com/Documentation/Splunk/8.1.2/SearchTutorial/Createnewdashboard</a></li></ul><h3 id=71>7.1</h3><h4 id=what-is-the-highest-eventid>What is the highest EventID?</h4><p>Query: <code>source="xmlWinEventLog:Microsoft-Windows-Sysmon/Operational" | top limit=1 EventID</code></p><p><img src=https://i.imgur.com/12yVdy2.png alt></p><hr><h2 id=task-8--alerts>TASK 8 : Alerts</h2><p>Alerts is a feature in Splunk that enables us to monitor and respond to specific events.</p><p>Alerts use a saved search to monitor events in real-time or on a schedule. Alerts will trigger when a specific condition is met to take the defined course of action.</p><p>Let&rsquo;s look at &lsquo;<a href=https://docs.splunk.com/Documentation/SplunkCloud/8.1.2012/Alert/AlertWorkflowOverview>The alerting workflow</a>&rsquo; from the Splunk documentation.</p><p><strong>Search: What do you want to track?</strong></p><ul><li>There is an external IP brute-forcing a web page. We want to be alerted whenever this IP address is actively attacking the infrastructure.</li></ul><p><strong>Alert Type: How often do you want to check for events?</strong></p><ul><li>Since we want to be alerted whenever this IP is active, a real-time alert is what we&rsquo;ll configure.</li></ul><p><strong>Alert trigger conditions and throttling: How often do you want to trigger an alert?</strong></p><ul><li>If 10 failed password events under 1 minute, generate an alert.</li></ul><p><strong>Alert action: What happens when the alert triggers?</strong></p><p>Send an email or send a message in an application using a <a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Alert/Webhooks>webhook</a>.</p><p><img src=https://assets.tryhackme.com/additional/splunk-overview/splunk-alert-1.png alt></p><p>In Splunk Free, we can not create alerts. You can experiment with this feature in the <a href="https://www.splunk.com/en_us/download/splunk-enterprise.html?utm_campaign=google_amer_en_search_brand&utm_source=google&utm_medium=cpc&utm_content=Splunk_Enterprise_Demo&utm_term=splunk%20enterprise&_bk=splunk%20enterprise&_bt=439715964910&_bm=e&_bn=g&_bg=43997960527&device=c&gclid=EAIaIQobChMIiYumpZ-V8AIViNrICh2arQ01EAAYASAAEgJw9PD_BwE">60-day trial of Splunk Enterprise</a>.</p><p>Please reference the Splunk documentation on Alerting <a href=https://docs.splunk.com/Documentation/Splunk/latest/Alert/Aboutalerts>here</a> to fully understand the different ways to configure them.</p><p><a href=https://docs.splunk.com/Documentation/SplunkCloud/8.1.2012/Alert/Alertexamples>Here</a> is the direct link to Alert examples.</p><hr><h2 id=task-9->TASK 9 :</h2><p>There is more to Splunk than what was covered in this 101 room.</p><p>Besides developing a good understanding of SPL (Search Process Language), it would be a good idea to level up your regex-fu. This will increase your ability to write complex search queries. Read more about regular expression in the Splunk documentation <a href=https://docs.splunk.com/Documentation/Splunk/8.1.2/Knowledge/AboutSplunkregularexpressions>here</a>.</p><p>Splunk has a free training + certification titled <a href="https://www.splunk.com/en_us/training/courses/splunk-fundamentals-1.html?utm_medium=email&utm_source=nurture&utm_campaign=GLOBAL_Enterprise_Trial_Learning_Mar19&utm_content=Splunk-fundamentals-1&elqTrackId=590afdde558446d1b16f45726f1bdbfb&elq=7e380948a4ab47419542ec6b54519247&elqaid=21461&elqat=1&elqCampaignId=15042">Splunk Fundamentals 1</a>. This course will cover much that was covered in this room and more.</p><hr><script type=text/javascript language=javascript>var aax_size='728x90',aax_pubname='anir0y-21',aax_src='302'</script><script type=text/javascript language=javascript src=http://c.amazon-adsystem.com/aax2/assoc.js></script></article></section></div></div><footer class="ui basic center aligned segment" style=background-color:transparent><p>© 2010 - 2021 Classroom</p></footer></div></section><section class=back><div class=dream-max-width><header class="ui basic very padded segment dream-header"><div class="ui small circular image"><img src=/img/avatar.jpeg></div><div class=content><h1 class="ui medium header">Classroom Notes & Blog Posts<div class="sub header"></div></h1><article class="ui horizontal list"><a class=item href=/categories><i class="th list icon" title="All Categories"></i></a>
<a class=item href=/tags><i class="tags icon" title="All Tags"></i></a></article><article class=dream-tags><a class="ui label" href=/tags/bash/ title=bash>bash</a>
<a class="ui label" href=/tags/cheatsheet/ title=cheatsheet>cheatsheet</a>
<a class="ui label" href=/tags/config/ title=config>config</a>
<a class="ui label" href=/tags/empire/ title=Empire>Empire</a>
<a class="ui label" href=/tags/encryption/ title=encryption>encryption</a>
<a class="ui label" href=/tags/forensic/ title=forensic>forensic</a>
<a class="ui label" href=/tags/gnupg/ title=gnupg>gnupg</a>
<a class="ui label" href=/tags/internship/ title=Internship>Internship</a>
<a class="ui label" href=/tags/interview/ title=interview>interview</a>
<a class="ui label" href=/tags/lab/ title=lab>lab</a>
<a class="ui label" href=/tags/linux/ title=Linux>Linux</a>
<a class="ui label" href=/tags/memory/ title=memory>memory</a>
<a class="ui label" href=/tags/metasploit/ title=metasploit>metasploit</a>
<a class="ui label" href=/tags/mobile/ title=Mobile>Mobile</a>
<a class="ui label" href=/tags/msf/ title=msf>msf</a>
<a class="ui label" href=/tags/notes/ title=notes>notes</a>
<a class="ui label" href=/tags/osi/ title=OSI>OSI</a>
<a class="ui label" href=/tags/osi-model/ title="OSI Model">OSI Model</a>
<a class="ui label" href=/tags/pentesting/ title=Pentesting>Pentesting</a>
<a class="ui label" href=/tags/pgp/ title=PGP>PGP</a>
<a class="ui label" href=/tags/powershell/ title=powershell>powershell</a>
<a class="ui label" href=/tags/ref/ title=Ref>Ref</a>
<a class="ui label" href=/tags/rooms/ title=rooms>rooms</a>
<a class="ui label" href=/tags/scripting/ title=Scripting>Scripting</a>
<a class="ui label" href=/tags/splunk/ title=splunk>splunk</a>
<a class="ui label" href=/tags/stego/ title=stego>stego</a>
<a class="ui label" href=/tags/sysmon/ title=sysmon>sysmon</a>
<a class="ui label" href=/tags/tools/ title=tools>tools</a>
<a class="ui label" href=/tags/tryhackme/ title=tryhackme>tryhackme</a>
<a class="ui label" href=/tags/vapt/ title=vapt>vapt</a>
<a class="ui label" href=/tags/volatility/ title=Volatility>Volatility</a>
<a class="ui label" href=/tags/vuln-labs/ title="vuln labs">vuln labs</a>
<a class="ui label" href=/tags/wireshark/ title=wireshark>wireshark</a></article></div></header><div class="ui relaxed grid dream-grid dream-back"><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment"><h3 class="ui header">Social Links</h3><nav class="ui secondary menu dream-menu dream-socials"><div class=item><a href=/index.xml><i class="large rss square icon" title=RSS></i></a></div><div class=item><a href=mailto:classroom@anir0y.in><i class="large mail icon" title=Email></i></a></div><div class=item><a href=https://twitter.com/anir0y target=_blank><i class="large twitter icon" title=Twitter></i></a></div><div class=item><a href=https://facebook.com/anir0yofficial target=_blank><i class="large facebook icon" title=Facebook></i></a></div><div class=item><a href=https://instagram.com/anir0yofficial target=_blank><i class="large instagram icon" title=Instagram></i></a></div><div class=item><a href=https://www.linkedin.com/in/anir0y target=_blank><i class="large linkedin icon" title=Linkedin></i></a></div><div class=item><a href=https://github.com/anir0y target=_blank><i class="large github icon" title=GitHub></i></a></div></nav></article></div><div class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article class="ui segment">YOU CAN RESUE MY CONTENT</article></div></div></div></section></div></div><script>window.defaultDark=null,window.backgroundDark="black",window.backgroundImageDark=null,window.darkNav=!0,window.hasTwitterEmbed=!0,window.hasTwitterEmbed&&(window.twttr=function(c,d,e){var b,f=c.getElementsByTagName(d)[0],a=window.twttr||{};return c.getElementById(e)?a:(b=c.createElement(d),b.id=e,b.src='https://platform.twitter.com/widgets.js',f.parentNode.insertBefore(b,f),a._e=[],a.ready=function(b){a._e.push(b)},a)}(document,'script','twitter-wjs'))</script><script src=/js/jquery.min.js></script><script src=/js/semantic.min.js></script><script src=/js/jquery.overlayScrollbars.min.js></script><script src=/js/header.js></script><script src=/js/main.js></script><script src=/js/theme.js></script><script src=/js/html2canvas.min.js></script><script src=/js/post.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/clojure.min.js></script><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js></script><script>hljs.initHighlightingOnLoad(),setHighlightTheme();function setHighlightTheme(){var a=localStore.getItem('hugo-theme-dream-is-dark'),b,c,d;a=a?a:window.defaultDark?'y':a,b="tomorrow",c="tomorrow-night",d=a==='y'?c:b,$('link[data-highlight]').attr('href','https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/'+d+'.min.css'),$('pre').css('background',a==='y'?'#333':'')}</script><div class="ui inverted segment" id=dream-search><div class="ui search"><div class="ui transparent input"><input class=prompt type=text placeholder=Search></div><div class=results></div></div></div><script>$(document).ready(function(){$.getJSON('https://classroom.anir0y.in/index.json',function(a){$('.ui.search').search({source:a,searchFields:['title'],showNoResults:!0})})})</script><script src=/js/search.js></script></body></html>