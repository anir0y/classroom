<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Try Hack Me Room Room Openvas | Classroom</title><meta name=keywords content="notes,tryhackme,rooms"><meta name=description content="Try Hack ME Room OpenVas walkthough"><meta name=author content="Animesh Roy"><link rel=canonical href=https://classroom.anir0y.in/post/thm-room-openvas/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=16x16 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=32x32 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=apple-touch-icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=mask-icon href=https://classroom.anir0y.in/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://classroom.anir0y.in/post/thm-room-openvas/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://classroom.anir0y.in/post/thm-room-openvas/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="Try Hack Me Room Room Openvas"><meta property="og:description" content="Try Hack ME Room OpenVas walkthough"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-10T01:36:51+05:30"><meta property="article:modified_time" content="2021-05-10T01:36:51+05:30"><meta property="article:tag" content="Notes"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="og:image" content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:title content="Try Hack Me Room Room Openvas"><meta name=twitter:description content="Try Hack ME Room OpenVas walkthough"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"Try Hack Me Room Room Openvas","item":"https://classroom.anir0y.in/post/thm-room-openvas/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Try Hack Me Room Room Openvas","name":"Try Hack Me Room Room Openvas","description":"Try Hack ME Room OpenVas walkthough","keywords":["notes","tryhackme","rooms"],"articleBody":"\nOpenVas Room Subscription Only\nTask 1: Introduction OpenVAS, an application used to scan endpoints and web applications to identify and detect vulnerabilities. It is commonly used by corporations as part of their mitigation solutions to quickly identify any gaps in their production or even development servers or applications. This is not an end all be all solution but can help to get rid of any common vulnerabilities that may have slipped through the cracks.\nFrom the OpenVAS GitHub repository “This is the Open Vulnerability Assessment Scanner (OpenVAS) of the Greenbone Vulnerability Management (GVM) Solution. It is used for the Greenbone Security Manager appliances and is a full-featured scan engine that executes a continuously updated and extended feed of Network Vulnerability Tests (NVTs)\nTask 2: GVM Framework Architecture As previously mentioned OpenVAS is built off the GreenBone Vulnerability Management (GVM) solution and is only one of the appliances that is released from GreenBone.\nOpenVAS is a service within a larger framework of services known as Greenbone Vulnerability Management (GVM). In this task we will break down the services that make up the framework and their roles.\nAbove is a brief visual breakdown of what the GVM framework looks like. There are many components that are apart of the architecture for the GVM framework, but we can break it down into three distinct sections: Front-End, Back-End, and Vulnerability/Information feed. These sections are further explained below.\nVulnerability/Information Feed (NVT, SCAP CERT, User Data, Community Feed) This section will contain all information and vulnerability tests that come from the Greenbone Community Feed that will be the main baseline for testing against systems. This can also include User Data provided by the user in place of Greenbone NVTs and SCAP CERTs.\nBack-End (OSP, OpenVAS, Targets) The back-end infrastructure is what will be actually conducting all of the vulnerability scanning and processing data and NVTS through OpenVAS and GVM. Greenbone Vulnerability Manager will be the middle man between the scanners and the front-end user interfaces.\nFront-End (GSA, Web Interfaces) This is what you interact with when you navigate to OpenVAS in your browser. The web interfaces are built off of the Greenbone Security Assistant and make life easier for an analyst or operator when working with OpenVAS or other forms of scanners through the GVM.\nFor more information about the GVM framework architecture check out this forum post https://community.greenbone.net/t/about-gvm-10-architecture/1231.\nTask 3: Installtion The installation procedure for OpenVAS can vary based on how you decide to install. You can install from Kali/OpenVAS repos, install from source, or run from a docker container. For our purposes, the preferred method is to run it inside a docker container as we don’t have to worry about a lot of the setup or errors that we may run into with other installation methods.\nOption 1: Install from Kali/OpenVAS repositories\nInstalling from repositories can sometimes be very simple or it can be a very painful process. For OpenVAS, the installation ranges in difficulty and can require many configurations ran. For more information about this option check out the guides below.\nhttps://websiteforstudents.com/how-to-install-and-configure-openvas-on-ubuntu-18-04-16-04/\nhttps://www.agix.com.au/installing-openvas-on-kali-in-2020/\nOption 2: Install from Source\nInstalling from source is the least preferred option for beginners and the least optimized way of installing OpenVAS due to prerequisites and make errors. For more information about installing from source look at the INSTALL.MD.\nOption 3: Run from Docker (Preferred)\nDocker is by far the easiest of all three installation methods and only requires one command to be run to get the client started. For this installation procedure, you will need docker installed.\nFor more information about this information procedure checkout the openvas-docker project on GitHub and DockerHub.\napt install docker.io docker run -d -p 443:443 --name openvas mikesplain/openvas This command will both pull the docker container and then run the container. It may take a few minutes for the container to fully set up and begin running. Once it is complete you can then navigate to https://127.0.0.1 in your preferred browser and OpenVAS will be setup and ready to go!\nBelow are the default credentials to access OpenVAS/GVM:\nUsername: admin Password: admin\nIf you successfully logged into OpenVAS you should see a dashboard that looks similar to the one below.\nTask 4: initial Configuration Before we can start scanning and implementing OpenVAS into our vulnerability management solution we need to do a little bit of maintenance and configuration to get OpenVAS properly working. Luckily for us, OpenVAS makes the process very easy and includes a wizard to make the process straightforward.\nBegin by navigating to Scans \u003e Tasks and clicking on the purple magic wand icon to begin the basic configuration wizard. We recommend beginning a scan on 127.0.0.1 to test out your installation and ensure it is working properly.\nIf you successfully navigated to the wizard you should see a pop-up similar to the one above. This is where you will set up your initial scan against your localhost to ensure everything is properly configured.\nThe scan may take a while to complete, allow OpenVAS enough time to finish the scan, and then you will be met with a new dashboard for monitoring and analyzing your complete and ongoing scans like the one below. Once your scan has finished you can navigate to Scans \u003e Reports and click on your newly created report from your previous task.\nIf correctly configured you should see three different vulnerabilities reported all originating from OpenVAS itself. This is normal behavior and can be configured/changed to maintain your OpSec.\nTASK 5: Scanning Infra Now that we know that everything is working we can get into the nitty-gritty of OpenVAS and how it works. Deploy the machine and navigate to Scans \u003e Tasks to begin creating a task to scan the provided machine.\nCreating a Task To create a configurable task navigate to the star icon in the upper right-hand corner of the Tasks dashboard and select New Task.\nOnce you select New Task from the dropdown you will be met with a large pop-up with many options. We will break down each of the options sections and what they can be used for.\nFor this task, we will be focusing only on the Name, Scan Targets, and Scanner Type, and Scan Config. In later tasks, we will be focusing on the other options for more advanced configuration and implementation/automation.\nName: Allows us to set the name the scan will be known as inside of OpenVAS Scan Targets: The targets to scan, can include Hosts, Ports, and Credentials. To create a new target you will need to follow another pop-up, this will be covered later in this task. Scanner: The scanner to use by default will use the OpenVAS architecture however you can set this to any scanner of your choosing in the settings menu. Scan Config: OpenVAS has seven different scan types you can select from and will be used based on how you aggressive or what information you want to collect from your scan Scoping a New Target To scope a new target, navigate to the star icon next to Scan Targets.\nAbove is the menu for configuring a new target. The two main options you will need to configure are the Name and the Hosts. This procedure is fairly straight forward and other options will only be used in advanced vulnerability management solutions. These will be covered in later tasks. Now that we have our target scoped we can continue to create our task and begin the scan.\nOnce you create the task you will be brought back to the scan dashboard where you can monitor and start your task. To start the task navigate to the start icon under Actions. Task 6: Reporting and Continuous Monitoring OpenVAS has very strong reporting and monitoring capabilities that can contribute to an efficient and optimal solution in your build or vulnerability management pipeline.\nDownload the provided report from a vulnerable machine to get familiar with the automated reporting capabilities of OpenVAS.\nBreaking Down the Report The automated report from OpenVAS begins with some basic host and task information including Host, Start, End, and Vulnerability categories. It will also check for host authentications and an overall summary of open ports on the host After the basic host and task information OpenVAS will report on each of the vulnerabilities found. In the above image, the vulnerability breakdown can give a lot of information. We can gather a summary of the vulnerability, detection details, mitigation details, and method of detection.\nContinuous Monitoring Overview OpenVAS offers many options for continuous and scheduled monitoring/vulnerability management. If you work in a team or a pipeline this can allow you to efficiently and quickly optimize your current solutions. Examples of continuous vulnerability scanning utilities are Alerts, Schedules, and Agents. Agents are out of scope for this room but we will be covering the configuration of schedules and alerts below.\nCreating Schedules To begin creating a schedule navigate to Configuration \u003e Schedules and as always click on the blue star icon in the upper left-hand corner. You should see a pop-up similar to the one below.\nFill out the basic information like Name, First Start Time, Period, etc. Once you have the schedule created you can now create a new Task/Scan with this created schedule attached. You can see this option below. Crafting Alerts The process for creating alerts is very similar to creating a schedule, navigate to Configuration \u003e Alerts and click on the blue star icon in the upper left-hand corner. You should see a pop-up similar to the one below.\nYou will notice that there are a lot more options than the schedule menu, don’t let this intimidate you, the process is very similar and straightforward. The main options you will need to worry about are Name, Event, Condition, and To Address. The event can be configured to alert based on the status of the scan or when a new NVT/vulnerability is detected. The condition option will make sure that your inbox isn’t flooded with alerts, this can be changed based on severity or filters. The To Address is fairly self-explanatory and will send an email of the alert to the specified mail address. Once created you will again need to connect the alert to a new Task/Scan. You can see the specific option below. Task 7: Practical Vulnerability Management Case 001: MS00-What? In this scenario, you are assigned to a routine vulnerability management pipeline as a SOC analyst. Your automated pipeline has already pulled a scan on the server, it is up to you to analyze and identify risk in this report.\nFlags Questions Flag When did the scan start in Case 001? Feb 28, 00:04:46 When did the scan end in Case 001? Feb 28, 00:21:02 How many ports are open in Case 001? 3 How many total vulnerabilities were found in Case 001? 5 What is the highest severity vulnerability found? (MSxx-xxx) MS17-010 What is the first affected OS to this vulnerability? Microsoft Windows 10 x32/x64 Edition What is the recommended vulnerability detection method? Send the crafted SMB transaction request with fid = 0 and check the response to confirm the vulnerability ","wordCount":"1853","inLanguage":"en","image":"https://classroom.anir0y.in/img/thm.gif","datePublished":"2021-05-10T01:36:51+05:30","dateModified":"2021-05-10T01:36:51+05:30","author":{"@type":"Person","name":"Animesh Roy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/thm-room-openvas/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https://classroom.anir0y.in/img/avatar.jpeg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://classroom.anir0y.in/ accesskey=h title="Classroom (Alt + H)"><img src=https://classroom.anir0y.in/img/avatar.jpeg alt aria-label=logo height=35>Classroom</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://classroom.anir0y.in/post/ title=Posts><span>Posts</span></a></li><li><a href=https://classroom.anir0y.in/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://classroom.anir0y.in/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://classroom.anir0y.in/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://classroom.anir0y.in/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://classroom.anir0y.in/about/me/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://classroom.anir0y.in/>Home</a>&nbsp;»&nbsp;<a href=https://classroom.anir0y.in/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Try Hack Me Room Room Openvas</h1><div class=post-description>Try Hack ME Room OpenVas walkthough</div><div class=post-meta><span title='2021-05-10 01:36:51 +0530 IST'>May 10, 2021</span>&nbsp;·&nbsp;<span>9 min</span>&nbsp;·&nbsp;<span>Animesh Roy</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/anir0y/classroom/tree/master/content/post/thm-room-openvas.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><figure class=entry-cover><img loading=eager src=https://classroom.anir0y.in/img/thm.gif alt="cover image"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#openvas>OpenVas</a></li><li><a href=#task-1-introduction>Task 1: Introduction</a></li><li><a href=#task-2-gvm-framework-architecture>Task 2: GVM Framework Architecture</a><ul><li></li></ul></li><li><a href=#task-3-installtion>Task 3: Installtion</a></li><li><a href=#task-4-initial-configuration>Task 4: initial Configuration</a></li><li><a href=#task-5-scanning-infra>TASK 5: Scanning Infra</a><ul><li><a href=#creating-a-task>Creating a Task</a></li><li><a href=#scoping-a-new-target>Scoping a New Target</a></li></ul></li><li><a href=#task-6-reporting-and-continuous-monitoring>Task 6: Reporting and Continuous Monitoring</a><ul><li><a href=#breaking-down-the-report>Breaking Down the Report</a></li><li><a href=#continuous-monitoring-overview>Continuous Monitoring Overview</a></li><li><a href=#creating-schedules>Creating Schedules</a></li><li><a href=#crafting-alerts>Crafting Alerts</a></li></ul></li><li><a href=#task-7-practical-vulnerability-management>Task 7: Practical Vulnerability Management</a><ul><li><a href=#case-001-ms00-what>Case 001: MS00-What?</a></li></ul></li><li><a href=#flags>Flags</a></li></ul></nav></div></details></div><div class=post-content><p><img alt="openvas logo" loading=lazy src=/img/openvas.png></p><h2 id=openvas>OpenVas<a hidden class=anchor aria-hidden=true href=#openvas>#</a></h2><script src=https://tryhackme.com/badge/434937></script><blockquote><p><strong>Room</strong> <a href=https://tryhackme.com/room/openvas>Subscription Only</a></p></blockquote><h2 id=task-1-introduction>Task 1: Introduction<a hidden class=anchor aria-hidden=true href=#task-1-introduction>#</a></h2><p>OpenVAS, an application used to scan endpoints and web applications to identify and detect vulnerabilities. It is commonly used by corporations as part of their mitigation solutions to quickly identify any gaps in their production or even development servers or applications. This is not an end all be all solution but can help to get rid of any common vulnerabilities that may have slipped through the cracks.</p><p>From the OpenVAS GitHub repository &ldquo;This is the Open Vulnerability Assessment Scanner (OpenVAS) of the Greenbone Vulnerability Management (GVM) Solution. It is used for the Greenbone Security Manager appliances and is a full-featured scan engine that executes a continuously updated and extended feed of Network Vulnerability Tests (NVTs)</p><h2 id=task-2-gvm-framework-architecture>Task 2: GVM Framework Architecture<a hidden class=anchor aria-hidden=true href=#task-2-gvm-framework-architecture>#</a></h2><p>As previously mentioned OpenVAS is built off the GreenBone Vulnerability Management (GVM) solution and is only one of the appliances that is released from GreenBone.</p><p><img alt="openvas: animesh roy blog post" loading=lazy src=https://www.greenbone.net/wp-content/uploads/01_Logo-mit-Schriftzug_500px_on_white_horiz1.jpg></p><p>OpenVAS is a service within a larger framework of services known as Greenbone Vulnerability Management (GVM). In this task we will break down the services that make up the framework and their roles.</p><p><img alt="openvas GVM" loading=lazy src=https://community.greenbone.net/uploads/default/optimized/1X/901766e0fa6b6cb6aee9f4702f46fb8a703a332b_2_690x323.png></p><p>Above is a brief visual breakdown of what the GVM framework looks like. There are many components that are apart of the architecture for the GVM framework, but we can break it down into three distinct sections: Front-End, Back-End, and Vulnerability/Information feed. These sections are further explained below.</p><h4 id=vulnerabilityinformation-feed-nvt-scap-cert-user-data-community-feed>Vulnerability/Information Feed (NVT, SCAP CERT, User Data, Community Feed)<a hidden class=anchor aria-hidden=true href=#vulnerabilityinformation-feed-nvt-scap-cert-user-data-community-feed>#</a></h4><p>This section will contain all information and vulnerability tests that come from the Greenbone Community Feed that will be the main baseline for testing against systems. This can also include User Data provided by the user in place of Greenbone NVTs and SCAP CERTs.</p><h4 id=back-end-osp-openvas-targets>Back-End (OSP, OpenVAS, Targets)<a hidden class=anchor aria-hidden=true href=#back-end-osp-openvas-targets>#</a></h4><p>The back-end infrastructure is what will be actually conducting all of the vulnerability scanning and processing data and NVTS through OpenVAS and GVM. Greenbone Vulnerability Manager will be the middle man between the scanners and the front-end user interfaces.</p><h4 id=front-end-gsa-web-interfaces>Front-End (GSA, Web Interfaces)<a hidden class=anchor aria-hidden=true href=#front-end-gsa-web-interfaces>#</a></h4><p>This is what you interact with when you navigate to OpenVAS in your browser. The web interfaces are built off of the Greenbone Security Assistant and make life easier for an analyst or operator when working with OpenVAS or other forms of scanners through the GVM.</p><p>For more information about the GVM framework architecture check out this forum post <a href=https://community.greenbone.net/t/about-gvm-10-architecture/1231>https://community.greenbone.net/t/about-gvm-10-architecture/1231</a>.</p><h2 id=task-3-installtion>Task 3: Installtion<a hidden class=anchor aria-hidden=true href=#task-3-installtion>#</a></h2><p>The installation procedure for OpenVAS can vary based on how you decide to install. You can install from Kali/OpenVAS repos, install from source, or run from a docker container. For our purposes, the preferred method is to run it inside a docker container as we don&rsquo;t have to worry about a lot of the setup or errors that we may run into with other installation methods.</p><p><strong>Option 1</strong>: Install from Kali/OpenVAS repositories</p><p>Installing from repositories can sometimes be very simple or it can be a very painful process. For OpenVAS, the installation ranges in difficulty and can require many configurations ran. For more information about this option check out the guides below.</p><p><a href=https://websiteforstudents.com/how-to-install-and-configure-openvas-on-ubuntu-18-04-16-04/>https://websiteforstudents.com/how-to-install-and-configure-openvas-on-ubuntu-18-04-16-04/</a></p><p><a href=https://www.agix.com.au/installing-openvas-on-kali-in-2020/>https://www.agix.com.au/installing-openvas-on-kali-in-2020/</a></p><p><strong>Option 2</strong>: Install from Source</p><p>Installing from source is the least preferred option for beginners and the least optimized way of installing OpenVAS due to prerequisites and make errors. For more information about installing from source look at the <a href=https://github.com/greenbone/openvas-scanner/blob/master/INSTALL.md>INSTALL.MD</a>.</p><p><strong>Option 3</strong>: Run from Docker (Preferred)</p><p>Docker is by far the easiest of all three installation methods and only requires one command to be run to get the client started. For this installation procedure, you will need docker installed.</p><p>For more information about this information procedure checkout the openvas-docker project on <a href=https://github.com/mikesplain/openvas-docker>GitHub</a> and <a href=https://hub.docker.com/r/mikesplain/openvas/dockerfile>DockerHub</a>.</p><ol><li><code>apt install docker.io</code></li><li><code>docker run -d -p 443:443 --name openvas mikesplain/openvas</code></li></ol><p>This command will both pull the docker container and then run the container. It may take a few minutes for the container to fully set up and begin running. Once it is complete you can then navigate to https://127.0.0.1 in your preferred browser and OpenVAS will be setup and ready to go!</p><p>Below are the default credentials to access OpenVAS/GVM:</p><blockquote><p><strong>Username: <code>admin</code>
Password: <code>admin</code></strong></p></blockquote><p>If you successfully logged into OpenVAS you should see a dashboard that looks similar to the one below.</p><p><img alt="openvas dashboard" loading=lazy src=https://i.imgur.com/a6WY4SW.png></p><h2 id=task-4-initial-configuration>Task 4: initial Configuration<a hidden class=anchor aria-hidden=true href=#task-4-initial-configuration>#</a></h2><p>Before we can start scanning and implementing OpenVAS into our vulnerability management solution we need to do a little bit of maintenance and configuration to get OpenVAS properly working. Luckily for us, OpenVAS makes the process very easy and includes a wizard to make the process straightforward.</p><p>Begin by navigating to Scans > Tasks and clicking on the purple magic wand icon to begin the basic configuration wizard. We recommend beginning a scan on <code>127.0.0.1</code> to test out your installation and ensure it is working properly.</p><p><img alt="openvas scan wizard" loading=lazy src=https://i.imgur.com/RbZNSC1.png></p><p>If you successfully navigated to the wizard you should see a pop-up similar to the one above. This is where you will set up your initial scan against your localhost to ensure everything is properly configured.</p><p>The scan may take a while to complete, allow OpenVAS enough time to finish the scan, and then you will be met with a new dashboard for monitoring and analyzing your complete and ongoing scans like the one below.
<img alt="scan result openvas" loading=lazy src=https://i.imgur.com/gMkDQww.png></p><p>Once your scan has finished you can navigate to Scans > Reports and click on your newly created report from your previous task.</p><p><img alt="openvas results" loading=lazy src=https://i.imgur.com/mxYWFJx.png></p><p>If correctly configured you should see three different vulnerabilities reported all originating from OpenVAS itself. This is normal behavior and can be configured/changed to maintain your OpSec.</p><h2 id=task-5-scanning-infra>TASK 5: Scanning Infra<a hidden class=anchor aria-hidden=true href=#task-5-scanning-infra>#</a></h2><p>Now that we know that everything is working we can get into the nitty-gritty of OpenVAS and how it works. Deploy the machine and navigate to Scans > Tasks to begin creating a task to scan the provided machine.</p><h3 id=creating-a-task>Creating a Task<a hidden class=anchor aria-hidden=true href=#creating-a-task>#</a></h3><p>To create a configurable task navigate to the star icon in the upper right-hand corner of the Tasks dashboard and select New Task.</p><p><img alt="creating task openvas" loading=lazy src=https://i.imgur.com/PNlNJuQ.png></p><p>Once you select New Task from the dropdown you will be met with a large pop-up with many options. We will break down each of the options sections and what they can be used for.</p><p><img alt="openvas task config" loading=lazy src=https://i.imgur.com/b8sKOYS.png></p><p>For this task, we will be focusing only on the Name, Scan Targets, and Scanner Type, and Scan Config. In later tasks, we will be focusing on the other options for more advanced configuration and implementation/automation.</p><ol><li>Name: Allows us to set the name the scan will be known as inside of OpenVAS</li><li>Scan Targets: The targets to scan, can include Hosts, Ports, and Credentials. To create a new target you will need to follow another pop-up, this will be covered later in this task.</li><li>Scanner: The scanner to use by default will use the OpenVAS architecture however you can set this to any scanner of your choosing in the settings menu.</li><li>Scan Config: OpenVAS has seven different scan types you can select from and will be used based on how you aggressive or what information you want to collect from your scan</li></ol><h3 id=scoping-a-new-target>Scoping a New Target<a hidden class=anchor aria-hidden=true href=#scoping-a-new-target>#</a></h3><p>To scope a new target, navigate to the star icon next to Scan Targets.</p><p><img alt="openvas scope" loading=lazy src=https://i.imgur.com/ro5xv85.png>
Above is the menu for configuring a new target. The two main options you will need to configure are the Name and the Hosts. This procedure is fairly straight forward and other options will only be used in advanced vulnerability management solutions. These will be covered in later tasks.
<img alt=dvwa loading=lazy src=https://i.imgur.com/9MHYq03.png></p><p>Now that we have our target scoped we can continue to create our task and begin the scan.</p><p>Once you create the task you will be brought back to the scan dashboard where you can monitor and start your task. To start the task navigate to the start icon under Actions.
<img alt="animesh roy " loading=lazy src=https://i.imgur.com/mYeVhVK.png>
<img alt="animesh roy blog post" loading=lazy src=https://i.imgur.com/0bYxIol.png></p><h2 id=task-6-reporting-and-continuous-monitoring>Task 6: Reporting and Continuous Monitoring<a hidden class=anchor aria-hidden=true href=#task-6-reporting-and-continuous-monitoring>#</a></h2><p>OpenVAS has very strong reporting and monitoring capabilities that can contribute to an efficient and optimal solution in your build or vulnerability management pipeline.</p><p>Download the provided report from a vulnerable machine to get familiar with the automated reporting capabilities of OpenVAS.</p><h3 id=breaking-down-the-report>Breaking Down the Report<a hidden class=anchor aria-hidden=true href=#breaking-down-the-report>#</a></h3><p>The automated report from OpenVAS begins with some basic host and task information including Host, Start, End, and Vulnerability categories. It will also check for host authentications and an overall summary of open ports on the host
<img loading=lazy src=https://i.imgur.com/V4VXU3t.png>
After the basic host and task information OpenVAS will report on each of the vulnerabilities found.
<img loading=lazy src=https://i.imgur.com/CUeOtgJ.png>
In the above image, the vulnerability breakdown can give a lot of information. We can gather a summary of the vulnerability, detection details, mitigation details, and method of detection.</p><h3 id=continuous-monitoring-overview>Continuous Monitoring Overview<a hidden class=anchor aria-hidden=true href=#continuous-monitoring-overview>#</a></h3><p>OpenVAS offers many options for continuous and scheduled monitoring/vulnerability management. If you work in a team or a pipeline this can allow you to efficiently and quickly optimize your current solutions. Examples of continuous vulnerability scanning utilities are Alerts, Schedules, and Agents. Agents are out of scope for this room but we will be covering the configuration of schedules and alerts below.</p><h3 id=creating-schedules>Creating Schedules<a hidden class=anchor aria-hidden=true href=#creating-schedules>#</a></h3><p>To begin creating a schedule navigate to Configuration > Schedules and as always click on the blue star icon in the upper left-hand corner. You should see a pop-up similar to the one below.</p><p><img loading=lazy src=https://i.imgur.com/bcNbfYj.png>
Fill out the basic information like Name, First Start Time, Period, etc. Once you have the schedule created you can now create a new Task/Scan with this created schedule attached. You can see this option below.
<img loading=lazy src=https://i.imgur.com/nitrmkz.png></p><h3 id=crafting-alerts>Crafting Alerts<a hidden class=anchor aria-hidden=true href=#crafting-alerts>#</a></h3><p>The process for creating alerts is very similar to creating a schedule, navigate to Configuration > Alerts and click on the blue star icon in the upper left-hand corner. You should see a pop-up similar to the one below.</p><p><img loading=lazy src=https://i.imgur.com/y3RNl1Y.png>
You will notice that there are a lot more options than the schedule menu, don&rsquo;t let this intimidate you, the process is very similar and straightforward. The main options you will need to worry about are Name, Event, Condition, and To Address. The event can be configured to alert based on the status of the scan or when a new NVT/vulnerability is detected. The condition option will make sure that your inbox isn&rsquo;t flooded with alerts, this can be changed based on severity or filters. The To Address is fairly self-explanatory and will send an email of the alert to the specified mail address. Once created you will again need to connect the alert to a new Task/Scan. You can see the specific option below.
<img loading=lazy src=https://i.imgur.com/Hqo9W71.png></p><hr><h2 id=task-7-practical-vulnerability-management>Task 7: Practical Vulnerability Management<a hidden class=anchor aria-hidden=true href=#task-7-practical-vulnerability-management>#</a></h2><h3 id=case-001-ms00-what>Case 001: MS00-What?<a hidden class=anchor aria-hidden=true href=#case-001-ms00-what>#</a></h3><p>In this scenario, you are assigned to a routine vulnerability management pipeline as a SOC analyst. Your automated pipeline has already pulled a scan on the server, it is up to you to analyze and identify risk in this report.</p><h2 id=flags>Flags<a hidden class=anchor aria-hidden=true href=#flags>#</a></h2><table><thead><tr><th>Questions</th><th>Flag</th></tr></thead><tbody><tr><td>When did the scan start in Case 001?</td><td><code>Feb 28, 00:04:46</code></td></tr><tr><td>When did the scan end in Case 001?</td><td><code>Feb 28, 00:21:02</code></td></tr><tr><td>How many ports are open in Case 001?</td><td><code>3</code></td></tr><tr><td>How many total vulnerabilities were found in Case 001?</td><td><code>5</code></td></tr><tr><td>What is the highest severity vulnerability found? (MSxx-xxx)</td><td><code>MS17-010</code></td></tr><tr><td>What is the first affected OS to this vulnerability?</td><td><code>Microsoft Windows 10 x32/x64 Edition</code></td></tr><tr><td>What is the recommended vulnerability detection method?</td><td><code>Send the crafted SMB transaction request with fid = 0 and check the response to confirm the vulnerability</code></td></tr></tbody></table><hr><hr><script type=text/javascript language=javascript>var aax_size="728x90",aax_pubname="anir0y-21",aax_src="302"</script><script type=text/javascript language=javascript src=https://c.amazon-adsystem.com/aax2/assoc.js></script></div><footer class=post-footer><ul class=post-tags><li><a href=https://classroom.anir0y.in/tags/notes/>Notes</a></li><li><a href=https://classroom.anir0y.in/tags/tryhackme/>Tryhackme</a></li><li><a href=https://classroom.anir0y.in/tags/rooms/>Rooms</a></li></ul><nav class=paginav><a class=prev href=https://classroom.anir0y.in/post/thm-room-osquery/><span class=title>« Prev</span><br><span>Try Hack Me Room Osquery</span>
</a><a class=next href=https://classroom.anir0y.in/post/thm-room-zerologon/><span class=title>Next »</span><br><span>Try Hack ME Room Zerologon</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Room Room Openvas on x" href="https://x.com/intent/tweet/?text=Try%20Hack%20Me%20Room%20Room%20Openvas&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-openvas%2f&amp;hashtags=notes%2ctryhackme%2crooms"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Room Room Openvas on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-openvas%2f&amp;title=Try%20Hack%20Me%20Room%20Room%20Openvas&amp;summary=Try%20Hack%20Me%20Room%20Room%20Openvas&amp;source=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-openvas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Room Room Openvas on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-openvas%2f&title=Try%20Hack%20Me%20Room%20Room%20Openvas"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Room Room Openvas on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-openvas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Room Room Openvas on whatsapp" href="https://api.whatsapp.com/send?text=Try%20Hack%20Me%20Room%20Room%20Openvas%20-%20https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-openvas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Room Room Openvas on telegram" href="https://telegram.me/share/url?text=Try%20Hack%20Me%20Room%20Room%20Openvas&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-openvas%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Room Room Openvas on ycombinator" href="https://news.ycombinator.com/submitlink?t=Try%20Hack%20Me%20Room%20Room%20Openvas&u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-openvas%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>YOU CAN REUSE MY CONTENT</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>