<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe Writeup REMnux - The Redux | Classroom</title><meta name=keywords content="tryhackme,rooms,thm"><meta name=description content="TryHackMe Room REMnux - The Redux solved by Animesh Roy. this is a walkthough. read more..."><meta name=author content="Animesh Roy"><link rel=canonical href=https://classroom.anir0y.in/post/thm-room-malremnuxv2/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=16x16 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=32x32 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=apple-touch-icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=mask-icon href=https://classroom.anir0y.in/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://classroom.anir0y.in/post/thm-room-malremnuxv2/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://classroom.anir0y.in/post/thm-room-malremnuxv2/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="TryHackMe Writeup REMnux - The Redux"><meta property="og:description" content="TryHackMe Room REMnux - The Redux solved by Animesh Roy. this is a walkthough. read more..."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-06-01T09:49:05+05:30"><meta property="article:modified_time" content="2021-06-01T09:49:05+05:30"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="article:tag" content="Thm"><meta property="og:image" content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:title content="TryHackMe Writeup REMnux - The Redux"><meta name=twitter:description content="TryHackMe Room REMnux - The Redux solved by Animesh Roy. this is a walkthough. read more..."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"TryHackMe Writeup REMnux - The Redux","item":"https://classroom.anir0y.in/post/thm-room-malremnuxv2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe Writeup REMnux - The Redux","name":"TryHackMe Writeup REMnux - The Redux","description":"TryHackMe Room REMnux - The Redux solved by Animesh Roy. this is a walkthough. read more...","keywords":["tryhackme","rooms","thm"],"articleBody":"REMnux - The Redux Profile Support Task 01: introduction Welcome to the redux of REMnux.\nSince the release of the previous REMnux room, REMnux has had substantial changes, rendering the previous room outdated and impossible to complete.\nI have taken the opportunity to recreate the room covering REMnux from scratch, taking a very different approach to ensure you get to use all the facilities that make REMnux unique.\nHow Have I Designed This Room Differently?\nI‚Äôve now re-designed the content for this room to get you as hands-on with REMnux and its tools as possible‚Ä¶gone are the days of reading cheatsheets for tasks; it‚Äôs time for you to get stuck in and see what REMnux is really about. This room isn‚Äôt designed with point-farming in mind, instead, I hope to give you enough guidance throughout the room that results in you developing a curiosity in exploring the topics \u0026 resources I introduce you to in your own time.\nYou will be doing the following:\nIdentifying and analysing malicious payloads of various formats embedded in PDF‚Äôs, EXE‚Äôs and Microsoft Office Macros (the most common method that malware developers use to spread malware today) Learning how to identify obfuscated code and packed files - and in turn - analyse these. Analysing the memory dump of a PC that became infected with the Jigsaw ransomware in the real-world using Volatility. I have attached some useful material about some of the topics covered in the room, alongside some cheatsheets and related articles that you can browse at your leisure at the end of the room.\nTask 02: 2. Deploy Nothing to do here\nTask 03: Analysing Malicious PDF‚Äôs A Blast From the Past\nWe‚Äôre back at this old chestnut, analysing malicious PDF files. In the previous room, you were analysing a PDF file for potential javascript code. PDF‚Äôs are capable of containing many more types of code that can be executed without the user‚Äôs knowledge. This includes:\nJavascript python Executables Powershell Executables Not only will this task be covering Javascript embeds (like we did previously), but also analysing embedded executables.\nLooking for Embedded Javascript\nWe previously discussed how easily javascript can be embedded into a PDF file, whereupon opening is executed unbeknownst to the user. Javascript, much like other languages that we come on to discover in Task 4, provide a great way of creating a foothold, where additional malware can be downloaded and executed.\nLooks like the Cooctus Clan just wanted to say hey - it‚Äôs a good thing that they‚Äôre nice people!\nPractical\nWe‚Äôll be using peepdfto begin a precursory analysis of a PDF file to determine the presence of Javascript. If there is, we will extract this Javascript code (without executing it) for our inspection.\nWe can simply do peepdf demo_notsuspicious.pdf:\nNote the output confirming that there‚Äôs Javascript present, but also how it is executed? OpenAction will execute the code when the PDF is launched.\nTo extract this Javascript, we can use peepdf‚Äôs ‚Äúextract‚Äù module. This requires a few steps to set up but is fairly trivial.\nThe following command will create a script file for peepdf to use\necho 'extract js \u003e javascript-from-demo_notsuspicious.pdf' \u003e extracted_javascript.txt The script will extract all javascript via extract js and pipe \u003e the contents into ‚Äújavascript-from-demo_notsuspicious.pdf‚Äù We now need to tell peepdf the name of the script (extracted_javascript.txt) and the PDF file that we want to extract from (demo_notsuspicious.pdf):\npeepdf -s extracted_javascript.txt demo_notsuspicious.pdf Remembering that the Javascript will output into a file called ‚Äújavascript-from-demo_nonsuspicious.pdf‚Äù because of our script.\nTo recap: ‚Äúextracted_javascript.txt‚Äù (highlighted in red) is our script, where ‚Äúdemo_notsuspicious.pdf‚Äù (highlighted in green) is the original PDF file that we think is malicious. You will see an output, in this case, a file named ‚Äújavascript-from-demo_notsuspicious‚Äù (highlighted in yellow). This file now contains our extracted Javascript, we can simply cat this to see the contents. As it turns out, the PDF file we have analysed contains the javascript code of app.alert(\"All your Cooctus are belong to us!\")\nPractical\nWe have used peepdf to:\nLook for the presence of Javascript Extract any contained Javascript for us to read without it being executed. The commands to do so have been used above, you may have to implement them differently, proceed to answer questions 1 - 4 before moving onto the next section\nExecutables\nOf course not only can Javascript be embedded, by executables can be very much too.\nThe ‚Äúadvert.pdf‚Äù actually has an embedded executable. Looking at the extracted Javascript, we can see the following Javascript snippet:\nThis tells us that when the PDF is opened, the user will be asked to save an attachment:\nAlthough PDF attachments can be ZIP files or images, in this case, it is another PDF‚Ä¶Or is it? Well, let‚Äôs save the file and see what happens. Uh oh‚Ä¶At least that we get a warning that something is trying to execute, but hey, Karen from HR wouldn‚Äôt send you a dodgy email, right? It‚Äôs probably a false alarm.\nAh‚Ä¶Well, turns out it was. We just got a reverse shell from the Windows PC to my attack machine.\nIt‚Äôs now obvious (albeit too late for them) that the ‚Äúpdf‚Äù that gets saved isn‚Äôt a PDF. Let‚Äôs open it up in a hex editor.\nWell well well, looks like we have an executable. Let‚Äôs investigate further by looking at the strings.\nIt looks like we have our attacker‚Äôs IP and port!\nFlag-3.1 How many types of categories of ‚ÄúSuspicious elements‚Äù are there in ‚Äúnotsuspicious.pdf‚Äù\n3 Flag-3.2 Use peepdf to extract the javascript from ‚Äúnotsuspicious.pdf‚Äù. What is the flag?\nFlag-3.3 How many types of categories of ‚ÄúSuspicious elements‚Äù are there in ‚Äúadvert.pdf‚Äù\nrun this peepdf advert.pdf Flag-3.4 Now use peepdf to extract the javascript from ‚Äúadvert.pdf‚Äù. What is the value of ‚ÄúcName‚Äù?\nTask 04: Analysing Malicious Microsoft Office Macros The Change in Focus from APT‚Äôs\nMalware infection via malicious macros (or scripts within Microsoft Office products such as Word and Excel) are some of the most successful attacks to date.\nFor example, current APT campaigns such as Emotet, QuickBot infect users by sending seemingly legitimate documents attached to emails i.e. an invoice for business. However, once opened, execute malicious code without the user knowing. This malicious code is often used in what‚Äôs known as a ‚Äúdropper attack‚Äù, where additional malicious programs are downloaded onto the host.\nTake the document file below as an example: Looks perfectly okay, right? Well in actual fact, this word document has just downloaded a ransomware file from a malicious IP address in the background, with not much more than this snippet of code:\nI have programmed the script to show a pop-up for demonstration purposes. However, in real life, this would be done without any popup.\nLuckily for me, this EXE is safe. Unfortunately in the real-world, this EXE could start encrypting my files.\nThankfully Anti-Viruses these days are pretty reliable on picking up that sort of activity when it is left in plaintext. The following example uses two-stages to execute an obfuscated payload code.\nThe macro starts once edit permissions (‚ÄúEnable Edit‚Äù or ‚ÄúEnable Content‚Äù)have enabled edit mode on the Word document The macro executes the payload stored in the text within the document. The downside to this? You need a large amount of text to be contained within the page, users will be suspicious and not proceed with editing the document.\nAlthough, just put on your steganography hat‚Ä¶Authors can just remove the borders from the text box and make the text white. The macro doesn‚Äôt need the text to be visible to the user, it just needs to exist on the page.\nSee? Not so suspicious now.\nPractical\nFirst, we will analyse a suspicious Microsoft Office Word document together. We can simply use REMnux‚Äôs vmonkey which is a parser engine that is capable of analysing visual basic macros without executing (opening the document).\nBy using vmonkey DefinitelyALegitInvoice.doc. vmonkey has detected potentially malicious visual basic code within a macro.\nNow it‚Äôs your turn, analyse the two Microsoft Office document‚Äôs (.doc) files located within ‚Äú/home/remnux/Tasks/4‚Äù to answer the questions attached to this task.\nFLag-4.1 What is the name of the Macro for ‚ÄúDefinitelyALegitInvoice.doc‚Äù\nFLag-4.2 What is the URL the Macro in ‚ÄúTaxes2020.doc‚Äù would try to launch?\nTask 05: I Hope You Packed Your But first: Entropy 101\nThere‚Äôs a reason why I‚Äôve waited until now to discuss file entropy in the malware series.\nREMnux provides a nice range of command-line tools that allow for bulk or semi-automated classification and static analysis. File entropy is very indicative of the suspiciousness of a file and is a prominent characteristic that these tools look for within a Portable Executable (PE).\nAt it‚Äôs very simplest, file entropy is a rating that scores how random the data within a PE file is. With a scale of 0 to 8. 0 meaning the less ‚Äúrandomness‚Äù of the data in the file, where a scoring towards 8 indicates this data is more ‚Äúrandom‚Äù.\nFor example, files that are encrypted will have a very high entropy score. Where files that have large chunks of the same data such as ‚Äú1‚Äôs‚Äù will have a low entropy score\nOkay‚Ä¶so?\nMalware authors use techniques such as encryption or packing (we‚Äôll come onto this next) to obfuscate their code and to attempt to bypass anti-virus. Because of this, these files will have high entropy. If an analyst had 1,000 files, they could rank the files by their entropy scoring, of course, the files with the higher entropy should be analysed first.\nWhereas however, this file would have a high entropy because there‚Äôs no pattern to the data - it‚Äôs a lot more random in comparison.\nPacking and Unpacking\nWe‚Äôll start with a bit of theory (so bare with me here) on how packing works and why it‚Äôs used. Packer‚Äôs use an executable as a source and output‚Äôs it to another executable. This executable will have had some modifications made depending on the packer. For example, the new executable could be compressed and/or obfuscated by using mathematics.\nLegitimate software developers use packing to reduce the size of their applications and to ultimately protect their work from being stolen. It is, however, a double-edged sword, malware authors reap the benefits of packing to make the reverse engineering and detection of the code hard to impossible.\nExecutables have what‚Äôs called an entry point. When launched, this entry point is simply the location of the first pieces of code to be executed within the file - as illustrated below:\n(Sikorski and Honig, 2012)\nWhen an executable is packed, it must unpack itself before any code can execute. Because of this, packers change the entry point from the original location to what‚Äôs called the ‚ÄúUnpacking Stub‚Äù.\n(Sikorski and Honig, 2012)\nThe ‚ÄúUnpacking Stub‚Äù will begin to unpack the executable into its original state. Once the program is fully unpacked, the entry point will now relocate back to its normal place to begin executing code\n(Sikorski and Honig, 2012)\nIt is only at this point can an analyst begin to understand what the executable is doing as it is now in it‚Äôs true, original form.\nDetermining if an Executable is Packed\nDon‚Äôt worry, learning how to manually unpack an executable is out-of-scope for this pathway. We have a few tools at our arsenal that should do a sufficient job for most of the samples we come across in the wild.\nPacked files have a few characteristics that may indicate whether or not they are packed:\nRemember about file entropy? Packed files will have a high entropy! There are very few ‚ÄúImports‚Äù, packed files may only have ‚ÄúGetProcAddress‚Äù and ‚ÄúLoadLibrary‚Äù. The executable may have sections named after certain packers such as UPX. Demonstration\nI have two copies of my application, one not packed and another has been packed.\nBelow we can see that this copy has 34 imports, so a noticeable amount and the imports are quite revealing in what we can expect the application to do:\nWhereas the other copy only presents us with 6 imports.\nWe can verify that this was packed using UPX via tools such as PEID, or by manually comparing the executables sections and filesize differences.\nLook at that entropy! 7.526 out of 8! Also, note the name of the sections. UPX0 and the entry point being at UPX1‚Ä¶that‚Äôs our packer.\nFlag-5 task 06: How‚Äôs Your Memory? If you‚Äôve had enough of hearing about entropy and packing - I don‚Äôt blame you, me too.\nMemory Forensics\nYou are going to be analysing the memory dump I‚Äôve taken of a Windows 7 PC that has been infected with the Jigsaw Ransomware. This memory dump can be found in ‚Äú/home/remnux/Tasks/6/Win7-Jigsaw.raw‚Äù.\nA Volatility Crash Course Understanding our Memory Dump\nIt goes without saying that every operating system will store data in different places, and this is no different when data is stored within memory. Volatility is unable to assume what the operating system that we have created a memory dump is, and in turn, where to look for things and what commands can be executed. For example, hivelist is used for Windows registry and will not work on a Linux memory dump.\nWhilst Volatility can‚Äôt assume, it can guess. Here‚Äôs where profiles come into play. In other scenarios, we would use the imageinfo plugin to help determine what profile is most suitable with the syntax of volatility -f Win7-Jigsaw.raw imageinfo. However, this could take hours to complete on a large memory dump on an Instance like that attached to the room. So instead, I have provided it for you.\nPlease note that volatility will take a few minutes for commands to complete.\nProfile Win7SP1x64 is the first suggested and just happens to be the correct OS version.\nBeginning our Investigation\nViewing What Processes Were Running at Infection\n‚ÄúA process, in the simplest terms, is an executing program.‚Äù (Processes and Threads - Win32 apps, 2018)\nProcesses range from every-day applications such as your browser to system services and other inner-workings.\nSpecifically, we need to identify the malicious processes to get an understanding of how the malware works and to also build a picture of Indicators of Compromise (IoC). We can list the processes that were running via pslist:\nvolatility -f Win7-Jigsaw.raw --profile=Win7SP1x64 pslist\nNote how you can see Google Chrome within the process because the application was running at the time of the memory dump.\nNeedles in Haystacks\nLuckily we‚Äôve got quite a shortlist of processes here, so we can start to narrow down between the system processes and any applications.\nIt can be daunting at first in trying to decide on what‚Äôs worthy of investigating. As your seat time in malware analysis increases, you‚Äôll be able to pick out abnormalities. In this case, it‚Äôs process ‚Äúdrpbx.exe‚Äù with a PID of 3704.\nWhat Can We Do With This?\nNow that we‚Äôve identified the abnormal process, we can begin to dump this specifically and begin analysing. As the application will be unpacked and/or in it‚Äôs most revealing state, it is perfect for analysis.\nPeeking Behind the Curtain\nEven without analysing, we can start to understand what sort of interaction the process is capable of with the operating system. DLL‚Äôs are structured very similarly to executables, however, they cannot be directly executed. Moreover, multiple applications can interact with a DLL all at the same time. We can list the DLL‚Äôs that ‚Äúdrpbx.exe‚Äù references with dlllist:\nAll the DLL‚ÄôS\nAgain, it‚Äôs easy to become overwhelmed at trying to figure out what‚Äôs of significance. It only comes with time, experience and research into what Windows DLL‚Äôs do what.\nWhat stands out initially is the ‚ÄúCRYPTBASE.dll‚Äù\nThis DLL is a Windows library that allows applications to use cryptography. Whilst many use it legitimately, i.e. HTTPS, let‚Äôs assume that we didn‚Äôt know that the host was infected with ransomware specifically, we‚Äôd need to start investigating the process further. However, that is not for here. We‚Äôve found enough evidence to suspect ransomware through memory forensics \u0026 research.\nFlag-6: N\\A Task 07: Finishing Up I encourage you to go back through the tasks and use alternate tools to that which I used, all located within the attached REMnux box. Malicious macros within Microsoft Office documents are very successful and dangerous vehicles for malware authors to weaponise. Whilst macros have legitimate purposes in MS Office documents, rampant APT campaigns such as Emotet, Ryuk and Qakbot exploit these as droppers.\nFor a bonus challenge, spend some more time in getting familiar with Volatility. Are there any more additional indicators of compromise within the Windows 7 memory dump that we briefly analyzed?\nFlag-7: N\\A Task 08: References \u0026 Further Reading Material References\nTask 1\nZeltser Security Corp., 2020. REMnux (image) Retrieved from: https://remnux.org/\nTask 5\nSikorski, M. and Honig, A., 2012. Practical Malware Analysis. San Francisco: No Starch Press, pp.386-387.\nTask 6\nDocs.microsoft.com. 2018. Processes And Threads - Win32 Apps. Retrieved from: https://docs.microsoft.com/en-us/windows/win32/procthread/processes-and-threads\nAdditional Reading\nA Look At Entropy Analysis\n[BlackHat 2019] Investigating Malware Using Memory Forensics (Video)\nMalware Threat Report - Q2 2020 (Avira)\nMalware Detection in PDF and Office Documents: A survey\nCheatsheets\nREMnux 7.0 Documentation\nVolatility 2.4. Windows \u0026 Linux Profile Cheatsheets\n","wordCount":"2844","inLanguage":"en","image":"https://classroom.anir0y.in/img/thm.gif","datePublished":"2021-06-01T09:49:05+05:30","dateModified":"2021-06-01T09:49:05+05:30","author":{"@type":"Person","name":"Animesh Roy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/thm-room-malremnuxv2/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https://classroom.anir0y.in/img/avatar.jpeg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://classroom.anir0y.in/ accesskey=h title="Classroom (Alt + H)"><img src=https://classroom.anir0y.in/img/avatar.jpeg alt aria-label=logo height=35>Classroom</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://classroom.anir0y.in/post/ title=Posts><span>Posts</span></a></li><li><a href=https://classroom.anir0y.in/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://classroom.anir0y.in/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://classroom.anir0y.in/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://classroom.anir0y.in/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://classroom.anir0y.in/about/me/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://classroom.anir0y.in/>Home</a>&nbsp;¬ª&nbsp;<a href=https://classroom.anir0y.in/post/>Posts</a></div><h1 class="post-title entry-hint-parent">TryHackMe Writeup REMnux - The Redux</h1><div class=post-description>TryHackMe Room REMnux - The Redux solved by Animesh Roy. this is a walkthough. read more...</div><div class=post-meta><span title='2021-06-01 09:49:05 +0530 IST'>June 1, 2021</span>&nbsp;¬∑&nbsp;<span>14 min</span>&nbsp;¬∑&nbsp;<span>Animesh Roy</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/anir0y/classroom/tree/master/content/post/thm-room-malremnuxv2.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><figure class=entry-cover><img loading=eager src=https://classroom.anir0y.in/img/thm.gif alt="cover image"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#task-01-introduction>Task 01: introduction</a></li><li><a href=#task-02-2-deploy>Task 02: 2. Deploy</a></li><li><a href=#task-03-analysing-malicious-pdfs>Task 03: Analysing Malicious PDF&rsquo;s</a><ul><li><a href=#flag-31>Flag-3.1</a></li><li><a href=#flag-32>Flag-3.2</a></li><li><a href=#flag-33>Flag-3.3</a></li><li><a href=#flag-34>Flag-3.4</a></li></ul></li><li><a href=#task-04-analysing-malicious-microsoft-office-macros>Task 04: Analysing Malicious Microsoft Office Macros</a><ul><li><a href=#flag-41>FLag-4.1</a></li><li><a href=#flag-42>FLag-4.2</a></li></ul></li><li><a href=#task-05-i-hope-you-packed-your>Task 05: I Hope You Packed Your</a><ul><li><a href=#flag-5>Flag-5</a></li></ul></li><li><a href=#task-06-hows-your-memory>task 06: How&rsquo;s Your Memory?</a><ul><li><a href=#flag-6--na>Flag-6: <code>N\A</code></a></li></ul></li><li><a href=#task-07-finishing-up>Task 07: Finishing Up</a><ul><li><a href=#flag-7-na>Flag-7: <code>N\A</code></a></li></ul></li><li><a href=#task-08-references--further-reading-material>Task 08: References & Further Reading Material</a></li></ul></nav></div></details></div><div class=post-content><h1 id=remnux---the-redux>REMnux - The Redux<a hidden class=anchor aria-hidden=true href=#remnux---the-redux>#</a></h1><table><thead><tr><th style=text-align:left>Profile</th><th style=text-align:right>Support</th></tr></thead><tbody><tr><td style=text-align:left><script src=https://tryhackme.com/badge/434937></script></td><td style=text-align:right><a href=https://www.buymeacoffee.com/anir0y><img src="https://img.buymeacoffee.com/button-api/?text=Cheers!!!&emoji=üç∫&slug=anir0y&button_colour=BD5FFF&font_colour=ffffff&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00"></a></td></tr></tbody></table><script type=text/javascript language=javascript>var aax_size="300x250",aax_pubname="anir0y-21",aax_src="302"</script><script type=text/javascript language=javascript src=https://c.amazon-adsystem.com/aax2/assoc.js></script><hr><h2 id=task-01-introduction>Task 01: introduction<a hidden class=anchor aria-hidden=true href=#task-01-introduction>#</a></h2><p><strong>Welcome to the redux of REMnux.</strong></p><p>Since the release of the previous REMnux room, REMnux has had substantial changes, rendering the previous room outdated and impossible to complete.</p><p>I have taken the opportunity to recreate the room covering REMnux from scratch, taking a very different approach to ensure you get to use all the facilities that make REMnux unique.</p><p><strong>How Have I Designed This Room Differently?</strong></p><p>I&rsquo;ve now re-designed the content for this room to get you as hands-on with REMnux and its tools as possible&mldr;gone are the days of reading cheatsheets for tasks; it&rsquo;s time for you to get stuck in and see what REMnux is really about. This room isn&rsquo;t designed with point-farming in mind, instead, I hope to give you enough guidance throughout the room that results in you developing a curiosity in exploring the topics & resources I introduce you to in your own time.</p><p>You will be doing the following:</p><ul><li>Identifying and analysing malicious payloads of various formats embedded in PDF&rsquo;s, EXE&rsquo;s and Microsoft Office Macros (the most common method that malware developers use to spread malware today)</li><li>Learning how to identify obfuscated code and packed files - and in turn - analyse these.</li><li>Analysing the memory dump of a PC that became infected with the Jigsaw ransomware in the real-world using Volatility.</li></ul><p>I have attached some useful material about some of the topics covered in the room, alongside some cheatsheets and related articles that you can browse at your leisure at the end of the room.</p><hr><h2 id=task-02-2-deploy>Task 02: 2. Deploy<a hidden class=anchor aria-hidden=true href=#task-02-2-deploy>#</a></h2><p>Nothing to do here</p><p><img loading=lazy src=https://media.tenor.com/images/785f74ac0466d62e60c051a6ea108242/tenor.gif></p><hr><h2 id=task-03-analysing-malicious-pdfs>Task 03: Analysing Malicious PDF&rsquo;s<a hidden class=anchor aria-hidden=true href=#task-03-analysing-malicious-pdfs>#</a></h2><p><strong>A Blast From the Past</strong></p><p>We&rsquo;re back at this old chestnut, analysing malicious PDF files. In the previous room, you were analysing a PDF file for potential javascript code. PDF&rsquo;s are capable of containing many more types of code that can be executed without the user&rsquo;s knowledge. This includes:</p><ul><li>Javascript</li><li>python</li><li>Executables</li><li>Powershell Executables</li></ul><p>Not only will this task be covering Javascript embeds (like we did previously), but also analysing embedded executables.</p><p><strong>Looking for Embedded Javascript</strong></p><p>We previously discussed how easily javascript can be embedded into a PDF file, whereupon opening is executed unbeknownst to the user. Javascript, much like other languages that we come on to discover in Task 4, provide a great way of creating a foothold, where additional malware can be downloaded and executed.</p><p><img loading=lazy src=https://i.imgur.com/16r4ZtR.png></p><p>Looks like the Cooctus Clan just wanted to say hey - it&rsquo;s a good thing that they&rsquo;re nice people!</p><p><strong>Practical</strong></p><p>We&rsquo;ll be using <code>peepdfto</code> begin a precursory analysis of a PDF file to determine the presence of Javascript. If there is, we will extract this Javascript code (without executing it) for our inspection.</p><p>We can simply do <code>peepdf demo_notsuspicious.pdf</code>:</p><p><img loading=lazy src=https://i.imgur.com/yBhDeYi.png></p><p>Note the output confirming that there&rsquo;s Javascript present, but also how it is executed? OpenAction will execute the code when the PDF is launched.</p><p>To extract this Javascript, we can use <code>peepdf</code>&rsquo;s &ldquo;extract&rdquo; module. This requires a few steps to set up but is fairly trivial.</p><p>The following command will create a script file for <code>peepdf</code> to use</p><ol><li><p><code>echo 'extract js > javascript-from-demo_notsuspicious.pdf' > extracted_javascript.txt</code>
<img loading=lazy src=https://i.imgur.com/hYUwXuu.png></p><p>The script will extract all javascript via <code>extract js</code> and pipe <code>></code> the contents into &ldquo;javascript-from-demo_notsuspicious.pdf&rdquo;
We now need to tell <code>peepdf</code> the name of the script (extracted_javascript.txt) and the PDF file that we want to extract from (demo_notsuspicious.pdf):</p></li><li><p><code>peepdf -s extracted_javascript.txt demo_notsuspicious.pdf</code>
Remembering that the Javascript will output into a file called &ldquo;javascript-from-demo_nonsuspicious.pdf&rdquo; because of our script.</p></li></ol><p>To recap: &ldquo;extracted_javascript.txt&rdquo; (highlighted in red) is our script, where &ldquo;demo_notsuspicious.pdf&rdquo; (highlighted in green) is the original PDF file that we think is malicious.
<img loading=lazy src=https://i.imgur.com/0q0dt9I.png>
You will see an output, in this case, a file named &ldquo;javascript-from-demo_notsuspicious&rdquo; (highlighted in yellow). This file now contains our extracted Javascript, we can simply <code>cat</code> this to see the contents.
<img loading=lazy src=https://i.imgur.com/zSLNeKV.png></p><p>As it turns out, the PDF file we have analysed contains the javascript code of <code>app.alert("All your Cooctus are belong to us!")</code></p><p><strong>Practical</strong></p><p>We have used peepdf to:</p><ol><li>Look for the presence of Javascript</li><li>Extract any contained Javascript for us to read without it being executed.</li></ol><p><img loading=lazy src=https://i.imgur.com/gI35CYV.png></p><p>The commands to do so have been used above, you may have to implement them differently, proceed to answer questions 1 - 4 before moving onto the next section</p><p><strong>Executables</strong></p><p>Of course not only can Javascript be embedded, by executables can be very much too.</p><p>The &ldquo;advert.pdf&rdquo; actually has an embedded executable. Looking at the extracted Javascript, we can see the following Javascript snippet:</p><p><img loading=lazy src=https://i.imgur.com/HkaEbdF.png></p><p>This tells us that when the PDF is opened, the user will be asked to save an attachment:</p><p><img loading=lazy src=https://i.imgur.com/2ABomDi.png></p><p>Although PDF attachments can be ZIP files or images, in this case, it is another PDF&mldr;Or is it? Well, let&rsquo;s save the file and see what happens. Uh oh&mldr;At least that we get a warning that something is trying to execute, but hey, Karen from HR wouldn&rsquo;t send you a dodgy email, right? It&rsquo;s probably a false alarm.</p><p><img loading=lazy src=https://i.imgur.com/daoeGoL.png></p><p>Ah&mldr;Well, turns out it was. We just got a reverse shell from the Windows PC to my attack machine.</p><p><img loading=lazy src=https://i.imgur.com/o9mP0CA.png></p><p>It&rsquo;s now obvious (albeit too late for them) that the &ldquo;pdf&rdquo; that gets saved isn&rsquo;t a PDF. Let&rsquo;s open it up in a hex editor.</p><p><img loading=lazy src=https://i.imgur.com/CSypGSC.png></p><p>Well well well, looks like we have an executable. Let&rsquo;s investigate further by looking at the strings.</p><p><img loading=lazy src=https://i.imgur.com/lVmoupA.png></p><p>It looks like we have our attacker&rsquo;s IP and port!</p><p><img loading=lazy src=https://i.imgur.com/wthxQE3.png></p><h3 id=flag-31>Flag-3.1<a hidden class=anchor aria-hidden=true href=#flag-31>#</a></h3><blockquote><p>How many types of categories of &ldquo;Suspicious elements&rdquo; are there in &ldquo;notsuspicious.pdf&rdquo;</p><p><code>3</code>
<img loading=lazy src=https://i.imgur.com/AsEMzbp.png></p></blockquote><h3 id=flag-32>Flag-3.2<a hidden class=anchor aria-hidden=true href=#flag-32>#</a></h3><blockquote><p>Use peepdf to extract the javascript from &ldquo;notsuspicious.pdf&rdquo;. What is the flag?</p></blockquote><p><img loading=lazy src=https://i.imgur.com/vfecjOD.png></p><h3 id=flag-33>Flag-3.3<a hidden class=anchor aria-hidden=true href=#flag-33>#</a></h3><blockquote><p>How many types of categories of &ldquo;Suspicious elements&rdquo; are there in &ldquo;advert.pdf&rdquo;</p></blockquote><p>run this <code>peepdf advert.pdf</code>
<img loading=lazy src=https://i.imgur.com/H5Mk3Zi.png></p><h3 id=flag-34>Flag-3.4<a hidden class=anchor aria-hidden=true href=#flag-34>#</a></h3><blockquote><p>Now use peepdf to extract the javascript from &ldquo;advert.pdf&rdquo;. What is the value of &ldquo;cName&rdquo;?</p></blockquote><p><img loading=lazy src=https://i.imgur.com/DR6Q6cX.png></p><hr><h2 id=task-04-analysing-malicious-microsoft-office-macros>Task 04: Analysing Malicious Microsoft Office Macros<a hidden class=anchor aria-hidden=true href=#task-04-analysing-malicious-microsoft-office-macros>#</a></h2><p><strong>The Change in Focus from APT&rsquo;s</strong></p><p>Malware infection via malicious macros (or scripts within Microsoft Office products such as Word and Excel) are some of the most successful attacks to date.</p><p>For example, current APT campaigns such as Emotet, QuickBot infect users by sending seemingly legitimate documents attached to emails i.e. an invoice for business. However, once opened, execute malicious code without the user knowing. This malicious code is often used in what&rsquo;s known as a &ldquo;dropper attack&rdquo;, where additional malicious programs are downloaded onto the host.</p><p>Take the document file below as an example:<br><img loading=lazy src=https://i.imgur.com/ciosaCD.png></p><p>Looks perfectly okay, right? Well in actual fact, this word document has just downloaded a ransomware file from a malicious IP address in the background, with not much more than this snippet of code:</p><p><img loading=lazy src=https://i.imgur.com/DQxSeHt.png></p><p>I have programmed the script to show a pop-up for demonstration purposes. However, in real life, this would be done without any popup.</p><p><img loading=lazy src=https://i.imgur.com/SVT0kOZ.png></p><p>Luckily for me, this EXE is safe. Unfortunately in the real-world, this EXE could start encrypting my files.</p><p>Thankfully Anti-Viruses these days are pretty reliable on picking up that sort of activity when it is left in plaintext. The following example uses two-stages to execute an obfuscated payload code.</p><ol><li>The macro starts once edit permissions (&ldquo;Enable Edit&rdquo; or &ldquo;Enable Content&rdquo;)have enabled edit mode on the Word document</li><li>The macro executes the payload stored in the text within the document.</li></ol><p>The downside to this? You need a large amount of text to be contained within the page, users will be suspicious and not proceed with editing the document.</p><p><img loading=lazy src=https://i.imgur.com/5Td2ywE.png></p><p>Although, just put on your steganography hat&mldr;Authors can just remove the borders from the text box and make the text white. The macro doesn&rsquo;t need the text to be visible to the user, it just needs to exist on the page.</p><p><img loading=lazy src=https://i.imgur.com/DMhsuTd.png></p><p>See? Not so suspicious now.</p><p><strong>Practical</strong></p><p>First, we will analyse a suspicious Microsoft Office Word document together. We can simply use REMnux&rsquo;s <code>vmonkey</code> which is a parser engine that is capable of analysing visual basic macros without executing (opening the document).</p><p>By using <code>vmonkey DefinitelyALegitInvoice.doc</code>. vmonkey has detected potentially malicious visual basic code within a macro.</p><p><img loading=lazy src=https://i.imgur.com/jooSji9.png></p><p>Now it&rsquo;s your turn, analyse the two Microsoft Office document&rsquo;s (.doc) files located within &ldquo;/home/remnux/Tasks/4&rdquo; to answer the questions attached to this task.</p><h3 id=flag-41>FLag-4.1<a hidden class=anchor aria-hidden=true href=#flag-41>#</a></h3><blockquote><p>What is the name of the Macro for &ldquo;DefinitelyALegitInvoice.doc&rdquo;</p></blockquote><p><img loading=lazy src=https://i.imgur.com/kg7OPYT.png></p><h3 id=flag-42>FLag-4.2<a hidden class=anchor aria-hidden=true href=#flag-42>#</a></h3><blockquote><p>What is the URL the Macro in &ldquo;Taxes2020.doc&rdquo; would try to launch?</p></blockquote><p><img loading=lazy src=https://i.imgur.com/d3eIk2i.png></p><hr><h2 id=task-05-i-hope-you-packed-your>Task 05: I Hope You Packed Your<a hidden class=anchor aria-hidden=true href=#task-05-i-hope-you-packed-your>#</a></h2><p><strong>But first: Entropy 101</strong></p><p>There&rsquo;s a reason why I&rsquo;ve waited until now to discuss file entropy in the malware series.</p><p>REMnux provides a nice range of command-line tools that allow for bulk or semi-automated classification and static analysis. File entropy is very indicative of the suspiciousness of a file and is a prominent characteristic that these tools look for within a Portable Executable (PE).</p><p>At it&rsquo;s very simplest, file entropy is a rating that scores how random the data within a PE file is. With a scale of 0 to 8. 0 meaning the less &ldquo;randomness&rdquo; of the data in the file, where a scoring towards 8 indicates this data is more &ldquo;random&rdquo;.</p><p>For example, files that are encrypted will have a very high entropy score. Where files that have large chunks of the same data such as &ldquo;1&rsquo;s&rdquo; will have a low entropy score</p><p><strong>Okay&mldr;so?</strong></p><p>Malware authors use techniques such as encryption or packing (we&rsquo;ll come onto this next) to obfuscate their code and to attempt to bypass anti-virus. Because of this, these files will have high entropy. If an analyst had 1,000 files, they could rank the files by their entropy scoring, of course, the files with the higher entropy should be analysed first.</p><p><img loading=lazy src=https://i.imgur.com/4lgx8FM.png></p><p>Whereas however, this file would have a high entropy because there&rsquo;s no pattern to the data - it&rsquo;s a lot more random in comparison.</p><p><img loading=lazy src=https://i.imgur.com/kX0JcNy.png></p><p><strong>Packing and Unpacking</strong></p><p>We&rsquo;ll start with a bit of theory (so bare with me here) on how packing works and why it&rsquo;s used. Packer&rsquo;s use an executable as a source and output&rsquo;s it to another executable. This executable will have had some modifications made depending on the packer. For example, the new executable could be compressed and/or obfuscated by using mathematics.</p><p>Legitimate software developers use packing to reduce the size of their applications and to ultimately protect their work from being stolen. It is, however, a double-edged sword, malware authors reap the benefits of packing to make the reverse engineering and detection of the code hard to impossible.</p><p>Executables have what&rsquo;s called an entry point. When launched, this entry point is simply the location of the first pieces of code to be executed within the file - as illustrated below:</p><p><img loading=lazy src=https://i.imgur.com/gZgqg2n.png>
(Sikorski and Honig, 2012)</p><p>When an executable is packed, it must unpack itself before any code can execute. Because of this, packers change the entry point from the original location to what&rsquo;s called the &ldquo;Unpacking Stub&rdquo;.<br><img loading=lazy src=https://i.imgur.com/zKEDArl.png>
(Sikorski and Honig, 2012)</p><p>The &ldquo;Unpacking Stub&rdquo; will begin to unpack the executable into its original state. Once the program is fully unpacked, the entry point will now relocate back to its normal place to begin executing code</p><p><img loading=lazy src=https://i.imgur.com/o3dRrTh.png>
(Sikorski and Honig, 2012)</p><p>It is only at this point can an analyst begin to understand what the executable is doing as it is now in it&rsquo;s true, original form.</p><p><strong>Determining if an Executable is Packed</strong></p><p>Don&rsquo;t worry, learning how to manually unpack an executable is out-of-scope for this pathway. We have a few tools at our arsenal that should do a sufficient job for most of the samples we come across in the wild.</p><p>Packed files have a few characteristics that may indicate whether or not they are packed:</p><ul><li>Remember about file entropy? Packed files will have a high entropy!</li><li>There are very few &ldquo;Imports&rdquo;, packed files may only have &ldquo;GetProcAddress&rdquo; and &ldquo;LoadLibrary&rdquo;.</li><li>The executable may have sections named after certain packers such as UPX.</li></ul><p><strong>Demonstration</strong></p><p>I have two copies of my application, one not packed and another has been packed.</p><p>Below we can see that this copy has 34 imports, so a noticeable amount and the imports are quite revealing in what we can expect the application to do:</p><p><img loading=lazy src=https://i.imgur.com/HdG2Gol.png></p><p>Whereas the other copy only presents us with 6 imports.</p><p><img loading=lazy src=https://i.imgur.com/5TZ8pa5.png></p><p>We can verify that this was packed using UPX via tools such as <a href=https://www.aldeid.com/wiki/PEiD>PEID</a>, or by manually comparing the executables sections and filesize differences.</p><p><img loading=lazy src=https://i.imgur.com/jgp7geN.png></p><p>Look at that entropy! 7.526 out of 8! Also, note the name of the sections. UPX0 and the entry point being at UPX1&mldr;that&rsquo;s our packer.</p><p><img loading=lazy src=https://i.imgur.com/BKlrTA0.png></p><h3 id=flag-5>Flag-5<a hidden class=anchor aria-hidden=true href=#flag-5>#</a></h3><p><img loading=lazy src=https://i.imgur.com/3qrihQX.png></p><hr><h2 id=task-06-hows-your-memory>task 06: How&rsquo;s Your Memory?<a hidden class=anchor aria-hidden=true href=#task-06-hows-your-memory>#</a></h2><p><em>If you&rsquo;ve had enough of hearing about entropy and packing - I don&rsquo;t blame you, me too</em>.</p><p><strong>Memory Forensics</strong></p><p>You are going to be analysing the memory dump I&rsquo;ve taken of a Windows 7 PC that has been infected with the Jigsaw Ransomware. This memory dump can be found in &ldquo;/home/remnux/Tasks/6/Win7-Jigsaw.raw&rdquo;.</p><p><img loading=lazy src=https://i.imgur.com/hzhY3OC.png></p><p><strong>A Volatility Crash Course</strong><br><strong>Understanding our Memory Dump</strong></p><p>It goes without saying that every operating system will store data in different places, and this is no different when data is stored within memory. Volatility is unable to assume what the operating system that we have created a memory dump is, and in turn, where to look for things and what commands can be executed. For example, <code>hivelist</code> is used for Windows registry and will not work on a Linux memory dump.</p><p>Whilst Volatility can&rsquo;t assume, it can guess. Here&rsquo;s where profiles come into play. In other scenarios, we would use the <code>imageinfo</code> plugin to help determine what profile is most suitable with the syntax of <code>volatility -f Win7-Jigsaw.raw imageinfo</code>. However, this could take hours to complete on a large memory dump on an Instance like that attached to the room. So instead, I have provided it for you.</p><p><em>Please note that volatility will take a few minutes for commands to complete.</em></p><p><img loading=lazy src=https://i.imgur.com/vSyKXJl.png></p><p>Profile <code>Win7SP1x64</code> is the first suggested and just happens to be the correct OS version.</p><p><strong>Beginning our Investigation</strong></p><p><strong>Viewing What Processes Were Running at Infection</strong></p><p><em>&ldquo;A process, in the simplest terms, is an executing program.&rdquo; (<a href=https://docs.microsoft.com/en-us/windows/win32/procthread/processes-and-threads>Processes and Threads - Win32 apps, 2018</a>)</em></p><p>Processes range from every-day applications such as your browser to system services and other inner-workings.</p><p>Specifically, we need to identify the malicious processes to get an understanding of how the malware works and to also build a picture of Indicators of Compromise (IoC). We can list the processes that were running via <code>pslist</code>:</p><p><code>volatility -f Win7-Jigsaw.raw --profile=Win7SP1x64 pslist</code></p><p>Note how you can see Google Chrome within the process because the application was running at the time of the memory dump.</p><p><img loading=lazy src=https://i.imgur.com/pZwWizH.png></p><p><strong>Needles in Haystacks</strong></p><p>Luckily we&rsquo;ve got quite a shortlist of processes here, so we can start to narrow down between the system processes and any applications.</p><p>It can be daunting at first in trying to decide on what&rsquo;s worthy of investigating. As your seat time in malware analysis increases, you&rsquo;ll be able to pick out abnormalities. In this case, it&rsquo;s process &ldquo;drpbx.exe&rdquo; with a PID of 3704.</p><p><strong>What Can We Do With This?</strong></p><p>Now that we&rsquo;ve identified the abnormal process, we can begin to dump this specifically and begin analysing. As the application will be unpacked and/or in it&rsquo;s most revealing state, it is perfect for analysis.</p><p><strong>Peeking Behind the Curtain</strong></p><p>Even without analysing, we can start to understand what sort of interaction the process is capable of with the operating system. DLL&rsquo;s are structured very similarly to executables, however, they cannot be directly executed. Moreover, multiple applications can interact with a DLL all at the same time. We can list the DLL&rsquo;s that &ldquo;drpbx.exe&rdquo; references with dlllist:</p><p><strong>All the DLL&rsquo;S</strong></p><p>Again, it&rsquo;s easy to become overwhelmed at trying to figure out what&rsquo;s of significance. It only comes with time, experience and research into what Windows DLL&rsquo;s do what.</p><p><img loading=lazy src=https://i.imgur.com/S7aICI0.png></p><p>What stands out initially is the &ldquo;CRYPTBASE.dll&rdquo;</p><p><img loading=lazy src=https://i.imgur.com/r1qtrXJ.png></p><p>This DLL is a Windows library that allows applications to use cryptography. Whilst many use it legitimately, i.e. HTTPS, let&rsquo;s assume that we didn&rsquo;t know that the host was infected with ransomware specifically, we&rsquo;d need to start investigating the process further. However, that is not for here. We&rsquo;ve found enough evidence to suspect ransomware through memory forensics & research.</p><h3 id=flag-6--na>Flag-6: <code>N\A</code><a hidden class=anchor aria-hidden=true href=#flag-6--na>#</a></h3><hr><h2 id=task-07-finishing-up>Task 07: Finishing Up<a hidden class=anchor aria-hidden=true href=#task-07-finishing-up>#</a></h2><p>I encourage you to go back through the tasks and use alternate tools to that which I used, all located within the attached REMnux box. Malicious macros within Microsoft Office documents are very successful and dangerous vehicles for malware authors to weaponise. Whilst macros have legitimate purposes in MS Office documents, rampant APT campaigns such as Emotet, Ryuk and Qakbot exploit these as droppers.</p><p>For a bonus challenge, spend some more time in getting familiar with Volatility. Are there any more additional indicators of compromise within the Windows 7 memory dump that we briefly analyzed?</p><h3 id=flag-7-na>Flag-7: <code>N\A</code><a hidden class=anchor aria-hidden=true href=#flag-7-na>#</a></h3><hr><h2 id=task-08-references--further-reading-material>Task 08: References & Further Reading Material<a hidden class=anchor aria-hidden=true href=#task-08-references--further-reading-material>#</a></h2><p><strong>References</strong></p><p><strong>Task 1</strong></p><p>Zeltser Security Corp., 2020. REMnux (image) Retrieved from: <a href=https://remnux.org/>https://remnux.org/</a></p><p><strong>Task 5</strong></p><p>Sikorski, M. and Honig, A., 2012. Practical Malware Analysis. San Francisco: No Starch Press, pp.386-387.</p><p><strong>Task 6</strong></p><p>Docs.microsoft.com. 2018. Processes And Threads - Win32 Apps. Retrieved from: <a href=https://docs.microsoft.com/en-us/windows/win32/procthread/processes-and-threads>https://docs.microsoft.com/en-us/windows/win32/procthread/processes-and-threads</a></p><p><strong>Additional Reading</strong></p><ul><li><p><a href=https://fsec404.github.io/blog/Shanon-entropy/>A Look At Entropy Analysis</a></p></li><li><p><a href="https://www.youtube.com/watch?v=BMFCdAGxVN4">[BlackHat 2019] Investigating Malware Using Memory Forensics (Video)</a></p></li><li><p><a href=https://www.avira.com/en/blog/malware-threat-report-q2-2020-statistics-and-trends>Malware Threat Report - Q2 2020 (Avira)</a></p></li><li><p><a href=https://api.semanticscholar.org/CorpusID:212680542%20(P.%20Singh,%20S.%20Tapaswi,%20S.Gupta)>Malware Detection in PDF and Office Documents: A survey</a></p></li></ul><p><strong>Cheatsheets</strong></p><ul><li><p><a href=https://docs.remnux.org/>REMnux 7.0 Documentation</a></p></li><li><p><a href=https://downloads.volatilityfoundation.org/releases/2.4/CheatSheet_v2.4.pdf>Volatility 2.4. Windows & Linux Profile Cheatsheets</a></p></li></ul><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://classroom.anir0y.in/tags/tryhackme/>Tryhackme</a></li><li><a href=https://classroom.anir0y.in/tags/rooms/>Rooms</a></li><li><a href=https://classroom.anir0y.in/tags/thm/>Thm</a></li></ul><nav class=paginav><a class=prev href=https://classroom.anir0y.in/post/cs-hijackputty-msfvenom/><span class=title>¬´ Prev</span><br><span>Backdooring EXE Files</span>
</a><a class=next href=https://classroom.anir0y.in/post/thm-room-basicmalwarere/><span class=title>Next ¬ª</span><br><span>TryHackMe BasicMalwareRE Writeup</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Writeup REMnux - The Redux on x" href="https://x.com/intent/tweet/?text=TryHackMe%20Writeup%20REMnux%20-%20The%20Redux&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malremnuxv2%2f&amp;hashtags=tryhackme%2crooms%2cthm"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Writeup REMnux - The Redux on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malremnuxv2%2f&amp;title=TryHackMe%20Writeup%20REMnux%20-%20The%20Redux&amp;summary=TryHackMe%20Writeup%20REMnux%20-%20The%20Redux&amp;source=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malremnuxv2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Writeup REMnux - The Redux on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malremnuxv2%2f&title=TryHackMe%20Writeup%20REMnux%20-%20The%20Redux"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Writeup REMnux - The Redux on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malremnuxv2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Writeup REMnux - The Redux on whatsapp" href="https://api.whatsapp.com/send?text=TryHackMe%20Writeup%20REMnux%20-%20The%20Redux%20-%20https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malremnuxv2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Writeup REMnux - The Redux on telegram" href="https://telegram.me/share/url?text=TryHackMe%20Writeup%20REMnux%20-%20The%20Redux&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malremnuxv2%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Writeup REMnux - The Redux on ycombinator" href="https://news.ycombinator.com/submitlink?t=TryHackMe%20Writeup%20REMnux%20-%20The%20Redux&u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malremnuxv2%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>YOU CAN REUSE MY CONTENT</span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>