<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Try Hack Me writeup | Osquery The Basics | Classroom</title><meta name=keywords content><meta name=description content="Try Hack Me Room Osquery The Basics solved by Animesh Roy. this is a walkthough. read more..."><meta name=author content="Animesh Roy"><link rel=canonical href=https://classroom.anir0y.in/post/tryhackme-osquerythebasics/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=16x16 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=32x32 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=apple-touch-icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=mask-icon href=https://classroom.anir0y.in/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://classroom.anir0y.in/post/tryhackme-osquerythebasics/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-osquerythebasics/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="Try Hack Me writeup | Osquery The Basics"><meta property="og:description" content="Try Hack Me Room Osquery The Basics solved by Animesh Roy. this is a walkthough. read more..."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-11-12T18:18:23+05:30"><meta property="article:modified_time" content="2022-11-12T18:18:23+05:30"><meta property="og:image" content="https://classroom.anir0y.in/img/osquery-1.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://classroom.anir0y.in/img/osquery-1.png"><meta name=twitter:title content="Try Hack Me writeup | Osquery The Basics"><meta name=twitter:description content="Try Hack Me Room Osquery The Basics solved by Animesh Roy. this is a walkthough. read more..."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"Try Hack Me writeup | Osquery The Basics","item":"https://classroom.anir0y.in/post/tryhackme-osquerythebasics/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Try Hack Me writeup | Osquery The Basics","name":"Try Hack Me writeup | Osquery The Basics","description":"Try Hack Me Room Osquery The Basics solved by Animesh Roy. this is a walkthough. read more...","keywords":[],"articleBody":"OverView Follow @anir0y Osquery The Basics solvedSubscriber only Task 01: Introduction Osquery is an open-source agent created by Facebook in 2014. It converts the operating system into a relational database. It allows us to ask questions from the tables using SQL queries, like returning the list of running processes, a user account created on the host, and the process of communicating with certain suspicious domains. It is widely used by Security Analysts, Incident Responders, Threat Hunters, etc. Osquery can be installed on multiple platforms: Windows, Linux, macOS, and FreeBSD.\nLearning Objective\nWhat is Osquery, and what problem it solves? Osquery in Interactive Mode How to use the interactive mode of Osquery to interact with the operating system How to join two tables to get a single answer Task 02: Connect with the Lab Note that it will take 3-5 minutes for the VM to boot up completely. so wait till it’s complete booting up.\nTask 03: Osquery: Interactive Mode One of the ways to interact with Osquery is by using the interactive mode. Open the terminal and run run osqueryi. To understand the tool, run the .help command in the interactive terminal, as shown below:\nroot@analyst$ osqueryi Using a virtual database. Need help, type '.help' osquery\u003e .help Welcome to the osquery shell. Please explore your OS! You are connected to a transient 'in-memory' virtual database. .all [TABLE] Select all from a table .bail ON|OFF Stop after hitting an error .connect PATH Connect to an osquery extension socket .disconnect Disconnect from a connected extension socket .echo ON|OFF Turn command echo on or off .exit Exit this program .features List osquery's features and their statuses .headers ON|OFF Turn display of headers on or off .help Show this message .mode MODE Set output mode where MODE is one of: csv Comma-separated values column Left-aligned columns see .width line One value per line list Values delimited by .separator string pretty Pretty printed SQL results (default) .nullvalue STR Use STRING in place of NULL values .print STR... Print literal STRING .quit Exit this program .schema [TABLE] Show the CREATE statements .separator STR Change separator used by output mode .socket Show the local osquery extensions socket path .show Show the current values for various settings .summary Alias for the show meta command .tables [TABLE] List names of tables .types [SQL] Show result of getQueryColumns for the given query .width [NUM1]+ Set column widths for \"column\" mode .timer ON|OFF Turn the CPU timer measurement on or off List the tables To list all the available tables that can be queried, use the .tables meta-command.\nFor example, if you wish to check what tables are associated with processes, you can use .tables process\nTo list all the tables with the term user in them, we will use .tables user as shown below:\nIn the above example, four tables are returned that contain the word user.\nUnderstanding the table Schema Table names are not enough to know what information it contains without actually querying it. Knowledge of columns and types (known as a schema ) for each table is also helpful.\nWe can list a table’s schema with the following meta-command: .schema table_name\nHere, we are interested in understanding the columns in the user’s table.\nThe above result provides the column names like username, description, PID followed by respective datatypes like BIGINT, TEXT, INTEGER, etc. Let us pick a few columns from this schema and use SQL query to ask osquery to display the columns from the user table using the following syntax:\nSQL QUERY SYNTAX: select column1, column2, column3 from table;\nDisplay Mode Osquery comes with multiple display modes to select from. Use the .help option to list the available modes or choose 1 of them as shown below:\nThe schema API online documentation can be used to view a complete list of tables, columns, types, and column descriptions.\nTask 3: Answer the questions below 3.1 How many tables are returned when we query “table process” in the interactive mode of Osquery?\nrun .table process to get the number of runnging process\n3.2 Looking at the schema of the processes table, which column displays the process id for the particular process?\nrun .schema process to get the answer.\n3.3 Examine the .help command, how many output display modes are available for the .mode command?\nrun .help and count the modes\nTask 04: Schema Documentation For this task, go to the schema documentation of Osquery version 5.5.1, the latest version. The schema documentation looks like the image shown below:\nDocumentation link: https://osquery.io/schema/5.5.1/\nBreakdown\nLet’s break down the important information we could find in this schema documentation:\nA dropdown lists various versions of Osquery. Choose the version of Osquery you wish to see schema tables for. The number of tables within the selected version of Osquery. (In the above image, 106 tables are available). The list of tables is listed in alphabetical order for the selected version of Osquery. This is the same result we get when we use the .table command in the interactive mode. The name of the table and a brief description. A detailed chart showing each table’s column, type, and description. Information to which Operating System the table applies. (In the above image, the account_policy_data table is available only for macOS) A dropdown menu to select the Operating System of choice. We can choose multiple Operating Systems, which will display the tables available for those Operating systems. Task 4 Answer the questions below 4.1 In Osquery version 5.5.1, how many common tables are returned, when we select both Linux and Window Operating system?\n4.2 In Osquery version 5.5.1, how many tables for MAC OS are available?\n4.3 In the Windows Operating system, which table is used to display the installed programs?\nref to this link and search for windows “programs”\n4.4 In Windows Operating system, which column contains the registry value within the registry table?\nTask 05: Creating SQL queries The SQL language implemented in Osquery is not an entire SQL language that you might be accustomed to, but rather it’s a superset of SQLite.\nRealistically all your queries will start with a SELECT statement. This makes sense because, with Osquery, you are only querying information on an endpoint. You won’t be updating or deleting any information/data on the endpoint.\nThe exception to the rule: Using other SQL statements, such as UPDATE and DELETE, is possible, but only if you’re creating run-time tables (views) or using an extension if the extension supports them.\nYour queries will also include a FROM clause and end with a semicolon.\nExploring Installed Programs\nIf you wish to retrieve all the information about the installed programs on the endpoint, first understand the table schema either using the .schema programs command in the interactive mode or use the documentation here.\nQuery: SELECT * FROM programs LIMIT 1;\nIn the above example LIMIT was used followed by the number to limit the results to display.\nNote: Your results will be different if you run this query in the attached VM or your local machine (if Osquery is installed). Here line mode is used to display the result.\nThe number of columns returned might be more than what you need. You can select specific columns rather than retrieve every column in the table.\nQuery: SELECT name, version, install_location, install_date from programs limit 1;\nThe above query will list the name, version, install location, and installed date of the programs on the endpoint. This will still return many results, depending on how busy the endpoint is.\nCount\nTo see how many programs or entries in any table are returned, we can use the count() function, as shown below:\nQuery: SELECT count(*) from programs;\nWHERE Clause\nOptionally, you can use a WHERE clause to narrow down the list of results returned based on specified criteria. The following query will first get the user table and only display the result for the user James, as shown below:\nQuery: SELECT * FROM users WHERE username='James';\nThe equal sign is not the only filtering option in a WHERE clause. Below are filtering operators that can be used in a WHERE clause:\n= [equal] \u003c\u003e [not equal] \u003e, \u003e= [greater than, greater than, or equal to] \u003c, \u003c= [less than or less than or equal to] BETWEEN [between a range] LIKE [pattern wildcard searches] %[wildcard, multiple characters] _ [wildcard, one character] Matching Wildcard Rules\nBelow is a screenshot from the Osquery documentation showing examples of using wildcards when used in folder structures:\n%: Match all files and folders for one level. %%: Match all files and folders recursively. %abc: Match all within-level ending in “abc”. abc%: Match all within-level starting with “abc”. Matching Examples\n/Users/%/Library: Monitor for changes to every user’s Library folder, but not the contents within. /Users/%/Library/: Monitor for changes to files within each Library folder, but not the contents of their subdirectories. /Users/%/Library/%: Same, changes to files within each Library folder. /Users/%/Library/%%: Monitor changes recursively within each Library. /bin/%sh: Monitor the bin directory for changes ending in sh. Some tables require a WHERE clause, such as the file table, to return a value. If the required WHERE clause is not included in the query, then you will get an error.\nJoining Tables using JOIN Function\nOSquery can also be used to join two tables based on a column that is shared by both tables. Let’s look at two tables to demonstrate this further. Below is the schema for the user’s table and the processes table.\nLooking at both schemas, uid in users table is meant to identify the user record, and in the processes table, the column uid represents the user responsible for executing the particular process. We can join both tables using this uid field as shown below:\nQuery1: select uid, pid, name, path from processes;\nQuery2: select uid, username, description from users;\nJoined Query: select p.pid, p.name, p.path, u.username from processes p JOIN users u on u.uid=p.uid LIMIT 10;\nNote: Please refer to the Osquery documentation for more information regarding SQL and creating queries specific to Osquery.\nTask 05 Answer the questions below Using Osquery, how many programs are installed on this host?\nselect count(*) from programs;\nUsing Osquery, what is the description for the user James?\nselect username,description from users;\nWhen we run the following search query, what is the full SID of the user with RID ‘1009’?\nQuery: select path, key, name from registry where key = ‘HKEY_USERS’;\nWhen we run the following search query, what is the Internet Explorer browser extension installed on this machine? Query: select * from ie_extensions;\nAfter running the following query, what is the full name of the program returned? Query: select name,install_location from programs where name LIKE ‘%wireshark%’;\nTask 06 Challenge and Conclusion Now that we have explored various tables, learned how to create search queries, and ask questions from the operating system, it’s time for a challenge. Use OSquery to examine the host and answer the following questions.\nTask 06 Answer the questions below Which table stores the evidence of process execution in Windows OS?\nOne of the users seems to have executed a program to remove traces from the disk; what is the name of that program?\nwe alreay know the SID of our user James : S-1-5-21-1966530601-3185510712-10604624-1009\nselect sid,path from userassist where sid='S-1-5-21-1966530601-3185510712-10604624-1009';\nCreate a search query to identify the VPN installed on this host. What is name of the software?\nselect name from programs;\nHow many services are running on this host? select count(*) from services ;\nA table autoexec contains the list of executables that are automatically executed on the target machine. There seems to be a batch file that runs automatically. What is the name of that batch file (with the extension .bat)?\nselect * from autoexec where name like '%.bat';\nWhat is the full path of the batch file found in the above question? (Last in the List)\nselect * from autoexec where name like '%.bat';\n","wordCount":"1986","inLanguage":"en","image":"https://classroom.anir0y.in/img/osquery-1.png","datePublished":"2022-11-12T18:18:23+05:30","dateModified":"2022-11-12T18:18:23+05:30","author":{"@type":"Person","name":"Animesh Roy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/tryhackme-osquerythebasics/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https://classroom.anir0y.in/img/avatar.jpeg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://classroom.anir0y.in/ accesskey=h title="Classroom (Alt + H)"><img src=https://classroom.anir0y.in/img/avatar.jpeg alt aria-label=logo height=35>Classroom</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://classroom.anir0y.in/post/ title=Posts><span>Posts</span></a></li><li><a href=https://classroom.anir0y.in/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://classroom.anir0y.in/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://classroom.anir0y.in/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://classroom.anir0y.in/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://classroom.anir0y.in/about/me/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://classroom.anir0y.in/>Home</a>&nbsp;»&nbsp;<a href=https://classroom.anir0y.in/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Try Hack Me writeup | Osquery The Basics</h1><div class=post-description>Try Hack Me Room Osquery The Basics solved by Animesh Roy. this is a walkthough. read more...</div><div class=post-meta><span title='2022-11-12 18:18:23 +0530 IST'>November 12, 2022</span>&nbsp;·&nbsp;<span>10 min</span>&nbsp;·&nbsp;<span>Animesh Roy</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/anir0y/classroom/tree/master/content/post/TryHackMe-osqueryTheBasics.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><figure class=entry-cover><img loading=eager src=https://classroom.anir0y.in/img/osquery-1.png alt="cover image"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>OverView</a></li><li><a href=#task-01-introduction>Task 01: Introduction</a></li><li><a href=#task-02-connect-with-the-lab>Task 02: Connect with the Lab</a></li><li><a href=#task-03-osquery-interactive-mode>Task 03: Osquery: Interactive Mode</a><ul><li><a href=#list-the-tables>List the tables</a></li><li><a href=#understanding-the-table-schema>Understanding the table Schema</a></li><li><a href=#display-mode>Display Mode</a></li><li><a href=#task-3-answer-the-questions-below>Task 3: Answer the questions below</a></li></ul></li><li><a href=#task-04--schema-documentation>Task 04: Schema Documentation</a><ul><li><a href=#task-4-answer-the-questions-below>Task 4 Answer the questions below</a></li></ul></li><li><a href=#task-05--creating-sql-queries>Task 05: Creating SQL queries</a><ul><li><a href=#task-05-answer-the-questions-below>Task 05 Answer the questions below</a></li></ul></li><li><a href=#task-06--challenge-and-conclusion>Task 06 Challenge and Conclusion</a><ul><li><a href=#task-06-answer-the-questions-below>Task 06 Answer the questions below</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=overview>OverView<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><table><thead><tr><th><script src=https://tryhackme.com/badge/434937></script></th><th><a class=twitter-follow-button href=https://twitter.com/anir0y data-size=large>Follow @anir0y<a></th></tr></thead><tbody><tr><td>Osquery The Basics solved<a href=https://tryhackme.com/room/osqueryf8><strong>Subscriber only</strong></a></td><td><img alt=logo loading=lazy src=https://tryhackme-images.s3.amazonaws.com/room-icons/2d1116d536a64d634647d6efa1f2acf0.png></td></tr></tbody></table><h2 id=task-01-introduction>Task 01: Introduction<a hidden class=anchor aria-hidden=true href=#task-01-introduction>#</a></h2><p>Osquery is an open-source agent created by Facebook in 2014. It converts the operating system into a relational database. It allows us to ask questions from the tables using SQL queries, like returning the list of running processes, a user account created on the host, and the process of communicating with certain suspicious domains. It is widely used by Security Analysts, Incident Responders, Threat Hunters, etc. Osquery can be installed on multiple platforms: Windows, Linux, macOS, and FreeBSD.</p><p><strong>Learning Objective</strong></p><ul><li>What is Osquery, and what problem it solves?</li><li>Osquery in Interactive Mode</li><li>How to use the interactive mode of Osquery to interact with the operating system</li><li>How to join two tables to get a single answer</li></ul><h2 id=task-02-connect-with-the-lab>Task 02: Connect with the Lab<a hidden class=anchor aria-hidden=true href=#task-02-connect-with-the-lab>#</a></h2><p>Note that it will take 3-5 minutes for the VM to boot up completely. so wait till it&rsquo;s complete booting up.</p><h2 id=task-03-osquery-interactive-mode>Task 03: Osquery: Interactive Mode<a hidden class=anchor aria-hidden=true href=#task-03-osquery-interactive-mode>#</a></h2><p>One of the ways to interact with Osquery is by using the interactive mode. Open the terminal and run run <code>osqueryi</code>. To understand the tool, run the <code>.help</code> command in the interactive terminal, as shown below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@analyst$ osqueryi
</span></span><span class=line><span class=cl>Using a virtual database. Need help, <span class=nb>type</span> <span class=s1>&#39;.help&#39;</span>
</span></span><span class=line><span class=cl>osquery&gt; .help
</span></span><span class=line><span class=cl>Welcome to the osquery shell. Please explore your OS!
</span></span><span class=line><span class=cl>You are connected to a transient <span class=s1>&#39;in-memory&#39;</span> virtual database.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.all <span class=o>[</span>TABLE<span class=o>]</span>     Select all from a table
</span></span><span class=line><span class=cl>.bail ON<span class=p>|</span>OFF     Stop after hitting an error
</span></span><span class=line><span class=cl>.connect PATH    Connect to an osquery extension socket
</span></span><span class=line><span class=cl>.disconnect      Disconnect from a connected extension socket
</span></span><span class=line><span class=cl>.echo ON<span class=p>|</span>OFF     Turn <span class=nb>command</span> <span class=nb>echo</span> on or off
</span></span><span class=line><span class=cl>.exit            Exit this program
</span></span><span class=line><span class=cl>.features        List osquery<span class=err>&#39;</span>s features and their statuses
</span></span><span class=line><span class=cl>.headers ON<span class=p>|</span>OFF  Turn display of headers on or off
</span></span><span class=line><span class=cl>.help            Show this message
</span></span><span class=line><span class=cl>.mode MODE       Set output mode where MODE is one of:
</span></span><span class=line><span class=cl>                   csv      Comma-separated values
</span></span><span class=line><span class=cl>                   column   Left-aligned columns see .width
</span></span><span class=line><span class=cl>                   line     One value per line
</span></span><span class=line><span class=cl>                   list     Values delimited by .separator string
</span></span><span class=line><span class=cl>                   pretty   Pretty printed SQL results <span class=o>(</span>default<span class=o>)</span>
</span></span><span class=line><span class=cl>.nullvalue STR   Use STRING in place of NULL values
</span></span><span class=line><span class=cl>.print STR...    Print literal STRING
</span></span><span class=line><span class=cl>.quit            Exit this program
</span></span><span class=line><span class=cl>.schema <span class=o>[</span>TABLE<span class=o>]</span>  Show the CREATE statements
</span></span><span class=line><span class=cl>.separator STR   Change separator used by output mode
</span></span><span class=line><span class=cl>.socket          Show the <span class=nb>local</span> osquery extensions socket path
</span></span><span class=line><span class=cl>.show            Show the current values <span class=k>for</span> various settings
</span></span><span class=line><span class=cl>.summary         Alias <span class=k>for</span> the show meta <span class=nb>command</span>
</span></span><span class=line><span class=cl>.tables <span class=o>[</span>TABLE<span class=o>]</span>  List names of tables
</span></span><span class=line><span class=cl>.types <span class=o>[</span>SQL<span class=o>]</span>     Show result of getQueryColumns <span class=k>for</span> the given query
</span></span><span class=line><span class=cl>.width <span class=o>[</span>NUM1<span class=o>]</span>+   Set column widths <span class=k>for</span> <span class=s2>&#34;column&#34;</span> mode
</span></span><span class=line><span class=cl>.timer ON<span class=p>|</span>OFF      Turn the CPU timer measurement on or off
</span></span></code></pre></div><h3 id=list-the-tables>List the tables<a hidden class=anchor aria-hidden=true href=#list-the-tables>#</a></h3><p>To list all the available tables that can be queried, use the <code>.tables </code>meta-command.</p><p>For example, if you wish to check what tables are associated with processes, you can use <code>.tables process</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/D3olWfd.png></p><p>To list all the tables with the term <code>user</code> in them, we will use <code>.tables user</code> as shown below:</p><p><img alt=img loading=lazy src=https://i.imgur.com/eQS5f6N.png></p><p>In the above example, four tables are returned that contain the word user.</p><h3 id=understanding-the-table-schema>Understanding the table Schema<a hidden class=anchor aria-hidden=true href=#understanding-the-table-schema>#</a></h3><p>Table names are not enough to know what information it contains without actually querying it. Knowledge of columns and types (known as a schema ) for each table is also helpful.</p><p>We can list a table&rsquo;s schema with the following meta-command: <code>.schema table_name</code></p><p>Here, we are interested in understanding the columns in the user&rsquo;s table.</p><p><img alt=img loading=lazy src=https://i.imgur.com/2Fv7b00.png></p><p>The above result provides the column names like username, description, PID followed by respective datatypes like BIGINT, TEXT, INTEGER, etc. Let us pick a few columns from this schema and use SQL query to ask osquery to display the columns from the user table using the following syntax:</p><p><strong>SQL QUERY SYNTAX:</strong> <code>select column1, column2, column3 from table;</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/Ot2gpFe.png></p><h3 id=display-mode>Display Mode<a hidden class=anchor aria-hidden=true href=#display-mode>#</a></h3><p>Osquery comes with multiple display modes to select from. Use the <code>.help</code> option to list the available modes or choose 1 of them as shown below:</p><p><img alt=img loading=lazy src=https://i.imgur.com/ysJtAAS.png></p><p>The schema API online documentation can be used to view a complete list of tables, columns, types, and column descriptions.</p><h3 id=task-3-answer-the-questions-below>Task 3: Answer the questions below<a hidden class=anchor aria-hidden=true href=#task-3-answer-the-questions-below>#</a></h3><ul><li><p>3.1 How many tables are returned when we query &ldquo;table process&rdquo; in the interactive mode of Osquery?</p><p>run <code>.table process</code> to get the number of runnging process</p></li><li><p>3.2 Looking at the schema of the processes table, which column displays the process id for the particular process?</p><p>run <code>.schema process</code> to get the answer.</p></li><li><p>3.3 Examine the .help command, how many output display modes are available for the .mode command?</p><p>run <code>.help</code> and count the <code>modes</code></p></li></ul><hr><h2 id=task-04--schema-documentation>Task 04: Schema Documentation<a hidden class=anchor aria-hidden=true href=#task-04--schema-documentation>#</a></h2><p>For this task, go to the schema documentation of Osquery version 5.5.1, the latest version. The schema documentation looks like the image shown below:</p><p>Documentation link: <a href=https://osquery.io/schema/5.5.1/>https://osquery.io/schema/5.5.1/</a></p><p><strong>Breakdown</strong></p><p>Let&rsquo;s break down the important information we could find in this schema documentation:</p><ul><li>A dropdown lists various versions of Osquery. Choose the version of Osquery you wish to see schema tables for.</li><li>The number of tables within the selected version of Osquery. (In the above image, 106 tables are available).</li><li>The list of tables is listed in alphabetical order for the selected version of Osquery. This is the same result we get when we use the .table command in the interactive mode.</li><li>The name of the table and a brief description.</li><li>A detailed chart showing each table&rsquo;s column, type, and description.</li><li>Information to which Operating System the table applies. (In the above image, the account_policy_data table is available only for macOS)</li><li>A dropdown menu to select the Operating System of choice. We can choose multiple Operating Systems, which will display the tables available for those Operating systems.</li></ul><h3 id=task-4-answer-the-questions-below>Task 4 Answer the questions below<a hidden class=anchor aria-hidden=true href=#task-4-answer-the-questions-below>#</a></h3><ul><li><p>4.1 In Osquery version 5.5.1, how many common tables are returned, when we select both Linux and Window Operating system?</p><p><img alt=img loading=lazy src=https://i.imgur.com/m8Z7sln.png></p></li><li><p>4.2 In Osquery version 5.5.1, how many tables for MAC OS are available?</p><p><img alt=img loading=lazy src=https://i.imgur.com/FDi0VIy.png></p></li><li><p>4.3 In the Windows Operating system, which table is used to display the installed programs?</p><p><img alt=img loading=lazy src=https://i.imgur.com/GZmjEv7.png></p><p>ref to this link and search for <a href=https://osquery.io/schema/5.5.1/>windows &ldquo;programs&rdquo;</a></p></li><li><p>4.4 In Windows Operating system, which column contains the registry value within the registry table?</p><p><img alt=img loading=lazy src=https://i.imgur.com/jAKuD4Z.png></p></li></ul><hr><h2 id=task-05--creating-sql-queries>Task 05: Creating SQL queries<a hidden class=anchor aria-hidden=true href=#task-05--creating-sql-queries>#</a></h2><p>The SQL language implemented in Osquery is not an entire SQL language that you might be accustomed to, but rather it&rsquo;s a superset of SQLite.</p><p>Realistically all your queries will start with a SELECT statement. This makes sense because, with Osquery, you are only querying information on an endpoint. You won&rsquo;t be updating or deleting any information/data on the endpoint.</p><p>The exception to the rule: Using other SQL statements, such as UPDATE and DELETE, is possible, but only if you&rsquo;re creating run-time tables (views) or using an extension if the extension supports them.</p><p>Your queries will also include a FROM clause and end with a semicolon.</p><p><strong>Exploring Installed Programs</strong></p><p>If you wish to retrieve all the information about the installed programs on the endpoint, first understand the table schema either using the <code>.schema programs</code> command in the interactive mode or use the documentation <a href=https://osquery.io/schema/5.5.1/#programs>here</a>.</p><p><strong>Query:</strong> <code>SELECT * FROM programs LIMIT 1;</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/rFgGmRG.png></p><p>In the above example <code>LIMIT</code> was used followed by the number to limit the results to display.</p><p><strong>Note</strong>: Your results will be different if you run this query in the attached VM or your local machine (if Osquery is installed). Here line mode is used to display the result.</p><p>The number of columns returned might be more than what you need. You can select specific columns rather than retrieve every column in the table.</p><p><strong>Query:</strong> <code>SELECT name, version, install_location, install_date from programs limit 1;</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/4CDssKY.png></p><p>The above query will list the name, version, install location, and installed date of the programs on the endpoint. This will still return many results, depending on how busy the endpoint is.</p><p><strong>Count</strong></p><p>To see how many programs or entries in any table are returned, we can use the count() function, as shown below:</p><p><strong>Query:</strong> <code>SELECT count(*) from programs;</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/kx9U5Sj.png></p><p><strong>WHERE Clause</strong></p><p>Optionally, you can use a WHERE clause to narrow down the list of results returned based on specified criteria. The following query will first get the user table and only display the result for the user James, as shown below:</p><p><em>Query:</em> <code>SELECT * FROM users WHERE username='James';</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/l6NkeO9.png></p><p>The equal sign is not the only filtering option in a WHERE clause. Below are filtering operators that can be used in a WHERE clause:</p><ul><li><code>=</code> [equal]</li><li><code>&lt;></code> [not equal]</li><li><code>>, >=</code> [greater than, greater than, or equal to]</li><li><code>&lt;, &lt;=</code> [less than or less than or equal to]</li><li><code>BETWEEN</code> [between a range]</li><li><code>LIKE</code> [pattern wildcard searches]</li><li><code>%</code>[wildcard, multiple characters]</li><li><code>_</code> [wildcard, one character]</li></ul><p><strong>Matching Wildcard Rules</strong></p><p>Below is a screenshot from the <a href=https://osquery.readthedocs.io/en/stable/deployment/file-integrity-monitoring/>Osquery documentation</a> showing examples of using wildcards when used in folder structures:</p><ul><li><code>%</code>: Match all files and folders for one level.</li><li><code>%%</code>: Match all files and folders recursively.</li><li><code>%abc</code>: Match all within-level ending in &ldquo;abc&rdquo;.</li><li><code>abc%</code>: Match all within-level starting with &ldquo;abc&rdquo;.</li></ul><p><strong>Matching Examples</strong></p><ul><li><code>/Users/%/Library</code>: Monitor for changes to every user&rsquo;s Library folder, but not the contents within.</li><li><code>/Users/%/Library/</code>: Monitor for changes to files within each Library folder, but not the contents of their subdirectories.</li><li><code>/Users/%/Library/%</code>: Same, changes to files within each Library folder.</li><li><code>/Users/%/Library/%%</code>: Monitor changes recursively within each Library.</li><li><code>/bin/%sh</code>: Monitor the <code>bin</code> directory for changes ending in <code>sh</code>.</li></ul><p>Some tables require a WHERE clause, such as the file table, to return a value. If the required WHERE clause is not included in the query, then you will get an error.</p><p><img alt=img loading=lazy src=https://i.imgur.com/I61a4vF.png></p><p><strong>Joining Tables using JOIN Function</strong></p><p>OSquery can also be used to join two tables based on a column that is shared by both tables. Let&rsquo;s look at two tables to demonstrate this further. Below is the schema for the user&rsquo;s table and the processes table.</p><p><img alt=img loading=lazy src=https://i.imgur.com/wJVtDN5.png></p><p>Looking at both schemas, <code>uid</code> in <code>users</code> table is meant to identify the user record, and in the processes table, the column <code>uid</code> represents the user responsible for executing the particular process. We can join both tables using this <code>uid</code> field as shown below:</p><p><em>Query1</em>: <code>select uid, pid, name, path from processes;</code></p><p><em>Query2</em>: <code>select uid, username, description from users;</code></p><p><em>Joined Query</em>: <code>select p.pid, p.name, p.path, u.username from processes p JOIN users u on u.uid=p.uid LIMIT 10;</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/KiNL25B.png></p><p>Note: Please refer to the <a href=https://osquery.readthedocs.io/en/stable/introduction/sql/>Osquery documentation</a> for more information regarding SQL and creating queries specific to Osquery.</p><h3 id=task-05-answer-the-questions-below>Task 05 Answer the questions below<a hidden class=anchor aria-hidden=true href=#task-05-answer-the-questions-below>#</a></h3><ul><li><p>Using Osquery, how many programs are installed on this host?</p><p><code>select count(*) from programs;</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/g9GqlJy.png></p></li><li><p>Using Osquery, what is the description for the user James?</p></li></ul><p><code>select username,description from users;</code></p><ul><li><p>When we run the following search query, what is the full SID of the user with RID &lsquo;1009&rsquo;?</p><p><em>Query: select path, key, name from registry where key = &lsquo;HKEY_USERS&rsquo;;</em></p><p><img alt=img loading=lazy src=https://i.imgur.com/F18ldxc.png></p></li><li><p>When we run the following search query, what is the Internet Explorer browser extension installed on this machine?
<em>Query: select * from ie_extensions;</em></p><p><img alt=img loading=lazy src=https://i.imgur.com/FoIuKEU.png></p></li><li><p>After running the following query, what is the full name of the program returned?
<em>Query: select name,install_location from programs where name LIKE &lsquo;%wireshark%&rsquo;;</em></p><p><img alt=img loading=lazy src=https://i.imgur.com/kJXQEkv.png></p></li></ul><hr><h2 id=task-06--challenge-and-conclusion>Task 06 Challenge and Conclusion<a hidden class=anchor aria-hidden=true href=#task-06--challenge-and-conclusion>#</a></h2><p>Now that we have explored various tables, learned how to create search queries, and ask questions from the operating system, it&rsquo;s time for a challenge. Use OSquery to examine the host and answer the following questions.</p><h3 id=task-06-answer-the-questions-below>Task 06 Answer the questions below<a hidden class=anchor aria-hidden=true href=#task-06-answer-the-questions-below>#</a></h3><ul><li><p>Which table stores the evidence of process execution in Windows OS?</p><p><img alt=img loading=lazy src=https://i.imgur.com/Pv3n6y0.png></p></li><li><p>One of the users seems to have executed a program to remove traces from the disk; what is the name of that program?</p><p>we alreay know the SID of our user James : <code>S-1-5-21-1966530601-3185510712-10604624-1009</code></p><p><code>select sid,path from userassist where sid='S-1-5-21-1966530601-3185510712-10604624-1009';</code></p></li><li><p>Create a search query to identify the VPN installed on this host. What is name of the software?</p><p><code>select name from programs;</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/FqYTI9y.png></p></li><li><p>How many services are running on this host?
<code>select count(*) from services ;</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/nWWCeIM.png></p></li><li><p>A table autoexec contains the list of executables that are automatically executed on the target machine. There seems to be a batch file that runs automatically. What is the name of that batch file (with the extension .bat)?</p><p><code>select * from autoexec where name like '%.bat';</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/Ao25ozI.png></p></li><li><p>What is the full path of the batch file found in the above question? (Last in the List)</p><p><code>select * from autoexec where name like '%.bat';</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/Ao25ozI.png></p></li></ul><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=anir0y data-description="Support me on Buy me a coffee!" data-message data-color=#5F7FFF data-position=Right data-x_margin=18 data-y_margin=18></script></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://classroom.anir0y.in/post/tinyurl/><span class=title>« Prev</span><br><span>BLOG | Shorten URL using TinyURL API</span>
</a><a class=next href=https://classroom.anir0y.in/post/tryhackme-printnightmareagain/><span class=title>Next »</span><br><span>Writeup |Try Hack Me PrintNightmare, again!</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me writeup | Osquery The Basics on x" href="https://x.com/intent/tweet/?text=Try%20Hack%20Me%20writeup%20%7c%20Osquery%20The%20Basics&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-osquerythebasics%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me writeup | Osquery The Basics on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-osquerythebasics%2f&amp;title=Try%20Hack%20Me%20writeup%20%7c%20Osquery%20The%20Basics&amp;summary=Try%20Hack%20Me%20writeup%20%7c%20Osquery%20The%20Basics&amp;source=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-osquerythebasics%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me writeup | Osquery The Basics on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-osquerythebasics%2f&title=Try%20Hack%20Me%20writeup%20%7c%20Osquery%20The%20Basics"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me writeup | Osquery The Basics on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-osquerythebasics%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me writeup | Osquery The Basics on whatsapp" href="https://api.whatsapp.com/send?text=Try%20Hack%20Me%20writeup%20%7c%20Osquery%20The%20Basics%20-%20https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-osquerythebasics%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me writeup | Osquery The Basics on telegram" href="https://telegram.me/share/url?text=Try%20Hack%20Me%20writeup%20%7c%20Osquery%20The%20Basics&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-osquerythebasics%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me writeup | Osquery The Basics on ycombinator" href="https://news.ycombinator.com/submitlink?t=Try%20Hack%20Me%20writeup%20%7c%20Osquery%20The%20Basics&u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-osquerythebasics%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>YOU CAN REUSE MY CONTENT</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>