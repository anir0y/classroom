<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe Ffuf | Classroom</title><meta name=keywords content="tryhackme,rooms,thm,ffuf"><meta name=description content="TryHackMe Room ffuf solved by Animesh Roy. this is a walkthough. ffuf stands for Fuzz Faster U Fool. It's a tool used for web enumeration, fuzzing, and directory brute forcing..."><meta name=author content="Animesh Roy"><link rel=canonical href=https://classroom.anir0y.in/post/tryhackme-ffuf/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=16x16 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=32x32 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=apple-touch-icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=mask-icon href=https://classroom.anir0y.in/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://classroom.anir0y.in/post/tryhackme-ffuf/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-ffuf/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="TryHackMe Ffuf"><meta property="og:description" content="TryHackMe Room ffuf solved by Animesh Roy. this is a walkthough. ffuf stands for Fuzz Faster U Fool. It's a tool used for web enumeration, fuzzing, and directory brute forcing..."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-07-17T02:49:02+05:30"><meta property="article:modified_time" content="2021-07-17T02:49:02+05:30"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="article:tag" content="Thm"><meta property="article:tag" content="Ffuf"><meta property="og:image" content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:title content="TryHackMe Ffuf"><meta name=twitter:description content="TryHackMe Room ffuf solved by Animesh Roy. this is a walkthough. ffuf stands for Fuzz Faster U Fool. It's a tool used for web enumeration, fuzzing, and directory brute forcing..."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"TryHackMe Ffuf","item":"https://classroom.anir0y.in/post/tryhackme-ffuf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe Ffuf","name":"TryHackMe Ffuf","description":"TryHackMe Room ffuf solved by Animesh Roy. this is a walkthough. ffuf stands for Fuzz Faster U Fool. It's a tool used for web enumeration, fuzzing, and directory brute forcing...","keywords":["tryhackme","rooms","thm","ffuf"],"articleBody":"overview fuff room Link task 01: Introduction Summary ffuf stands for Fuzz Faster U Fool. It’s a tool used for web enumeration, fuzzing, and directory brute forcing.\nInstall ffuf ffuf is already included in the following Linux distributions:\nBlackArch Pentoo Kali Parrot Install SecLists SecLists is a collection of multiple types of lists used during security assessments. List types include usernames, passwords, URLs, sensitive data patterns, fuzzing payloads, web shells, and many more.\ntask 02: Basics The Help page can be displayed using ffuf -h and it will be useful as we will use a lot of options.\nFuzz Faster U Fool - v1.3.0-dev HTTP OPTIONS: -H Header `\"Name: Value\"`, separated by colon. Multiple -H flags are accepted. -X HTTP method to use -b Cookie data `\"NAME1=VALUE1; NAME2=VALUE2\"` for copy as curl functionality. -d POST data -ignore-body Do not fetch the response content. (default: false) -r Follow redirects (default: false) -recursion Scan recursively. Only FUZZ keyword is supported, and URL (-u) has to end in it. (default: false) -recursion-depth Maximum recursion depth. (default: 0) -recursion-strategy Recursion strategy: \"default\" for a redirect based, and \"greedy\" to recurse on all matches (default: default) -replay-proxy Replay matched requests using this proxy. -timeout HTTP request timeout in seconds. (default: 10) -u Target URL -x Proxy URL (SOCKS5 or HTTP). For example: http://127.0.0.1:8080 or socks5://127.0.0.1:8080 GENERAL OPTIONS: -V Show version information. (default: false) -ac Automatically calibrate filtering options (default: false) -acc Custom auto-calibration string. Can be used multiple times. Implies -ac -c Colorize output. (default: false) -config Load configuration from a file -maxtime Maximum running time in seconds for entire process. (default: 0) -maxtime-job Maximum running time in seconds per job. (default: 0) -p Seconds of `delay` between requests, or a range of random delay. For example \"0.1\" or \"0.1-2.0\" -rate Rate of requests per second (default: 0) -s Do not print additional information (silent mode) (default: false) -sa Stop on all error cases. Implies -sf and -se. (default: false) -se Stop on spurious errors (default: false) -sf Stop when \u003e 95% of responses return 403 Forbidden (default: false) -t Number of concurrent threads. (default: 40) -v Verbose output, printing full URL and redirect location (if any) with the results. (default: false) MATCHER OPTIONS: -mc Match HTTP status codes, or \"all\" for everything. (default: 200,204,301,302,307,401,403,405) -ml Match amount of lines in response -mr Match regexp -ms Match HTTP response size -mw Match amount of words in response FILTER OPTIONS: -fc Filter HTTP status codes from response. Comma separated list of codes and ranges -fl Filter by amount of lines in response. Comma separated list of line counts and ranges -fr Filter regexp -fs Filter HTTP response size. Comma separated list of sizes and ranges -fw Filter by amount of words in response. Comma separated list of word counts and ranges INPUT OPTIONS: -D DirSearch wordlist compatibility mode. Used in conjunction with -e flag. (default: false) -e Comma separated list of extensions. Extends FUZZ keyword. -ic Ignore wordlist comments (default: false) -input-cmd Command producing the input. --input-num is required when using this input method. Overrides -w. -input-num Number of inputs to test. Used in conjunction with --input-cmd. (default: 100) -input-shell Shell to be used for running command -mode Multi-wordlist operation mode. Available modes: clusterbomb, pitchfork (default: clusterbomb) -request File containing the raw http request -request-proto Protocol to use along with raw request (default: https) -w Wordlist file path and (optional) keyword separated by colon. eg. '/path/to/wordlist:KEYWORD' OUTPUT OPTIONS: -debug-log Write all of the internal logging to the specified file. -o Write output to file -od Directory path to store matched results to. -of Output file format. Available formats: json, ejson, html, md, csv, ecsv (or, 'all' for all formats) (default: json) -or Don't create the output file if we don't have results (default: false) At a minimum we’re required to supply two options: -u to specify an URL and -w to specify a wordlist. The default keyword FUZZ is used to tell ffuf where the wordlist entries will be injected. We can append it to the end of the URL like so:\nffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/big.txt\nYou could also use any custom keyword instead of FUZZ, you just need to define it like this wordlist.txt:KEYWORD.\nffuf -u http://10.10.62.131/NORAJ -w /usr/share/seclists/Discovery/Web-Content/big.txt:NORAJ\n2.1 What is the first file you found with a 200 status code?\ncommand I ran:\nffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/big.txt /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 ________________________________________________ :: Method : GET :: URL : http://10.10.62.131/FUZZ :: Wordlist : FUZZ: Tools/wordlists/SecLists/Discovery/Web-Content/big.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ .htpasswd [Status: 403, Size: 288, Words: 21, Lines: 11] .htaccess [Status: 403, Size: 288, Words: 21, Lines: 11] config [Status: 301, Size: 312, Words: 20, Lines: 10] docs [Status: 301, Size: 310, Words: 20, Lines: 10] external [Status: 301, Size: 314, Words: 20, Lines: 10] [flag-here] [Status: 200, Size: 1406, Words: 5, Lines: 2] robots.txt [Status: 200, Size: 26, Words: 3, Lines: 2] server-status [Status: 403, Size: 292, Words: 21, Lines: 11] :: Progress: [20473/20473] :: Job [1/1] :: 3717 req/sec :: Duration: [0:00:10] :: Errors: 0 :: task 03: Finding pages and directories One approach you could take would be to start enumerating with a generic list of files such as raft-medium-files-lowercase.txt.\nffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt\nHowever, using a large generic wordlist containing irrelevant file extensions is not very efficient.\nInstead, we can usually assume index. is the default page on most websites so we can try common extensions for just the index page. With this method, we can usually determine what programming language or languages the site uses.\nFor example, we can append the extension after index.\nhead /usr/share/seclists/Discovery/Web-Content/web-extensions.txt .asp .aspx .bat .c .cfm .cgi .css .com .dll .exe ffuf -u http://10.10.62.131/indexFUZZ -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt\nNow that we know the extensions supported we can try a list of generic words (without of extension) and apply the extensions we know works (found from Q2) + some common ones like .txt.\nWe’ll exclude the 4 letter extensions from this wordlist as it will result in many false positives.\nffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -e .php,.txt\nDirectory names are not always dependent on the type of environment you’re enumerating and is often a good starting point before attempting to fuzz for files. If we wanted to fuzz directories we only need to provide a wordlist.\nffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt\n3.1 What text file did you find?\nffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-files-lowercase.txt /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 ...[snip]... robots.txt [Status: 200, Size: 26, Words: 3, Lines: 2] ...[snip]... 3.2 What two file extensions were found for the index page?\nffuf -u http://10.10.62.131/indexFUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/web-extensions.txt ...[snip]... ________________________________________________ .phps [Status: 403, Size: 289, Words: 21, Lines: 11] .php [Status: 302, Size: 0, Words: 1, Lines: 1] 3.3 What page has a size of 4840?\nffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-words-lowercase.txt -e .php,.txt /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 ________________________________________________ ...[snip]... about.php [Status: 200, Size: 4840, Words: 331, Lines: 109] ...[snip]... 3.4 How many directories are there?\nffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt ...[snip]... docs [Status: 301, Size: 310, Words: 20, Lines: 10] config [Status: 301, Size: 312, Words: 20, Lines: 10] external [Status: 301, Size: 314, Words: 20, Lines: 10] server-status [Status: 403, Size: 292, Words: 21, Lines: 11] ...[snip]... task 04: Using filters Remember the command we ran for Q1 of Task 3?\n$ ffuf -u http://MACHINE_IP/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1-dev ________________________________________________ :: Method : GET :: URL : http://10.10.130.176/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ favicon.ico [Status: 200, Size: 1406, Words: 5, Lines: 2] .htaccess [Status: 403, Size: 289, Words: 21, Lines: 11] logout.php [Status: 302, Size: 0, Words: 1, Lines: 1] robots.txt [Status: 200, Size: 26, Words: 3, Lines: 2] phpinfo.php [Status: 302, Size: 0, Words: 1, Lines: 1] . [Status: 302, Size: 0, Words: 1, Lines: 1] php.ini [Status: 200, Size: 148, Words: 17, Lines: 5] about.php [Status: 200, Size: 4840, Words: 331, Lines: 109] .html [Status: 403, Size: 285, Words: 21, Lines: 11] login.php [Status: 200, Size: 1523, Words: 89, Lines: 77] .php [Status: 403, Size: 284, Words: 21, Lines: 11] setup.php [Status: 200, Size: 4067, Words: 308, Lines: 123] .htpasswd [Status: 403, Size: 289, Words: 21, Lines: 11] security.php [Status: 302, Size: 0, Words: 1, Lines: 1] .htm [Status: 403, Size: 284, Words: 21, Lines: 11] .htpasswds [Status: 403, Size: 290, Words: 21, Lines: 11] index.php [Status: 302, Size: 0, Words: 1, Lines: 1] .htgroup [Status: 403, Size: 288, Words: 21, Lines: 11] wp-forum.phps [Status: 403, Size: 293, Words: 21, Lines: 11] .htaccess.bak [Status: 403, Size: 293, Words: 21, Lines: 11] .htuser [Status: 403, Size: 287, Words: 21, Lines: 11] .ht [Status: 403, Size: 283, Words: 21, Lines: 11] .htc [Status: 403, Size: 284, Words: 21, Lines: 11] :: Progress: [16243/16243] :: Job [1/1] :: 1690 req/sec :: Duration: [0:00:13] :: Errors: 0 :: We had a lot of output but not much was useful. For example, a 403 HTTP status code indicates that we’re forbidden to access the requested resource. Let’s hide responses with 403 status codes for now. We can accomplish this by using filters.\nBy adding -fc 403 (filter code) we’ll hide from the output all 403 HTTP status codes.\nq1\nffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fc 403\nSometimes you might want to filter out multiple status codes such as 500, 302, 301, 401, etc. For instance, if you know you want to see 200 status code responses, you could use -mc 200 (match code) instead of having a long list of filtered codes.\nQ2\nffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -mc 200\nSometimes it might be beneficial to see what requests the server doesn’t handle by matching for HTTP 500 Internal Server Error response codes (-mc 500). Finding irregularities in behavior could help better understand how the web app works.\nThere are other filters and matchers. For example, you could encounter entries with a 200 status code with a response size of zero. eg. functions.php or inc/myfile.php.\n$ ffuf -u http://MACHINE_IP/config/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fc 403 ... . [Status: 200, Size: 1165, Words: 76, Lines: 18] config.inc.php [Status: 200, Size: 0, Words: 1, Lines: 1] :: Progress: [16243/16243] :: Job [1/1] :: 1732 req/sec :: Duration: [0:00:13] :: Errors: 0 :: Unless we have a LFI (local file inclusion) this kind of files aren’t interesting, so we can use -fs 0 (filter size).\nHere are all filters and matchers:\n$ ffuf -h ... MATCHER OPTIONS: -mc Match HTTP status codes, or \"all\" for everything. (default: 200,204,301,302,307,401,403,405) -ml Match amount of lines in response -mr Match regexp -ms Match HTTP response size -mw Match amount of words in response FILTER OPTIONS: -fc Filter HTTP status codes from response. Comma separated list of codes and ranges -fl Filter by amount of lines in response. Comma separated list of line counts and ranges -fr Filter regexp -fs Filter HTTP response size. Comma separated list of sizes and ranges -fw Filter by amount of words in response. Comma separated list of word counts and ranges We often see there are false positives with files beginning with a dot (eg. .htgroups,.php, etc.). They throw a 403 Forbidden error, however those files don’t actually exist. It’s tempting to use -fc 403 but this could hide valuable files we don’t have access to yet. So instead we can use a regexp to match all files beginning with a dot\nQ3\nffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fr '/\\..*'\n4.1 After applying the fc filter, how many results were returned?\nffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fc 403 index.php [Status: 302, Size: 0, Words: 1, Lines: 1] favicon.ico [Status: 200, Size: 1406, Words: 5, Lines: 2] logout.php [Status: 302, Size: 0, Words: 1, Lines: 1] robots.txt [Status: 200, Size: 26, Words: 3, Lines: 2] phpinfo.php [Status: 302, Size: 0, Words: 1, Lines: 1] . [Status: 302, Size: 0, Words: 1, Lines: 1] php.ini [Status: 200, Size: 148, Words: 17, Lines: 5] about.php [Status: 200, Size: 4840, Words: 331, Lines: 109] login.php [Status: 200, Size: 1523, Words: 89, Lines: 77] setup.php [Status: 200, Size: 4066, Words: 308, Lines: 123] security.php [Status: 302, Size: 0, Words: 1, Lines: 1] :: Progress: [16243/16243] :: Job [1/1] :: 147 req/sec :: Duration: [0:00:04] :: Errors: 0 :: 4.2 After applying the mc filter, how many results were returned?\nffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-files-lowercase.txt -mc 200 favicon.ico [Status: 200, Size: 1406, Words: 5, Lines: 2] robots.txt [Status: 200, Size: 26, Words: 3, Lines: 2] php.ini [Status: 200, Size: 148, Words: 17, Lines: 5] about.php [Status: 200, Size: 4840, Words: 331, Lines: 109] setup.php [Status: 200, Size: 4066, Words: 308, Lines: 123] login.php [Status: 200, Size: 1523, Words: 89, Lines: 77] 4.3 Which valuable file would have been hidden if you used -fc 403 instead of -fr?\nffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists//Discovery/Web-Content/raft-medium-files-lowercase.txt -fr '/\\..*' /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 ________________________________________________ wp-forum.phps [Status: 403, Size: 292, Words: 21, Lines: 11] task 05: Fuzzing parameters Discovering a vulnerable parameter could lead to file inclusion, path disclosure, XSS, SQL injection, or even command injection. Since ffuf allows you to put the keyword anywhere we can use it to fuzz for parameters.\nCommand for Q1\n$ ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?FUZZ=1' -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -fw 39 $ ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?FUZZ=1' -c -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -fw 39 Now that we found a parameter accepting integer values we’ll start fuzzing values.\nAt this point, we could generate a wordlist and save a file containing integers. To cut out a step we can use -w - which tells ffuf to read a wordlist from stdout. This will allow us to generate a list of integers with a command of our choice then pipe the output to ffuf. Below is a list of 5 different ways to generate numbers 0 - 255.\nCommands for Q2\n$ ruby -e '(0..255).each{|i| puts i}' | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33 $ ruby -e 'puts (0..255).to_a' | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33 $ for i in {0..255}; do echo $i; done | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33 $ seq 0 255 | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33 $ cook '[0-255]' | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33 We can also use ffuf for wordlist-based brute-force attacks, for example, trying passwords on an authentication page.\nCommand for Q3\n$ ffuf -u http://10.10.71.46/sqli-labs/Less-11/ -c -w /usr/share/seclists/Passwords/Leaked-Databases/hak5.txt -X POST -d 'uname=Dummy\u0026passwd=FUZZ\u0026submit=Submit' -fs 1435 -H 'Content-Type: application/x-www-form-urlencoded' Here we have to use the POST method (specified with -X) and to give the POST data (with -d) where we include the FUZZ keyword in place of the password.\nWe also have to specify a custom header -H 'Content-Type: application/x-www-form-urlencoded' because ffuf doesn’t set this content-type header automatically as curl does.\n5.1 $ ffuf -u 'http://10.10.71.46/sqli-labs/Less-1/?FUZZ=1' -c -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-words-lowercase.txt -fw 39 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 ________________________________________________ id [Status: 200, Size: 721, Words: 37, Lines: 29] ________________________________________________ 5.2 What is the highest valid id?\nruby -e '(0..255).each{|i| puts i}' | ffuf -u 'http://10.10.71.46/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 ________________________________________________ 6 [Status: 200, Size: 728, Words: 37, Lines: 29] 12 [Status: 200, Size: 725, Words: 37, Lines: 29] 7 [Status: 200, Size: 725, Words: 37, Lines: 29] 8 [Status: 200, Size: 723, Words: 37, Lines: 29] 11 [Status: 200, Size: 725, Words: 37, Lines: 29] 10 [Status: 200, Size: 725, Words: 37, Lines: 29] 9 [Status: 200, Size: 725, Words: 37, Lines: 29] 5 [Status: 200, Size: 728, Words: 37, Lines: 29] 4 [Status: 200, Size: 725, Words: 37, Lines: 29] 3 [Status: 200, Size: 726, Words: 37, Lines: 29] 1 [Status: 200, Size: 721, Words: 37, Lines: 29] 2 [Status: 200, Size: 731, Words: 37, Lines: 29] 14 [Status: 200, Size: 725, Words: 37, Lines: 29] :: Progress: [256/256] :: Job [1/1] :: 16 req/sec :: Duration: [0:00:04] :: Errors: 0 :: ________________________________________________ 5.3 What is Dummy’s password?\n# ffuf -u http://10.10.71.46/sqli-labs/Less-11/ -c -w Tools/wordlists/SecLists/Passwords/Leaked-Databases/hak5.txt -X POST -d 'uname=Dummy\u0026passwd=FUZZ\u0026submit=Submit' -fs 1435 -H 'Content-Type: application/x-www-form-urlencoded' /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 ________________________________________________ p@ssword [Status: 200, Size: 1526, Words: 100, Lines: 50] :: Progress: [2351/2351] :: Job [1/1] :: 3743 req/sec :: Duration: [0:00:04] :: Errors: 0 :: ________________________________________________ task 06: Finding vhosts and subdomains ffuf may not be as efficient as specialized tools when it comes to subdomain enumeration but it’s possible to do.\nCommand for Q1\n$ ffuf -u http://FUZZ.tryhackme.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt\nSome subdomains might not be resolvable by the DNS server you’re using and are only resolvable from within the target’s local network by their private DNS servers. So some virtual hosts (vhosts) may exist with private subdomains so the previous command doesn’t find them. To try finding private subdomains we’ll have to use the Host HTTP header as these requests might be accepted by the web server. Note: virtual hosts (vhosts) is the name used by Apache httpd but for Nginx the right term is Server Blocks\nCompare the results you obtain with direct subdomain enumeration and with vhost enumeration:\nCommands for Q2\n$ ffuf -u http://FUZZ.google.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -fs 0 $ ffuf -u http://google.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H 'Host: FUZZ.google.com' -fs 0\nFor example there is a subdomain aol.google.com you can’t find it with direct subdomain enumeration (1st command) but that you can find with vhost enumeration (2nd command).\nWe can use drill or dig to find the IP address of the root domain:\n$ drill google.com ... google.com. 104 IN A 216.58.204.110 ... If you enter this domain directly in your web browser or with curl, you won’t be able to resolve it:\n$ curl https://aol.google.com curl: (6) Could not resolve host: aol.google.com But now if you add it in /etc/hosts or force the resolution with curl you’ll be able to browse it:\n$ curl --resolve aol.google.com:443:216.58.198.206 https://aol.google.com \u003c!doctype html\u003e","wordCount":"3760","inLanguage":"en","image":"https://classroom.anir0y.in/img/thm.gif","datePublished":"2021-07-17T02:49:02+05:30","dateModified":"2021-07-17T02:49:02+05:30","author":{"@type":"Person","name":"Animesh Roy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/tryhackme-ffuf/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https://classroom.anir0y.in/img/avatar.jpeg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://classroom.anir0y.in/ accesskey=h title="Classroom (Alt + H)"><img src=https://classroom.anir0y.in/img/avatar.jpeg alt aria-label=logo height=35>Classroom</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://classroom.anir0y.in/post/ title=Posts><span>Posts</span></a></li><li><a href=https://classroom.anir0y.in/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://classroom.anir0y.in/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://classroom.anir0y.in/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://classroom.anir0y.in/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://classroom.anir0y.in/about/me/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://classroom.anir0y.in/>Home</a>&nbsp;»&nbsp;<a href=https://classroom.anir0y.in/post/>Posts</a></div><h1 class="post-title entry-hint-parent">TryHackMe Ffuf</h1><div class=post-description>TryHackMe Room ffuf solved by Animesh Roy. this is a walkthough. ffuf stands for Fuzz Faster U Fool. It's a tool used for web enumeration, fuzzing, and directory brute forcing...</div><div class=post-meta><span title='2021-07-17 02:49:02 +0530 IST'>July 17, 2021</span>&nbsp;·&nbsp;<span>18 min</span>&nbsp;·&nbsp;<span>Animesh Roy</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/anir0y/classroom/tree/master/content/post/TryHackMe-ffuf.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><figure class=entry-cover><img loading=eager src=https://classroom.anir0y.in/img/thm.gif alt="cover image"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>overview</a></li><li><a href=#task-01-introduction>task 01: Introduction</a><ul><li><a href=#summary>Summary</a></li><li><a href=#install-ffuf>Install ffuf</a></li><li><a href=#install-seclists>Install SecLists</a></li></ul></li><li><a href=#task-02-basics>task 02: Basics</a><ul><li><a href=#21>2.1</a></li></ul></li><li><a href=#task-03-finding-pages-and-directories>task 03: Finding pages and directories</a><ul><li><a href=#31>3.1</a></li><li><a href=#32>3.2</a></li><li><a href=#33>3.3</a></li><li><a href=#34>3.4</a></li></ul></li><li><a href=#task-04-using-filters>task 04: Using filters</a><ul><li><a href=#41>4.1</a></li><li><a href=#42>4.2</a></li><li><a href=#43>4.3</a></li></ul></li><li><a href=#task-05-fuzzing-parameters>task 05: Fuzzing parameters</a><ul><li><a href=#51>5.1</a></li><li><a href=#52>5.2</a></li><li><a href=#53>5.3</a></li></ul></li><li><a href=#task-06-finding-vhosts-and-subdomains>task 06: Finding vhosts and subdomains</a><ul><li><a href=#61>6.1</a></li></ul></li><li><a href=#task-07-proxifying-ffuf-traffic>Task 07: Proxifying ffuf traffic</a></li><li><a href=#task-08-reviewing-the-options>Task 08: Reviewing the options</a><ul><li><a href=#81>8.1</a></li><li><a href=#82>8.2</a></li><li><a href=#83>8.3</a></li><li><a href=#84>8.4</a></li><li><a href=#85>8.5</a></li><li><a href=#86>8.6</a></li><li><a href=#87>8.7</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=overview>overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><table><thead><tr><th>fuff</th><th></th></tr></thead><tbody><tr><td></td><td><img alt=logo loading=lazy src=https://tryhackme-images.s3.amazonaws.com/room-icons/b197813dc74d88fa2a6df2c128ff155c.png></td></tr><tr><td>room</td><td><a href=https://tryhackme.com/room/ffuf>Link</a></td></tr></tbody></table><hr><h2 id=task-01-introduction>task 01: Introduction<a hidden class=anchor aria-hidden=true href=#task-01-introduction>#</a></h2><h3 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h3><p>ffuf stands for Fuzz Faster U Fool. It&rsquo;s a tool used for web enumeration, fuzzing, and directory brute forcing.</p><h3 id=install-ffuf>Install ffuf<a hidden class=anchor aria-hidden=true href=#install-ffuf>#</a></h3><p>ffuf is already included in the following Linux distributions:</p><ul><li>BlackArch</li><li>Pentoo</li><li>Kali</li><li>Parrot</li></ul><h3 id=install-seclists>Install SecLists<a hidden class=anchor aria-hidden=true href=#install-seclists>#</a></h3><p>SecLists is a collection of multiple types of lists used during security assessments. List types include usernames, passwords, URLs, sensitive data patterns, fuzzing payloads, web shells, and many more.</p><h2 id=task-02-basics>task 02: Basics<a hidden class=anchor aria-hidden=true href=#task-02-basics>#</a></h2><p>The Help page can be displayed using <code>ffuf -h</code> and it will be useful as we will use a lot of options.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Fuzz Faster U Fool - v1.3.0-dev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP OPTIONS:
</span></span><span class=line><span class=cl>  -H                  Header <span class=sb>`</span><span class=s2>&#34;Name: Value&#34;</span><span class=sb>`</span>, separated by colon. Multiple -H flags are accepted.
</span></span><span class=line><span class=cl>  -X                  HTTP method to use
</span></span><span class=line><span class=cl>  -b                  Cookie data <span class=sb>`</span><span class=s2>&#34;NAME1=VALUE1; NAME2=VALUE2&#34;</span><span class=sb>`</span> <span class=k>for</span> copy as curl functionality.
</span></span><span class=line><span class=cl>  -d                  POST data
</span></span><span class=line><span class=cl>  -ignore-body        Do not fetch the response content. <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -r                  Follow redirects <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -recursion          Scan recursively. Only FUZZ keyword is supported, and URL <span class=o>(</span>-u<span class=o>)</span> has to end in it. <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -recursion-depth    Maximum recursion depth. <span class=o>(</span>default: 0<span class=o>)</span>
</span></span><span class=line><span class=cl>  -recursion-strategy Recursion strategy: <span class=s2>&#34;default&#34;</span> <span class=k>for</span> a redirect based, and <span class=s2>&#34;greedy&#34;</span> to recurse on all matches <span class=o>(</span>default: default<span class=o>)</span>
</span></span><span class=line><span class=cl>  -replay-proxy       Replay matched requests using this proxy.
</span></span><span class=line><span class=cl>  -timeout            HTTP request timeout in seconds. <span class=o>(</span>default: 10<span class=o>)</span>
</span></span><span class=line><span class=cl>  -u                  Target URL
</span></span><span class=line><span class=cl>  -x                  Proxy URL <span class=o>(</span>SOCKS5 or HTTP<span class=o>)</span>. For example: http://127.0.0.1:8080 or socks5://127.0.0.1:8080
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>GENERAL OPTIONS:
</span></span><span class=line><span class=cl>  -V                  Show version information. <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -ac                 Automatically calibrate filtering options <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -acc                Custom auto-calibration string. Can be used multiple times. Implies -ac
</span></span><span class=line><span class=cl>  -c                  Colorize output. <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -config             Load configuration from a file
</span></span><span class=line><span class=cl>  -maxtime            Maximum running <span class=nb>time</span> in seconds <span class=k>for</span> entire process. <span class=o>(</span>default: 0<span class=o>)</span>
</span></span><span class=line><span class=cl>  -maxtime-job        Maximum running <span class=nb>time</span> in seconds per job. <span class=o>(</span>default: 0<span class=o>)</span>
</span></span><span class=line><span class=cl>  -p                  Seconds of <span class=sb>`</span>delay<span class=sb>`</span> between requests, or a range of random delay. For example <span class=s2>&#34;0.1&#34;</span> or <span class=s2>&#34;0.1-2.0&#34;</span>
</span></span><span class=line><span class=cl>  -rate               Rate of requests per second <span class=o>(</span>default: 0<span class=o>)</span>
</span></span><span class=line><span class=cl>  -s                  Do not print additional information <span class=o>(</span>silent mode<span class=o>)</span> <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -sa                 Stop on all error cases. Implies -sf and -se. <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -se                 Stop on spurious errors <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -sf                 Stop when &gt; 95% of responses <span class=k>return</span> <span class=m>403</span> Forbidden <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -t                  Number of concurrent threads. <span class=o>(</span>default: 40<span class=o>)</span>
</span></span><span class=line><span class=cl>  -v                  Verbose output, printing full URL and redirect location <span class=o>(</span><span class=k>if</span> any<span class=o>)</span> with the results. <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>MATCHER OPTIONS:
</span></span><span class=line><span class=cl>  -mc                 Match HTTP status codes, or <span class=s2>&#34;all&#34;</span> <span class=k>for</span> everything. <span class=o>(</span>default: 200,204,301,302,307,401,403,405<span class=o>)</span>
</span></span><span class=line><span class=cl>  -ml                 Match amount of lines in response
</span></span><span class=line><span class=cl>  -mr                 Match regexp
</span></span><span class=line><span class=cl>  -ms                 Match HTTP response size
</span></span><span class=line><span class=cl>  -mw                 Match amount of words in response
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>FILTER OPTIONS:
</span></span><span class=line><span class=cl>  -fc                 Filter HTTP status codes from response. Comma separated list of codes and ranges
</span></span><span class=line><span class=cl>  -fl                 Filter by amount of lines in response. Comma separated list of line counts and ranges
</span></span><span class=line><span class=cl>  -fr                 Filter regexp
</span></span><span class=line><span class=cl>  -fs                 Filter HTTP response size. Comma separated list of sizes and ranges
</span></span><span class=line><span class=cl>  -fw                 Filter by amount of words in response. Comma separated list of word counts and ranges
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>INPUT OPTIONS:
</span></span><span class=line><span class=cl>  -D                  DirSearch wordlist compatibility mode. Used in conjunction with -e flag. <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -e                  Comma separated list of extensions. Extends FUZZ keyword.
</span></span><span class=line><span class=cl>  -ic                 Ignore wordlist comments <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -input-cmd          Command producing the input. --input-num is required when using this input method. Overrides -w.
</span></span><span class=line><span class=cl>  -input-num          Number of inputs to test. Used in conjunction with --input-cmd. <span class=o>(</span>default: 100<span class=o>)</span>
</span></span><span class=line><span class=cl>  -input-shell        Shell to be used <span class=k>for</span> running <span class=nb>command</span>
</span></span><span class=line><span class=cl>  -mode               Multi-wordlist operation mode. Available modes: clusterbomb, pitchfork <span class=o>(</span>default: clusterbomb<span class=o>)</span>
</span></span><span class=line><span class=cl>  -request            File containing the raw http request
</span></span><span class=line><span class=cl>  -request-proto      Protocol to use along with raw request <span class=o>(</span>default: https<span class=o>)</span>
</span></span><span class=line><span class=cl>  -w                  Wordlist file path and <span class=o>(</span>optional<span class=o>)</span> keyword separated by colon. eg. <span class=s1>&#39;/path/to/wordlist:KEYWORD&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OUTPUT OPTIONS:
</span></span><span class=line><span class=cl>  -debug-log          Write all of the internal logging to the specified file.
</span></span><span class=line><span class=cl>  -o                  Write output to file
</span></span><span class=line><span class=cl>  -od                 Directory path to store matched results to.
</span></span><span class=line><span class=cl>  -of                 Output file format. Available formats: json, ejson, html, md, csv, ecsv <span class=o>(</span>or, <span class=s1>&#39;all&#39;</span> <span class=k>for</span> all formats<span class=o>)</span> <span class=o>(</span>default: json<span class=o>)</span>
</span></span><span class=line><span class=cl>  -or                 Don<span class=s1>&#39;t create the output file if we don&#39;</span>t have results <span class=o>(</span>default: <span class=nb>false</span><span class=o>)</span>
</span></span></code></pre></div><p>At a minimum we&rsquo;re required to supply two options: -u to specify an URL and -w to specify a wordlist. The default keyword FUZZ is used to tell ffuf where the wordlist entries will be injected. We can append it to the end of the URL like so:</p><p><code>ffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/big.txt</code></p><p>You could also use any custom keyword instead of <code>FUZZ</code>, you just need to define it like this <code>wordlist.txt:KEYWORD</code>.</p><p><code>ffuf -u http://10.10.62.131/NORAJ -w /usr/share/seclists/Discovery/Web-Content/big.txt:NORAJ</code></p><h3 id=21>2.1<a hidden class=anchor aria-hidden=true href=#21>#</a></h3><p>What is the first file you found with a 200 status code?</p><p>command I ran:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/big.txt 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> :: Method           : GET
</span></span><span class=line><span class=cl> :: URL              : http://10.10.62.131/FUZZ
</span></span><span class=line><span class=cl> :: Wordlist         : FUZZ: Tools/wordlists/SecLists/Discovery/Web-Content/big.txt
</span></span><span class=line><span class=cl> :: Follow redirects : <span class=nb>false</span>
</span></span><span class=line><span class=cl> :: Calibration      : <span class=nb>false</span>
</span></span><span class=line><span class=cl> :: Timeout          : <span class=m>10</span>
</span></span><span class=line><span class=cl> :: Threads          : <span class=m>40</span>
</span></span><span class=line><span class=cl> :: Matcher          : Response status: 200,204,301,302,307,401,403,405
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.htpasswd               <span class=o>[</span>Status: 403, Size: 288, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>.htaccess               <span class=o>[</span>Status: 403, Size: 288, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>config                  <span class=o>[</span>Status: 301, Size: 312, Words: 20, Lines: 10<span class=o>]</span>
</span></span><span class=line><span class=cl>docs                    <span class=o>[</span>Status: 301, Size: 310, Words: 20, Lines: 10<span class=o>]</span>
</span></span><span class=line><span class=cl>external                <span class=o>[</span>Status: 301, Size: 314, Words: 20, Lines: 10<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>flag-here<span class=o>]</span>             <span class=o>[</span>Status: 200, Size: 1406, Words: 5, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>robots.txt              <span class=o>[</span>Status: 200, Size: 26, Words: 3, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>server-status           <span class=o>[</span>Status: 403, Size: 292, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>:: Progress: <span class=o>[</span>20473/20473<span class=o>]</span> :: Job <span class=o>[</span>1/1<span class=o>]</span> :: <span class=m>3717</span> req/sec :: Duration: <span class=o>[</span>0:00:10<span class=o>]</span> :: Errors: <span class=m>0</span> ::
</span></span></code></pre></div><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr><h2 id=task-03-finding-pages-and-directories>task 03: Finding pages and directories<a hidden class=anchor aria-hidden=true href=#task-03-finding-pages-and-directories>#</a></h2><p>One approach you could take would be to start enumerating with a generic list of files such as raft-medium-files-lowercase.txt.</p><blockquote><p><code>ffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt</code></p></blockquote><p>However, using a large generic wordlist containing irrelevant file extensions is not very efficient.</p><p>Instead, we can usually assume <code>index.&lt;extension></code> is the default page on most websites so we can try common extensions for just the index page. With this method, we can usually determine what programming language or languages the site uses.</p><p>For example, we can append the extension after index.</p><pre tabindex=0><code>head /usr/share/seclists/Discovery/Web-Content/web-extensions.txt                                                            
.asp
.aspx
.bat
.c
.cfm
.cgi
.css
.com
.dll
.exe
</code></pre><blockquote><p><code>ffuf -u http://10.10.62.131/indexFUZZ -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt</code></p></blockquote><p>Now that we know the extensions supported we can try a list of generic words (without of extension) and apply the extensions we know works (found from Q2) + some common ones like <code>.txt</code>.</p><p>We&rsquo;ll exclude the 4 letter extensions from this wordlist as it will result in many false positives.</p><blockquote><p><code>ffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -e .php,.txt</code></p></blockquote><p>Directory names are not always dependent on the type of environment you&rsquo;re enumerating and is often a good starting point before attempting to fuzz for files. If we wanted to fuzz directories we only need to provide a wordlist.</p><blockquote><p><code>ffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt</code></p></blockquote><h3 id=31>3.1<a hidden class=anchor aria-hidden=true href=#31>#</a></h3><p>What text file did you find?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-files-lowercase.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1
</span></span><span class=line><span class=cl>...<span class=o>[</span>snip<span class=o>]</span>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>robots.txt              <span class=o>[</span>Status: 200, Size: 26, Words: 3, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>...<span class=o>[</span>snip<span class=o>]</span>...
</span></span></code></pre></div><h3 id=32>3.2<a hidden class=anchor aria-hidden=true href=#32>#</a></h3><p>What two file extensions were found for the index page?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.10.62.131/indexFUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/web-extensions.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...<span class=o>[</span>snip<span class=o>]</span>...
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.phps                   <span class=o>[</span>Status: 403, Size: 289, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>.php                    <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span></code></pre></div><h3 id=33>3.3<a hidden class=anchor aria-hidden=true href=#33>#</a></h3><p>What page has a size of 4840?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-words-lowercase.txt -e .php,.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...<span class=o>[</span>snip<span class=o>]</span>...
</span></span><span class=line><span class=cl>about.php               <span class=o>[</span>Status: 200, Size: 4840, Words: 331, Lines: 109<span class=o>]</span>
</span></span><span class=line><span class=cl>...<span class=o>[</span>snip<span class=o>]</span>...
</span></span></code></pre></div><h3 id=34>3.4<a hidden class=anchor aria-hidden=true href=#34>#</a></h3><p>How many directories are there?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
</span></span><span class=line><span class=cl>...<span class=o>[</span>snip<span class=o>]</span>...
</span></span><span class=line><span class=cl>docs                    <span class=o>[</span>Status: 301, Size: 310, Words: 20, Lines: 10<span class=o>]</span>
</span></span><span class=line><span class=cl>config                  <span class=o>[</span>Status: 301, Size: 312, Words: 20, Lines: 10<span class=o>]</span>
</span></span><span class=line><span class=cl>external                <span class=o>[</span>Status: 301, Size: 314, Words: 20, Lines: 10<span class=o>]</span>
</span></span><span class=line><span class=cl>server-status           <span class=o>[</span>Status: 403, Size: 292, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>...<span class=o>[</span>snip<span class=o>]</span>...
</span></span></code></pre></div><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr><h2 id=task-04-using-filters>task 04: Using filters<a hidden class=anchor aria-hidden=true href=#task-04-using-filters>#</a></h2><p>Remember the command we ran for Q1 of Task 3?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>$ ffuf -u http://MACHINE_IP/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\
</span></span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\
</span></span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\
</span></span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1-dev
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> :: Method           : GET
</span></span><span class=line><span class=cl> :: URL              : http://10.10.130.176/FUZZ
</span></span><span class=line><span class=cl> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt
</span></span><span class=line><span class=cl> :: Follow redirects : <span class=nb>false</span>
</span></span><span class=line><span class=cl> :: Calibration      : <span class=nb>false</span>
</span></span><span class=line><span class=cl> :: Timeout          : <span class=m>10</span>
</span></span><span class=line><span class=cl> :: Threads          : <span class=m>40</span>
</span></span><span class=line><span class=cl> :: Matcher          : Response status: 200,204,301,302,307,401,403,405
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>favicon.ico             <span class=o>[</span>Status: 200, Size: 1406, Words: 5, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>.htaccess               <span class=o>[</span>Status: 403, Size: 289, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>logout.php              <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>robots.txt              <span class=o>[</span>Status: 200, Size: 26, Words: 3, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>phpinfo.php             <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>.                       <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>php.ini                 <span class=o>[</span>Status: 200, Size: 148, Words: 17, Lines: 5<span class=o>]</span>
</span></span><span class=line><span class=cl>about.php               <span class=o>[</span>Status: 200, Size: 4840, Words: 331, Lines: 109<span class=o>]</span>
</span></span><span class=line><span class=cl>.html                   <span class=o>[</span>Status: 403, Size: 285, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>login.php               <span class=o>[</span>Status: 200, Size: 1523, Words: 89, Lines: 77<span class=o>]</span>
</span></span><span class=line><span class=cl>.php                    <span class=o>[</span>Status: 403, Size: 284, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>setup.php               <span class=o>[</span>Status: 200, Size: 4067, Words: 308, Lines: 123<span class=o>]</span>
</span></span><span class=line><span class=cl>.htpasswd               <span class=o>[</span>Status: 403, Size: 289, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>security.php            <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>.htm                    <span class=o>[</span>Status: 403, Size: 284, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>.htpasswds              <span class=o>[</span>Status: 403, Size: 290, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>index.php               <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>.htgroup                <span class=o>[</span>Status: 403, Size: 288, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>wp-forum.phps           <span class=o>[</span>Status: 403, Size: 293, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>.htaccess.bak           <span class=o>[</span>Status: 403, Size: 293, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>.htuser                 <span class=o>[</span>Status: 403, Size: 287, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>.ht                     <span class=o>[</span>Status: 403, Size: 283, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>.htc                    <span class=o>[</span>Status: 403, Size: 284, Words: 21, Lines: 11<span class=o>]</span>
</span></span><span class=line><span class=cl>:: Progress: <span class=o>[</span>16243/16243<span class=o>]</span> :: Job <span class=o>[</span>1/1<span class=o>]</span> :: <span class=m>1690</span> req/sec :: Duration: <span class=o>[</span>0:00:13<span class=o>]</span> :: Errors: <span class=m>0</span> ::
</span></span></code></pre></div><p>We had a lot of output but not much was useful.
For example, a 403 HTTP status code indicates that we&rsquo;re forbidden to access the requested resource. Let&rsquo;s hide responses with 403 status codes for now. We can accomplish this by using filters.</p><p>By adding <code>-fc 403</code> (filter code) we&rsquo;ll hide from the output all 403 HTTP status codes.</p><blockquote><p>q1</p><p><code>ffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fc 403</code></p></blockquote><p>Sometimes you might want to filter out multiple status codes such as 500, 302, 301, 401, etc. For instance, if you know you want to see 200 status code responses, you could use <code>-mc 200</code> (match code) instead of having a long list of filtered codes.</p><blockquote><p>Q2</p><p><code>ffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -mc 200</code></p></blockquote><p>Sometimes it might be beneficial to see what requests the server doesn&rsquo;t handle by matching for HTTP 500 Internal Server Error response codes (<code>-mc 500</code>). Finding irregularities in behavior could help better understand how the web app works.</p><p>There are other filters and matchers. For example, you could encounter entries with a 200 status code with a response size of zero. eg. <code>functions.php</code> or <code>inc/myfile.php</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>$ ffuf -u http://MACHINE_IP/config/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fc <span class=m>403</span>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>.                       <span class=o>[</span>Status: 200, Size: 1165, Words: 76, Lines: 18<span class=o>]</span>
</span></span><span class=line><span class=cl>config.inc.php          <span class=o>[</span>Status: 200, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>:: Progress: <span class=o>[</span>16243/16243<span class=o>]</span> :: Job <span class=o>[</span>1/1<span class=o>]</span> :: <span class=m>1732</span> req/sec :: Duration: <span class=o>[</span>0:00:13<span class=o>]</span> :: Errors: <span class=m>0</span> ::
</span></span></code></pre></div><p>Unless we have a LFI (local file inclusion) this kind of files aren&rsquo;t interesting, so we can use <code>-fs 0</code> (filter size).</p><p>Here are all filters and matchers:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ffuf -h
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>MATCHER OPTIONS:
</span></span><span class=line><span class=cl>  -mc                 Match HTTP status codes, or <span class=s2>&#34;all&#34;</span> <span class=k>for</span> everything. <span class=o>(</span>default: 200,204,301,302,307,401,403,405<span class=o>)</span>
</span></span><span class=line><span class=cl>  -ml                 Match amount of lines in response
</span></span><span class=line><span class=cl>  -mr                 Match regexp
</span></span><span class=line><span class=cl>  -ms                 Match HTTP response size
</span></span><span class=line><span class=cl>  -mw                 Match amount of words in response
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>FILTER OPTIONS:
</span></span><span class=line><span class=cl>  -fc                 Filter HTTP status codes from response. Comma separated list of codes and ranges
</span></span><span class=line><span class=cl>  -fl                 Filter by amount of lines in response. Comma separated list of line counts and ranges
</span></span><span class=line><span class=cl>  -fr                 Filter regexp
</span></span><span class=line><span class=cl>  -fs                 Filter HTTP response size. Comma separated list of sizes and ranges
</span></span><span class=line><span class=cl>  -fw                 Filter by amount of words in response. Comma separated list of word counts and ranges
</span></span></code></pre></div><p>We often see there are false positives with files beginning with a dot (eg. .htgroups,.php, etc.). They throw a 403 Forbidden error, however those files don&rsquo;t actually exist. It&rsquo;s tempting to use <code>-fc 403</code> but this could hide valuable files we don&rsquo;t have access to yet. So instead we can use a regexp to match all files beginning with a dot</p><blockquote><p>Q3</p><p><code>ffuf -u http://10.10.62.131/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fr '/\..*'</code></p></blockquote><h3 id=41>4.1<a hidden class=anchor aria-hidden=true href=#41>#</a></h3><p>After applying the fc filter, how many results were returned?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>ffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fc <span class=m>403</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>index.php               <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>favicon.ico             <span class=o>[</span>Status: 200, Size: 1406, Words: 5, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>logout.php              <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>robots.txt              <span class=o>[</span>Status: 200, Size: 26, Words: 3, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>phpinfo.php             <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>.                       <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>php.ini                 <span class=o>[</span>Status: 200, Size: 148, Words: 17, Lines: 5<span class=o>]</span>
</span></span><span class=line><span class=cl>about.php               <span class=o>[</span>Status: 200, Size: 4840, Words: 331, Lines: 109<span class=o>]</span>
</span></span><span class=line><span class=cl>login.php               <span class=o>[</span>Status: 200, Size: 1523, Words: 89, Lines: 77<span class=o>]</span>
</span></span><span class=line><span class=cl>setup.php               <span class=o>[</span>Status: 200, Size: 4066, Words: 308, Lines: 123<span class=o>]</span>
</span></span><span class=line><span class=cl>security.php            <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1<span class=o>]</span>
</span></span><span class=line><span class=cl>:: Progress: <span class=o>[</span>16243/16243<span class=o>]</span> :: Job <span class=o>[</span>1/1<span class=o>]</span> :: <span class=m>147</span> req/sec :: Duration: <span class=o>[</span>0:00:04<span class=o>]</span> :: Errors: <span class=m>0</span> ::
</span></span></code></pre></div><h3 id=42>4.2<a hidden class=anchor aria-hidden=true href=#42>#</a></h3><p>After applying the mc filter, how many results were returned?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>ffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-files-lowercase.txt -mc <span class=m>200</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>favicon.ico             <span class=o>[</span>Status: 200, Size: 1406, Words: 5, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>robots.txt              <span class=o>[</span>Status: 200, Size: 26, Words: 3, Lines: 2<span class=o>]</span>
</span></span><span class=line><span class=cl>php.ini                 <span class=o>[</span>Status: 200, Size: 148, Words: 17, Lines: 5<span class=o>]</span>
</span></span><span class=line><span class=cl>about.php               <span class=o>[</span>Status: 200, Size: 4840, Words: 331, Lines: 109<span class=o>]</span>
</span></span><span class=line><span class=cl>setup.php               <span class=o>[</span>Status: 200, Size: 4066, Words: 308, Lines: 123<span class=o>]</span>
</span></span><span class=line><span class=cl>login.php               <span class=o>[</span>Status: 200, Size: 1523, Words: 89, Lines: 77<span class=o>]</span>
</span></span></code></pre></div><h3 id=43>4.3<a hidden class=anchor aria-hidden=true href=#43>#</a></h3><p>Which valuable file would have been hidden if you used -fc 403 instead of -fr?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>ffuf -u http://10.10.62.131/FUZZ -w Tools/wordlists/SecLists//Discovery/Web-Content/raft-medium-files-lowercase.txt -fr <span class=s1>&#39;/\..*&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>wp-forum.phps           <span class=o>[</span>Status: 403, Size: 292, Words: 21, Lines: 11<span class=o>]</span>
</span></span></code></pre></div><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr><h2 id=task-05-fuzzing-parameters>task 05: Fuzzing parameters<a hidden class=anchor aria-hidden=true href=#task-05-fuzzing-parameters>#</a></h2><p>Discovering a vulnerable parameter could lead to file inclusion, path disclosure, XSS, SQL injection, or even command injection. Since ffuf allows you to put the keyword anywhere we can use it to fuzz for parameters.</p><blockquote><p>Command for Q1</p></blockquote><pre><code> $ ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?FUZZ=1' -c -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -fw 39
 $ ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?FUZZ=1' -c -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -fw 39
</code></pre><p>Now that we found a parameter accepting integer values we&rsquo;ll start fuzzing values.</p><p>At this point, we could generate a wordlist and save a file containing integers. To cut out a step we can use -w - which tells ffuf to read a wordlist from stdout. This will allow us to generate a list of integers with a command of our choice then pipe the output to ffuf. Below is a list of 5 different ways to generate numbers 0 - 255.</p><blockquote><p>Commands for Q2</p></blockquote><pre><code> $ ruby -e '(0..255).each{|i| puts i}' | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33
 $ ruby -e 'puts (0..255).to_a' | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33
 $ for i in {0..255}; do echo $i; done | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33
 $ seq 0 255 | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33
 $ cook '[0-255]' | ffuf -u 'http://MACHINE_IP/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33
</code></pre><p>We can also use ffuf for wordlist-based brute-force attacks, for example, trying passwords on an authentication page.</p><blockquote><p>Command for Q3</p></blockquote><pre><code> $ ffuf -u http://10.10.71.46/sqli-labs/Less-11/ -c -w /usr/share/seclists/Passwords/Leaked-Databases/hak5.txt -X POST -d 'uname=Dummy&amp;passwd=FUZZ&amp;submit=Submit' -fs 1435 -H 'Content-Type: application/x-www-form-urlencoded'
</code></pre><p>Here we have to use the POST method (specified with <code>-X</code>) and to give the POST data (with <code>-d</code>) where we include the <code>FUZZ</code> keyword in place of the password.</p><p>We also have to specify a custom header<code> -H 'Content-Type: application/x-www-form-urlencoded'</code> because ffuf doesn&rsquo;t set this content-type header automatically as curl does.</p><h3 id=51>5.1<a hidden class=anchor aria-hidden=true href=#51>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ffuf -u <span class=s1>&#39;http://10.10.71.46/sqli-labs/Less-1/?FUZZ=1&#39;</span> -c -w Tools/wordlists/SecLists/Discovery/Web-Content/raft-medium-words-lowercase.txt -fw <span class=m>39</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>id                      <span class=o>[</span>Status: 200, Size: 721, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl>________________________________________________
</span></span></code></pre></div><h3 id=52>5.2<a hidden class=anchor aria-hidden=true href=#52>#</a></h3><p>What is the highest valid id?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ruby -e <span class=s1>&#39;(0..255).each{|i| puts i}&#39;</span> <span class=p>|</span> ffuf -u <span class=s1>&#39;http://10.10.71.46/sqli-labs/Less-1/?id=FUZZ&#39;</span> -c -w - -fw <span class=m>33</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>6</span>                       <span class=o>[</span>Status: 200, Size: 728, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>12</span>                      <span class=o>[</span>Status: 200, Size: 725, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>7</span>                       <span class=o>[</span>Status: 200, Size: 725, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>8</span>                       <span class=o>[</span>Status: 200, Size: 723, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>11</span>                      <span class=o>[</span>Status: 200, Size: 725, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>10</span>                      <span class=o>[</span>Status: 200, Size: 725, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>9</span>                       <span class=o>[</span>Status: 200, Size: 725, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>5</span>                       <span class=o>[</span>Status: 200, Size: 728, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>4</span>                       <span class=o>[</span>Status: 200, Size: 725, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>3</span>                       <span class=o>[</span>Status: 200, Size: 726, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>1</span>                       <span class=o>[</span>Status: 200, Size: 721, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>2</span>                       <span class=o>[</span>Status: 200, Size: 731, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>14</span>                      <span class=o>[</span>Status: 200, Size: 725, Words: 37, Lines: 29<span class=o>]</span>
</span></span><span class=line><span class=cl>:: Progress: <span class=o>[</span>256/256<span class=o>]</span> :: Job <span class=o>[</span>1/1<span class=o>]</span> :: <span class=m>16</span> req/sec :: Duration: <span class=o>[</span>0:00:04<span class=o>]</span> :: Errors: <span class=m>0</span> ::
</span></span><span class=line><span class=cl>________________________________________________
</span></span></code></pre></div><h3 id=53>5.3<a hidden class=anchor aria-hidden=true href=#53>#</a></h3><p>What is Dummy&rsquo;s password?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ffuf -u http://10.10.71.46/sqli-labs/Less-11/ -c -w Tools/wordlists/SecLists/Passwords/Leaked-Databases/hak5.txt -X POST -d &#39;uname=Dummy&amp;passwd=FUZZ&amp;submit=Submit&#39; -fs 1435 -H &#39;Content-Type: application/x-www-form-urlencoded&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>p@ssword                <span class=o>[</span>Status: 200, Size: 1526, Words: 100, Lines: 50<span class=o>]</span>
</span></span><span class=line><span class=cl>:: Progress: <span class=o>[</span>2351/2351<span class=o>]</span> :: Job <span class=o>[</span>1/1<span class=o>]</span> :: <span class=m>3743</span> req/sec :: Duration: <span class=o>[</span>0:00:04<span class=o>]</span> :: Errors: <span class=m>0</span> ::
</span></span><span class=line><span class=cl>________________________________________________
</span></span></code></pre></div><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr><h2 id=task-06-finding-vhosts-and-subdomains>task 06: Finding vhosts and subdomains<a hidden class=anchor aria-hidden=true href=#task-06-finding-vhosts-and-subdomains>#</a></h2><p>ffuf may not be as efficient as specialized tools when it comes to subdomain enumeration but it&rsquo;s possible to do.</p><blockquote><p>Command for Q1</p><p><code>$ ffuf -u http://FUZZ.tryhackme.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt</code></p></blockquote><p>Some subdomains might not be resolvable by the DNS server you&rsquo;re using and are only resolvable from within the target&rsquo;s local network by their private DNS servers. So some virtual hosts (vhosts) may exist with private subdomains so the previous command doesn&rsquo;t find them. To try finding private subdomains we&rsquo;ll have to use the Host HTTP header as these requests might be accepted by the web server.
Note: virtual hosts (vhosts) is the name used by Apache httpd but for Nginx the right term is Server Blocks</p><p>Compare the results you obtain with direct subdomain enumeration and with vhost enumeration:</p><blockquote><p>Commands for Q2</p><p><code>$ ffuf -u http://FUZZ.google.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -fs 0</code>
<code>$ ffuf -u http://google.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H 'Host: FUZZ.google.com' -fs 0</code></p></blockquote><p>For example there is a subdomain aol.google.com you can&rsquo;t find it with direct subdomain enumeration (1st command) but that you can find with vhost enumeration (2nd command).</p><p>We can use drill or dig to find the IP address of the root domain:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ drill google.com
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>google.com.     <span class=m>104</span>     IN      A       216.58.204.110
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>If you enter this domain directly in your web browser or with curl, you won&rsquo;t be able to resolve it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl https://aol.google.com
</span></span><span class=line><span class=cl>curl: <span class=o>(</span>6<span class=o>)</span> Could not resolve host: aol.google.com
</span></span></code></pre></div><p>But now if you add it in <code>/etc/hosts</code> or force the resolution with curl you&rsquo;ll be able to browse it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>$ curl --resolve aol.google.com:443:216.58.198.206 https://aol.google.com
</span></span><span class=line><span class=cl>&lt;!doctype html&gt;&lt;html <span class=nv>itemscope</span><span class=o>=</span><span class=s2>&#34;&#34;</span> <span class=nv>itemtype</span><span class=o>=</span><span class=s2>&#34;http://schema.org/WebPage&#34;</span> <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;fr&#34;</span>&gt;
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>Here the aol subdomain is not very interesting as it&rsquo;s an alias for <a href=https://www.google.com>www.google.com</a> and other subdomains are redirecting aliases. However, you shouldn&rsquo;t discount this enumeration technique as it may lead to discovering content that wasn&rsquo;t meant to be accessed externally.</p><h3 id=61>6.1<a hidden class=anchor aria-hidden=true href=#61>#</a></h3><p>What is THMs private CDN subdomain?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ffuf -u http://FUZZ.tryhackme.com -c -w Tools/wordlists/SecLists//Discovery/DNS/subdomains-top1million-5000.txt </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.1
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>assets                  <span class=o>[</span>Status: 301, Size: 183, Words: 6, Lines: 8<span class=o>]</span>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>________________________________________________
</span></span></code></pre></div><p>What is the private domain you can find with vhost enumeration but not with direct subdomain enumeration?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># based on Hint, google.com is the domain to scan</span>
</span></span><span class=line><span class=cl><span class=c1># ffuf -u http://FUZZ.google.com -c -w Tools/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -fs 0 -v </span>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>dev                   <span class=o>[</span>Status: 301, Size: 223, Words: 9, Lines: 7<span class=o>]</span>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><hr><h2 id=task-07-proxifying-ffuf-traffic>Task 07: Proxifying ffuf traffic<a hidden class=anchor aria-hidden=true href=#task-07-proxifying-ffuf-traffic>#</a></h2><p>Whether it&rsquo; for <a href=https://blog.raw.pm/en/state-of-the-art-of-network-pivoting-in-2019/>network pivoting</a> or for using BurpSuite plugins you can send all the ffuf traffic through a web proxy (HTTP or SOCKS5).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.10.71.46/ -c -w /usr/share/seclists/Discovery/Web-Content/common.txt -x http://127.0.0.1:8080
</span></span></code></pre></div><p>It&rsquo;s also possible to send only matches to your proxy for replaying:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>ffuf -u http://FUZZ.tryhackme.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -replay-proxy http://127.0.0.1:8080
</span></span></code></pre></div><hr><h2 id=task-08-reviewing-the-options>Task 08: Reviewing the options<a hidden class=anchor aria-hidden=true href=#task-08-reviewing-the-options>#</a></h2><p>As you start to use ffuf more, some options will prove to be very useful depending on your situation. For example, <code>-ic</code> allows you to ignore comments in wordlists that such as headers, copyright notes, comments, etc</p><pre tabindex=0><code class=language-powrshell data-lang=powrshell>$ head /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt                                                            
# directory-list-2.3-medium.txt
#
# Copyright 2007 James Fisher
#
# This work is licensed under the Creative Commons
# Attribution-Share Alike 3.0 License. To view a copy of this
# license, visit http://creativecommons.org/licenses/by-sa/3.0/
# or send a letter to Creative Commons, 171 Second Street,
# Suite 300, San Francisco, California, 94105, USA.
#
</code></pre><p><code>ffuf -u http://10.10.71.46/FUZZ -c -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -ic -fs 0</code></p><p>We&rsquo;ve only reviewed a small subset of the useful features and options ffuf has to offer for fuzzing.
Use <code>ffuf -h</code> to discover the other options that might be useful for you and to answer the remaining questions in this task</p><h3 id=81>8.1<a hidden class=anchor aria-hidden=true href=#81>#</a></h3><p>How do you save the output to a markdown file (ffuf.md)?</p><pre><code> of md -o ffuf.md
</code></pre><h3 id=82>8.2<a hidden class=anchor aria-hidden=true href=#82>#</a></h3><p>How do you re-use a raw http request file?</p><pre><code> -request
</code></pre><h3 id=83>8.3<a hidden class=anchor aria-hidden=true href=#83>#</a></h3><p>How do you strip comments from a wordlist?</p><pre><code> -ic
</code></pre><h3 id=84>8.4<a hidden class=anchor aria-hidden=true href=#84>#</a></h3><p>How would you read a wordlist from STDIN?</p><pre><code> -w -
</code></pre><h3 id=85>8.5<a hidden class=anchor aria-hidden=true href=#85>#</a></h3><p>How do you print full URLs and redirect locations?</p><pre><code> -v
</code></pre><h3 id=86>8.6<a hidden class=anchor aria-hidden=true href=#86>#</a></h3><p>What option would you use to follow redirects?</p><pre><code> -r
</code></pre><h3 id=87>8.7<a hidden class=anchor aria-hidden=true href=#87>#</a></h3><p>How do you enable colorized output?</p><pre><code> -c
</code></pre><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=anir0y data-description="Support me on Buy me a coffee!" data-message data-color=#5F7FFF data-position=Right data-x_margin=18 data-y_margin=18></script></div><footer class=post-footer><ul class=post-tags><li><a href=https://classroom.anir0y.in/tags/tryhackme/>Tryhackme</a></li><li><a href=https://classroom.anir0y.in/tags/rooms/>Rooms</a></li><li><a href=https://classroom.anir0y.in/tags/thm/>Thm</a></li><li><a href=https://classroom.anir0y.in/tags/ffuf/>Ffuf</a></li></ul><nav class=paginav><a class=prev href=https://classroom.anir0y.in/post/tryhackme-linuxfunctionhooking/><span class=title>« Prev</span><br><span>TryHackMe Linux Function Hooking</span>
</a><a class=next href=https://classroom.anir0y.in/post/tryhackme-rpwebscanning/><span class=title>Next »</span><br><span>Try Hack Me Web Scanning</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Ffuf on x" href="https://x.com/intent/tweet/?text=TryHackMe%20Ffuf&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-ffuf%2f&amp;hashtags=tryhackme%2crooms%2cthm%2cffuf"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Ffuf on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-ffuf%2f&amp;title=TryHackMe%20Ffuf&amp;summary=TryHackMe%20Ffuf&amp;source=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-ffuf%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Ffuf on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-ffuf%2f&title=TryHackMe%20Ffuf"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Ffuf on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-ffuf%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Ffuf on whatsapp" href="https://api.whatsapp.com/send?text=TryHackMe%20Ffuf%20-%20https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-ffuf%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Ffuf on telegram" href="https://telegram.me/share/url?text=TryHackMe%20Ffuf&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-ffuf%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share TryHackMe Ffuf on ycombinator" href="https://news.ycombinator.com/submitlink?t=TryHackMe%20Ffuf&u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-ffuf%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>YOU CAN REUSE MY CONTENT</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>