<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Try Hack ME Room Malstrings | Classroom</title><meta name=keywords content="tryhackme,rooms,thm"><meta name=description content="Try Hack Me Room MALware Strings solved by Animesh Roy. this is a walkthough. read more..."><meta name=author content="Animesh Roy"><link rel=canonical href=https://classroom.anir0y.in/post/thm-room-malstrings/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=16x16 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=32x32 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=apple-touch-icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=mask-icon href=https://classroom.anir0y.in/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://classroom.anir0y.in/post/thm-room-malstrings/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://classroom.anir0y.in/post/thm-room-malstrings/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="Try Hack ME Room Malstrings"><meta property="og:description" content="Try Hack Me Room MALware Strings solved by Animesh Roy. this is a walkthough. read more..."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-31T00:21:19+05:30"><meta property="article:modified_time" content="2021-05-31T00:21:19+05:30"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="article:tag" content="Thm"><meta property="og:image" content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:title content="Try Hack ME Room Malstrings"><meta name=twitter:description content="Try Hack Me Room MALware Strings solved by Animesh Roy. this is a walkthough. read more..."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"Try Hack ME Room Malstrings","item":"https://classroom.anir0y.in/post/thm-room-malstrings/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Try Hack ME Room Malstrings","name":"Try Hack ME Room Malstrings","description":"Try Hack Me Room MALware Strings solved by Animesh Roy. this is a walkthough. read more...","keywords":["tryhackme","rooms","thm"],"articleBody":"MAL: Strings Profile Support Task 01: What are ‚Äústrings‚Äù? MP: Strings What are ‚Äústrings‚Äù? From a programming perspective, ‚Äústrings‚Äù is the term given for data handled by an application. At a broader view, these pieces of data are used to store information such as text to numerical values.\nFor example, let‚Äôs say we have an application such as a calculator. A user will have to input two numerical values (e.g. 1 and 5) combined with an operator (e.g. + or plus) addition in this case. These values will be stored as ‚Äústrings‚Äù.\nHowever ‚Äústrings‚Äù can be stored within the application itself - where no input is necessary from the user. For example, using the example of usernames and passwords is a great representation of the many types of information that may be stored as a ‚Äústring‚Äù.\nWhy are ‚Äústrings‚Äù important? We‚Äôre all security-minded people here and know that writing down passwords isn‚Äôt a very smart thing to do. However, developers are not quite so likeminded and often leave credentials in applications which are often essential i.e. An application that server needs to know the IP address of it. Arguably, an IP address is trivial in comparison to the sensitivity of a password - but both would be stored as strings.\nThere are a plethora of examples of companies storing sensitive information such as passwords within their applications. For example, Intellian, a satellite-communications focused company had the disclosure of their ‚ÄúAptus Web 1.24‚Äù application retaining a default passcode of ‚Äú12345678‚Äù.\nIllustrated below is an example of an Android Application containing sensitive credentials within strings:\n(Credit: Ezequiel., Skullarmy)\nTime for a bit of research to solve the questions below:\nFlag-1.1 What is the name of the account that had the passcode of ‚Äú12345678‚Äù in the intellian example discussed above?\nintellian\nI searched this product name on google and found it‚Äôs default username and password. Flag-1.2 What is the CVE entry disclosed by the company ‚ÄúTeradata‚Äù in their ‚ÄúViewpoint‚Äù Application that has a password within a string?\nCVE-2019-6499\nquick read: https://nvd.nist.gov/vuln/detail/CVE-2019-6499\nFlag-1.3 According to OWASP‚Äôs list of ‚ÄúTop Ten IoT‚Äù vulnerabilities, name the ranking this vulnerability would fall within, represented as text.\none\nAccording to OWASP‚Äôs list of ‚ÄúTop Ten IoT‚Äù vulnerabilities, name the ranking this vulnerability would fall within, represented as text. read: https://owasp.org/www-pdf-archive/OWASP-IoT-Top-10-2018-final.pdf\nTask 02: Practical: Extracting ‚Äústrings‚Äù From an Application Download the material attached to the task.\nIt is a little console program I have written in c++ for this example that replicates a login prompt.\nAs displayed above, if you were to execute this on Windows you‚Äôd be greeted with a prompt asking for a Username and password. The problem is, we don‚Äôt know what the credentials are but we want to get in! Let‚Äôs have a look into how the application understands what usernames and passwords are right and wrong.\nLoad up a terminal and use the command strings replacing with the name and path of the downloaded file attached to this Task i.e. strings /home/kali/Downloads/LoginForm.exe\nYou will see a lot of text appear - and might be cut things out! Rather than just printing the output to the terminal, perhaps we should save it to a file? You can ‚Äúpipe‚Äù (or direct) the output to a file.\nNow that we have stored the output into a file, we can do all sorts - filter it, sort it, search it! That‚Äôs what you‚Äôll need to do. Open it in a text editor - either via terminal using nano, vi or Kali‚Äôs installed GUI text editor Mousepad\nLooking through the file will show mostly garbage, but all you need is one golden nugget! You will be able to answer the following questions with this information. Think, what looks most likely a username and password?\nFlag-2.1 What is the correct username required by the ‚ÄúLoginForm‚Äù?\ncmnatic\nFlag-2.2 What is the required password to authenticate with?\nTryHackMeMerchWhen\nFlag-2.3 What is the ‚Äúhidden‚Äù THM{} flag?\nTHM{Not_So_Hidden_Flag}\nAns of all 3 questions. Task 03: Strings in the Context of Malware Great, developers can be lazy - they leave passwords in applications as we have previously discussed. How does that relate to us as a malware analyst? Well‚Ä¶\nWe‚Äôve discovered that even professional developers can ‚Äúslip up‚Äù a few times, malware authors are still developers at the end of the day.\nBut more specifically, malware types such as botnets and ransomware rely upon information being stored within strings I.e. IP Addresses so that they are able to ‚Äúcall home‚Äù and connect to their ‚ÄúCommand and Control‚Äù (C\u0026C) server.\nA famous example is the ‚ÄúWannacry‚Äù ransomware. The ‚Äúkillswitch‚Äù was a domain that was discovered as a value contained within a string.\nAs we will later come on to discover, building a picture of the various stages a piece of malware proceeds through is essential to prevent further infection. Information such as who the software communicates to I.e. IP Addresses such as in the case of a botnet, or the payment address in the instances of ransomware is prevalent in building this picture.\nFlag-3.1 What is the key term to describe a server that Botnets recieve instructions from?\nCommand and Control\nRead the statement of Task 03\nFlag-3.2 Name the discussed example malware that uses ‚Äústrings‚Äù to store the bitcoin wallet addresses for payment\nwannacry\nRead the statement of Task 03\nTask 04: Practical: Finding Bitcoin Addresses in Ransomware (Deploy!) What is Bitcoin?\nAt a brief overview, Bitcoin is an ‚Äúanonymous‚Äù online payment currency in the sense that there is no direct attribution between the sender and recipient. Authors of ransomware use this currency because of this trait - however, just because there is no attribution such as real names like traditional payment methods, it is traceable by Law Enforcement (albeit difficult).\nFor example, Wannacry uses Bitcoin as the payment method for the decryption of files. Bitcoin uses virtual wallets, similar to a MAC address of a network interface card. MuirlandOracle explains the concept of MAC addresses in his Introductory: Networking room, these wallets have addresses who are unique.\nI.e. The Bitcoin address used by the authors of Wannacry was 13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94\nIn this case, the previously mentioned Bitcoin address used for Wannacry has to-date received over 20BTC (Bitcoins) from victims, which translates into over just over ¬£158k (as of 06/04/2020).\nYou can use a website such as BlockCypher to explore the Bitcoin network and transactions between wallets.\nPractical\nYou need to perform a few prerequisites before you can complete this task, the steps are detailed below:\nDeploy the VM attached to this room and wait a couple of minutes for it to deploy. In the interim, ensure you are connected to TryHackMe via OpenVPN to RDP into the machine using the details below, or alternatively, control the instance in-browser at the top of the web page! Open the ‚ÄúSysinternals‚Äù folder located on the Desktop to proceed Before using the ‚Äústrings‚Äù tool provided with Sysinternals, we need to accept the license agreement first. You can do this by launching the executable through the command prompt and press ‚ÄúAgree‚Äù on the popup dialogue box\nWith this license accepted, we can now use this tool to extract the ‚Äústrings‚Äù contained within the ComplexCalculatorv2.exe with the following syntax: strings.exe ComplexCalculatorv2.exe \u003e strings.txt\nNow open up the text file created from the syntax we just entered with a text editor such as Notepad, where you will find the answer to solve Question #2.\nFlag-4.1 List the number of total transactions that the Bitcoin wallet used by the ‚ÄúWannacry‚Äù author(s)\n142\nalways check this URL to get the Correct ANS: https://live.blockcypher.com/btc/address/13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94/\nFlag-4.2 What is the Bitcoin Address stored within ‚ÄúComplexCalculator.exe‚Äù\nans: Task 05: Summary Let‚Äôs Recap‚Ä¶\nThis room is somewhat arguably brief. However, we discussed the theory behind ‚Äústrings‚Äù and why they are important for us as malware analysts. There isn‚Äôt all that much to the actual process of extracting ‚Äústrings‚Äù, however, it is an important topic to discuss.\nMoreover, hopefully after a bit of research, you now understand why ‚Äúhard-coded‚Äù values such as credentials are a bad thing - and unfortunately still a re-occurring problem, least not an easy way to get into bug bounties!\nWe then extracted some of these ‚Äústrings‚Äù from an example application that I made using Kali Linux‚Äôs strings command.\nWhilst there isn‚Äôt a default command to extract ‚Äústrings‚Äù within a program on Windows, there‚Äôs certainly a toolset that Microsoft provides that you can download!\nFinally, we discussed how malware variants such as ransomware rely upon ‚Äústrings‚Äù functionality i.e. ‚Äúcalling home‚Äù and/or bitcoin wallet addresses.\nI hope you enjoyed the practical side and remember the tools available to you to extract these ‚Äústrings‚Äù for use later on within the series!\nFlag-5 ","wordCount":"1445","inLanguage":"en","image":"https://classroom.anir0y.in/img/thm.gif","datePublished":"2021-05-31T00:21:19+05:30","dateModified":"2021-05-31T00:21:19+05:30","author":{"@type":"Person","name":"Animesh Roy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/thm-room-malstrings/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https://classroom.anir0y.in/img/avatar.jpeg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://classroom.anir0y.in/ accesskey=h title="Classroom (Alt + H)"><img src=https://classroom.anir0y.in/img/avatar.jpeg alt aria-label=logo height=35>Classroom</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://classroom.anir0y.in/post/ title=Posts><span>Posts</span></a></li><li><a href=https://classroom.anir0y.in/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://classroom.anir0y.in/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://classroom.anir0y.in/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://classroom.anir0y.in/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://classroom.anir0y.in/about/me/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://classroom.anir0y.in/>Home</a>&nbsp;¬ª&nbsp;<a href=https://classroom.anir0y.in/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Try Hack ME Room Malstrings</h1><div class=post-description>Try Hack Me Room MALware Strings solved by Animesh Roy. this is a walkthough. read more...</div><div class=post-meta><span title='2021-05-31 00:21:19 +0530 IST'>May 31, 2021</span>&nbsp;¬∑&nbsp;<span>7 min</span>&nbsp;¬∑&nbsp;<span>Animesh Roy</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/anir0y/classroom/tree/master/content/post/thm-room-malstrings.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><figure class=entry-cover><img loading=eager src=https://classroom.anir0y.in/img/thm.gif alt="cover image"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#task-01-what-are-strings>Task 01: What are &ldquo;strings&rdquo;?</a><ul><li><a href=#mp-strings>MP: Strings</a></li><li><a href=#flag-11>Flag-1.1</a></li><li><a href=#flag-12>Flag-1.2</a></li><li><a href=#flag-13>Flag-1.3</a></li></ul></li><li><a href=#task-02-practical-extracting-strings-from-an-application>Task 02: Practical: Extracting &ldquo;strings&rdquo; From an Application</a><ul><li><a href=#flag-21>Flag-2.1</a></li><li><a href=#flag-22>Flag-2.2</a></li><li><a href=#flag-23>Flag-2.3</a></li></ul></li><li><a href=#task-03-strings-in-the-context-of-malware>Task 03: Strings in the Context of Malware</a><ul><li><a href=#flag-31>Flag-3.1</a></li><li><a href=#flag-32>Flag-3.2</a></li></ul></li><li><a href=#task-04-practical-finding-bitcoin-addresses-in-ransomware-deploy>Task 04: Practical: Finding Bitcoin Addresses in Ransomware (Deploy!)</a><ul><li><a href=#flag-41>Flag-4.1</a></li><li><a href=#flag-42>Flag-4.2</a></li></ul></li><li><a href=#task-05-summary>Task 05: Summary</a><ul><li><a href=#flag-5>Flag-5</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h1 id=mal-strings>MAL: Strings<a hidden class=anchor aria-hidden=true href=#mal-strings>#</a></h1><table><thead><tr><th style=text-align:left>Profile</th><th style=text-align:right>Support</th></tr></thead><tbody><tr><td style=text-align:left><script src=https://tryhackme.com/badge/434937></script></td><td style=text-align:right><a href=https://www.buymeacoffee.com/anir0y><img src="https://img.buymeacoffee.com/button-api/?text=Cheers!!!&emoji=üç∫&slug=anir0y&button_colour=BD5FFF&font_colour=ffffff&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00"></a></td></tr></tbody></table><script type=text/javascript language=javascript>var aax_size="300x250",aax_pubname="anir0y-21",aax_src="302"</script><script type=text/javascript language=javascript src=https://c.amazon-adsystem.com/aax2/assoc.js></script><hr><h2 id=task-01-what-are-strings>Task 01: What are &ldquo;strings&rdquo;?<a hidden class=anchor aria-hidden=true href=#task-01-what-are-strings>#</a></h2><h3 id=mp-strings>MP: Strings<a hidden class=anchor aria-hidden=true href=#mp-strings>#</a></h3><h4 id=what-are-strings>What are &ldquo;strings&rdquo;?<a hidden class=anchor aria-hidden=true href=#what-are-strings>#</a></h4><p>From a programming perspective, &ldquo;strings&rdquo; is the term given for data handled by an application. At a broader view, these pieces of data are used to store information such as text to numerical values.</p><p>For example, let&rsquo;s say we have an application such as a calculator. A user will have to input two numerical values (e.g. 1 and 5) combined with an operator (e.g. + or plus) addition in this case. These values will be stored as &ldquo;strings&rdquo;.</p><p>However &ldquo;strings&rdquo; can be stored within the application itself - where no input is necessary from the user. For example, using the example of usernames and passwords is a great representation of the many types of information that may be stored as a &ldquo;string&rdquo;.</p><h4 id=why-are-strings-important>Why are &ldquo;strings&rdquo; important?<a hidden class=anchor aria-hidden=true href=#why-are-strings-important>#</a></h4><p>We&rsquo;re all security-minded people here and know that writing down passwords isn&rsquo;t a very smart thing to do. However, developers are not quite so likeminded and often leave credentials in applications which are often essential i.e. An application that server needs to know the IP address of it. Arguably, an IP address is trivial in comparison to the sensitivity of a password - but both would be stored as strings.</p><p>There are a plethora of examples of companies storing sensitive information such as passwords within their applications. For example, Intellian, a satellite-communications focused company had the disclosure of their &ldquo;Aptus Web 1.24&rdquo; application retaining a default passcode of ‚Äú12345678‚Äù.</p><p>Illustrated below is an example of an Android Application containing sensitive credentials within strings:</p><p><img loading=lazy src=https://1.bp.blogspot.com/-itNHMN1O9J8/Xi2olyvRRfI/AAAAAAAAGtk/LEY9xXheHJgBs4TUdhQsEzUGunvVH3BmwCEwYBhgL/s640/2_hardcoded_pass.png></p><p>(Credit: <a href=https://www.blogger.com/profile/01349805697841422503>Ezequiel., Skullarmy</a>)</p><p>Time for a bit of research to solve the questions below:</p><h3 id=flag-11>Flag-1.1<a hidden class=anchor aria-hidden=true href=#flag-11>#</a></h3><blockquote><p>What is the name of the account that had the passcode of &ldquo;12345678&rdquo; in the intellian example discussed above?</p><p><code>intellian</code></p></blockquote><p>I searched this product name on google and found it‚Äôs default username and password.<br><img loading=lazy src=https://i.imgur.com/keVrtdy.png></p><h3 id=flag-12>Flag-1.2<a hidden class=anchor aria-hidden=true href=#flag-12>#</a></h3><blockquote><p>What is the CVE entry disclosed by the company &ldquo;Teradata&rdquo; in their &ldquo;Viewpoint&rdquo; Application that has a password within a string?</p><p><code>CVE-2019-6499</code></p></blockquote><p>quick read: <a href=https://nvd.nist.gov/vuln/detail/CVE-2019-6499>https://nvd.nist.gov/vuln/detail/CVE-2019-6499</a></p><h3 id=flag-13>Flag-1.3<a hidden class=anchor aria-hidden=true href=#flag-13>#</a></h3><blockquote><p>According to OWASP&rsquo;s list of &ldquo;Top Ten IoT&rdquo; vulnerabilities, name the ranking this vulnerability would fall within, represented as text.</p><p><code>one</code></p></blockquote><p>According to OWASP‚Äôs list of ‚ÄúTop Ten IoT‚Äù vulnerabilities, name the ranking this vulnerability would fall within, represented as text.
read: <a href=https://owasp.org/www-pdf-archive/OWASP-IoT-Top-10-2018-final.pdf>https://owasp.org/www-pdf-archive/OWASP-IoT-Top-10-2018-final.pdf</a></p><hr><h2 id=task-02-practical-extracting-strings-from-an-application>Task 02: Practical: Extracting &ldquo;strings&rdquo; From an Application<a hidden class=anchor aria-hidden=true href=#task-02-practical-extracting-strings-from-an-application>#</a></h2><p><strong>Download the material attached to the task.</strong></p><p>It is a little console program I have written in c++ for this example that replicates a login prompt.</p><p><img loading=lazy src=https://i.imgur.com/3PQghBl.png></p><p>As displayed above, if you were to execute this on Windows you&rsquo;d be greeted with a prompt asking for a Username and password. The problem is, we don&rsquo;t know what the credentials are but we want to get in! Let&rsquo;s have a look into how the application understands what usernames and passwords are right and wrong.</p><p>Load up a terminal and use the command <code>strings &lt;filename></code> replacing <filename>with the name and path of the downloaded file attached to this Task i.e. <code>strings /home/kali/Downloads/LoginForm.exe</code></p><p>You will see a lot of text appear - and might be cut things out! Rather than just printing the output to the terminal, perhaps we should save it to a file? You can &ldquo;pipe&rdquo; (or direct) the output to a file.</p><p><img loading=lazy src=https://i.imgur.com/ge2sGB4.png></p><p>Now that we have stored the output into a file, we can do all sorts - filter it, sort it, search it! That&rsquo;s what you&rsquo;ll need to do. Open it in a text editor - either via terminal using nano, vi or Kali&rsquo;s installed GUI text editor Mousepad</p><p><img loading=lazy src=https://i.imgur.com/Azkt3su.png></p><p>Looking through the file will show mostly garbage, but all you need is one golden nugget! You will be able to answer the following questions with this information. Think, what looks most likely a username and password?</p><h3 id=flag-21>Flag-2.1<a hidden class=anchor aria-hidden=true href=#flag-21>#</a></h3><blockquote><p>What is the correct username required by the &ldquo;LoginForm&rdquo;?</p><p><code>cmnatic</code></p></blockquote><h3 id=flag-22>Flag-2.2<a hidden class=anchor aria-hidden=true href=#flag-22>#</a></h3><blockquote><p>What is the required password to authenticate with?</p><p><code>TryHackMeMerchWhen</code></p></blockquote><h3 id=flag-23>Flag-2.3<a hidden class=anchor aria-hidden=true href=#flag-23>#</a></h3><blockquote><p>What is the &ldquo;hidden&rdquo; THM{} flag?</p><p><code>THM{Not_So_Hidden_Flag}</code></p></blockquote><h4 id=ans-of-all-3-questions>Ans of all 3 questions.<a hidden class=anchor aria-hidden=true href=#ans-of-all-3-questions>#</a></h4><p><img loading=lazy src=https://i.imgur.com/vCU5igb.png></p><hr><h2 id=task-03-strings-in-the-context-of-malware>Task 03: Strings in the Context of Malware<a hidden class=anchor aria-hidden=true href=#task-03-strings-in-the-context-of-malware>#</a></h2><p>Great, developers can be lazy - they leave passwords in applications as we have previously discussed. How does that relate to us as a malware analyst? Well&mldr;</p><p>We&rsquo;ve discovered that even professional developers can &ldquo;slip up&rdquo; a few times, malware authors are still developers at the end of the day.</p><p>But more specifically, malware types such as botnets and ransomware rely upon information being stored within strings I.e. IP Addresses so that they are able to &ldquo;call home&rdquo; and connect to their &ldquo;Command and Control&rdquo; (C&amp;C) server.</p><p>A famous example is the &ldquo;Wannacry&rdquo; ransomware. The &ldquo;killswitch&rdquo; was a domain that was discovered as a value contained within a string.</p><p>As we will later come on to discover, building a picture of the various stages a piece of malware proceeds through is essential to prevent further infection. Information such as who the software communicates to I.e. IP Addresses such as in the case of a botnet, or the payment address in the instances of ransomware is prevalent in building this picture.</p><h3 id=flag-31>Flag-3.1<a hidden class=anchor aria-hidden=true href=#flag-31>#</a></h3><blockquote><p>What is the key term to describe a server that Botnets recieve instructions from?</p><p><code>Command and Control</code></p></blockquote><p>Read the statement of <a href=#task-03-strings-in-the-context-of-malware>Task 03</a></p><h3 id=flag-32>Flag-3.2<a hidden class=anchor aria-hidden=true href=#flag-32>#</a></h3><blockquote><p>Name the discussed example malware that uses &ldquo;strings&rdquo; to store the bitcoin wallet addresses for payment</p><p><code>wannacry</code></p></blockquote><p>Read the statement of <a href=#task-03-strings-in-the-context-of-malware>Task 03</a></p><hr><h2 id=task-04-practical-finding-bitcoin-addresses-in-ransomware-deploy>Task 04: Practical: Finding Bitcoin Addresses in Ransomware (Deploy!)<a hidden class=anchor aria-hidden=true href=#task-04-practical-finding-bitcoin-addresses-in-ransomware-deploy>#</a></h2><p><strong>What is Bitcoin?</strong></p><p>At a brief overview, Bitcoin is an &ldquo;anonymous&rdquo; online payment currency in the sense that there is no direct attribution between the sender and recipient. Authors of ransomware use this currency because of this trait - however, just because there is no attribution such as real names like traditional payment methods, it is traceable by Law Enforcement (albeit difficult).</p><p>For example, Wannacry uses Bitcoin as the payment method for the decryption of files. Bitcoin uses virtual wallets, similar to a MAC address of a network interface card. <a href=https://tryhackme.com/p/MuirlandOracle>MuirlandOracle</a> explains the concept of MAC addresses in his Introductory: Networking room, these wallets have addresses who are unique.</p><p>I.e. The Bitcoin address used by the authors of Wannacry was <a href=https://live.blockcypher.com/btc/address/13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94/>13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94</a></p><p><img alt="wanncry bitcoin wallet" loading=lazy src=https://i.imgur.com/i6m7GOI.png></p><p>In this case, the previously mentioned Bitcoin address used for Wannacry has to-date received over 20BTC (Bitcoins) from victims, which translates into over just over ¬£158k (as of 06/04/2020).</p><p>You can use a website such as <a href=https://live.blockcypher.com/>BlockCypher</a> to explore the Bitcoin network and transactions between wallets.</p><p><img loading=lazy src=https://i.imgur.com/fFQHzwg.png></p><p><strong>Practical</strong></p><p>You need to perform a few prerequisites before you can complete this task, the steps are detailed below:</p><ol><li>Deploy the VM attached to this room and wait a couple of minutes for it to deploy. In the interim, ensure you are connected to TryHackMe via OpenVPN to RDP into the machine using the details below, or alternatively, control the instance in-browser at the top of the web page!</li><li>Open the &ldquo;Sysinternals&rdquo; folder located on the Desktop to proceed</li></ol><p>Before using the &ldquo;strings&rdquo; tool provided with Sysinternals, we need to accept the license agreement first. You can do this by launching the executable through the command prompt and press &ldquo;Agree&rdquo; on the popup dialogue box</p><p><img loading=lazy src=https://i.imgur.com/O6A2Ais.png></p><p>With this license accepted, we can now use this tool to extract the &ldquo;strings&rdquo; contained within the ComplexCalculatorv2.exe with the following syntax: <code>strings.exe ComplexCalculatorv2.exe > strings.txt</code></p><p><img loading=lazy src=https://i.imgur.com/XqwKQJW.png></p><p>Now open up the text file created from the syntax we just entered with a text editor such as Notepad, where you will find the answer to solve Question #2.</p><h3 id=flag-41>Flag-4.1<a hidden class=anchor aria-hidden=true href=#flag-41>#</a></h3><blockquote><p>List the number of total transactions that the Bitcoin wallet used by the &ldquo;Wannacry&rdquo; author(s)</p><p><code>142</code></p></blockquote><p>always check this URL to get the Correct ANS: <a href=https://live.blockcypher.com/btc/address/13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94/>https://live.blockcypher.com/btc/address/13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94/</a></p><p><img loading=lazy src=https://i.imgur.com/5QrhqTy.png></p><h3 id=flag-42>Flag-4.2<a hidden class=anchor aria-hidden=true href=#flag-42>#</a></h3><blockquote><p>What is the Bitcoin Address stored within &ldquo;ComplexCalculator.exe&rdquo;</p></blockquote><p>ans:
<img loading=lazy src=https://i.imgur.com/CQCWdz3.png></p><hr><h2 id=task-05-summary>Task 05: Summary<a hidden class=anchor aria-hidden=true href=#task-05-summary>#</a></h2><p><strong>Let&rsquo;s Recap&mldr;</strong></p><p>This room is somewhat arguably brief. However, we discussed the theory behind &ldquo;strings&rdquo; and why they are important for us as malware analysts. There isn&rsquo;t all that much to the actual process of extracting &ldquo;strings&rdquo;, however, it is an important topic to discuss.</p><p>Moreover, hopefully after a bit of research, you now understand why &ldquo;hard-coded&rdquo; values such as credentials are a bad thing - and unfortunately still a re-occurring problem, least not an easy way to get into bug bounties!</p><p>We then extracted some of these &ldquo;strings&rdquo; from an example application that I made using Kali Linux&rsquo;s strings command.</p><p>Whilst there isn&rsquo;t a default command to extract &ldquo;strings&rdquo; within a program on Windows, there&rsquo;s certainly a toolset that Microsoft provides that you can download!</p><p>Finally, we discussed how malware variants such as ransomware rely upon &ldquo;strings&rdquo; functionality i.e. &ldquo;calling home&rdquo; and/or bitcoin wallet addresses.</p><p>I hope you enjoyed the practical side and remember the tools available to you to extract these &ldquo;strings&rdquo; for use later on within the series!</p><h3 id=flag-5>Flag-5<a hidden class=anchor aria-hidden=true href=#flag-5>#</a></h3><p><img loading=lazy src=https://i.imgur.com/gucHwHG.png></p><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://classroom.anir0y.in/tags/tryhackme/>Tryhackme</a></li><li><a href=https://classroom.anir0y.in/tags/rooms/>Rooms</a></li><li><a href=https://classroom.anir0y.in/tags/thm/>Thm</a></li></ul><nav class=paginav><a class=prev href=https://classroom.anir0y.in/post/thm-room-basicmalwarere/><span class=title>¬´ Prev</span><br><span>TryHackMe BasicMalwareRE Writeup</span>
</a><a class=next href=https://classroom.anir0y.in/post/thm-room-malmalintroductory/><span class=title>Next ¬ª</span><br><span>Try Hack ME Room Malware Introductory</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack ME Room Malstrings on x" href="https://x.com/intent/tweet/?text=Try%20Hack%20ME%20Room%20Malstrings&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malstrings%2f&amp;hashtags=tryhackme%2crooms%2cthm"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack ME Room Malstrings on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malstrings%2f&amp;title=Try%20Hack%20ME%20Room%20Malstrings&amp;summary=Try%20Hack%20ME%20Room%20Malstrings&amp;source=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malstrings%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack ME Room Malstrings on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malstrings%2f&title=Try%20Hack%20ME%20Room%20Malstrings"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack ME Room Malstrings on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malstrings%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack ME Room Malstrings on whatsapp" href="https://api.whatsapp.com/send?text=Try%20Hack%20ME%20Room%20Malstrings%20-%20https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malstrings%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack ME Room Malstrings on telegram" href="https://telegram.me/share/url?text=Try%20Hack%20ME%20Room%20Malstrings&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malstrings%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack ME Room Malstrings on ycombinator" href="https://news.ycombinator.com/submitlink?t=Try%20Hack%20ME%20Room%20Malstrings&u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-malstrings%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>YOU CAN REUSE MY CONTENT</span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>