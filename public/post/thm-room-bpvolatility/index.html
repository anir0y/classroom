<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Try Hack me Room Volatility | Classroom</title><meta name=keywords content="tryhackme,rooms,thm,Volatility"><meta name=description content="Try Hack Me Room Volatility solved by Animesh Roy. this is a walkthough. read more..."><meta name=author content="Animesh Roy"><link rel=canonical href=https://classroom.anir0y.in/post/thm-room-bpvolatility/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=16x16 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=32x32 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=apple-touch-icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=mask-icon href=https://classroom.anir0y.in/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://classroom.anir0y.in/post/thm-room-bpvolatility/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://classroom.anir0y.in/post/thm-room-bpvolatility/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="Try Hack me Room Volatility"><meta property="og:description" content="Try Hack Me Room Volatility solved by Animesh Roy. this is a walkthough. read more..."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-05-23T23:09:45+05:30"><meta property="article:modified_time" content="2021-05-23T23:09:45+05:30"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="article:tag" content="Thm"><meta property="article:tag" content="Volatility"><meta property="og:image" content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://classroom.anir0y.in/img/thm.gif"><meta name=twitter:title content="Try Hack me Room Volatility"><meta name=twitter:description content="Try Hack Me Room Volatility solved by Animesh Roy. this is a walkthough. read more..."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"Try Hack me Room Volatility","item":"https://classroom.anir0y.in/post/thm-room-bpvolatility/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Try Hack me Room Volatility","name":"Try Hack me Room Volatility","description":"Try Hack Me Room Volatility solved by Animesh Roy. this is a walkthough. read more...","keywords":["tryhackme","rooms","thm","Volatility"],"articleBody":"Volatility Learn how to perform memory forensics with Volatility!\nProfile Support Task 01: Intro Volatility is a free memory forensics tool developed and maintained by Volatility labs. Regarded as the gold standard for memory forensics in incident response, Volatility is wildly expandable via a plugins system and is an invaluable tool for any Blue Teamer.\nTask 02: Obtaining Memory Samples Obtaining a memory capture from machines can be done in numerous ways, however, the easiest method will often vary depending on what you‚Äôre working with. For example, live machines (turned on) can have their memory captured with one of the following tools:\nFTK Imager - Link Redline - Link *Requires registration but Redline has a very nice GUI DumpIt.exe win32dd.exe / win64dd.exe - *Has fantastic psexec support, great for IT departments if your EDR solution doesn‚Äôt support this These tools will typically output a .raw file which contains an image of the system memory. The .raw format is one of the most common memory file types you will see in the wild.\nOffline machines, however, can have their memory pulled relatively easily as long as their drives aren‚Äôt encrypted. For Windows systems, this can be done via pulling the following file:\n%SystemDrive%/hiberfil.sys\nhiberfil.sys, better known as the Windows hibernation file contains a compressed memory image from the previous boot. Microsoft Windows systems use this in order to provide faster boot-up times, however, we can use this file in our case for some memory forensics!\nThings get even more exciting when we start to talk about virtual machines and memory captures. Here‚Äôs a quick sampling of the memory capture process/file containing a memory image for different virtual machine hypervisors:\nVMware - .vmem file Hyper-V - .bin file Parallels - .mem file VirtualBox - .sav file *This is only a partial memory file. You‚Äôll need to dump memory like a normal bare-metal system for this hypervisor These files can often be found simply in the data store of the corresponding hypervisor and often can be simply copied without shutting the associated virtual machine off. This allows for virtually zero disturbance to the virtual machine, preserving it‚Äôs forensic integrity.\nFlags: 2 What memory format is the most common? .raw The Window‚Äôs system we‚Äôre looking to perform memory forensics on was turned off by mistake. What file contains a compressed memory image? hiberfil.sys How about if we wanted to perform memory forensics on a VMware-based virtual machine? .vmem Task 03: Examining Our Patient Now that we‚Äôve collected our memory image let‚Äôs dig into it! For those using their own workstation for this activity, I‚Äôve provided a download link to our memory sample attached to this task. If you‚Äôre using the workstation I‚Äôve provided as a VM for this activity you‚Äôll find the memory image in the ‚Äòvoluser‚Äô home directory.\nFlags 3.1 First, let‚Äôs figure out what profile we need to use. Profiles determine how Volatility treats our memory image since every version of Windows is a little bit different. Let‚Äôs see our options now with the command volatility -f MEMORY_FILE.raw imageinfo ANS: N/A\nFlag 3.2 Running the imageinfo command in Volatility will provide us with a number of profiles we can test with, however, only one will be correct. We can test these profiles using the pslist command, validating our profile selection by the sheer number of returned results. Do this now with the command volatility -f MEMORY_FILE.raw --profile=PROFILE pslist. What profile is correct for this memory image? Ans WinXPSP2x86 Flag 3.3 Take a look through the processes within our image. What is the process ID for the smss.exe process? If results are scrolling off-screen, try piping your output into less Ans 368 Flag 3.4 In addition to viewing active processes, we can also view active network connections at the time of image creation! Let‚Äôs do this now with the command volatility -f MEMORY_FILE.raw --profile=PROFILE netscan. Unfortunately, something not great is going to happen here due to the sheer age of the target operating system as the command netscan doesn‚Äôt support it. Ans N/A Flag 3.5 It‚Äôs fairly common for malware to attempt to hide itself and the process associated with it. That being said, we can view intentionally hidden processes via the command psxview. What process has only one ‚ÄòFalse‚Äô listed? Ans csrss.exe Flag 3.6 In addition to viewing hidden processes via psxview, we can also check this with a greater focus via the command ‚Äôldrmodules‚Äô. Three columns will appear here in the middle, InLoad, InInit, InMem. If any of these are false, that module has likely been injected which is a really bad thing. On a normal system the grep statement above should return no output. Which process has all three columns listed as ‚ÄòFalse‚Äô (other than System)? Ans csrss.exe Flag 3.7 Injected code can be a huge issue and is highly indicative of very very bad things. We can check for this with the command malfind. Using the full command volatility -f MEMORY_FILE.raw --profile=PROFILE malfind -D we can not only find this code, but also dump it to our specified directory. Let‚Äôs do this now! We‚Äôll use this dump later for more analysis. How many files does this generate? Ans 12 Flag 3.8 Last but certainly not least we can view all of the DLLs loaded into memory. DLLs are shared system libraries utilized in system processes. These are commonly subjected to hijacking and other side-loading attacks, making them a key target for forensics. Let‚Äôs list all of the DLLs in memory now with the command dlllist Ans n/a Flag 3.9 Now that we‚Äôve seen all of the DLLs running in memory, let‚Äôs go a step further and pull them out! Do this now with the command volatility -f MEMORY_FILE.raw --profile=PROFILE --pid=PID dlldump -D where the PID is the process ID of the infected process we identified earlier (questions five and six). How many DLLs does this end up pulling? Ans 12 First find the PID, ref to question 5: CSRSS.EXE is the process dump the DLLs Task 04: Post Actions Now that we‚Äôve performed some basic forensics, let‚Äôs go a step further and see what the community at large has to say about the items we‚Äôve discovered. Check out the following two sites and upload the injected code we yanked out of our previous section. You can pull this code either via SCP with the box above, your local volatility workstation, or via a download link attached to this task.\nVirusTotal - Link Hybrid Analysis - Link Flags 4 1 Upload the extracted files to VirusTotal for examination. na 2 Upload the extracted files to Hybrid Analysis for examination - Note, this will also upload to VirusTotal but for the sake of demonstration we have done this separately. na 3 What malware has our sample been infected with? You can find this in the results of VirusTotal and Hybrid Anaylsis. Cridex Explanation Flag4.3 Step 1: Get the DLL list\nstep 2: upload them to VT\none of them return the malware name\ntask 05: Extra Credit Interested in going further? Here‚Äôs a slew of awesome resources (both paid and free in no particular order) to check out and learn more!\nAlienVault Open Threat Exchange (OTX) - An open-source threat tracking system. Create pulses based on your malware analysis work and check out the work of others. Link\nSANS 408 - Windows Forensic Analysis Link\n‚ÄúThe Art of Memory Forensics‚Äù - Link\nMemLabs - A collection of CTF-style memory forensic labs Link\n","wordCount":"1245","inLanguage":"en","image":"https://classroom.anir0y.in/img/thm.gif","datePublished":"2021-05-23T23:09:45+05:30","dateModified":"2021-05-23T23:09:45+05:30","author":{"@type":"Person","name":"Animesh Roy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/thm-room-bpvolatility/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https://classroom.anir0y.in/img/avatar.jpeg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://classroom.anir0y.in/ accesskey=h title="Classroom (Alt + H)"><img src=https://classroom.anir0y.in/img/avatar.jpeg alt aria-label=logo height=35>Classroom</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://classroom.anir0y.in/post/ title=Posts><span>Posts</span></a></li><li><a href=https://classroom.anir0y.in/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://classroom.anir0y.in/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://classroom.anir0y.in/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://classroom.anir0y.in/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://classroom.anir0y.in/about/me/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://classroom.anir0y.in/>Home</a>&nbsp;¬ª&nbsp;<a href=https://classroom.anir0y.in/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Try Hack me Room Volatility</h1><div class=post-description>Try Hack Me Room Volatility solved by Animesh Roy. this is a walkthough. read more...</div><div class=post-meta><span title='2021-05-23 23:09:45 +0530 IST'>May 23, 2021</span>&nbsp;¬∑&nbsp;<span>6 min</span>&nbsp;¬∑&nbsp;<span>Animesh Roy</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/anir0y/classroom/tree/master/content/post/thm-room-bpvolatility.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><figure class=entry-cover><img loading=eager src=https://classroom.anir0y.in/img/thm.gif alt="cover image"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#task-01-intro>Task 01: Intro</a></li><li><a href=#task-02-obtaining-memory-samples>Task 02: Obtaining Memory Samples</a><ul><li><a href=#flags-2>Flags: 2</a></li></ul></li><li><a href=#task-03-examining-our-patient>Task 03: Examining Our Patient</a><ul><li><a href=#flags-31>Flags 3.1</a></li><li><a href=#flag-32>Flag 3.2</a></li><li><a href=#flag-33>Flag 3.3</a></li><li><a href=#flag-34>Flag 3.4</a></li><li><a href=#flag-35>Flag 3.5</a></li><li><a href=#flag-36>Flag 3.6</a></li><li><a href=#flag-37>Flag 3.7</a></li><li><a href=#flag-38>Flag 3.8</a></li><li><a href=#flag-39>Flag 3.9</a></li></ul></li><li><a href=#task-04-post-actions>Task 04: Post Actions</a><ul><li><a href=#flags-4>Flags 4</a></li><li><a href=#task-05-extra-credit>task 05: Extra Credit</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h1 id=volatility>Volatility<a hidden class=anchor aria-hidden=true href=#volatility>#</a></h1><blockquote><p>Learn how to perform memory forensics with Volatility!</p></blockquote><table><thead><tr><th style=text-align:left>Profile</th><th style=text-align:right>Support</th></tr></thead><tbody><tr><td style=text-align:left><script src=https://tryhackme.com/badge/434937></script></td><td style=text-align:right><a href=https://www.buymeacoffee.com/anir0y><img src="https://img.buymeacoffee.com/button-api/?text=Cheers!!!&emoji=üç∫&slug=anir0y&button_colour=BD5FFF&font_colour=ffffff&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00"></a></td></tr></tbody></table><h2 id=task-01-intro>Task 01: Intro<a hidden class=anchor aria-hidden=true href=#task-01-intro>#</a></h2><p>Volatility is a free memory forensics tool developed and maintained by Volatility labs. Regarded as the gold standard for memory forensics in incident response, Volatility is wildly expandable via a plugins system and is an invaluable tool for any Blue Teamer.</p><hr><script type=text/javascript language=javascript>var aax_size="300x250",aax_pubname="anir0y-21",aax_src="302"</script><script type=text/javascript language=javascript src=https://c.amazon-adsystem.com/aax2/assoc.js></script><hr><h2 id=task-02-obtaining-memory-samples>Task 02: Obtaining Memory Samples<a hidden class=anchor aria-hidden=true href=#task-02-obtaining-memory-samples>#</a></h2><p>Obtaining a memory capture from machines can be done in numerous ways, however, the easiest method will often vary depending on what you&rsquo;re working with. For example, live machines (turned on) can have their memory captured with one of the following tools:</p><ul><li>FTK Imager - <a href=https://accessdata.com/product-download/ftk-imager-version-4-2-0>Link</a></li><li>Redline - <a href=https://www.fireeye.com/services/freeware/redline.html>Link</a> *Requires registration but Redline has a very nice GUI</li><li>DumpIt.exe</li><li>win32dd.exe / win64dd.exe - *Has fantastic psexec support, great for IT departments if your EDR solution doesn&rsquo;t support this</li></ul><p>These tools will typically output a .raw file which contains an image of the system memory. The .raw format is one of the most common memory file types you will see in the wild.</p><p>Offline machines, however, can have their memory pulled relatively easily as long as their drives aren&rsquo;t encrypted. For Windows systems, this can be done via pulling the following file:</p><p><code>%SystemDrive%/hiberfil.sys</code></p><p>hiberfil.sys, better known as the Windows hibernation file contains a compressed memory image from the previous boot. Microsoft Windows systems use this in order to provide faster boot-up times, however, we can use this file in our case for some memory forensics!</p><p>Things get even more exciting when we start to talk about virtual machines and memory captures. Here&rsquo;s a quick sampling of the memory capture process/file containing a memory image for different virtual machine hypervisors:</p><ul><li>VMware - .vmem file</li><li>Hyper-V - .bin file</li><li>Parallels - .mem file</li><li>VirtualBox - .sav file *This is only a partial memory file. You&rsquo;ll need to dump memory like a normal bare-metal system for this hypervisor</li></ul><p>These files can often be found simply in the data store of the corresponding hypervisor and often can be simply copied without shutting the associated virtual machine off. This allows for virtually zero disturbance to the virtual machine, preserving it&rsquo;s forensic integrity.</p><h3 id=flags-2>Flags: 2<a hidden class=anchor aria-hidden=true href=#flags-2>#</a></h3><table><thead><tr><th style=text-align:center></th><th></th></tr></thead><tbody><tr><td style=text-align:center>What memory format is the most common?</td><td style=text-align:left><code>.raw</code></td></tr><tr><td style=text-align:center>The Window&rsquo;s system we&rsquo;re looking to perform memory forensics on was turned off by mistake. What file contains a compressed memory image?</td><td style=text-align:left><code>hiberfil.sys</code></td></tr><tr><td style=text-align:center>How about if we wanted to perform memory forensics on a VMware-based virtual machine?</td><td style=text-align:left><code>.vmem</code></td></tr></tbody></table><hr><h2 id=task-03-examining-our-patient>Task 03: Examining Our Patient<a hidden class=anchor aria-hidden=true href=#task-03-examining-our-patient>#</a></h2><p>Now that we&rsquo;ve collected our memory image let&rsquo;s dig into it! For those using their own workstation for this activity, I&rsquo;ve provided a download link to our memory sample attached to this task. If you&rsquo;re using the workstation I&rsquo;ve provided as a VM for this activity you&rsquo;ll find the memory image in the &lsquo;voluser&rsquo; home directory.</p><h3 id=flags-31>Flags 3.1<a hidden class=anchor aria-hidden=true href=#flags-31>#</a></h3><h4 id=first-lets-figure-out-what-profile-we-need-to-use-profiles-determine-how-volatility-treats-our-memory-image-since-every-version-of-windows-is-a-little-bit-different-lets-see-our-options-now-with-the-command-volatility--f-memory_fileraw-imageinfo>First, let&rsquo;s figure out what profile we need to use. Profiles determine how Volatility treats our memory image since every version of Windows is a little bit different. Let&rsquo;s see our options now with the command <code>volatility -f MEMORY_FILE.raw imageinfo</code><a hidden class=anchor aria-hidden=true href=#first-lets-figure-out-what-profile-we-need-to-use-profiles-determine-how-volatility-treats-our-memory-image-since-every-version-of-windows-is-a-little-bit-different-lets-see-our-options-now-with-the-command-volatility--f-memory_fileraw-imageinfo>#</a></h4><p>ANS: N/A</p><h3 id=flag-32>Flag 3.2<a hidden class=anchor aria-hidden=true href=#flag-32>#</a></h3><h4 id=running-the-imageinfo-command-in-volatility-will-provide-us-with-a-number-of-profiles-we-can-test-with-however-only-one-will-be-correct-we-can-test-these-profiles-using-the-pslist-command-validating-our-profile-selection-by-the-sheer-number-of-returned-results-do-this-now-with-the-command-volatility--f-memory_fileraw---profileprofile-pslist-what-profile-is-correct-for-this-memory-image>Running the imageinfo command in Volatility will provide us with a number of profiles we can test with, however, only one will be correct. We can test these profiles using the pslist command, validating our profile selection by the sheer number of returned results. Do this now with the command <code>volatility -f MEMORY_FILE.raw --profile=PROFILE pslist</code>. What profile is correct for this memory image?<a hidden class=anchor aria-hidden=true href=#running-the-imageinfo-command-in-volatility-will-provide-us-with-a-number-of-profiles-we-can-test-with-however-only-one-will-be-correct-we-can-test-these-profiles-using-the-pslist-command-validating-our-profile-selection-by-the-sheer-number-of-returned-results-do-this-now-with-the-command-volatility--f-memory_fileraw---profileprofile-pslist-what-profile-is-correct-for-this-memory-image>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Ans</td><td>WinXPSP2x86</td></tr></tbody></table><p><img loading=lazy src=https://i.imgur.com/IAS86zK.png></p><h3 id=flag-33>Flag 3.3<a hidden class=anchor aria-hidden=true href=#flag-33>#</a></h3><h4 id=take-a-look-through-the-processes-within-our-image-what-is-the-process-id-for-the-smssexe-process-if-results-are-scrolling-off-screen-try-piping-your-output-into-less>Take a look through the processes within our image. What is the process ID for the smss.exe process? If results are scrolling off-screen, try piping your output into less<a hidden class=anchor aria-hidden=true href=#take-a-look-through-the-processes-within-our-image-what-is-the-process-id-for-the-smssexe-process-if-results-are-scrolling-off-screen-try-piping-your-output-into-less>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Ans</td><td><code>368</code></td></tr></tbody></table><p><img loading=lazy src=https://i.imgur.com/mTM1rbC.png></p><h3 id=flag-34>Flag 3.4<a hidden class=anchor aria-hidden=true href=#flag-34>#</a></h3><h4 id=in-addition-to-viewing-active-processes-we-can-also-view-active-network-connections-at-the-time-of-image-creation-lets-do-this-now-with-the-command-volatility--f-memory_fileraw---profileprofile-netscan-unfortunately-something-not-great-is-going-to-happen-here-due-to-the-sheer-age-of-the-target-operating-system-as-the-command-netscan-doesnt-support-it>In addition to viewing active processes, we can also view active network connections at the time of image creation! Let&rsquo;s do this now with the command <code>volatility -f MEMORY_FILE.raw --profile=PROFILE netscan</code>. Unfortunately, something not great is going to happen here due to the sheer age of the target operating system as the command netscan doesn&rsquo;t support it.<a hidden class=anchor aria-hidden=true href=#in-addition-to-viewing-active-processes-we-can-also-view-active-network-connections-at-the-time-of-image-creation-lets-do-this-now-with-the-command-volatility--f-memory_fileraw---profileprofile-netscan-unfortunately-something-not-great-is-going-to-happen-here-due-to-the-sheer-age-of-the-target-operating-system-as-the-command-netscan-doesnt-support-it>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Ans</td><td><code>N/A</code></td></tr></tbody></table><h3 id=flag-35>Flag 3.5<a hidden class=anchor aria-hidden=true href=#flag-35>#</a></h3><h4 id=its-fairly-common-for-malware-to-attempt-to-hide-itself-and-the-process-associated-with-it-that-being-said-we-can-view-intentionally-hidden-processes-via-the-command-psxview-what-process-has-only-one-false-listed>It&rsquo;s fairly common for malware to attempt to hide itself and the process associated with it. That being said, we can view intentionally hidden processes via the command <code>psxview</code>. What process has only one &lsquo;False&rsquo; listed?<a hidden class=anchor aria-hidden=true href=#its-fairly-common-for-malware-to-attempt-to-hide-itself-and-the-process-associated-with-it-that-being-said-we-can-view-intentionally-hidden-processes-via-the-command-psxview-what-process-has-only-one-false-listed>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Ans</td><td><code>csrss.exe</code></td></tr></tbody></table><p><img loading=lazy src=https://i.imgur.com/RovjndU.png></p><h3 id=flag-36>Flag 3.6<a hidden class=anchor aria-hidden=true href=#flag-36>#</a></h3><h4 id=in-addition-to-viewing-hidden-processes-via-psxview-we-can-also-check-this-with-a-greater-focus-via-the-command-ldrmodules-three-columns-will-appear-here-in-the-middle-inload-ininit-inmem-if-any-of-these-are-false-that-module-has-likely-been-injected-which-is-a-really-bad-thing-on-a-normal-system-the-grep-statement-above-should-return-no-output-which-process-has-all-three-columns-listed-as-false-other-than-system>In addition to viewing hidden processes via psxview, we can also check this with a greater focus via the command &rsquo;ldrmodules&rsquo;. Three columns will appear here in the middle, InLoad, InInit, InMem. If any of these are false, that module has likely been injected which is a really bad thing. On a normal system the grep statement above should return no output. Which process has all three columns listed as &lsquo;False&rsquo; (other than System)?<a hidden class=anchor aria-hidden=true href=#in-addition-to-viewing-hidden-processes-via-psxview-we-can-also-check-this-with-a-greater-focus-via-the-command-ldrmodules-three-columns-will-appear-here-in-the-middle-inload-ininit-inmem-if-any-of-these-are-false-that-module-has-likely-been-injected-which-is-a-really-bad-thing-on-a-normal-system-the-grep-statement-above-should-return-no-output-which-process-has-all-three-columns-listed-as-false-other-than-system>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Ans</td><td><code>csrss.exe</code></td></tr><tr><td><img loading=lazy src=https://i.imgur.com/Ss1qJhg.png></td><td></td></tr></tbody></table><h3 id=flag-37>Flag 3.7<a hidden class=anchor aria-hidden=true href=#flag-37>#</a></h3><h4 id=injected-code-can-be-a-huge-issue-and-is-highly-indicative-of-very-very-bad-things-we-can-check-for-this-with-the-command-malfind-using-the-full-command-volatility--f-memory_fileraw---profileprofile-malfind--d-destination-directory-we-can-not-only-find-this-code-but-also-dump-it-to-our-specified-directory-lets-do-this-now-well-use-this-dump-later-for-more-analysis-how-many-files-does-this-generate>Injected code can be a huge issue and is highly indicative of very very bad things. We can check for this with the command <code>malfind</code>. Using the full command <code>volatility -f MEMORY_FILE.raw --profile=PROFILE malfind -D &lt;Destination Directory></code> we can not only find this code, but also dump it to our specified directory. Let&rsquo;s do this now! We&rsquo;ll use this dump later for more analysis. How many files does this generate?<a hidden class=anchor aria-hidden=true href=#injected-code-can-be-a-huge-issue-and-is-highly-indicative-of-very-very-bad-things-we-can-check-for-this-with-the-command-malfind-using-the-full-command-volatility--f-memory_fileraw---profileprofile-malfind--d-destination-directory-we-can-not-only-find-this-code-but-also-dump-it-to-our-specified-directory-lets-do-this-now-well-use-this-dump-later-for-more-analysis-how-many-files-does-this-generate>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Ans</td><td><code>12</code></td></tr><tr><td><img loading=lazy src=https://i.imgur.com/jhMFuBz.png></td><td></td></tr></tbody></table><h3 id=flag-38>Flag 3.8<a hidden class=anchor aria-hidden=true href=#flag-38>#</a></h3><h4 id=last-but-certainly-not-least-we-can-view-all-of-the-dlls-loaded-into-memory-dlls-are-shared-system-libraries-utilized-in-system-processes-these-are-commonly-subjected-to-hijacking-and-other-side-loading-attacks-making-them-a-key-target-for-forensics-lets-list-all-of-the-dlls-in-memory-now-with-the-command-dlllist>Last but certainly not least we can view all of the DLLs loaded into memory. DLLs are shared system libraries utilized in system processes. These are commonly subjected to hijacking and other side-loading attacks, making them a key target for forensics. Let&rsquo;s list all of the DLLs in memory now with the command <code>dlllist</code><a hidden class=anchor aria-hidden=true href=#last-but-certainly-not-least-we-can-view-all-of-the-dlls-loaded-into-memory-dlls-are-shared-system-libraries-utilized-in-system-processes-these-are-commonly-subjected-to-hijacking-and-other-side-loading-attacks-making-them-a-key-target-for-forensics-lets-list-all-of-the-dlls-in-memory-now-with-the-command-dlllist>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Ans</td><td><code>n/a</code></td></tr></tbody></table><h3 id=flag-39>Flag 3.9<a hidden class=anchor aria-hidden=true href=#flag-39>#</a></h3><h4 id=now-that-weve-seen-all-of-the-dlls-running-in-memory-lets-go-a-step-further-and-pull-them-out-do-this-now-with-the-command-volatility--f-memory_fileraw---profileprofile---pidpid-dlldump--d-destination-directory-where-the-pid-is-the-process-id-of-the-infected-process-we-identified-earlier-questions-five-and-six-how-many-dlls-does-this-end-up-pulling>Now that we&rsquo;ve seen all of the DLLs running in memory, let&rsquo;s go a step further and pull them out! Do this now with the command <code>volatility -f MEMORY_FILE.raw --profile=PROFILE --pid=PID dlldump -D &lt;Destination Directory></code> where the PID is the process ID of the infected process we identified earlier (questions five and six). How many DLLs does this end up pulling?<a hidden class=anchor aria-hidden=true href=#now-that-weve-seen-all-of-the-dlls-running-in-memory-lets-go-a-step-further-and-pull-them-out-do-this-now-with-the-command-volatility--f-memory_fileraw---profileprofile---pidpid-dlldump--d-destination-directory-where-the-pid-is-the-process-id-of-the-infected-process-we-identified-earlier-questions-five-and-six-how-many-dlls-does-this-end-up-pulling>#</a></h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Ans</td><td><code>12</code></td></tr></tbody></table><blockquote><p>First find the PID, ref to question 5: CSRSS.EXE is the process
<img loading=lazy src=https://i.imgur.com/JwLhiI7.png></p></blockquote><blockquote><p>dump the DLLs
<img loading=lazy src=https://i.imgur.com/fkVd0lW.png></p></blockquote><hr><h2 id=task-04-post-actions>Task 04: Post Actions<a hidden class=anchor aria-hidden=true href=#task-04-post-actions>#</a></h2><p>Now that we&rsquo;ve performed some basic forensics, let&rsquo;s go a step further and see what the community at large has to say about the items we&rsquo;ve discovered. Check out the following two sites and upload the injected code we yanked out of our previous section. You can pull this code either via SCP with the box above, your local volatility workstation, or via a download link attached to this task.</p><ul><li>VirusTotal - <a href=https://www.virustotal.com/gui/home/upload>Link</a></li><li>Hybrid Analysis - <a href=https://www.hybrid-analysis.com/>Link</a></li></ul><h3 id=flags-4>Flags 4<a hidden class=anchor aria-hidden=true href=#flags-4>#</a></h3><table><thead><tr><th></th><th style=text-align:center></th><th></th></tr></thead><tbody><tr><td>1</td><td style=text-align:center>Upload the extracted files to VirusTotal for examination.</td><td style=text-align:left><code>na</code></td></tr><tr><td>2</td><td style=text-align:center>Upload the extracted files to Hybrid Analysis for examination - Note, this will also upload to VirusTotal but for the sake of demonstration we have done this separately.</td><td style=text-align:left><code>na</code></td></tr><tr><td>3</td><td style=text-align:center>What malware has our sample been infected with? You can find this in the results of VirusTotal and Hybrid Anaylsis.</td><td style=text-align:left><code>Cridex</code></td></tr></tbody></table><h4 id=explanation-flag43>Explanation Flag4.3<a hidden class=anchor aria-hidden=true href=#explanation-flag43>#</a></h4><p><strong>Step 1: Get the DLL list</strong></p><p><img loading=lazy src=https://i.imgur.com/MIdjNrx.png></p><p><strong>step 2: upload them to VT</strong></p><blockquote><p>one of them return the malware name</p></blockquote><p><img loading=lazy src=https://i.imgur.com/t67noV1.png></p><hr><h3 id=task-05-extra-credit>task 05: Extra Credit<a hidden class=anchor aria-hidden=true href=#task-05-extra-credit>#</a></h3><p>Interested in going further? Here&rsquo;s a slew of awesome resources (both paid and free in no particular order) to check out and learn more!</p><p><strong>AlienVault Open Threat Exchange (OTX)</strong> - An open-source threat tracking system. Create pulses based on your malware analysis work and check out the work of others. <a href=https://otx.alienvault.com/dashboard/new>Link</a></p><p><strong>SANS 408</strong> - Windows Forensic Analysis <a href=https://www.sans.org/blog/for408-windows-forensic-analysis-has-been-renumbered-to-for500-windows-forensics-analysis/>Link</a></p><p><strong>&ldquo;The Art of Memory Forensics&rdquo;</strong> - <a href=https://amzn.to/3ffexFK>Link</a></p><p><img loading=lazy src=https://i.imgur.com/j2BBJxa.jpg></p><p><strong>MemLabs</strong> - A collection of CTF-style memory forensic labs <a href=https://github.com/stuxnet999/MemLabs>Link</a></p><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://classroom.anir0y.in/tags/tryhackme/>Tryhackme</a></li><li><a href=https://classroom.anir0y.in/tags/rooms/>Rooms</a></li><li><a href=https://classroom.anir0y.in/tags/thm/>Thm</a></li><li><a href=https://classroom.anir0y.in/tags/volatility/>Volatility</a></li></ul><nav class=paginav><a class=prev href=https://classroom.anir0y.in/post/investigatingwindows/><span class=title>¬´ Prev</span><br><span>Investigating Windows</span>
</a><a class=next href=https://classroom.anir0y.in/post/scripts-dominos/><span class=title>Next ¬ª</span><br><span>Domino‚Äôs India Data Leak Of 18 Cr Orders Resurfaces; Customer Location, Mobile Numbers Exposed</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack me Room Volatility on x" href="https://x.com/intent/tweet/?text=Try%20Hack%20me%20Room%20Volatility&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-bpvolatility%2f&amp;hashtags=tryhackme%2crooms%2cthm%2cVolatility"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack me Room Volatility on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-bpvolatility%2f&amp;title=Try%20Hack%20me%20Room%20Volatility&amp;summary=Try%20Hack%20me%20Room%20Volatility&amp;source=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-bpvolatility%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack me Room Volatility on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-bpvolatility%2f&title=Try%20Hack%20me%20Room%20Volatility"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack me Room Volatility on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-bpvolatility%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack me Room Volatility on whatsapp" href="https://api.whatsapp.com/send?text=Try%20Hack%20me%20Room%20Volatility%20-%20https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-bpvolatility%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack me Room Volatility on telegram" href="https://telegram.me/share/url?text=Try%20Hack%20me%20Room%20Volatility&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-bpvolatility%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack me Room Volatility on ycombinator" href="https://news.ycombinator.com/submitlink?t=Try%20Hack%20me%20Room%20Volatility&u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2fthm-room-bpvolatility%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>YOU CAN REUSE MY CONTENT</span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>