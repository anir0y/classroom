<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Try Hack Me Red Team Threat Intel | Classroom</title><meta name=keywords content="tryhackme,rooms,thm"><meta name=description content="Try Hack Me Room Red Team Threat Intel solved by Animesh Roy. this is a walkthough. read more..."><meta name=author content="Animesh Roy"><link rel=canonical href=https://classroom.anir0y.in/post/tryhackme-redteamthreatintel/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=16x16 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=icon type=image/png sizes=32x32 href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=apple-touch-icon href=https://classroom.anir0y.in/img/avatar.jpeg><link rel=mask-icon href=https://classroom.anir0y.in/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://classroom.anir0y.in/post/tryhackme-redteamthreatintel/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://classroom.anir0y.in/post/tryhackme-redteamthreatintel/"><meta property="og:site_name" content="Classroom"><meta property="og:title" content="Try Hack Me Red Team Threat Intel"><meta property="og:description" content="Try Hack Me Room Red Team Threat Intel solved by Animesh Roy. this is a walkthough. read more..."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-08-12T13:05:49+05:30"><meta property="article:modified_time" content="2022-08-12T13:05:49+05:30"><meta property="article:tag" content="Tryhackme"><meta property="article:tag" content="Rooms"><meta property="article:tag" content="Thm"><meta property="og:image" content="https://classroom.anir0y.in/img/redteamthreatintel.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://classroom.anir0y.in/img/redteamthreatintel.png"><meta name=twitter:title content="Try Hack Me Red Team Threat Intel"><meta name=twitter:description content="Try Hack Me Room Red Team Threat Intel solved by Animesh Roy. this is a walkthough. read more..."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://classroom.anir0y.in/post/"},{"@type":"ListItem","position":2,"name":"Try Hack Me Red Team Threat Intel","item":"https://classroom.anir0y.in/post/tryhackme-redteamthreatintel/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Try Hack Me Red Team Threat Intel","name":"Try Hack Me Red Team Threat Intel","description":"Try Hack Me Room Red Team Threat Intel solved by Animesh Roy. this is a walkthough. read more...","keywords":["tryhackme","rooms","thm"],"articleBody":"OverView Follow @anir0y Operating System Security Operating System Security [Subscription Required] Operating System Security Task 01: Introduction Threat Intelligence (TI) or Cyber Threat Intelligence (CTI) is the information, or TTPs (Tactics, Techniques, and Procedures), attributed to an adversary, commonly used by defenders to aid in detection measures. The red cell can leverage CTI from an offensive perspective to assist in adversary emulation.\nLearning Objectives\nUnderstand the basics of threat intelligence and how it can be applied to red team engagements. Learn how to create a threat-intel-driven campaign. Use frameworks to understand concepts and leverage threat intelligence. Task 02: What is Threat Intelligence Traditionally, defenders use threat intelligence to provide context to the ever-changing threat landscape and quantify findings. IOCs are quantified by traces left by adversaries such as domains, IPs, files, strings, etc. The blue team can utilize various IOCs to build detections and analyze behavior. From a red team perspective, you can think of threat intelligence as the red team’s analysis of the blue team’s ability to properly leverage CTI for detections.\nTask 03: Applying Threat Intel to the Red Team To aid in consuming CTI and collecting TTPs, red teams will often use threat intelligence platforms and frameworks such as MITRE ATT\u0026CK, TIBER-EU, and OST Map.\nThese cyber frameworks will collect known TTPs and categorize them based on varying characteristics such as,\nThreat Group Kill Chain Phase Tactic Objective/Goal Once a targeted adversary is selected, the goal is to identify all TTPs categorized with that chosen adversary and map them to a known cyber kill chain. This concept is covered further in the next task.\nLeveraging TTPs is used as a planning technique rather than something a team will focus on during engagement execution. Depending on the size of the team, a CTI team or threat intelligence operator may be employed to gather TTPs for the red team. During the execution of an engagement, the red team will use threat intelligence to craft tooling, modify traffic and behavior, and emulate the targeted adversary. This concept is covered further in task 5.\nOverall the red team consumes threat intelligence to analyze and emulate the behaviors of adversaries through collected TTPs and IOCs.\nTask 04: The TIBER-EU Framework TIBER-EU (Threat Intelligence-based Ethical Red Teaming) is a common framework developed by the European Central Bank that centers around the use of threat intelligence.\nFrom the ECB TIBER-EU white paper, “The Framework for Threat Intelligence-based Ethical Red Teaming (TIBER-EU) enables European and national authorities to work with financial infrastructures and institutions (hereafter referred to collectively as ’entities’) to put in place a programme to test and improve their resilience against sophisticated cyber attacks.”\nThe main difference between this framework and others is the “Testing” phase that requires threat intelligence to feed the red team’s testing.\nThis framework encompasses a best practice rather than anything actionable from a red team perspective.\nThere are several public white papers and documents if you are interested in reading about this framework further,\nhttps://www.ecb.europa.eu/pub/pdf/other/ecb.tiber_eu_framework.en.pdf https://www.crest-approved.org/tiber-eu/index.html https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/pf/ms/sb-tiber-eu.pdf Task 05: TTP Mapping TTP Mapping is employed by the red cell to map adversaries’ collected TTPs to a standard cyber kill chain. Mapping TTPs to a kill chain aids the red team in planning an engagement to emulate an adversary.\nTo begin the process of mapping TTPs, an adversary must be selected as the target. An adversary can be chosen based on,\nTarget Industry Employed Attack Vectors Country of Origin Other Factors As an example for this task, we have decided to use APT 39, a cyber-espionage group run by the Iranian ministry, known for targeting a wide variety of industries.\nWe will use the Lockheed Martin cyber kill chain as our standard cyber kill chain to map TTPs.\nThe first cyber framework we will be collecting TTPs from is MITRE ATT\u0026CK. If you are not familiar with MITRE ATT\u0026CK, it provides IDs and descriptions of categorized TTPs. For more information about MITRE and how to use ATT\u0026CK, check out the MITRE room.\nATT\u0026CK provides a basic summary of a group’s collected TTPs. We can use ATT\u0026CK Navigator to help us visualize each TTP and categorize its place in the kill chain. Navigator visualizes the ATT\u0026CK chain with the adversaries’ designated TTPs highlighted under the corresponding sub-section.\nTo use the ATT\u0026CK Navigator: navigate to the groups summary page, next to “Techniques Used,” navigate to “ATT\u0026CK Navigator Layers,” from the dropdown navigate to “view.” An ATT\u0026CK Navigator layer should have opened with the selected group’s TTPs highlighted in a new tab.\nGoing through the Navigator layer, we can assign various TTPs we want to employ during the engagement. Below is a compiled kill chain with mapped TTPs for APT39.\nReconnaissance: No identified TTPs, use internal team methodology\nWeaponization:\nCommand and Scripting Interpreter PowerShell Python VBA Delivery:\nExploit Public-Facing Applications Spearphishing Exploitation:\nRegistry modification Scheduled tasks Keylogging Credential dumping Installation:\nIngress tool transfer Proxy usage Command \u0026 Control:\nWeb protocols (HTTP/HTTPS) DNS Actions on Objectives\nExfiltration over C2 MITRE ATT\u0026CK will do most of the work needed, but we can also supplement threat intelligence information with other platforms and frameworks. Another example of a TTP framework is OST Map.\nOST Map provides a visual map to link multiple threat actors and their TTPs.\nOther open-source and enterprise threat intelligence platforms can aid red teamers in adversary emulation and TTP mapping, such as,\nMandiant Advantage Ontic CrowdStrike Falcon 5 Answer the questions below 5.1: Read the above and use MITRE ATT\u0026CK Navigator to answer the questions below using a Carbanak layer. N/A\n5.2: How many Command and Control techniques are employed by Carbanak? follow this Map ans is 2\n5.3: What signed binary did Carbanak use for defense evasion? Rundll32 ref to \"Defense Evasion\" tactic\n5.4: What Initial Access technique is employed by Carbanak? Valid Accounts ref to \"Initial Access\" tactic\nTask 06: Other Red Team Applications of CTI CTI can also be used during engagement execution, emulating the adversary’s behavioral characteristics, such as\nC2 Traffic\nUser Agents Ports, Protocols Listener Profiles Malware and Tooling\nIOCs Behaviors The first behavioral use of CTI we will showcase is C2 (Command \u0026 Control) traffic manipulation. A red team can use CTI to identify adversaries’ traffic and modify their C2 traffic to emulate it.\nAn example of a red team modifying C2 traffic based on gathered CTI is malleable profiles. A malleable profile allows a red team operator to control multiple aspects of a C2’s listener traffic.\nInformation to be implemented in the profile can be gathered from ISACs and collected IOCs or packet captures, including,\nHost Headers POST URIs Server Responses and Headers The gathered traffic can aid a red team to make their traffic look similar to the targeted adversary to get closer to the goal of adversary emulation.\nThe second behavioral use of CTI is analyzing behavior and actions of an adversaries’ malware and tools to develop your offensive tooling that emulates similar behaviors or has similar vital indicators.\nAn example of this could be an adversary using a custom dropper. The red team can emulate the dropper by,\nIdentifying traffic Observing syscalls and API calls Identifying overall dropper behavior and objective Tampering with file signatures and IOCs In telligence and tools gathered from behavioral threat intelligence can aid a red team in preparing the specific tools they will use to action planned TTPs.\nTask 07: Creating a Threat Intel Driven Campaign A threat-intel-driven campaign will take all knowledge and topics previously covered and combine them to create a well-planned and researched campaign.\nThe task flow in this room logically follows the same path you would take as a red team to begin planning a campaign,\nIdentify framework and general kill chain Determine targeted adversary Identify adversary’s TTPs and IOCs Map gathered threat intelligence to a kill chain or framework Draft and maintain needed engagement documentation Determine and use needed engagement resources (tools, C2 modification, domains, etc.) In this task, we will be walking through a red team’s thought process from beginning to end of planning a threat-intel-driven campaign.\nThe hardest part of planning a threat-intel-driven campaign can be mapping two different cyber frameworks. To make this process simpler we have provided a basic table comparing the Lockheed Martin Cyber Kill Chain and the MITRE ATT\u0026CK framework.\nCyber Kill Chain MITRE ATT\u0026CK Recon Reconnaissance Weaponization Execution Delivery Initial Access Exploitation Initial Access Installation Persistence / Defense Evasion Command \u0026 Control Command and Control Actions on Objectives Exfiltration / Impact To begin working through this task, download the required resources and launch the static site attached to this task.\nYour team has already decided to use the Lockheed Martin cyber kill chain to emulate APT 41 as the adversary that best fits the client’s objectives and scope.\n7 Answer the questions below Open the provided ATT\u0026CK Navigator layer and identify matched TTPs to the cyber kill chain. Once TTPs are identified, map them to the cyber kill chain in the static site.\nTo complete the challenge, you must submit one technique name per kill chain section.\nOnce the chain is complete and you have received the flag, submit it below.\nref to image below\nTask 08: Conclusion When planning an engagement, it is essential to note the significance of adversary emulation and how threat intelligence can aid you in identifying adversaries and their behaviors.\nEach red team will have its methodology of collecting and digesting threat intelligence in the real world. This room covered basic ground-level knowledge of varying concepts commonly applied to a red team scenario.\nWhen planning an engagement, remember that it is crucial to look at scenarios from all perspectives: offensive, defensive, and the adversary’s.\nThreat intelligence allows us as the red team to look deeper into an adversary’s behavior by using the blue team’s methodology to our advantage.\n","wordCount":"1628","inLanguage":"en","image":"https://classroom.anir0y.in/img/redteamthreatintel.png","datePublished":"2022-08-12T13:05:49+05:30","dateModified":"2022-08-12T13:05:49+05:30","author":{"@type":"Person","name":"Animesh Roy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://classroom.anir0y.in/post/tryhackme-redteamthreatintel/"},"publisher":{"@type":"Organization","name":"Classroom","logo":{"@type":"ImageObject","url":"https://classroom.anir0y.in/img/avatar.jpeg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://classroom.anir0y.in/ accesskey=h title="Classroom (Alt + H)"><img src=https://classroom.anir0y.in/img/avatar.jpeg alt aria-label=logo height=35>Classroom</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://classroom.anir0y.in/post/ title=Posts><span>Posts</span></a></li><li><a href=https://classroom.anir0y.in/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://classroom.anir0y.in/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://classroom.anir0y.in/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://classroom.anir0y.in/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://classroom.anir0y.in/about/me/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://classroom.anir0y.in/>Home</a>&nbsp;»&nbsp;<a href=https://classroom.anir0y.in/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Try Hack Me Red Team Threat Intel</h1><div class=post-description>Try Hack Me Room Red Team Threat Intel solved by Animesh Roy. this is a walkthough. read more...</div><div class=post-meta><span title='2022-08-12 13:05:49 +0530 IST'>August 12, 2022</span>&nbsp;·&nbsp;<span>8 min</span>&nbsp;·&nbsp;<span>Animesh Roy</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/anir0y/classroom/tree/master/content/post/TryHackMe-redteamthreatintel.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><figure class=entry-cover><img loading=eager src=https://classroom.anir0y.in/img/redteamthreatintel.png alt="cover image"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>OverView</a></li><li><a href=#task-01--introduction>Task 01: Introduction</a></li><li><a href=#task-02--what-is-threat-intelligence>Task 02: What is Threat Intelligence</a></li><li><a href=#task-03-applying-threat-intel-to-the-red-team>Task 03: Applying Threat Intel to the Red Team</a></li><li><a href=#task-04--the-tiber-eu-framework>Task 04: The TIBER-EU Framework</a></li><li><a href=#task-05-ttp-mapping>Task 05: TTP Mapping</a><ul><li><a href=#5-answer-the-questions-below>5 Answer the questions below</a></li></ul></li><li><a href=#task-06-other-red-team-applications-of-cti>Task 06: Other Red Team Applications of CTI</a></li><li><a href=#task-07--creating-a-threat-intel-driven-campaign>Task 07: Creating a Threat Intel Driven Campaign</a><ul><li><a href=#7-answer-the-questions-below>7 Answer the questions below</a></li></ul></li><li><a href=#task-08--conclusion>Task 08: Conclusion</a></li></ul></nav></div></details></div><div class=post-content><h2 id=overview>OverView<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><table><thead><tr><th><script src=https://tryhackme.com/badge/434937></script></th><th><a class=twitter-follow-button href=https://twitter.com/anir0y data-size=large>Follow @anir0y<a></th></tr></thead><tbody><tr><td>Operating System Security</td><td><img alt=logo loading=lazy src=https://tryhackme-images.s3.amazonaws.com/room-icons/81642a6b52cd6596b8c09ccc219becfe.png></td></tr><tr><td><b>Operating System Security [Subscription Required]</b></td><td><a href=https://tryhackme.com/room/operatingsystemsecurity>Operating System Security</a></td></tr></tbody></table><h2 id=task-01--introduction>Task 01: Introduction<a hidden class=anchor aria-hidden=true href=#task-01--introduction>#</a></h2><p>Threat Intelligence (TI) or Cyber Threat Intelligence (CTI) is the information, or TTPs (Tactics, Techniques, and Procedures), attributed to an adversary, commonly used by defenders to aid in detection measures. The red cell can leverage CTI from an offensive perspective to assist in adversary emulation.</p><p>Learning Objectives</p><ul><li>Understand the basics of threat intelligence and how it can be applied to red team engagements.</li><li>Learn how to create a threat-intel-driven campaign.</li><li>Use frameworks to understand concepts and leverage threat intelligence.</li></ul><hr><h2 id=task-02--what-is-threat-intelligence>Task 02: What is Threat Intelligence<a hidden class=anchor aria-hidden=true href=#task-02--what-is-threat-intelligence>#</a></h2><p>Traditionally, defenders use threat intelligence to provide context to the ever-changing threat landscape and quantify findings. IOCs are quantified by traces left by adversaries such as domains, IPs, files, strings, etc. The blue team can utilize various IOCs to build detections and analyze behavior. From a red team perspective, you can think of threat intelligence as the red team&rsquo;s analysis of the blue team&rsquo;s ability to properly leverage CTI for detections.</p><hr><h2 id=task-03-applying-threat-intel-to-the-red-team>Task 03: Applying Threat Intel to the Red Team<a hidden class=anchor aria-hidden=true href=#task-03-applying-threat-intel-to-the-red-team>#</a></h2><p>To aid in consuming CTI and collecting TTPs, red teams will often use threat intelligence platforms and frameworks such as MITRE ATT&amp;CK, TIBER-EU, and OST Map.</p><p>These cyber frameworks will collect known TTPs and categorize them based on varying characteristics such as,</p><ul><li>Threat Group</li><li>Kill Chain Phase</li><li>Tactic</li><li>Objective/Goal</li></ul><p>Once a targeted adversary is selected, the goal is to identify all TTPs categorized with that chosen adversary and map them to a known cyber kill chain. This concept is covered further in the next task.</p><p>Leveraging TTPs is used as a planning technique rather than something a team will focus on during engagement execution. Depending on the size of the team, a CTI team or threat intelligence operator may be employed to gather TTPs for the red team. During the execution of an engagement, the red team will use threat intelligence to craft tooling, modify traffic and behavior, and emulate the targeted adversary. This concept is covered further in task 5.</p><p>Overall the red team consumes threat intelligence to analyze and emulate the behaviors of adversaries through collected TTPs and IOCs.</p><hr><h2 id=task-04--the-tiber-eu-framework>Task 04: The TIBER-EU Framework<a hidden class=anchor aria-hidden=true href=#task-04--the-tiber-eu-framework>#</a></h2><p>TIBER-EU (Threat Intelligence-based Ethical Red Teaming) is a common framework developed by the European Central Bank that centers around the use of threat intelligence.</p><p>From the ECB TIBER-EU white paper, &ldquo;The Framework for Threat Intelligence-based Ethical Red Teaming (TIBER-EU) enables European and national authorities to work with financial infrastructures and institutions (hereafter referred to collectively as &rsquo;entities&rsquo;) to put in place a programme to test and improve their resilience against sophisticated cyber attacks.&rdquo;</p><p><img alt=img loading=lazy src=https://i.imgur.com/su8hzod.png></p><p>The main difference between this framework and others is the &ldquo;Testing&rdquo; phase that requires threat intelligence to feed the red team&rsquo;s testing.</p><p>This framework encompasses a best practice rather than anything actionable from a red team perspective.</p><p>There are several public white papers and documents if you are interested in reading about this framework further,</p><ul><li><a href=https://www.ecb.europa.eu/pub/pdf/other/ecb.tiber_eu_framework.en.pdf>https://www.ecb.europa.eu/pub/pdf/other/ecb.tiber_eu_framework.en.pdf</a></li><li><a href=https://www.crest-approved.org/tiber-eu/index.html>https://www.crest-approved.org/tiber-eu/index.html</a></li><li><a href=https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/pf/ms/sb-tiber-eu.pdf>https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/pf/ms/sb-tiber-eu.pdf</a></li></ul><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><hr><h2 id=task-05-ttp-mapping>Task 05: TTP Mapping<a hidden class=anchor aria-hidden=true href=#task-05-ttp-mapping>#</a></h2><p>TTP Mapping is employed by the red cell to map adversaries&rsquo; collected TTPs to a standard cyber kill chain. Mapping TTPs to a kill chain aids the red team in planning an engagement to emulate an adversary.</p><p>To begin the process of mapping TTPs, an adversary must be selected as the target. An adversary can be chosen based on,</p><ul><li>Target Industry</li><li>Employed Attack Vectors</li><li>Country of Origin</li><li>Other Factors</li></ul><p>As an example for this task, we have decided to use <a href=https://attack.mitre.org/groups/G0087/>APT 39</a>, a cyber-espionage group run by the Iranian ministry, known for targeting a wide variety of industries.</p><p>We will use the Lockheed Martin cyber kill chain as our standard cyber kill chain to map TTPs.</p><p><img alt=img loading=lazy src=https://i.imgur.com/JopqA4m.png></p><p>The first cyber framework we will be collecting TTPs from is <a href=https://attack.mitre.org/>MITRE ATT&amp;CK</a>. If you are not familiar with MITRE ATT&amp;CK, it provides IDs and descriptions of categorized TTPs. For more information about MITRE and how to use ATT&amp;CK, check out the MITRE room.</p><p>ATT&amp;CK provides a basic summary of a group&rsquo;s collected TTPs. We can use <a href=https://mitre-attack.github.io/attack-navigator/>ATT&amp;CK Navigator</a> to help us visualize each TTP and categorize its place in the kill chain. Navigator visualizes the ATT&amp;CK chain with the adversaries&rsquo; designated TTPs highlighted under the corresponding sub-section.</p><p>To use the ATT&amp;CK Navigator: navigate to the groups summary page, next to &ldquo;Techniques Used,&rdquo; navigate to &ldquo;ATT&amp;CK Navigator Layers,&rdquo; from the dropdown navigate to &ldquo;view.&rdquo; An ATT&amp;CK Navigator layer should have opened with the selected group&rsquo;s TTPs highlighted in a new tab.</p><p>Going through the Navigator layer, we can assign various TTPs we want to employ during the engagement. Below is a compiled kill chain with mapped TTPs for APT39.</p><ol><li><p>Reconnaissance:
No identified TTPs, use internal team methodology</p></li><li><p>Weaponization:</p><ul><li>Command and Scripting Interpreter</li><li>PowerShell</li><li>Python</li><li>VBA</li></ul></li><li><p>Delivery:</p><ul><li>Exploit Public-Facing Applications</li><li>Spearphishing</li></ul></li><li><p>Exploitation:</p><ul><li>Registry modification</li><li>Scheduled tasks</li><li>Keylogging</li><li>Credential dumping</li></ul></li><li><p>Installation:</p><ul><li>Ingress tool transfer</li><li>Proxy usage</li></ul></li><li><p>Command & Control:</p><ul><li>Web protocols (HTTP/HTTPS)</li><li>DNS</li></ul></li><li><p>Actions on Objectives</p><ul><li>Exfiltration over C2</li></ul></li></ol><p>MITRE ATT&amp;CK will do most of the work needed, but we can also supplement threat intelligence information with other platforms and frameworks. Another example of a TTP framework is <a href=https://www.intezer.com/ost-map/>OST Map</a>.</p><p>OST Map provides a visual map to link multiple threat actors and their TTPs.</p><p>Other open-source and enterprise threat intelligence platforms can aid red teamers in adversary emulation and TTP mapping, such as,</p><ul><li>Mandiant Advantage</li><li>Ontic</li><li>CrowdStrike Falcon</li></ul><h3 id=5-answer-the-questions-below>5 Answer the questions below<a hidden class=anchor aria-hidden=true href=#5-answer-the-questions-below>#</a></h3><h4 id=51-read-the-above-and-use-mitre-attck-navigator-to-answer-the-questions-below-using-a-carbanak-layer>5.1: Read the above and use MITRE ATT&amp;CK Navigator to answer the questions below using a Carbanak layer.<a hidden class=anchor aria-hidden=true href=#51-read-the-above-and-use-mitre-attck-navigator-to-answer-the-questions-below-using-a-carbanak-layer>#</a></h4><p><code>N/A</code></p><h4 id=52-how-many-command-and-control-techniques-are-employed-by-carbanak>5.2: How many Command and Control techniques are employed by Carbanak?<a hidden class=anchor aria-hidden=true href=#52-how-many-command-and-control-techniques-are-employed-by-carbanak>#</a></h4><p>follow this <a href="https://mitre-attack.github.io/attack-navigator//#layerURL=https%3A%2F%2Fattack.mitre.org%2Fgroups%2FG0008%2FG0008-enterprise-layer.json">Map</a>
ans is <code>2</code></p><h4 id=53-what-signed-binary-did-carbanak-use-for-defense-evasion>5.3: What signed binary did Carbanak use for defense evasion?<a hidden class=anchor aria-hidden=true href=#53-what-signed-binary-did-carbanak-use-for-defense-evasion>#</a></h4><p><code>Rundll32</code> ref to <code>"Defense Evasion" tactic</code></p><h4 id=54-what-initial-access-technique-is-employed-by-carbanak>5.4: What Initial Access technique is employed by Carbanak?<a hidden class=anchor aria-hidden=true href=#54-what-initial-access-technique-is-employed-by-carbanak>#</a></h4><p><code>Valid Accounts</code> ref to <code>"Initial Access" tactic</code></p><hr><h2 id=task-06-other-red-team-applications-of-cti>Task 06: Other Red Team Applications of CTI<a hidden class=anchor aria-hidden=true href=#task-06-other-red-team-applications-of-cti>#</a></h2><p>CTI can also be used during engagement execution, emulating the adversary&rsquo;s behavioral characteristics, such as</p><ul><li><p>C2 Traffic</p><ul><li>User Agents</li><li>Ports, Protocols</li><li>Listener Profiles</li></ul></li><li><p>Malware and Tooling</p><ul><li>IOCs</li><li>Behaviors</li></ul></li></ul><p>The first behavioral use of CTI we will showcase is C2 (Command & Control) traffic manipulation. A red team can use CTI to identify adversaries&rsquo; traffic and modify their C2 traffic to emulate it.</p><p>An example of a red team modifying C2 traffic based on gathered CTI is <a href=https://www.cobaltstrike.com/help-malleable-c2>malleable profiles</a>. A malleable profile allows a red team operator to control multiple aspects of a C2&rsquo;s listener traffic.</p><p>Information to be implemented in the profile can be gathered from ISACs and collected IOCs or packet captures, including,</p><ul><li>Host Headers</li><li>POST URIs</li><li>Server Responses and Headers</li></ul><p>The gathered traffic can aid a red team to make their traffic look similar to the targeted adversary to get closer to the goal of adversary emulation.</p><p>The second behavioral use of CTI is analyzing behavior and actions of an adversaries&rsquo; malware and tools to develop your offensive tooling that emulates similar behaviors or has similar vital indicators.</p><p>An example of this could be an adversary using a custom dropper. The red team can emulate the dropper by,</p><ul><li>Identifying traffic</li><li>Observing syscalls and API calls</li><li>Identifying overall dropper behavior and objective</li><li>Tampering with file signatures and IOCs</li></ul><p>In
telligence and tools gathered from behavioral threat intelligence can aid a red team in preparing the specific tools they will use to action planned TTPs.</p><hr><h2 id=task-07--creating-a-threat-intel-driven-campaign>Task 07: Creating a Threat Intel Driven Campaign<a hidden class=anchor aria-hidden=true href=#task-07--creating-a-threat-intel-driven-campaign>#</a></h2><p>A threat-intel-driven campaign will take all knowledge and topics previously covered and combine them to create a well-planned and researched campaign.</p><p>The task flow in this room logically follows the same path you would take as a red team to begin planning a campaign,</p><ul><li>Identify framework and general kill chain</li><li>Determine targeted adversary</li><li>Identify adversary&rsquo;s TTPs and IOCs</li><li>Map gathered threat intelligence to a kill chain or framework</li><li>Draft and maintain needed engagement documentation</li><li>Determine and use needed engagement resources (tools, C2 modification, domains, etc.)</li></ul><p>In this task, we will be walking through a red team&rsquo;s thought process from beginning to end of planning a threat-intel-driven campaign.</p><p>The hardest part of planning a threat-intel-driven campaign can be mapping two different cyber frameworks. To make this process simpler we have provided a basic table comparing the Lockheed Martin Cyber Kill Chain and the MITRE ATT&amp;CK framework.</p><table><thead><tr><th>Cyber Kill Chain</th><th>MITRE ATT&amp;CK</th></tr></thead><tbody><tr><td>Recon</td><td>Reconnaissance</td></tr><tr><td>Weaponization</td><td>Execution</td></tr><tr><td>Delivery</td><td>Initial Access</td></tr><tr><td>Exploitation</td><td>Initial Access</td></tr><tr><td>Installation</td><td>Persistence / Defense Evasion</td></tr><tr><td>Command & Control</td><td>Command and Control</td></tr><tr><td>Actions on Objectives</td><td>Exfiltration / Impact</td></tr></tbody></table><p>To begin working through this task, download the required resources and launch the static site attached to this task.</p><p>Your team has already decided to use the Lockheed Martin cyber kill chain to emulate <a href=https://attack.mitre.org/groups/G0096/>APT 41</a> as the adversary that best fits the client&rsquo;s objectives and scope.</p><h3 id=7-answer-the-questions-below>7 Answer the questions below<a hidden class=anchor aria-hidden=true href=#7-answer-the-questions-below>#</a></h3><p>Open the provided ATT&amp;CK Navigator layer and identify matched TTPs to the cyber kill chain. Once TTPs are identified, map them to the cyber kill chain in the static site.</p><p>To complete the challenge, you must submit one technique name per kill chain section.</p><p>Once the chain is complete and you have received the flag, submit it below.</p><p><code>ref to image below</code></p><p><img alt=img loading=lazy src=https://i.imgur.com/t6KuNQn.png></p><hr><h2 id=task-08--conclusion>Task 08: Conclusion<a hidden class=anchor aria-hidden=true href=#task-08--conclusion>#</a></h2><p>When planning an engagement, it is essential to note the significance of adversary emulation and how threat intelligence can aid you in identifying adversaries and their behaviors.</p><p>Each red team will have its methodology of collecting and digesting threat intelligence in the real world. This room covered basic ground-level knowledge of varying concepts commonly applied to a red team scenario.</p><p>When planning an engagement, remember that it is crucial to look at scenarios from all perspectives: offensive, defensive, and the adversary&rsquo;s.</p><p>Threat intelligence allows us as the red team to look deeper into an adversary&rsquo;s behavior by using the blue team&rsquo;s methodology to our advantage.</p><hr><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-3526678290068011 data-ad-slot=7160066188></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=anir0y data-description="Support me on Buy me a coffee!" data-message data-color=#5F7FFF data-position=Right data-x_margin=18 data-y_margin=18></script></div><footer class=post-footer><ul class=post-tags><li><a href=https://classroom.anir0y.in/tags/tryhackme/>Tryhackme</a></li><li><a href=https://classroom.anir0y.in/tags/rooms/>Rooms</a></li><li><a href=https://classroom.anir0y.in/tags/thm/>Thm</a></li></ul><nav class=paginav><a class=prev href=https://classroom.anir0y.in/post/tryhackme-phishingemails4/><span class=title>« Prev</span><br><span>Try Hack Me Phishing Emails 4</span>
</a><a class=next href=https://classroom.anir0y.in/post/what_is_ransomware/><span class=title>Next »</span><br><span>Basics of Ransomware</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Red Team Threat Intel on x" href="https://x.com/intent/tweet/?text=Try%20Hack%20Me%20Red%20Team%20Threat%20Intel&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-redteamthreatintel%2f&amp;hashtags=tryhackme%2crooms%2cthm"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Red Team Threat Intel on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-redteamthreatintel%2f&amp;title=Try%20Hack%20Me%20Red%20Team%20Threat%20Intel&amp;summary=Try%20Hack%20Me%20Red%20Team%20Threat%20Intel&amp;source=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-redteamthreatintel%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Red Team Threat Intel on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-redteamthreatintel%2f&title=Try%20Hack%20Me%20Red%20Team%20Threat%20Intel"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Red Team Threat Intel on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-redteamthreatintel%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Red Team Threat Intel on whatsapp" href="https://api.whatsapp.com/send?text=Try%20Hack%20Me%20Red%20Team%20Threat%20Intel%20-%20https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-redteamthreatintel%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Red Team Threat Intel on telegram" href="https://telegram.me/share/url?text=Try%20Hack%20Me%20Red%20Team%20Threat%20Intel&amp;url=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-redteamthreatintel%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Try Hack Me Red Team Threat Intel on ycombinator" href="https://news.ycombinator.com/submitlink?t=Try%20Hack%20Me%20Red%20Team%20Threat%20Intel&u=https%3a%2f%2fclassroom.anir0y.in%2fpost%2ftryhackme-redteamthreatintel%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>YOU CAN REUSE MY CONTENT</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>